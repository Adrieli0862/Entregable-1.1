;/*FB_PKG_DELIM*/

__d("EchoBackupCompareUtils",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b;return{contentSubtype:a.contentSubtype,contentType:a.contentType,reactionTsList:(b=a.reactionAuthoritativeTimestampMs)==null?void 0:b.map(function(a){return a.displayName==null?null:Number(a.displayName)/1e3}).filter(Boolean).sort(),receiptTsList:(b=a.receiptStatusList)==null?void 0:b.map(function(a){return a.timestampMs==null?null:a.timestampMs/1e3}).filter(Boolean).sort()}}function g(a,b){if(a==null&&b==null)return!0;if(a!=null&&b!=null)return a.length===b.length&&a.every(function(a,c){return a===b[c]});return a==null&&(b==null?void 0:b.length)===0||b==null&&(a==null?void 0:a.length)===0?!0:!1}function b(a,b){return b!=null&&a.contentSubtype===b.contentSubtype&&a.contentType===b.contentType&&g(a.reactionTsList,b.reactionTsList)}f.buildEchoDocCacheValue=a;f.echoEquals=b}),66);
__d("EchoCommonUtils",[],(function(a,b,c,d,e,f){"use strict";c="Echo-Doc-Version";function a(a,b){var c=a.localKey;a=a.transportKey;return c+"@"+a+"-"+b}function b(a,b,c){return a==null?{localKey:b,transportKey:c}:{displayName:a,localKey:b,transportKey:c}}f.ECHO_COMMON_FIELD_DOCUMENT_VERSION=c;f.getEchoAddressFieldNameWithSuffix=a;f.craftEchoAddress=b}),66);
__d("EchoConstants",[],(function(a,b,c,d,e,f){"use strict";a=new Set(["\0","\x01","\x02","\x03","\x04","\x05","\x06","\x07","\b","\t","\n","\v","\f","\r","\x0e","\x0f","\x10","\x11","\x12","\x13","\x14","\x15","\x16","\x17","\x18","\x19","\x1a","\x1b","\x1c","\x1d","\x1e","\x1f",'"'," ","(",")",",",":",";","<",">","@","[","]","\\"]);f.ADDRESS_LOCAL_KEY_CHARS_NEED_QUOTE=a}),66);
__d("EchoDecodingUtils",["invariant","EchoConstants","WALogger"],(function(a,b,c,d,e,f,g,h){"use strict";function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] "," not a valid number in echo message"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Fail to decode if the input string does not have CRLF"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Address  decode failed with value: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] invalid input to echoDecodeAddressList detected"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] invalid transportKey in address detected"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] invalid localKey in address detected"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] parse localKey in address failed"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] echoDecodeAddress failed"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] conditional quote mode decode failed"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] invalid input to echoDecodeAddress"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Fail decoding because we didn't have a closing quote. Error Field: ",""]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Field name is blank"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] This is a raw line and we cannot decode its field name and value."]);u=function(){return a};return a}var v=new Set([]);function w(a,b){if(a.length===0)return;var c=a.indexOf(":");if(c===-1){d("WALogger").ERROR(u());return}var e=a.substring(0,c).trim();a=a.substring(c+1).trim();if(e.length===0){d("WALogger").ERROR(t());return}if(a.length===0){b.has(e)&&b["delete"](e);return}b.set(e,a)}function x(a,b,c,e){c===void 0&&(c=new Set());var f=!1,g=b==="conditional"&&a[0]==='"',h="",i=g?1:0;while(i<a.length){var j=a[i];if(b==="conditional"&&!g&&j==='"')break;if(!g&&c.has(j))break;if(g&&!f&&j==='"'){g=!1;i++;break}if(g&&!f&&j==="\\"){if(i===a.length-1)break;f=!0}else f&&j==="r"?h+="\r":f&&j==="n"?h+="\n":h+=j,f=!1;i++}if(g||h.length===0){c=(j=e)!=null?j:"unknown";d("WALogger").ERROR(s(),c);return{remainder:a,result:null,success:!1}}return{remainder:a.substring(i),result:h,success:!0}}function y(a,b){if(a.length===0){d("WALogger").ERROR(r());return{remainder:a,result:null,success:!1}}var c=a.trimLeft();c=x(c,"conditional",d("EchoConstants").ADDRESS_LOCAL_KEY_CHARS_NEED_QUOTE,b);if(!c.success){d("WALogger").ERROR(q());return{remainder:a,result:null,success:!1}}c.result!=null||h(0,47923);if(c.remainder[0]==="@"){var e=z(c.remainder,c.result,b);return{remainder:e.remainder,result:e.result,success:e.success}}e=c.result;c=c.remainder.trimLeft();if(c.startsWith("<")){c=z(c.substring(1),void 0,b);b=c.result;var f=c.remainder;if(c.success&&b!=null&&f.startsWith(">"))if(e.length===0)return{remainder:f.substring(1),result:b,success:!0};else return{remainder:f.substring(1),result:babelHelpers["extends"]({},b,{displayName:e}),success:!0}}d("WALogger").ERROR(p());return{remainder:a,result:null,success:!1}}function z(a,b,c){var e=b==null?a.trimLeft():a;b=b;if(b==null){var f=x(e,"conditional",d("EchoConstants").ADDRESS_LOCAL_KEY_CHARS_NEED_QUOTE,c);if(!f.success){d("WALogger").ERROR(o());return{remainder:a,result:null,success:!1}}b=f.result;e=f.remainder}if(b==null||b.length===0||e[0]!=="@"){d("WALogger").ERROR(n());return{remainder:a,result:null,success:!1}}f=x(e.substring(1),"never",d("EchoConstants").ADDRESS_LOCAL_KEY_CHARS_NEED_QUOTE,c);e=f.result;if(f.success&&e!=null&&e.length>0)return{remainder:f.remainder,result:{localKey:b,transportKey:e},success:!0};else{d("WALogger").ERROR(m());return{remainder:a,result:null,success:!1}}}function A(a,b){if(a.length===0){d("WALogger").ERROR(l());return{result:null,success:!1}}var c=y(a,b);if(!c.success){d("WALogger").ERROR(k(),a);return{result:null,success:!1}}c.result!=null||h(0,47927);a=[c.result];c=c.remainder;while(c.startsWith(",")){var e=y(c.substring(1).trimLeft(),b);if(e.success)e.result!=null&&a.push(e.result),c=e.remainder;else break}return{result:a,success:!0}}function a(a){var b=new Map(),c=a.split("\r\n");if(c.length===1&&c[0]===a){d("WALogger").ERROR(j());return b}c.forEach(function(a){return w(a,b)});return b}function b(a,b){a=a.get(b);if(a==null||a.length===0)return{result:null,success:!1};a=x(a,"conditional",v,b);b=a.result;a=a.success;return{result:b,success:a}}function c(a,b){a=B(a,b);return{result:(b=a.result)!=null?b:0,success:a.success}}function B(a,b){a=a.get(b);if(a==null||a.length===0)return{result:null,success:!1};a=parseInt(a,10);if(isNaN(a)){d("WALogger").ERROR(i(),b);return{result:null,success:!1}}else return Number.isSafeInteger(a)?{result:a,success:!0}:{result:a>Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,success:!0}}function e(a,b){a=C(a,b);return{result:(b=a.result)!=null?b:!1,success:a.success}}function C(a,b){a=B(a,b);return!a.success||a.result!==0&&a.result!==1?{result:null,success:!1}:{result:a.result===1,success:!0}}function f(a,b){a=a.get(b);if(a==null||a.length===0)return{result:null,success:!1};a=y(a,b);b=a.result;a=a.success;return{result:b,success:a}}function D(a,b){a=a.get(b);return a==null||a.length===0?{result:null,success:!1}:A(a,b)}function E(a,b){a=a.get(b);if(a==null||a.length===0)return{result:null,success:!1};b=a.split(",").map(function(a){return a.trim()}).filter(Boolean);return b.length===0?{result:null,success:!1}:{result:b,success:!0}}g.echoDecodeFields=a;g.echoDecodeStringField=b;g.echoDecodeIntField=c;g.echoDecodeNullableIntField=B;g.echoDecodeBooleanField=e;g.echoDecodeNullableBooleanField=C;g.echoDecodeAddressField=f;g.echoDecodeAddressListField=D;g.echoDecodeObjectIdListField=E}),98);
__d("EchoEncodingUtils",["EchoConstants","EchoMessage","MAWMsgType","WABase64","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h=new Set(['"',"\\","\n","\r","\0"]),i=new Set(["\0","\x01","\x02","\x03","\x04","\x05","\x06","\x07","\b","\t","\n","\v","\f","\r","\x0e","\x0f","\x10","\x11","\x12","\x13","\x14","\x15","\x16","\x17","\x18","\x19","\x1a","\x1b","\x1c","\x1d","\x1e","\x1f",'"',"\\"]);function j(a,b){for(var b=b,c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;if(a.indexOf(e)>=0)return!0}return!1}function k(a,b,d){d===void 0&&(d=new Set());if(a.length<=0)throw c("unrecoverableViolation")("The input string must be non-empty","labyrinth_web");var e=b;b==="conditional"&&(j(a,d)?e="always":e="never");if(e==="never")return a;b='"';for(d=0;d<a.length;d++){e=a[d];h.has(e)?(b+="\\",e==="\r"?b+="r":e==="\n"?b+="n":b+=e):b+=e}return b+'"'}function l(a){if(!Number.isSafeInteger(a))throw c("unrecoverableViolation")("The input value must be a safe integer","labyrinth_web");return a.toString()}function m(a){var b="",c=a.displayName,e=a.localKey;a=a.transportKey;c!=null&&c.length>0&&(b+=k(c,"always")+" <");b+=k(e,"conditional",d("EchoConstants").ADDRESS_LOCAL_KEY_CHARS_NEED_QUOTE)+"@"+a;c!=null&&c.length>0&&(b+=">");return b}function n(a,b,c){c!=null&&c.length!==0&&a.set(b,k(c,"conditional",i))}function a(a,b,c){if(c!=null){c=l(c);n(a,b,c)}}function b(a,b,c){if(c!=null){c=l(c?1:0);n(a,b,c)}}function e(a,b,c){c!=null&&a.set(b,m(c))}function f(a,b,c){if(c!=null){var d="";c.forEach(function(a,b){d+=m(a),b<c.length-1&&(d+=", ")});a.set(b,d)}}function o(a){var b="";a.forEach(function(a,c){b=b+c+": "+a+"\r\n"});return b}function p(a){return d("WABase64").encodeB64UrlSafe(a)}function q(a){switch(a){case d("MAWMsgType").MSG_TYPE.TEXT:return d("EchoMessage").EchoXMessageContentType.TEXT;case d("MAWMsgType").MSG_TYPE.IMAGE:return d("EchoMessage").EchoXMessageContentType.IMAGE;case d("MAWMsgType").MSG_TYPE.VIDEO:return d("EchoMessage").EchoXMessageContentType.VIDEO;case d("MAWMsgType").MSG_TYPE.PTT:return d("EchoMessage").EchoXMessageContentType.AUDIO;case d("MAWMsgType").MSG_TYPE.STICKER:return d("EchoMessage").EchoXMessageContentType.STICKER;case d("MAWMsgType").MSG_TYPE.GIF:return d("EchoMessage").EchoXMessageContentType.GIF;case d("MAWMsgType").MSG_TYPE.XMA:return d("EchoMessage").EchoXMessageContentType.XMA;case d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:return d("EchoMessage").EchoXMessageContentType.DOCUMENT;case d("MAWMsgType").MSG_TYPE.REACTION:return d("EchoMessage").EchoXMessageContentType.REACTION;case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:return d("EchoMessage").EchoXMessageContentType.EPHEMERAL_SETTINGS;case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SYNC_RESPONSE:return d("EchoMessage").EchoXMessageContentType.EPHEMERAL_SYNC_RESPONSE;case d("MAWMsgType").MSG_TYPE.DELETE_FOR_ME:return d("EchoMessage").EchoXMessageContentType.MESSAGE_DELETE_FOR_ME;case d("MAWMsgType").MSG_TYPE.REVOKED:return d("EchoMessage").EchoXMessageContentType.UNSEND;case d("MAWMsgType").MSG_TYPE.GROUP_INVITE:return d("EchoMessage").EchoXMessageContentType.GROUP_INVITES;default:return d("EchoMessage").EchoXMessageContentType.UNKNOWN}}g.echoSetStringField=n;g.echoSetIntField=a;g.echoSetBooleanField=b;g.echoSetAddressField=e;g.echoSetAddressListField=f;g.echoEncodeFields=o;g.convertMediaKeyToString=p;g.convertDbMsgTypeToXMessageContentType=q}),98);
__d("EchoMessage",["$InternalEnum","EchoCommonUtils","EchoDecodingUtils","EchoEncodingUtils","EchoMessageMediaFieldUtils","EchoMessageQuoteFieldUtils","EchoMessageReceiptStatusFieldUtils","EchoMessageXMAFieldUtils","FBLogger","WALogger","gkx","qex"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] mandatory xma data is missing from xma message, msgId: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([""," Message origin: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([""," Message origin: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([""," Message origin: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([""," Message origin: ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] fieldsMap is empty for the echo message"]);m=function(){return a};return a}var n="Message-ID",o="Thread-ID",p="Sort-Order",q="Display-Timestamp",r="Authoritative-Timestamp",s="From",t="Text",u="Text-Size",v="Send-Error",w="Is-Tombstoned",x="Expire-Timestamp",y="Delete-Timestamp",z="Ephemeral-Duration",A="Message-Content-Type",B="X-Message-Content-Type",C="Message-Content-Subtype",D="Is-Forwarded",E="X-Offline-Threading-ID",F="X-Thread-ID",G="X-Message-Placeholder-Type",H="Reactions",I="Reaction-Authoritative-Timestamps",J="X-Reaction-Offline-Threading-IDs",K="Echo-Serialization-Origin",L="Revoke-Sent-Timestamp",M="Revoke-Unsent-Timestamp",N="Edit-Count",O="Edit-Contents-",P="Edit-Timestamps-",Q=1,R=(f=b("$InternalEnum"))({NONE:"none",SMALL:"small",MEDIUM:"medium",LARGE:"large"}),S=f({NONE:"none",UNSEND:"unsend"}),T=f({DECRYPTION_FAILURE:"decryption_failure",UNSUPPORTED_NEEDS_UPDATE:"unsupported_needs_update",TEXT:"text",ADMIN_MESSAGE:"admin_message",MEDIA:"media",XMA:"xma",NULL_STATE:"null_state",PLACEHOLDER:"placeholder"}),U=f({UNKNOWN:"unknown",TEXT:"text",IMAGE:"image",VIDEO:"video",AUDIO:"audio",STICKER:"sticker",GIF:"gif",URL:"url",EPHEMERAL_SETTINGS:"ephemeral_settings",LOCATION:"location",DOCUMENT:"document",UNSEND:"unsend",SCREENSHOT_ACTION:"screenshot_action",REACTION:"reaction",XMA:"xma",VISUAL_MESSAGE_VIDEO:"visual_message_video",VISUAL_MESSAGE_IMAGE:"visual_message_image",VISUAL_MESSAGE_ACTION:"visual_message_action",SCREEN_RECORDING_ACTION:"screen_recording_action",MESSAGE_DELETE_FOR_ME:"message_delete_for_me",ENCRYPTED_BACKUP_NEW_DEVICE_ENROLLMENT:"encrypted_backup_new_device_enrollment",SENDER_KEY:"sender_key",DELETE_THREAD:"delete_thread",READ_THREAD:"read_thread",UNREAD_THREAD:"unread_thread",REACTION_UNSEND:"reaction_unsend",GROUP_INVITES:"group_invites",EPHEMERAL_SYNC_RESPONSE:"ephemeral_sync_response"}),V=f({NO_PLACEHOLDER:"0",DECRYPTION_FAILURE:"-1",CLIENT_NOT_SUPPORTED_NEED_UPDATE:"-2",UNAVIALABLE_DEVICE:"-3"}),W=f({UNKNOWN:"Unknown",WEB:"Web",MOBILE:"Mobile"});function a(a){var b=new Map();da(b,a);"mediaData"in a&&a.mediaData&&d("EchoMessageMediaFieldUtils").echoMessageSetMediaMetadataFields(b,a.mediaData);return d("EchoEncodingUtils").echoEncodeFields(b)}function X(a,b){var e=[],f=0,g=new Set();if(c("gkx")("23918")||c("qex")._("778")===!0){var h;b.forEach(function(c,f,h){c=f.startsWith(O);h=f.startsWith(P);if(c||h){h=f.slice(c?O.length:P.length);if(!g.has(h)){g.add(h);c=(f=d("EchoDecodingUtils").echoDecodeStringField(b,""+O+h).result)!=null?f:"";f=((f=d("EchoDecodingUtils").echoDecodeIntField(b,""+P+h).result)!=null?f:0)/1e3;e.push({messageId:h,originalMessageId:a,text:c,timestamp:f})}}});f=(h=d("EchoDecodingUtils").echoDecodeIntField(b,N).result)!=null?h:0}return{editCount:f,editHistory:e}}function e(a){a=d("EchoDecodingUtils").echoDecodeFields(a);if(a.size===0){d("WALogger").ERROR(m());return null}var b=d("EchoDecodingUtils").echoDecodeStringField(a,n),e=d("EchoDecodingUtils").echoDecodeStringField(a,o),f=d("EchoDecodingUtils").echoDecodeIntField(a,p),g=d("EchoDecodingUtils").echoDecodeIntField(a,q),N=d("EchoDecodingUtils").echoDecodeStringField(a,A),O=d("EchoDecodingUtils").echoDecodeStringField(a,B),P=d("EchoDecodingUtils").echoDecodeStringField(a,C);if(b.success&&e.success&&f.success){b=b.result;if(b==null)throw c("FBLogger")("messenger_e2ee_web").mustfixThrow("The decoded messageId cannot be null");e=e.result;if(e==null)throw c("FBLogger")("messenger_e2ee_web").mustfixThrow("The decoded threadId cannot be null");N=N==null?void 0:N.result;if(N==null)throw c("FBLogger")("messenger_e2ee_web").mustfixThrow("The decoded contentTypeString cannot be null");var R=X(b,a),U=R.editCount;R=R.editHistory;P={contentSubtype:aa(P.result),contentType:Z(N),displayTimestampMs:g.success?g.result:f.result,editCount:U,editHistory:R,messageId:b,sortOrderMs:f.result,threadId:e};N=$(O.result);N!=null&&(P.xContentType=N);g=d("EchoDecodingUtils").echoDecodeAddressField(a,s);g.success&&g.result!=null&&(P.from=g.result);U=d("EchoDecodingUtils").echoDecodeNullableBooleanField(a,w);U.success&&U.result!=null&&(P.isTombstoned=U.result);R=d("EchoDecodingUtils").echoDecodeStringField(a,t);R.success&&R.result!=null&&(P.text=R.result);b=d("EchoDecodingUtils").echoDecodeStringField(a,u);if(b.success&&b.result!=null){f=Y(b.result);P.textSize=f}e=d("EchoDecodingUtils").echoDecodeStringField(a,G);if(e.success&&e.result!=null){O=ba(e.result);P.xMessagePlaceholderType=O}N=d("EchoDecodingUtils").echoDecodeStringField(a,v);N.success&&N.result!=null&&(P.sendError=N.result);g=d("EchoDecodingUtils").echoDecodeNullableIntField(a,x);g.success&&g.result!=null&&(P.expireTimestampMs=g.result);U=d("EchoDecodingUtils").echoDecodeNullableIntField(a,y);U.success&&U.result!=null&&(P.deleteTimestampMs=U.result);R=d("EchoDecodingUtils").echoDecodeNullableIntField(a,z);R.success&&R.result!=null&&(P.ephemeralDurationInSec=R.result);b=d("EchoDecodingUtils").echoDecodeNullableIntField(a,r);b.success&&b.result!=null&&(P.authoritativeTimestampMs=b.result);f=d("EchoMessageReceiptStatusFieldUtils").echoMessageDecodeReceiptStatusDataFields(a);f.length>0&&(P.receiptStatusList=f);e=d("EchoDecodingUtils").echoDecodeNullableBooleanField(a,D);e.success&&e.result!=null&&(P.isForwarded=e.result);O=d("EchoDecodingUtils").echoDecodeStringField(a,E);O.success&&O.result!=null&&(P.xOfflineThreadingId=O.result);N=d("EchoDecodingUtils").echoDecodeStringField(a,F);N.success&&N.result!=null&&(P.xThreadId=N.result);g=d("EchoDecodingUtils").echoDecodeStringField(a,K);g.success&&g.result!=null&&(P.serializationOrigin=ca(g.result));U=d("EchoDecodingUtils").echoDecodeNullableIntField(a,d("EchoCommonUtils").ECHO_COMMON_FIELD_DOCUMENT_VERSION);P.version=U.success&&U.result!=null?U.result:Q;R=d("EchoDecodingUtils").echoDecodeAddressListField(a,H);R.success&&R.result!=null&&(P.reactions=R.result);b=d("EchoDecodingUtils").echoDecodeAddressListField(a,I);b.success&&b.result!=null&&(P.reactionAuthoritativeTimestampMs=b.result);f=d("EchoDecodingUtils").echoDecodeAddressListField(a,J);f.success&&f.result!=null&&(P.reactionXOfflineThreadingIds=f.result);e=d("EchoMessageQuoteFieldUtils").echoMessageDecodeQuoteFields(a);e!=null&&(P.quoteData=e);if((P==null?void 0:P.contentType)===T.MEDIA||(P==null?void 0:P.contentType)===T.XMA){O=d("EchoMessageMediaFieldUtils").echoMessageDecodeMediaDataFields(a,P==null?void 0:P.contentType,P==null?void 0:P.xContentType);N="[labyrinth_web] mandatory media data is missing from media message, msgId: "+P.messageId+".";O!=null?(O.length!==1&&O.length!==2&&((P==null?void 0:P.contentType)===T.MEDIA&&d("WALogger").ERROR(l(),N,P.serializationOrigin),(P==null?void 0:P.contentType)===T.XMA&&d("WALogger").WARN(k(),N,P.serializationOrigin)),P.mediaData=O[0],O.length===2&&(P.previewMediaData=O[1])):((P==null?void 0:P.contentType)===T.MEDIA&&d("WALogger").ERROR(j(),N,P.serializationOrigin),(P==null?void 0:P.contentType)===T.XMA&&d("WALogger").WARN(i(),N,P.serializationOrigin))}if(P.contentType===T.PLACEHOLDER&&P.contentSubtype===S.UNSEND){g=d("EchoDecodingUtils").echoDecodeNullableIntField(a,L);g.success&&g.result!=null&&(P.revokeSentTimestampMs=g.result);U=d("EchoDecodingUtils").echoDecodeNullableIntField(a,M);U.success&&U.result!=null&&(P.revokeUnsentTimestampMS=U.result)}if(P.contentType===T.XMA){R=d("EchoMessageXMAFieldUtils").decodeXMAFields(a);if(R!=null)P.xmaData=R;else{d("WALogger").ERROR(h(),P.messageId);return null}}return P}else return null}function Y(a){return(a=R.cast(a))!=null?a:R.NONE}function Z(a){return(a=T.cast(a))!=null?a:T.TEXT}function $(a){return U.cast(a)}function aa(a){return(a=S.cast(a))!=null?a:S.NONE}function ba(a){return(a=V.cast(a))!=null?a:V.NO_PLACEHOLDER}function ca(a){return(a=W.cast(a))!=null?a:W.UNKNOWN}function da(a,b){var e;(e=d("EchoEncodingUtils")).echoSetStringField(a,n,b.messageId);e.echoSetStringField(a,o,b.threadId);e.echoSetIntField(a,p,b.sortOrderMs);e.echoSetIntField(a,q,b.displayTimestampMs);e.echoSetIntField(a,r,b.authoritativeTimestampMs);e.echoSetAddressField(a,s,b.from);e.echoSetStringField(a,t,b.text);b.textSize!=null&&d("EchoEncodingUtils").echoSetStringField(a,u,b.textSize);b.xMessagePlaceholderType!=null&&d("EchoEncodingUtils").echoSetStringField(a,G,b.xMessagePlaceholderType);d("EchoEncodingUtils").echoSetStringField(a,v,b.sendError);d("EchoEncodingUtils").echoSetBooleanField(a,w,b.isTombstoned);d("EchoEncodingUtils").echoSetIntField(a,x,b.expireTimestampMs);d("EchoEncodingUtils").echoSetIntField(a,y,b.deleteTimestampMs);d("EchoEncodingUtils").echoSetIntField(a,z,b.ephemeralDurationInSec);b.contentType!=null&&d("EchoEncodingUtils").echoSetStringField(a,A,b.contentType);b.xContentType!=null&&d("EchoEncodingUtils").echoSetStringField(a,B,b.xContentType);d("EchoMessageReceiptStatusFieldUtils").echoMessageSetReceiptStatusDataFields(a,b.receiptStatusList);d("EchoEncodingUtils").echoSetBooleanField(a,D,b.isForwarded);d("EchoEncodingUtils").echoSetStringField(a,E,b.xOfflineThreadingId);d("EchoEncodingUtils").echoSetStringField(a,F,b.xThreadId);d("EchoEncodingUtils").echoSetIntField(a,d("EchoCommonUtils").ECHO_COMMON_FIELD_DOCUMENT_VERSION,b.version);b.contentSubtype!=null&&d("EchoEncodingUtils").echoSetStringField(a,C,b.contentSubtype);d("EchoEncodingUtils").echoSetAddressListField(a,H,b.reactions);d("EchoEncodingUtils").echoSetAddressListField(a,I,b.reactionAuthoritativeTimestampMs);d("EchoEncodingUtils").echoSetAddressListField(a,J,b.reactionXOfflineThreadingIds);d("EchoMessageQuoteFieldUtils").echoMessageSetQuoteFields(a,b);b.serializationOrigin!=null&&d("EchoEncodingUtils").echoSetStringField(a,K,b.serializationOrigin);b.revokeSentTimestampMs!=null&&d("EchoEncodingUtils").echoSetIntField(a,L,b.revokeSentTimestampMs);b.revokeUnsentTimestampMS!=null&&d("EchoEncodingUtils").echoSetIntField(a,M,b.revokeUnsentTimestampMS);e=b.xmaData;e!=null&&d("EchoMessageXMAFieldUtils").echoMessageSetXMAFields(a,e);(c("gkx")("23918")||c("qex")._("778")===!0)&&((e=b.editHistory)==null?void 0:e.length)>0&&(d("EchoEncodingUtils").echoSetIntField(a,N,b.editCount),b.editHistory.forEach(function(b){var c=b.messageId;c!=null&&(d("EchoEncodingUtils").echoSetStringField(a,O+c,b.text),d("EchoEncodingUtils").echoSetIntField(a,P+c,b.timestamp*1e3))}))}g.ECHO_SERIALIZATION_ORIGIN=K;g.ECHO_MESSAGE_FIELD_NAME_EDIT_COUNT=N;g.ECHO_MESSAGE_FIELD_NAME_EDIT_CONTENT_PREFIX=O;g.ECHO_MESSAGE_FIELD_NAME_EDIT_TS_PREFIX=P;g.ECHO_MESSAGE_MIGRATION_DOCUMENT_VERSION=Q;g.MessageTextSize=R;g.EchoMessageContentSubtype=S;g.EchoMessageContentType=T;g.EchoXMessageContentType=U;g.EchoMessagePlaceholderType=V;g.EchoSerializationOriginType=W;g.encodeEchoMessage=a;g.decodeEchoMessage=e}),98);
__d("EchoMessageMediaFieldUtils",["$InternalEnum","EchoDecodingUtils","EchoEncodingUtils","EchoMessage","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] multi blob media message: cannot find secondary attachment object id"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] multi blob media message: cannot find primary attachment object id"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] multi blob media message: can not parse objects ids. "," msgType: "," mediaType: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Missing enum fields from media fields: attachmentType: "," mediaPreviewContentType: "," mediaAttachmentType: "," EchoOrigin: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Missing "," from media fields. AttachmentType: "," EchoOrigin: ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Missing "," from media fields. AttachmentType: ",". EchoOrigin: ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Unable to get primary and secondary attachment object ids"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] multi blob media message: primary attachment object id is null. msgType: "," mediaType: ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Missing xAttachmentType field from required media metadata fields"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Missing xContentType field from required media metadata fields"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Missing plaintextHash field from required media metadata fields"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Missing mediaKeyTimestamp field from required media metadata fields"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Missing media key field from required media metadata fields"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Missing direct path field from required media metadata fields"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Missing attachment type from required media metadata fields"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Missing attachment object id from required media metadata fields"]);w=function(){return a};return a}var x="X-Object-Id",y="X-Attachment-Object-Ids",z="Attachment-Type",A="Content-Type",B="X-Encrypted-Hash",C="X-Attachment-Type",D="X-Backup-Ent-Fbid",E="X-Backup-Status",F="X-Content-Type",G="X-Direct-Path",H="Height",I="X-Media-Key",J="X-Media-Key-Timestamp",K="Playable-Duration",L="Preview-Height",M="Preview-Content-Type",N="Preview-Width",O="Size",P="Width",Q="X-Plaintext-Hash",R="File-Name",S="Header-Attribution-Content-Type",T=b("$InternalEnum")({IMAGE:"image",STICKER:"sticker",VIDEO:"video",GIF:"animated_image",PTT:"audio",XMA:"xma",DOCUMENT:"document"}),U=b("$InternalEnum")({IMAGE_JPEG:"image/jpeg",IMAGE_PNG:"image/png",STICKER:"image/webp",GIF:"image/gif",AUDIO_MP4:"audio/mp4",AUDIO_WAV:"audio/wav",XMA:"xma"}),V=b("$InternalEnum")({INVALID:"-1",IMAGE:"0",PTT:"1",AUDIO:"2",DOCUMENT:"3",VIDEO:"4",GIF:"5",STICKER:"6",PROFILE_PICTURE:"7",APP_STATE:"8",HISTORY_SYNC:"9",THUMBNAIL_IMAGE:"10",THUMBNAIL_VIDEO:"11",THUMBNAIL_GIF:"12",THUMBNAIL_DOCUMENT:"13",THUMBNAIL_LINK:"14",NOVI_IMAGE:"15",NOVI_VIDEO:"16",KYCID:"17",WAFFLE_IMAGE:"18",WAFFLE_VIDEO:"19",WAFFLE_GIF:"20",PAYMENT_BG_IMAGE:"21",XMA_IMAGE:"22",PAYMENT_BR_DOCUMENT:"23",BIZ_COVER_PHOTO:"24",MESSENGER_PREVIEW:"25"});function W(a){var b=a.attachmentObjectId,c=a.attachmentType,e=a.backupEntFbid,f=a.directPath,g=a.filename,h=a.encryptedHash,i=a.height,j=a.mediaBackupStatus,k=a.mediaContentType,l=a.mediaKey,m=a.mediaKeyTimestamp,n=a.mediaPlayableDuration,o=a.plaintextHash,x=a.previewContentHeight,y=a.previewContentType,z=a.previewContentWidth,A=a.size,B=a.width,C=a.xAttachmentType,D=a.xContentType;a=a.xmaData;if(b==null)d("WALogger").ERROR(w());else if(c==null)d("WALogger").ERROR(v());else if(f==null)d("WALogger").ERROR(u());else if(l==null)d("WALogger").ERROR(t());else if(m==null)d("WALogger").ERROR(s());else if(o==null)d("WALogger").ERROR(r());else if(D==null)d("WALogger").ERROR(q());else if(C==null)d("WALogger").ERROR(p());else return{attachmentObjectId:b,attachmentType:c,backupEntFbid:e,directPath:f,encryptedHash:h,filename:g,height:i,mediaBackupStatus:j,mediaContentType:k,mediaKey:l,mediaKeyTimestamp:m,mediaPlayableDuration:n,plaintextHash:o,previewContentHeight:x,previewContentType:y,previewContentWidth:z,size:A,width:B,xAttachmentType:C,xContentType:D,xmaData:a}}function a(a,b){var c;(c=d("EchoEncodingUtils")).echoSetStringField(a,x,b.attachmentObjectId);c.echoSetStringField(a,z,b.attachmentType);c.echoSetStringField(a,Q,b.plaintextHash);c.echoSetStringField(a,B,b.encryptedHash);c.echoSetIntField(a,O,b.size);c.echoSetStringField(a,I,b.mediaKey);c.echoSetIntField(a,J,b.mediaKeyTimestamp);c.echoSetStringField(a,G,b.directPath);b.mediaContentType!=null&&d("EchoEncodingUtils").echoSetStringField(a,A,b.mediaContentType);d("EchoEncodingUtils").echoSetIntField(a,P,b.width);d("EchoEncodingUtils").echoSetIntField(a,H,b.height);b.previewContentType!=null&&d("EchoEncodingUtils").echoSetStringField(a,M,b.previewContentType);b.headerAttributionContentType!=null&&d("EchoEncodingUtils").echoSetStringField(a,S,b.headerAttributionContentType);d("EchoEncodingUtils").echoSetIntField(a,N,b.previewContentWidth);d("EchoEncodingUtils").echoSetIntField(a,L,b.previewContentHeight);d("EchoEncodingUtils").echoSetIntField(a,K,b.mediaPlayableDuration);b.xAttachmentType!=null&&d("EchoEncodingUtils").echoSetStringField(a,C,b.xAttachmentType);d("EchoEncodingUtils").echoSetStringField(a,F,b.xContentType);d("EchoEncodingUtils").echoSetStringField(a,D,b.backupEntFbid);d("EchoEncodingUtils").echoSetStringField(a,E,b.mediaBackupStatus);d("EchoEncodingUtils").echoSetStringField(a,R,b.filename)}function c(a,b,c){var e={},f=!1,g=!1,h=!1;if(aa(a)){var i=ba(a,b,c);if(i==null){d("WALogger").ERROR(o(),b,c);return null}i.length!==2&&d("WALogger").ERROR(n());b=!1;c=!1;var j=i[0];i=i[1];var k={};f=Z(a,e,j);b=Z(a,k,i);g=Y(a,e,j,j);c=Y(a,k,i,j);h=X(a,e,j);j=X(a,k,i);if(!f||!g||!h||!b||!c||!j)return null;i=W(e);b=W(k);if(i!=null&&b!=null)return[i,b]}else{f=Z(a,e);g=Y(a,e);h=X(a,e);if(!f||!g||!h)return null;c=W(e);if(c!=null)return[c]}}function X(a,b,c){var e;e=(e=a.get(d("EchoMessage").ECHO_SERIALIZATION_ORIGIN))!=null?e:"";c=[{attachmentTypes:[],fieldName:"height",id:H},{attachmentTypes:[],fieldName:"width",id:P},{attachmentTypes:[V.IMAGE,V.GIF,V.STICKER,V.VIDEO,V.AUDIO],fieldName:"mediaKeyTimestamp",id:c!=null?c+"-"+J:J},{attachmentTypes:[V.IMAGE,V.GIF,V.STICKER,V.VIDEO],fieldName:"previewContentHeight",id:L},{attachmentTypes:[V.IMAGE,V.GIF,V.STICKER,V.VIDEO],fieldName:"previewContentWidth",id:N},{attachmentTypes:[V.VIDEO,V.AUDIO],fieldName:"mediaPlayableDuration",id:K},{attachmentTypes:[],fieldName:"size",id:O}];for(var f=0;f<c.length;f++){var g=c[f],h=g.attachmentTypes,i=g.fieldName;g=g.id;g=d("EchoDecodingUtils").echoDecodeIntField(a,g);var j=g.result;g=g.success;if(g&&j!=null)b[i]=j;else if(!(b.xAttachmentType!=null&&!$(h,b.xAttachmentType))){d("WALogger").ERROR(m(),i,b.xAttachmentType,e);return!1}}return!0}function Y(a,b,c,e){var f,g;f=(f=a.get(d("EchoMessage").ECHO_SERIALIZATION_ORIGIN))!=null?f:"";var h=[{fieldName:"filename",id:R}];c!=null&&e!=null?(b.attachmentObjectId=c,g=[{fieldName:"mediaKey",id:c+"-"+I},{fieldName:"plaintextHash",id:c+"-"+Q},{fieldName:"directPath",id:c+"-"+G},{fieldName:"xContentType",id:c+"-"+F},{fieldName:"mediaBackupStatus",id:e+"-"+E}],e=e+"-"+D,c=c+"-"+B):(g=[{fieldName:"mediaKey",id:I},{fieldName:"attachmentObjectId",id:x},{fieldName:"plaintextHash",id:Q},{fieldName:"directPath",id:G},{fieldName:"xContentType",id:F}],e=D,c=B);h.push({fieldName:"backupEntFbid",id:e});h.push({fieldName:"mediaContentType",id:A});h.push({fieldName:"mediaBackupStatus",id:E});h.push({fieldName:"encryptedHash",id:c});for(e=g,c=Array.isArray(e),g=0,e=c?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i;if(c){if(g>=e.length)break;i=e[g++]}else{g=e.next();if(g.done)break;i=g.value}i=i;var j=i.fieldName;i=i.id;i=d("EchoDecodingUtils").echoDecodeStringField(a,i);var k=i.result;i=i.success;if(i&&k!=null)b[j]=k;else{d("WALogger").ERROR(l(),j,b.attachmentType,f);return!1}}h.map(function(f){var c=f.fieldName;f=f.id;f=d("EchoDecodingUtils").echoDecodeStringField(a,f);var e=f.result;f=f.success;f&&e!=null&&(b[c]=e)});return!0}function Z(a,b,c){var e;e=(e=a.get(d("EchoMessage").ECHO_SERIALIZATION_ORIGIN))!=null?e:"";var f=d("EchoDecodingUtils").echoDecodeStringField(a,z);f=T.cast(f.result);f!=null&&(b.attachmentType=f);var g=d("EchoDecodingUtils").echoDecodeStringField(a,M);g=U.cast(g.result);g!=null&&(b.previewContentType=g);var h=d("EchoDecodingUtils").echoDecodeStringField(a,S);h=h.result;h!=null&&(b.headerAttributionContentType=h);h=d("EchoDecodingUtils").echoDecodeStringField(a,c!=null?c+"-"+C:C);h.success&&h.result!=null&&(a=ca(h.result),a!=null&&(b.xAttachmentType=a));if(f!=null&&(g!=null||f===T.DOCUMENT))return!0;else d("WALogger").ERROR(k(),f,g,h,e);return!1}function $(a,b){return a.reduce(function(a,c){return a||c===b},!1)}function aa(a){return a.has(y)}function ba(a,b,c){var e=d("EchoDecodingUtils").echoDecodeObjectIdListField(a,y),f=e.result;e=e.success;if(!e||f==null||f.length===0){d("WALogger").ERROR(j(),f,b,c);return null}var g=f.find(function(b){b=b+"-"+E;b=d("EchoDecodingUtils").echoDecodeStringField(a,b);var c=b.result;b=b.success;if(b&&c!=null)return!0});e=f.find(function(a){return a!==g});if(g==null){d("WALogger").ERROR(i());return null}if(e==null){d("WALogger").ERROR(h());return null}return[g,e]}function ca(a){a=V.cast(a);return(a=a)!=null?a:V.INVALID}g.AttachmentType=T;g.EchoMessageMediaPreviewType=U;g.EchoMessageActMediaAttachmentType=V;g.echoMessageSetMediaMetadataFields=a;g.echoMessageDecodeMediaDataFields=c}),98);
__d("EchoMessageQuoteFieldUtils",["EchoDecodingUtils","EchoEncodingUtils"],(function(a,b,c,d,e,f,g){"use strict";var h="Reply-Message-Id",i="Reply-Message-Sender",j="Reply-Sort-Order";function a(a){var b={quoteMessageId:"<not set>",quoteMessageSender:{localKey:"<not set>",transportKey:"<not set>"},quoteSortOrderInMs:0},c=k(a,b),d=l(a,b);a=m(a,b);return!c||!d||!a?null:b}function b(a,b){b=b.quoteData;if(b==null)return;d("EchoEncodingUtils").echoSetStringField(a,h,b.quoteMessageId);d("EchoEncodingUtils").echoSetAddressField(a,i,b.quoteMessageSender);d("EchoEncodingUtils").echoSetIntField(a,j,b.quoteSortOrderInMs)}function k(a,b){var c=[{fieldName:"quoteMessageSender",id:i}];for(var e=0;e<c.length;e++){var f=c[e],g=f.fieldName;f=f.id;f=d("EchoDecodingUtils").echoDecodeAddressField(a,f);var h=f.result;f=f.success;if(f&&h!=null)b[g]=h;else return!1}return!0}function l(a,b){var c=[{fieldName:"quoteMessageId",id:h}];for(var e=0;e<c.length;e++){var f=c[e],g=f.fieldName;f=f.id;f=d("EchoDecodingUtils").echoDecodeStringField(a,f);var i=f.result;f=f.success;if(f&&i!=null)b[g]=i;else return!1}return!0}function m(a,b){var c=[{fieldName:"quoteSortOrderInMs",id:j}];for(var e=0;e<c.length;e++){var f=c[e],g=f.fieldName;f=f.id;f=d("EchoDecodingUtils").echoDecodeIntField(a,f);var h=f.result;f=f.success;if(f&&h!=null)b[g]=h;else return!1}return!0}g.echoMessageDecodeQuoteFields=a;g.echoMessageSetQuoteFields=b}),98);
__d("EchoMessageReceiptStatusFieldUtils",["$InternalEnum","EchoCommonUtils","EchoDecodingUtils","EchoEncodingUtils","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Error occurred while decoding participants from echo doc, error: ",""]);h=function(){return a};return a}var i="Receipt-Status",j="Receipt-Timestamp",k=b("$InternalEnum")({UNKNOWN:"unknown",SENDING:"sending",SERVER_RECEIVED:"server_received",DELIVERED:"delivered",READ:"read",ERROR:"error",NON_RETRYABLE_ERROR:"non_retryable_error"});function a(a,b){if(b==null||b.length===0)return;b.forEach(function(b){d("EchoEncodingUtils").echoSetStringField(a,d("EchoCommonUtils").getEchoAddressFieldNameWithSuffix(b.address,i),b.status),b.timestampMs!=null&&d("EchoEncodingUtils").echoSetIntField(a,d("EchoCommonUtils").getEchoAddressFieldNameWithSuffix(b.address,j),b.timestampMs)})}function c(a){var b=[];l(a).forEach(function(c){var e=d("EchoCommonUtils").getEchoAddressFieldNameWithSuffix(c,i);e=d("EchoDecodingUtils").echoDecodeStringField(a,e);if(e.success){e=(e=k.cast(e.result))!=null?e:k.UNKNOWN;var f=d("EchoCommonUtils").getEchoAddressFieldNameWithSuffix(c,j);f=d("EchoDecodingUtils").echoDecodeNullableIntField(a,f);f.result!=null?b.push({address:c,status:e,timestampMs:f.result}):b.push({address:c,status:e})}});return b}function l(a){var b=new Set();for(var a=a.keys(),c=Array.isArray(a),e=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(c){if(e>=a.length)break;f=a[e++]}else{e=a.next();if(e.done)break;f=e.value}f=f;if(f.includes(i))try{f=f.split("@");var g=f[0];f=m(f[1]);b.add({localKey:g,transportKey:f})}catch(a){d("WALogger").ERROR(h(),a)}}return Array.from(b)}function m(a){a=a.split(i);return a[0].split("-")[0]}g.MessageReceiptStatus=k;g.echoMessageSetReceiptStatusDataFields=a;g.echoMessageDecodeReceiptStatusDataFields=c}),98);
__d("EchoMessageXMAFieldUtils",["$InternalEnum","EchoDecodingUtils","EchoEncodingUtils","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Missing "," from xma fields"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Missing "," from xma fields"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Missing "," from media fields"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Missing xmaIsTombstoned from xma fields"]);k=function(){return a};return a}var l="XMA-Default-CTA",m="XMA-Gating-Type",n="XMA-Header-Subtitle",o="XMA-Header-Title",p="XMA-Is-Tombstoned",q="XMA-Layout-Type",r="XMA-Max-Subtitle-Num-Lines",s="XMA-Max-Title-Num-Lines",t="XMA-Subtitle-Text",u="XMA-Target-Expiry",v="XMA-Target-ID",w="XMA-Target-Type",x="XMA-Target-Username",y="XMA-Title-Text",z=b("$InternalEnum").Mirrored(["SINGLE","HSCROLL","VSTACK","PORTRAIT"]),A=b("$InternalEnum").Mirrored(["NONE","IG_STORY_PHOTO_MENTION","IG_SINGLE_IMAGE_POST_SHARE","IG_MULTIPOST_SHARE","IG_SINGLE_VIDEO_POST_SHARE","IG_STORY_PHOTO_SHARE","IG_STORY_VIDEO_SHARE","IG_CLIPS_SHARE","IG_IGTV_SHARE","IG_SHOP_SHARE","IG_PROFILE_SHARE","IG_STORY_PHOTO_HIGHLIGHT_SHARE","IG_STORY_VIDEO_HIGHLIGHT_SHARE","IG_STORY_REPLY","IG_STORY_REACTION","FB_FEED_SHARE","FB_STORY_REPLY","FB_STORY_SHARE","FB_STORY_MENTION","FB_FEED_VIDEO_SHARE","FB_GAMING_CUSTOM_UPDATE","FB_PRODUCER_STORY_REPLY","MSG_EXTERNAL_LINK_SHARE","RTC_AUDIO_CALL","RTC_VIDEO_CALL","RTC_MISSED_AUDIO_CALL","RTC_MISSED_VIDEO_CALL","RTC_GROUP_AUDIO_CALL","RTC_GROUP_VIDEO_CALL","FB_EVENT"]),B=b("$InternalEnum").Mirrored(["NONE","PRIVATE","SENSITIVE","MISINFORMATION","MEDIA_LABEL","POST_COVER","POST_LABEL","WARNING_SCREENS","INFO","EYE_OFF","NEWS_OFF","WARNING"]);function a(a,b){b.xmaLayoutType!=null&&d("EchoEncodingUtils").echoSetStringField(a,q,b.xmaLayoutType),b.xmaTargetType!=null&&d("EchoEncodingUtils").echoSetStringField(a,w,b.xmaTargetType),d("EchoEncodingUtils").echoSetStringField(a,x,b.xmaTargetUsername),d("EchoEncodingUtils").echoSetStringField(a,v,b.xmaTargetId),b.xmaTargetExpiry!=null&&d("EchoEncodingUtils").echoSetIntField(a,u,b.xmaTargetExpiry),d("EchoEncodingUtils").echoSetStringField(a,l,b.xmaDefaultCTA),d("EchoEncodingUtils").echoSetStringField(a,o,b.xmaHeaderTitle),d("EchoEncodingUtils").echoSetStringField(a,n,b.xmaHeaderSubtitle),d("EchoEncodingUtils").echoSetStringField(a,y,b.xmaTitleText),d("EchoEncodingUtils").echoSetStringField(a,t,b.xmaSubtitleText),b.xmaMaxTitleNumLines!=null&&d("EchoEncodingUtils").echoSetIntField(a,s,b.xmaMaxTitleNumLines),b.xmaMaxSubtitleNumLines!=null&&d("EchoEncodingUtils").echoSetIntField(a,r,b.xmaMaxSubtitleNumLines),b.xmaGatingType!=null&&d("EchoEncodingUtils").echoSetStringField(a,m,b.xmaGatingType),d("EchoEncodingUtils").echoSetBooleanField(a,p,b.xmaIsTombstoned)}function c(a){var b=E(a,p);if(b==null){d("WALogger").ERROR(k());return null}var c=B.cast(d("EchoDecodingUtils").echoDecodeStringField(a,m).result),e=z.cast(d("EchoDecodingUtils").echoDecodeStringField(a,q).result),f=A.cast(d("EchoDecodingUtils").echoDecodeStringField(a,w).result);return{xmaDefaultCTA:C(a,l),xmaGatingType:c,xmaHeaderSubtitle:C(a,n),xmaHeaderTitle:C(a,o),xmaIsTombstoned:b,xmaLayoutType:e,xmaMaxSubtitleNumLines:D(a,r),xmaMaxTitleNumLines:D(a,s),xmaSubtitleText:C(a,t),xmaTargetExpiry:D(a,u),xmaTargetId:C(a,v),xmaTargetType:f,xmaTargetUsername:C(a,x),xmaTitleText:C(a,y)}}function C(a,b){a=d("EchoDecodingUtils").echoDecodeStringField(a,b);var c=a.result;a=a.success;if(a&&c!=null)return c;else d("WALogger").WARN(j(),b)}function D(a,b){a=d("EchoDecodingUtils").echoDecodeIntField(a,b);var c=a.result;a=a.success;if(a&&c!=null)return c;else d("WALogger").WARN(i(),b)}function E(a,b){a=d("EchoDecodingUtils").echoDecodeBooleanField(a,b);var c=a.result;a=a.success;if(a&&c!=null)return c;else d("WALogger").WARN(h(),b)}g.XMALayoutType=z;g.XMAContentType=A;g.XMAGatingType=B;g.echoMessageSetXMAFields=a;g.decodeXMAFields=c}),98);
__d("LSEBPayloadSerializerError",[],(function(a,b,c,d,e,f){a=Object.freeze({INVALID_BACKUP_OPERATION:-7,INVALID_CONTENT_TYPE:-6,INVALID_PAYLOAD_FORMAT:-5,CQL_DB_ERROR:-4,REQUIRED_COLUMN_NOT_PRESENT_ON_CLIENT:-3,DEPRECATED_SPROC:-2,UNKNOWN_ERROR:-1,NOT_AN_ERROR:0,BACKUP_NOT_FOUND:1,REQUIRED_TABLE_NOT_FOUND:2,NATIVE_OP_NOT_FOUND:3,BACKUP_UPLOAD_KILLSWITCHED:4,TASK_ID_NOT_FOUND:5,NOT_IMPLEMENTED:6,NOT_SUPPORTED_ON_WEB:7,DUPLICATE_TASK:8,CLIENT_STATE_NOT_LOADED:9,RECOVERY_CODE_NOT_FOUND:10,EPOCH_KEYS_NOT_FOUND:11,DEVICE_PAYLOAD_NOT_CREATED:12,NULL_DEVICE_PAYLOAD:13,EPOCH_PAYLOAD_NOT_CREATED:14,NULL_EPOCH_PAYLOAD:15,VIRTUAL_DEVICE_PAYLOAD_NOT_CREATED:16,NULL_VIRTUAL_DEVICE_PAYLOAD:17,DEVICE_METADATA_NOT_FOUND:18,NO_MATCHING_DEVICE_PUBLIC_KEY:19,NULL_MAILBOX_ROOT_KEY:20,NULL_ENCRYPTION_VERSION:21,NULL_OCMF_KEY:22,NULL_EPOCH_KEYS:23,NULL_DEVICE_ID:24,OPE_KEY_DERIVATION_FAILED:25,MESSAGE_KEY_DERIVATION_FAILED:26,NULL_MAILBOX_ROOT_KEY_V2:27,ECHO_DOCUMENT_ENCODING_FAILED:30,MESSAGE_PAYLOAD_ENCRYPTION_FAILED:40,SERVER_THREAD_ID_NOT_FOUND_FOR_JID:52,UNKNOWN_PROTOBUF_TYPE:60,SUPPLEMENTARY_DATA_KEY_UNEXPECTED:61,PROTOBUF_ENCRYPTION_FAILED:62,PROTOBUF_NOT_FOUND_IN_TOPLEVEL_TABLE:63,PROTOBUF_NOT_FOUND_IN_SUPPLEMENTAL_TABLE:64,SUPPLEMENTAL_KEY_NOT_SET_IN_CONTEXT_TABLE:65,SUPPLEMENTAL_ENCRYPTION_FAILED:66,PROTOBUF_CONTEXT_ROW_NOT_FOUND:67,PROTOBUF_FORMATTING_FAILED:68,SUPPLEMENTAL_FORMATTING_FAILED:69,PROTOBUF_ALREADY_DELETED:70,THREAD_PK_NOT_FOUND_FOR_JID:100,MESSAGE_DECRYPTION_FAILED:101,EPOCH_KEY_FETCH_FAILED:102,TOO_MANY_OPEN_EPOCHS:103,MESSAGE_RANGE_PREPARE_FAILURE:104,ECHO_DOCUMENT_RESTORE_FAILED:105,MISMATCH_POINT_QUERY_MESSAGE_AND_RANGE_LENGTH:106,INITIAL_THREADS_FETCH_FOR_RESTORE_FAILED:107,MISSING_SUPPLEMENTAL_KEY_CIPHERTEXT:108,SUPPLEMENTAL_KEY_DECRYPTION_FAILURE:109,DEVICE_ID_MISMATCH:110,RESTORE_TO_TAM_INFO:111,MISSING_SERVER_THREAD_KEY:112,MESSAGE_PK_NOT_FOUND_IN_CLIENT_MESSAGES:200,OTID_NOT_FOUND_IN_ACT_MESSAGES:201,THREAD_ID_NOT_FOUND_IN_ACT_THREADS:202,THREAD_PK_NOT_FOUND_IN_CLIENT_THREADS:203,FAILED_TO_GET_THREAD_SORT_KEY:204,MEDIA_INFO_INVALID:205,REVERB_DB_NOT_ENABLED_FOR_INSTAMADILLO:206,SKIPPED_EB_DISABLED:300,SKIPPED_THREAD_NOT_ELIGIBLE:301,SKIPPED_MESSAGE_NOT_ELIGIBLE:302,NO_EPOCHS_FOUND:400,LATEST_EPOCH_QUERY_BY_ID_FAILED:401,FOUND_EPOCH_WITH_NULL_ROOT_KEY:402,FOUND_EPOCH_WITH_NULL_ANON_ID:403,NO_RECOVERY_CODE:501,NO_ERROR:601,ERROR_GENERAL:602,UNKNOWN:603,ONBOARDING_MATERIAL_DERIVATION_FAILURE:604,NULL_DEVICE_HMAC:605,MISSING_LATEST_EPOCH_AT_ONBOARDING:606,NO_THREADS_TO_COMPARE:701,START_SORT_KEY_FAILURE:702,END_SORT_KEY_FAILURE:703,LOOPING_UPLOAD_PAYLOAD_NOT_FOUND:704,NULL_ECHO_IDENTIFIERS:705,ECHO_TIMESTAMP_CONVERSION_FAILED:706,ECHO_PROTOBUF_THREAD_ID_MISMATCH:707,ECHO_PROTOBUF_TIMESTAMP_MISMATCH:708,ECHO_PROTOBUF_OTID_MISMATCH:709,NULL_ECHO_DOCUMENT:710,INVALID_PROTOBUF_BACKUP_ACTION:711,EMPTY_ENCODED_ECHO_DOCUMENT:712,ECHO_DOCUMENT_ENCODING_UNKNOWN_ENCODING_ERROR:750,ECHO_DOCUMENT_ENCODING_MESSAGE_PK_NOT_FOUND_ERROR:751,ECHO_DOCUMENT_ENCODING_DISK_WRITE_CHECK_FAILED:752,ECHO_DOCUMENT_ENCODING_THREAD_TRANSPORT_ID_FETCH_FAILED:753,ECHO_DOCUMENT_ENCODING_FILE_WRITE_FAILED:754,ECHO_DOCUMENT_ENCODING_DISK_WRITE_DISABLED:755,ECHO_DOCUMENT_ENCODING_SHOULD_NOT_PERSIST:756,MISSING_SUPPLEMENTAL_DATA:757,ECHO_DOCUMENT_ENCODING_MESSAGE_FIELDS_REPLY_PROXY_ERROR:758,ECHO_DOCUMENT_ENCODING_MESSAGE_FIELDS_EDIT_MESSAGE_QUERY_ERROR:759,ECHO_DOCUMENT_ENCODING_MESSAGE_FIELDS_EDIT_MESSAGE_ERROR:760,ECHO_DOCUMENT_ENCODING_MESSAGE_FIELDS_RECEIPTS_ERROR:761,ECHO_DOCUMENT_ENCODING_MESSAGE_FIELDS_REACTIONS_ERROR:762,ECHO_DOCUMENT_ENCODING_MESSAGE_FIELDS_VISUAL_MESSAGE_ACTIONS_ERROR:763,ECHO_DOCUMENT_ENCODING_MESSAGE_FIELDS_POLLS_ERROR:764});f["default"]=a}),66);
__d("LSQueryBulkUtils",["ReQL"],(function(a,b,c,d,e,f,g){"use strict";async function a(a,b){b=await Promise.all(b.map(function(b){return d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a).getKeyRange(b))}));return b.flat()}async function b(a,b){await Promise.all(b.map(function(b){return a.put(b)}));return b}g.bulkGetByIndex=a;g.bulkPut=b}),98);
__d("WATextEncoding",[],(function(a,b,c,d,e,f){"use strict";e=TextEncoder;var g=TextDecoder,h=e,i=g;function a(){return new h()}function b(){return new i()}function c(a){h=a}function d(a){i=a}f.newTextEncoder=a;f.newTextDecoder=b;f.setTextEncoderClass=c;f.setTextDecoderClass=d}),66);
__d("WAWapDict",[],(function(a,b,c,d,e,f){a=3;b=["xmlstreamstart","xmlstreamend","s.whatsapp.net","type","participant","from","receipt","id","notification","disappearing_mode","status","jid","broadcast","user","devices","device_hash","to","offline","message","result","class","xmlns","duration","notify","iq","t","ack","g.us","enc","urn:xmpp:whatsapp:push","presence","config_value","picture","verified_name","config_code","key-index-list","contact","mediatype","routing_info","edge_routing","get","read","urn:xmpp:ping","fallback_hostname","0","chatstate","business_hours_config","unavailable","download_buckets","skmsg","verified_level","composing","handshake","device-list","media","text","fallback_ip4","media_conn","device","creation","location","config","item","fallback_ip6","count","w:profile:picture","image","business","2","hostname","call-creator","display_name","relaylatency","platform","abprops","success","msg","offline_preview","prop","key-index","v","day_of_week","pkmsg","version","1","ping","w:p","download","video","set","specific_hours","props","primary","unknown","hash","commerce_experience","last","subscribe","max_buckets","call","profile","member_since_text","close_time","call-id","sticker","mode","participants","value","query","profile_options","open_time","code","list","host","ts","contacts","upload","lid","preview","update","usync","w:stats","delivery","auth_ttl","context","fail","cart_enabled","appdata","category","atn","direct_connection","decrypt-fail","relay_id","mmg-fallback.whatsapp.net","target","available","name","last_id","mmg.whatsapp.net","categories","401","is_new","index","tctoken","ip4","token_id","latency","recipient","edit","ip6","add","thumbnail-document","26","paused","true","identity","stream:error","key","sidelist","background","audio","3","thumbnail-image","biz-cover-photo","cat","gcm","thumbnail-video","error","auth","deny","serial","in","registration","thumbnail-link","remove","00","gif","thumbnail-gif","tag","capability","multicast","item-not-found","description","business_hours","config_expo_key","md-app-state","expiration","fallback","ttl","300","md-msg-hist","device_orientation","out","w:m","open_24h","side_list","token","inactive","01","document","te2","played","encrypt","msgr","hide","direct_path","12","state","not-authorized","url","terminate","signature","status-revoke-delay","02","te","linked_accounts","trusted_contact","timezone","ptt","kyc-id","privacy_token","readreceipts","appointment_only","address","expected_ts","privacy","7","android","interactive","device-identity","enabled","attribute_padding","1080","03","screen_height"];c=["read-self","active","fbns","protocol","reaction","screen_width","heartbeat","deviceid","2:47DEQpj8","uploadfieldstat","voip_settings","retry","priority","longitude","conflict","false","ig_professional","replaced","preaccept","cover_photo","uncompressed","encopt","ppic","04","passive","status-revoke-drop","keygen","540","offer","rate","opus","latitude","w:gp2","ver","4","business_profile","medium","sender","prev_v_id","email","website","invited","sign_credential","05","transport","skey","reason","peer_abtest_bucket","America/Sao_Paulo","appid","refresh","100","06","404","101","104","107","102","109","103","member_add_mode","105","transaction-id","110","106","outgoing","108","111","tokens","followers","ig_handle","self_pid","tue","dec","thu","joinable","peer_pid","mon","features","wed","peer_device_presence","pn","delete","07","fri","audio_duration","admin","connected","delta","rcat","disable","collection","08","480","sat","phash","all","invite","accept","critical_unblock_low","group_update","signed_credential","blinded_credential","eph_setting","net","09","background_location","refresh_id","Asia/Kolkata","privacy_mode_ts","account_sync","voip_payload_type","service_areas","acs_public_key","v_id","0a","fallback_class","relay","actual_actors","metadata","w:biz","5","connected-limit","notice","0b","host_storage","fb_page","subject","privatestats","invis","groupadd","010","note.m4r","uuid","0c","8000","sun","372","1020","stage","1200","720","canonical","fb","011","video_duration","0d","1140","superadmin","012","Opening.m4r","keystore_attestation","dleq_proof","013","timestamp","ab_key","w:sync:app:state","0e","vertical","600","p_v_id","6","likes","014","500","1260","creator","0f","rte","destination","group","group_info","syncd_anti_tampering_fatal_exception_enabled","015","dl_bw","Asia/Jakarta","vp8/h.264","online","1320","fb:multiway","10","timeout","016","nse_retry","urn:xmpp:whatsapp:dirty","017","a_v_id","web_shops_chat_header_button_enabled","nse_call","inactive-upgrade","none","web","groups","2250","mms_hot_content_timespan_in_seconds","contact_blacklist","nse_read","suspended_group_deletion_notification","binary_version","018","https://www.whatsapp.com/otp/copy/","reg_push","shops_hide_catalog_attachment_entrypoint","server_sync",".","ephemeral_messages_allowed_values","019","mms_vcache_aggregation_enabled","iphone","America/Argentina/Buenos_Aires","01a","mms_vcard_autodownload_size_kb","nse_ver","shops_header_dropdown_menu_item","dhash","catalog_status","communities_mvp_new_iqs_serverprop","blocklist","default","11","ephemeral_messages_enabled","01b","original_dimensions","8","mms4_media_retry_notification_encryption_enabled","mms4_server_error_receipt_encryption_enabled","original_image_url","sync","multiway","420","companion_enc_static","shops_profile_drawer_entrypoint","01c","vcard_as_document_size_kb","status_video_max_duration","request_image_url","01d","regular_high","s_t","abt","share_ext_min_preliminary_image_quality","01e","32","syncd_key_rotation_enabled","data_namespace","md_downgrade_read_receipts2","patch","polltype","ephemeral_messages_setting","userrate","15","partial_pjpeg_bw_threshold","played-self","catalog_exists","01f","mute_v2"];d=["reject","dirty","announcement","020","13","9","status_video_max_bitrate","fb:thrift_iq","offline_batch","022","full","ctwa_first_business_reply_logging","h.264","smax_id","group_description_length","https://www.whatsapp.com/otp/code","status_image_max_edge","smb_upsell_business_profile_enabled","021","web_upgrade_to_md_modal","14","023","s_o","smaller_video_thumbs_status_enabled","media_max_autodownload","960","blocking_status","peer_msg","joinable_group_call_client_version","group_call_video_maximization_enabled","return_snapshot","high","America/Mexico_City","entry_point_block_logging_enabled","pop","024","1050","16","1380","one_tap_calling_in_group_chat_size","regular_low","inline_joinable_education_enabled","hq_image_max_edge","locked","America/Bogota","smb_biztools_deeplink_enabled","status_image_quality","1088","025","payments_upi_intent_transaction_limit","voip","w:g2","027","md_pin_chat_enabled","026","multi_scan_pjpeg_download_enabled","shops_product_grid","transaction_id","ctwa_context_enabled","20","fna","hq_image_quality","alt_jpeg_doc_detection_quality","group_call_max_participants","pkey","America/Belem","image_max_kbytes","web_cart_v1_1_order_message_changes_enabled","ctwa_context_enterprise_enabled","urn:xmpp:whatsapp:account","840","Asia/Kuala_Lumpur","max_participants","video_remux_after_repair_enabled","stella_addressbook_restriction_type","660","900","780","context_menu_ios13_enabled","mute-state","ref","payments_request_messages","029","frskmsg","vcard_max_size_kb","sample_buffer_gif_player_enabled","match_last_seen","510","4983","video_max_bitrate","028","w:comms:chat","17","frequently_forwarded_max","groups_privacy_blacklist","Asia/Karachi","02a","web_download_document_thumb_mms_enabled","02b","hist_sync","biz_block_reasons_version","1024","18","web_is_direct_connection_for_plm_transparent","view_once_write","file_max_size","paid_convo_id","online_privacy_setting","video_max_edge","view_once_read","enhanced_storage_management","multi_scan_pjpeg_encoding_enabled","ctwa_context_forward_enabled","video_transcode_downgrade_enable","template_doc_mime_types","hq_image_bw_threshold","30","body","u_aud_limit_sil_restarts_ctrl","other","participating","w:biz:directory","1110","vp8","4018","meta","doc_detection_image_max_edge","image_quality","1170","02c","smb_upsell_chat_banner_enabled","key_expiry_time_second","pid","stella_interop_enabled","19","linked_device_max_count","md_device_sync_enabled","02d","02e","360","enhanced_block_enabled","ephemeral_icon_in_forwarding","paid_convo_status","gif_provider","project_name","server-error","canonical_url_validation_enabled","wallpapers_v2","syncd_clear_chat_delete_chat_enabled","medianotify","02f","shops_required_tos_version","vote","reset_skey_on_id_change","030","image_max_edge","multicast_limit_global","ul_bw","21","25","5000","poll","570","22","031","1280","WhatsApp","032","bloks_shops_enabled","50","upload_host_switching_enabled","web_ctwa_context_compose_enabled","ptt_forwarded_features_enabled","unblocked","partial_pjpeg_enabled","fbid:devices","height","ephemeral_group_query_ts","group_join_permissions","order","033","alt_jpeg_status_quality","migrate","popular-bank","win_uwp_deprecation_killswitch_enabled","web_download_status_thumb_mms_enabled","blocking","url_text","035","web_forwarding_limit_to_groups","1600","val","1000","syncd_msg_date_enabled","bank-ref-id","max_subject","payments_web_enabled","web_upload_document_thumb_mms_enabled","size","request","ephemeral","24","receipt_agg","ptt_remember_play_position","sampling_weight","enc_rekey","mute_always","037","034","23","036","action","click_to_chat_qr_enabled","width","disabled","038","md_blocklist_v2","played_self_enabled","web_buttons_message_enabled","flow_id","clear","450","fbid:thread","bloks_session_state","America/Lima","attachment_picker_refresh","download_host_switching_enabled","1792","u_aud_limit_sil_restarts_test2","custom_urls","device_fanout","optimistic_upload","2000","key_cipher_suite","web_smb_upsell_in_biz_profile_enabled","e","039","siri_post_status_shortcut","pair-device","lg","lc","stream_attribution_url","model","mspjpeg_phash_gen","catalog_send_all","new_multi_vcards_ui","share_biz_vcard_enabled","-","clean","200","md_blocklist_v2_server","03b","03a","web_md_migration_experience","ptt_conversation_waveform","u_aud_limit_sil_restarts_test1"];e=["64","ptt_playback_speed_enabled","web_product_list_message_enabled","paid_convo_ts","27","manufacturer","psp-routing","grp_uii_cleanup","ptt_draft_enabled","03c","business_initiated","web_catalog_products_onoff","web_upload_link_thumb_mms_enabled","03e","mediaretry","35","hfm_string_changes","28","America/Fortaleza","max_keys","md_mhfs_days","streaming_upload_chunk_size","5541","040","03d","2675","03f","...","512","mute","48","041","alt_jpeg_quality","60","042","md_smb_quick_reply","5183","c","1343","40","1230","043","044","mms_cat_v1_forward_hot_override_enabled","user_notice","ptt_waveform_send","047","Asia/Calcutta","250","md_privacy_v2","31","29","128","md_messaging_enabled","046","crypto","690","045","enc_iv","75","failure","ptt_oot_playback","AIzaSyDR5yfaG7OG8sMTUj8kfQEb8T9pN8BM6Lk","w","048","2201","web_large_files_ui","Asia/Makassar","812","status_collapse_muted","1334","257","2HP4dm","049","patches","1290","43cY6T","America/Caracas","web_sticker_maker","campaign","ptt_pausable_enabled","33","42","attestation","biz","04b","query_linked","s","125","04a","810","availability","1411","responsiveness_v2_m1","catalog_not_created","34","America/Santiago","1465","enc_p","04d","status_info","04f","key_version","..","04c","04e","md_group_notification","1598","1215","web_cart_enabled","37","630","1920","2394","-1","vcard","38","elapsed","36","828","peer","pricing_category","1245","invalid","stella_ios_enabled","2687","45","1528","39","u_is_redial_audio_1104_ctrl","1025","1455","58","2524","2603","054","bsp_system_message_enabled","web_pip_redesign","051","verify_apps","1974","1272","1322","1755","052","70","050","1063","1135","1361","80","1096","1828","1851","1251","1921","key_config_id","1254","1566","1252","2525","critical_block","1669","max_available","w:auth:backup:token","product","2530","870","1022","participant_uuid","web_cart_on_off","1255","1432","1867","41","1415","1440","240","1204","1608","1690","1846","1483","1687","1749","69","url_number","053","1325","1040","365","59","Asia/Riyadh","1177","test_recommended","057","1612","43","1061","1518","1635","055","1034","1375","750","1430","event_code","1682","503","55","865","78","1309","1365","44","America/Guayaquil","535","LIMITED","1377","1613","1420","1599","1822","05a","1681","password","1111","1214","1376","1478","47","1082","4282","Europe/Istanbul","1307","46","058","1124","256","rate-overlimit","retail","u_a_socket_err_fix_succ_test","1292","1370","1388","520","861","psa","regular","1181","1766","05b","1183","1213","1304","1537"];var g=["1724","profile_picture","1071","1314","1605","407","990","1710","746","pricing_model","056","059","061","1119","6027","65","877","1607","05d","917","seen","1516","49","470","973","1037","1350","1394","1480","1796","keys","794","1536","1594","2378","1333","1524","1825","116","309","52","808","827","909","495","1660","361","957","google","1357","1565","1967","996","1775","586","736","1052","1670","bank","177","1416","2194","2222","1454","1839","1275","53","997","1629","6028","smba","1378","1410","05c","1849","727","create","1559","536","1106","1310","1944","670","1297","1316","1762","en","1148","1295","1551","1853","1890","1208","1784","7200","05f","178","1283","1332","381","643","1056","1238","2024","2387","179","981","1547","1705","05e","290","903","1069","1285","2436","062","251","560","582","719","56","1700","2321","325","448","613","777","791","51","488","902","Asia/Almaty","is_hidden","1398","1527","1893","1999","2367","2642","237","busy","065","067","233","590","993","1511","54","723","860","363","487","522","605","995","1321","1691","1865","2447","2462","NON_TRANSACTIONAL","433","871","432","1004","1207","2032","2050","2379","2446","279","636","703","904","248","370","691","700","1068","1655","2334","060","063","364","533","534","567","1191","1210","1473","1827","069","701","2531","514","prev_dhash","064","496","790","1046","1139","1505","1521","1108","207","544","637","final","1173","1293","1694","1939","1951","1993","2353","2515","504","601","857","modify","spam_request","p_121_aa_1101_test4","866","1427","1502","1638","1744","2153","068","382","725","1704","1864","1990","2003","Asia/Dubai","508","531","1387","1474","1632","2307","2386","819","2014","066","387","1468","1706","2186","2261","471","728","1147","1372","1961"],h=[c,d,e,g];f.DICT_VERSION=a;f.SINGLE_BYTE_TOKEN=b;f.DICTIONARY_0_TOKEN=c;f.DICTIONARY_1_TOKEN=d;f.DICTIONARY_2_TOKEN=e;f.DICTIONARY_3_TOKEN=g;f.DICTIONARIES=h}),66);
__d("WAWapJid",["$InternalEnum","WAJids"],(function(a,b,c,d,e,f,g){"use strict";var h={JID:0,JID_U:1,JID_AD:1,JID_FB:3,JID_INTEROP:4},i=b("$InternalEnum")({WHATSAPP:0,LID:1,HOSTED:128,HOSTED_LID:129});a=function(){function a(a){this.$1=a}a.createAD=function(b,c,d){return new a({type:h.JID_AD,user:b,device:d==null?0:d,agent:c==null?0:c,domainType:i.WHATSAPP})};a.createJidU=function(b,c,d){return new a({type:h.JID_U,user:b,device:d==null?0:d,domainType:c==null?i.WHATSAPP:c})};a.createFbJid=function(b,c){c=c==null?0:c;return new a({type:h.JID_FB,user:b,device:c})};a.createInteropJid=function(b,c,d){c=c==null?0:c;return new a({type:h.JID_INTEROP,user:b,device:c,integrator:d})};a.create=function(b,c){return new a({type:h.JID,user:b,server:c})};var b=a.prototype;b.toString=function(){if(this.$1.type===h.JID_AD||this.$1.type===h.JID_U){var a=this.$1,b=a.user,c=a.device;a=a.domainType;var e;a===i.WHATSAPP?e=d("WAJids").WA_USER_JID_SUFFIX:a===i.HOSTED?e=d("WAJids").HOSTED_SUFFIX:a===i.HOSTED_LID?e=d("WAJids").HOSTED_LID_SUFFIX:e=d("WAJids").LID_SUFFIX;return c===0?b+"@"+e:b+":"+c+"@"+e}else if(this.$1.type===h.JID_FB){a=this.$1;b=a.user;c=a.device;e=d("WAJids").MSGR_USER_JID_SUFFIX;return b+":"+c+"@"+e}else if(this.$1.type===h.JID_INTEROP){a=this.$1;b=a.user;c=a.device;e=a.integrator;a=d("WAJids").INTEROP_USER_JID_SUFFIX;return e+"-"+b+":"+c+"@"+a}else{this.$1.type;e=this.$1;b=e.user;c=e.server;return b!=null?b+"@"+c:c}};b.getInnerJid=function(){return this.$1};return a}();g.WAP_JID_SUBTYPE=h;g.DomainType=i;g.WapJid=a}),98);
__d("WAXmlFormatter",[],(function(a,b,c,d,e,f){"use strict";function a(a){a=a.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns:/g,"~::~xmlns:").replace(/\s*xmlns=/g,"~::~xmlns=").split("~::~");var b=a.length,c=!1,d=0,e="",f=0,g=["\n"];for(f=0;f<100;f++)g.push(g[f]+"    ");var h=function(b,a){var c=/^<[\w:\-.,]+/.exec(b[a-1]);b=/^<\/[\w:\-.,]+/.exec(b[a]);return c!=null&&b!=null&&c[0]===b[0]};for(f=0;f<b;f++)a[f].search(/<!/)>-1?(e+=g[d]+a[f],c=!0,(a[f].search(/-->/)>-1||a[f].search(/\]>/)>-1||a[f].search(/!DOCTYPE/)>-1)&&(c=!1)):a[f].search(/-->/)>-1||a[f].search(/\]>/)>-1?(e+=a[f],c=!1):h(a,f)?(e+=a[f],c||d--):a[f].search(/<\w/)>-1&&a[f].search(/<\//)===-1&&a[f].search(/\/>/)===-1?e=c?e+=a[f]:e+=g[d++]+a[f]:a[f].search(/<\w/)>-1&&a[f].search(/<\//)>-1?e=c?e+=a[f]:e+=g[d]+a[f]:a[f].search(/<\//)>-1?e=c?e+=a[f]:e+=g[d===0?d:--d]+a[f]:a[f].search(/\/>/)>-1?e=c?e+=a[f]:e+=g[d]+a[f]:a[f].search(/<\?/)>-1?e+=g[d]+a[f]:a[f].search(/xmlns:/)>-1||a[f].search(/xmlns=/)>-1?e+=g[d]+a[f]:e+=a[f];return e[0]==="\n"?e.slice(1):e}f["default"]=a}),66);
__d("WAXmlNode",["WAHex"],(function(a,b,c,d,e,f,g){"use strict";var h={};a=function(){function a(a,b,c){b===void 0&&(b=h),c===void 0&&(c=null),this.tag=a,this.attrs=b,this.content=c}var b=a.prototype;b.toString=function(){var a="<"+this.tag;a+=i(this.attrs);var b=this.content;Array.isArray(b)?a+=">"+b.map(String).join("")+"</"+this.tag+">":b instanceof Uint8Array?a+=">"+j(b)+"</"+this.tag+">":b!=null?a+=">"+String(b)+"</"+this.tag+">":a+=" />";return a};return a}();function i(a){var b=Object.keys(a),c="";for(var d=0;d<b.length;d++){var e=b[d];c+=" "+e+'="'+a[e].toString()+'"'}return c}function j(a){var b;a.length===0?b="<!-- empty binary -->":a.length<50?b=d("WAHex").bytesToDebugString(a):b="<!-- "+a.length+" bytes -->";return b}g.XmlNode=a;g.attrsToString=i;g.uint8ArrayToDebugString=j}),98);
__d("WAWap",["WAAssertUnreachable","WABinary","WACryptoDependencies","WAErr","WAJids","WALogger","WALongInt","WATextEncoding","WAWapDict","WAWapJid","WAXmlFormatter","WAXmlNode"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["decodeNullableString got invalid value: ",", string expected"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["decodeString got invalid value: ",", string expected"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Decoding compressed stanza"]);k=function(){return a};return a}var l=(h=d("WAJids")).MSGR_USER_DOMAIN.replace("@",""),aa=h.WA_USER_DOMAIN.replace("@",""),m=h.LID_DOMAIN.replace("@",""),n=h.INTEROP_DOMAIN.replace("@",""),o=h.HOSTED_DOMAIN.replace("@",""),p=2,ba=128,q=0,r=236,s=237,t=238,u=239,ca=[r,s,t,u],v=245,w=246,x=247,y=248,z=249,A=250,B=251,C=252,D=253,E=254,F=255,da=["0","1","2","3","4","5","6","7","8","9","-",".","\ufffd","\ufffd","\ufffd","\ufffd"],ea=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],G="",fa=1,H={sentinel:"DROP_ATTR"},I=(s=d("WAWapJid")).WapJid.create(null,"g.us"),J=s.WapJid.create(null,h.WA_SERVER_JID_SUFFIX);t=s.WapJid.create("status","broadcast");var K=s.WapJid.create(null,"newsletter");h=s.WapJid.create(null,"hosted");s=s.WapJid.create(null,"hosted.lid");var L={},M=!1;function a(){M=!0}var ga=d("WATextEncoding").newTextEncoder(),N=function(){function a(a,b,c){b===void 0&&(b=L),c===void 0&&(c=null),this.tag=a,this.attrs=b,this.content=c}var b=a.prototype;b.toString=function(){var a="<"+this.tag;a+=d("WAXmlNode").attrsToString(this.attrs);var b=this.content;Array.isArray(b)?a+=">"+b.map(String).join("")+"</"+this.tag+">":b?a+=">"+d("WAXmlNode").uint8ArrayToDebugString(b)+"</"+this.tag+">":a+=" />";M&&(a=c("WAXmlFormatter")(a));return a};return a}();function b(a,b,e){var f=null;if(b&&b.children!=null)throw c("WAErr")('Children should not be passed via props (see eslint check "react/no-children-props")');if(Array.isArray(e))f=e.filter(Boolean);else if(typeof e==="string")f=d("WABinary").Binary.build(e).readByteArray();else if(e instanceof ArrayBuffer)f=new Uint8Array(e);else if(e instanceof Uint8Array)f=e;else{var g=[];for(var h=2;h<arguments.length;h++){var i=arguments[h];i&&g.push(i)}f=g}Array.isArray(f)&&f.length===0&&(f=null);var j={};if(b){var k=b;Object.keys(k).forEach(function(b){if(["__self","__source"].includes(b))return;var d=k[b];if(d==null)throw c("WAErr")("Attr "+b+" in <"+a+"> is null");if(d===H)return;j[b]=d})}return new N(a,j,f)}var ha=b;function e(a){return a instanceof d("WAWapJid").WapJid?a.toString():a}function O(a){var b=a.content;Array.isArray(b)?b=b.map(O):typeof b==="string"&&(b=d("WABinary").Binary.build(b).readByteArray());return new N(a.tag,a.attrs||L,b)}function f(a){a=a instanceof N?a:O(a);var b=new(d("WABinary").Binary)();P(a,b);a=0;b=b.readByteArray();var c=new Uint8Array(1+b.length);c[0]=a;c.set(b,1);return c}function P(a,b){if(a==null)b.writeUint8(q);else if(a instanceof N)Q(a,b);else if(a instanceof d("WAWapJid").WapJid)ia(a,b);else if(typeof a==="string")U(a,b);else if(a instanceof Uint8Array)ja(a,b);else{a;b=typeof a;throw c("WAErr")("Invalid payload type "+b)}}function ia(a,b){a=a.getInnerJid();if(a.type===d("WAWapJid").WAP_JID_SUBTYPE.JID_U){var c=a.user,e=a.device,f=a.domainType;b.writeUint8(x);b.writeUint8(f);b.writeUint8(e);P(c,b)}else if(a.type===d("WAWapJid").WAP_JID_SUBTYPE.JID_FB){f=a.user;e=a.device;b.writeUint8(w);P(f,b);b.writeUint16(e);P(l,b)}else if(a.type===d("WAWapJid").WAP_JID_SUBTYPE.JID_INTEROP){c=a.user;f=a.device;e=a.integrator;b.writeUint8(v);P(c,b);b.writeUint16(f);b.writeUint16(e)}else{c=a.user;f=a.server;b.writeUint8(A);c!=null?P(c,b):b.writeUint8(q);P(f,b)}}function Q(a,b){if(a.tag===void 0){b.writeUint8(y);b.writeUint8(q);return}var c=1;a.attrs&&(c+=Object.keys(a.attrs).length*2);a.content&&c++;c<256?(b.writeUint8(y),b.writeUint8(c)):c<65536&&(b.writeUint8(z),b.writeUint16(c));P(a.tag,b);a.attrs&&Object.keys(a.attrs).forEach(function(c){U(c,b),P(a.attrs[c],b)});c=a.content;if(Array.isArray(c)){c.length<256?(b.writeUint8(y),b.writeUint8(c.length)):c.length<65536&&(b.writeUint8(z),b.writeUint16(c.length));for(var d=0;d<c.length;d++)Q(c[d],b)}else c&&P(c,b)}var R,S;function T(a){var b=new Map();for(var c=0;c<a.length;c++)b.set(a[c],c);return b}function U(a,b){if(a===""){b.writeUint8(C);b.writeUint8(0);return}R==null&&(R=T(d("WAWapDict").SINGLE_BYTE_TOKEN));var c=R.get(a);if(c!=null){b.writeUint8(c+1);return}if(S==null){S=[];for(c=0;c<d("WAWapDict").DICTIONARIES.length;++c)S.push(T(d("WAWapDict").DICTIONARIES[c]))}for(c=0;c<S.length;++c){var e=S[c].get(a);if(e!=null){b.writeUint8(ca[c]);b.writeUint8(e);return}}e=d("WABinary").numUtf8Bytes(a);if(e<128){c=/[^0-9.-]+?/;var f=/[^0-9A-F]+?/;if(!c.exec(a)){V(a,F,b);return}else if(!f.exec(a)){V(a,B,b);return}}ka(e,b);b.writeString(a)}function V(a,b,d){var e=a.length%2===1;d.writeUint8(b);var f=Math.ceil(a.length/2);e&&(f|=ba);d.writeUint8(f);e=0;for(f=0;f<a.length;f++){var g=a.charCodeAt(f),h=null;48<=g&&g<=57?h=g-48:b===F?g===45?h=10:g===46&&(h=11):b===B&&(65<=g&&g<=70&&(h=g-55));if(h==null)throw c("WAErr")("Cannot nibble encode "+g);else f%2===0?(e=h<<4,f===a.length-1&&(e|=15,d.writeUint8(e))):(e|=h,d.writeUint8(e))}}function ja(a,b){ka(a.length,b),b.writeByteArray(a)}function ka(a,b){if(a<256)b.writeUint8(C),b.writeUint8(a);else if(a<1048576)b.writeUint8(D),b.writeUint8(a>>>16&255),b.writeUint8(a>>>8&255),b.writeUint8(a&255);else if(a<4294967296)b.writeUint8(E),b.writeUint32(a);else throw c("WAErr")("Binary with length "+a+" is too big for WAP protocol")}function la(a,b){a=new(d("WABinary").Binary)(a);var c=a.readUint8();c=c&p;if(c){d("WALogger").LOG(k());return b(a.readByteArray()).then(function(a){return X(new(d("WABinary").Binary)(a))})}return Promise.resolve(X(a))}function ma(a){a=new(d("WABinary").Binary)(a);var b=a.readUint8();b=b&p;if(b)throw c("WAErr")("Cannot pass compressed stanza to decodeStanzaDebug");return X(a)}function W(a,b){var e=a.readUint8();if(e===q)return null;if(e===y)return na(a,a.readUint8());if(e===z)return na(a,a.readUint16());if(e===C){var f=a.readUint8();return Z(a,f,b)}if(e===D){f=a.readUint8();var g=a.readUint8(),h=a.readUint8();f=((f&15)<<16)+(g<<8)+h;return Z(a,f,b)}if(e===E){g=a.readUint32();return Z(a,g,b)}if(e===A)return pa(a);if(e===w)return qa(a);if(e===v)return ra(a);if(e===x)return sa(a);if(e===F){h=a.readUint8();f=h>>>7;g=h&127;return ta(a,da,f,g)}if(e===B){b=a.readUint8();h=b>>>7;f=b&127;return ta(a,ea,h,f)}if(e<=0||e>=240)throw c("WAErr")("Unable to decode WAP buffer");if(e>=r&&e<=u){g=e-r;b=d("WAWapDict").DICTIONARIES[g];if(b===void 0)throw c("WAErr")("Missing WAP dictionary "+g);h=a.readUint8();f=b[h];if(f===void 0)throw c("WAErr")("Invalid value index "+h+" in dict "+g);return f}a=d("WAWapDict").SINGLE_BYTE_TOKEN[e-1];if(a===void 0)throw c("WAErr")("Undefined token with index "+e);return a}function na(a,b){var c=[];for(var d=0;d<b;d++)c.push(X(a));return c}function X(a){var b=a.readUint8(),e;if(b===y)e=a.readUint8();else if(b===z)e=a.readUint16();else throw c("WAErr")("Failed to decode node since type byte "+String(b)+" is invalid");b=void 0;var f=null;if(e===0)throw c("WAErr")("Failed to decode node, list cannot be empty");var g=Y(a);e-=1;while(e>1){b||(b={});var h=Y(a),i=W(a,!0);b[h]=i;e-=2}e===1&&(f=W(a,!1),f instanceof d("WAWapJid").WapJid&&(f=String(f)),typeof f==="string"&&(f=ga.encode(f)));return new N(g,b,f)}function Y(a){a=W(a,!0);if(typeof a!=="string"){d("WALogger").DEV(j(),String(a));throw c("WAErr")("WAWap:decodeString got invalid value, string expected")}return a}function oa(a){a=W(a,!0);if(a!=null&&typeof a!=="string"){d("WALogger").DEV(i(),String(a));throw c("WAErr")("WAWap:decodeNullableString got invalid value, string expected")}return a}function pa(a){var b=oa(a);a=Y(a);return d("WAWapJid").WapJid.create(b,a)}function qa(a){var b=Y(a),c=a.readUint16();Y(a);return d("WAWapJid").WapJid.createFbJid(b,c)}function ra(a){var b=Y(a),c=a.readUint16(),e=a.readUint16();Y(a);return d("WAWapJid").WapJid.createInteropJid(b,c,e)}function sa(a){var b=null,e=a.readUint8();if(e===0)b=d("WAWapJid").DomainType.WHATSAPP;else if(e===1)b=d("WAWapJid").DomainType.LID;else if((1&e)===0&&(128&e)!==0)b=d("WAWapJid").DomainType.HOSTED;else if(e===129)b=d("WAWapJid").DomainType.HOSTED_LID;else throw c("WAErr")("decodeJidU - Invalid domain type encoding "+e);e=a.readUint8();a=Y(a);return d("WAWapJid").WapJid.createJidU(a,b,e)}function Z(a,b,c){c===void 0&&(c=!1);if(c)return a.readString(b);else return a.readByteArray(b)}function ta(a,b,c,d){d=new Array(d*2-c);for(var e=0;e<d.length-1;e+=2){var f=a.readUint8();d[e]=b[f>>>4];d[e+1]=b[f&15]}if(c){f=a.readUint8();d[d.length-1]=b[f>>>4]}return d.join("")}function ua(){if(!G){var a=new Uint16Array(2);d("WACryptoDependencies").getCrypto().getRandomValues(a);G=String(a[0])+"."+String(a[1])+"-"}return""+G+fa++}function va(a){switch(a.type){case"group":return a.groupJid;case"status":return d("WAJids").STATUS_JID;case"device":return a.deviceJid;case"newsletter":return a.newsletterJid;case"hosted":return a.hostedDeviceJid;case"hostedLid":return a.hostedLidDeviceJid;default:a.type;return a.broadcastJid}}function wa(a){switch(a.type){case"group":return a.author;case"status":return a.author;case"broadcast":return a.author;default:a.type;return null}}function xa(a){return a.type==="status"||a.type==="group"||a.type==="broadcast"?$(a.author):H}function ya(a){return $(va(a))}function $(a){var b=d("WAJids").validateDomainJid(a);if(b!=null)return za(b);b=a.split("@");a=b[0];b=b[1];var e=null;if((b===aa||b===l||b===n||b===m||b===o||b===d("WAJids").HOSTED_LID_SUFFIX)&&a.indexOf(":")!==-1){var f=a.split(":");a=f[0];f=f[1];e=parseInt(f,10)}if(b===n){f=a.split("-");var g=f[0];f=f[1];return d("WAWapJid").WapJid.createInteropJid(f,e,parseInt(g,10))}else if(b===l)return d("WAWapJid").WapJid.createFbJid(a,e);f=null;if(b===m)f=d("WAWapJid").DomainType.LID;else if(b===o){if(e!==99)throw c("WAErr")("wid unexpected deviceId");f=d("WAWapJid").DomainType.HOSTED}else if(b===d("WAJids").HOSTED_LID_SUFFIX){if(e!==99)throw c("WAErr")("lid invalid deviceId");f=d("WAWapJid").DomainType.HOSTED_LID}else f=d("WAWapJid").DomainType.WHATSAPP;return e!=null&&e!==0?d("WAWapJid").WapJid.createJidU(a,f,e):d("WAWapJid").WapJid.create(a,b)}function za(a){if(a==="s.whatsapp.net")return J;else if(a==="g.us")return I;else if(a==="newsletter")return K;else return c("WAAssertUnreachable")(a)}function Aa(a){return $(a)}function Ba(a){return $(a)}function Ca(a){return $(a)}function Da(a){return $(a)}function Ea(a){return $(a)}function Fa(a){return $(a)}function Ga(a){if(a.jidType==="phoneDevice")return $(a.deviceJid);else if(a.jidType==="msgrDevice")return $(a.deviceJid);else if(a.jidType==="lidDevice")return $(a.deviceJid);else if(a.jidType==="phoneUser")return $(a.userJid);else if(a.jidType==="msgrUser")return $(a.userJid);else if(a.jidType==="lidUser")return $(a.userJid);else if(a.jidType==="group")return $(a.groupJid);else if(a.jidType==="status")return $(a.statusJid);else if(a.jidType==="call")return $(a.callJid);else if(a.jidType==="interopDevice")return $(a.deviceJid);else if(a.jidType==="interopUser")return $(a.userJid);else if(a.jidType==="newsletter")return $(a.newsletterJid);else if(a.jidType==="hosted")return $(a.hostedDeviceJid);else if(a.jidType==="hostedLid")return $(a.hostedLidDeviceJid);else{a.jidType;return $(a.broadcastJid)}}function Ha(a){return a}function Ia(a){return a.toString()}function Ja(a){return a}function Ka(a){return a==null?H:a}function La(a){return a.toString()}function Ma(a){return d("WALongInt").longIntToDecimalString(a)}function Na(a,b){b===void 0&&(b=4);a=a;var c=new Uint8Array(b);for(b=b-1;b>=0;b--)c[b]=a&255,a>>>=8;return c}g.DROP_ATTR=H;g.G_US=I;g.S_WHATSAPP_NET=J;g.STATUS_BROADCAST=t;g.NEWSLETTER=K;g.HOSTED=h;g.HOSTED_LID=s;g.enableXMLFormat=a;g.WapNode=N;g.makeWapNode=b;g.wap=ha;g.decodeAsString=e;g.makeStanza=O;g.encodeStanza=f;g.decodeStanza=la;g.decodeStanzaDebug=ma;g.generateId=ua;g.extractToJid=va;g.extractParticipantJid=wa;g.PARTICIPANT_JID=xa;g.TO_JID=ya;g.JID=$;g.DOMAIN_JID=za;g.USER_JID=Aa;g.DEVICE_JID=Ba;g.GROUP_JID=Ca;g.BROADCAST_JID=Da;g.CALL_JID=Ea;g.NEWSLETTER_JID=Fa;g.TO_WAP_JID=Ga;g.STANZA_ID=Ha;g.SMAX_ID=Ia;g.CUSTOM_STRING=Ja;g.MAYBE_CUSTOM_STRING=Ka;g.INT=La;g.LONG_INT=Ma;g.BIG_ENDIAN_CONTENT=Na}),98);
__d("WAParsableWapNode",["WABinary","WAErr","WAJids","WALogger","WALongInt","WAParsableXmlNode","WASignalKeys","WATimeUtils","WAWap","WAWapJid"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["ParsableWapNode: attrFromJid() is called with ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["ParsableWapNode: attrFromJid() is called with ",""]);i=function(){return a};return a}var j=function(b){babelHelpers.inheritsLoose(a,b);function a(a,c){var d;d=b.call(this,"XmppParsingFailure: "+a+": "+c)||this;d.name="XmppParsingFailure";d.parser=a;d.reason=c;return d}var c=a.prototype;c.toString=function(){return"XmppParsingFailure: "+this.parser+": "+this.reason};return a}(babelHelpers.wrapNativeSuper(Error));a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c){return a.call(this,b,c)||this}var e=b.prototype;e.assertFromServer=function(){var a=this.attrString("from");a!==d("WAJids").WA_SERVER_JID_SUFFIX&&this["throw"]('to have "from"="s.whatsapp.net", but instead has "'+a+'"')};e.attrUserJid=function(a){var b=this.attrString(a),c=d("WAJids").interpretAndValidateJid(b);return c.userJid==null?this["throw"]('to have "'+a+'"={UserJid}, but instead has "'+b+'"'):c.userJid};e.attrPhoneUserJid=function(a){var b=this.attrString(a),c=d("WAJids").interpretAndValidateJid(b);return c.jidType==="phoneUser"?c.userJid:this["throw"]('to have "'+a+'"={PhoneUserJid}, but instead has "'+b+'"')};e.attrLidUserJid=function(a){var b=this.attrString(a),c=d("WAJids").interpretAndValidateJid(b);return c.jidType==="lidUser"?c.userJid:this["throw"]('to have "'+a+'"={LidUserJid}, but instead has "'+b+'"')};e.maybeAttrUserJid=function(a){return this.hasAttr(a)?this.attrUserJid(a):null};e.maybeAttrPhoneUserJid=function(a){return this.hasAttr(a)?this.attrPhoneUserJid(a):null};e.maybeAttrLidUserJid=function(a){return this.hasAttr(a)?this.attrLidUserJid(a):null};e.attrGroupJid=function(a){var b=this.attrString(a),c=d("WAJids").interpretAndValidateJid(b);return c.groupJid==null?this["throw"]('to have "'+a+'"={GroupJid}, but instead has "'+b+'"'):c.groupJid};e.maybeAttrGroupJid=function(a){return this.hasAttr(a)?this.attrGroupJid(a):null};e.attrChatJid=function(a){var b=this.attrString(a),c=d("WAJids").interpretAndValidateJid(b);if(c.userJid!=null)return c.userJid;return c.groupJid!=null?c.groupJid:this["throw"]('to have "'+a+'"={ChatJid}, but instead has "'+b+'"')};e.attrPhoneChatJid=function(a){var b=this.attrString(a),c=d("WAJids").interpretAndValidateJid(b);if(c.jidType==="phoneUser")return c.userJid;else if(c.jidType==="group")return c.groupJid;else return this["throw"]('to have "'+a+'"={ChatJid}, but instead has "'+b+'"')};e.attrDeviceJid=function(a){var b=this.attrString(a),c=d("WAJids").interpretAndValidateJid(b);if(c.deviceJid!=null)return c.deviceJid;if(c.userJid!=null)return d("WAJids").defaultDeviceJidForUser(c.userJid);if(c.hostedDeviceJid!=null)return c.hostedDeviceJid;return c.hostedLidDeviceJid!=null?c.hostedLidDeviceJid:this["throw"]('to have "'+a+'"={DeviceJid}, but instead has "'+b+'"')};e.attrPhoneDeviceJid=function(a){var b=this.attrString(a),c=d("WAJids").interpretAndValidateJid(b);if(c.jidType==="phoneDevice")return c.deviceJid;return c.jidType==="phoneUser"?d("WAJids").defaultPhoneDeviceJidForUser(c.userJid):this["throw"]('to have "'+a+'"={PhoneDeviceJid}, but instead has "'+b+'"')};e.attrLidDeviceJid=function(a){var b=this.attrString(a),c=d("WAJids").interpretAndValidateJid(b);if(c.jidType==="lidDevice")return c.deviceJid;return c.jidType==="lidUser"?d("WAJids").defaultLidDeviceJidForLidUserJid(c.userJid):this["throw"]('to have "'+a+'"={LidDeviceJid}, but instead has "'+b+'"')};e.attrDeviceId=function(a){a=this.attrInt(a);return d("WAJids").interpretAsDeviceId(a)};e.attrFromJidChat=function(){var a=this.attrJidWithType();switch(a.jidType){case"msgrUser":var b=a.userJid,e=d("WAJids").defaultDeviceJidForUser(b);return{type:"device",chat:b,deviceJid:e,author:e};case"interopUser":b=a.userJid;e=d("WAJids").defaultDeviceJidForUser(b);return{type:"device",chat:b,deviceJid:e,author:e};case"phoneUser":b=a.userJid;e=d("WAJids").defaultDeviceJidForUser(b);return{type:"device",chat:b,deviceJid:e,author:e};case"lidUser":b=a.userJid;e=d("WAJids").defaultLidDeviceJidForLidUserJid(b);return{type:"device",chat:b,deviceJid:e,author:e};case"phoneDevice":b=a.deviceJid;return{type:"device",chat:d("WAJids").extractUserJid(b),deviceJid:b,author:b};case"msgrDevice":e=a.deviceJid;return{type:"device",chat:d("WAJids").extractUserJid(e),deviceJid:e,author:e};case"interopDevice":b=a.deviceJid;return{type:"device",chat:d("WAJids").extractUserJid(b),deviceJid:b,author:b};case"lidDevice":e=a.deviceJid;return{type:"device",chat:d("WAJids").extractUserJid(e),deviceJid:e,author:e};case"group":b=this.hasAttr("participant")?this.attrDeviceJid("participant"):null;return b==null?this["throw"]("expected to have participant JID for group"):{type:"group",chat:a.groupJid,groupJid:a.groupJid,author:b};case"broadcast":e=this.hasAttr("participant")?this.attrDeviceJid("participant"):null;return e==null?this["throw"]("expected to have participant JID for group"):{type:"broadcast",broadcastJid:a.broadcastJid,chat:d("WAJids").extractUserJid(e),author:e};case"hosted":b=a.hostedDeviceJid;return{type:"device",chat:d("WAJids").extractUserJid(b),deviceJid:b,author:b};case"hostedLid":e=a.hostedLidDeviceJid;return{type:"device",chat:d("WAJids").extractUserJid(e),deviceJid:e,author:e};case"call":d("WALogger").ERROR(i(),a.callJid);throw c("WAErr")("ParsableWapNode: attrFromJid() does not support CallJid");default:a.jidType;return this["throw"]("attrFromJidChat should not be used with jid of type "+a.jidType)}};e.attrFromJidPhoneChat=function(){var a=this.attrJidWithType();switch(a.jidType){case"phoneUser":var b=a.userJid,e=d("WAJids").defaultPhoneDeviceJidForUser(b);return{type:"device",chat:b,deviceJid:e,author:e};case"phoneDevice":b=a.deviceJid;return{type:"device",chat:d("WAJids").extractPhoneUserJid(b),deviceJid:b,author:b};case"group":e=this.hasAttr("participant")?this.attrPhoneDeviceJid("participant"):null;return e==null?this["throw"]("expected to have participant JID for group"):{type:"group",chat:a.groupJid,groupJid:a.groupJid,author:e};case"broadcast":b=this.hasAttr("participant")?this.attrPhoneDeviceJid("participant"):null;return b==null?this["throw"]("expected to have participant JID for group"):{type:"broadcast",broadcastJid:a.broadcastJid,chat:d("WAJids").extractPhoneUserJid(b),author:b};case"call":d("WALogger").ERROR(h(),a.callJid);throw c("WAErr")("ParsableWapNode: attrFromJid() does not support CallJid");default:a.jidType;return this["throw"]("attrFromJidChat should not be used with jid of type "+a.jidType)}};e.attrFromPhoneJid=function(){var a=this.attrJidWithType();if(a.jidType==="status"){a=this.hasAttr("participant")?this.attrPhoneDeviceJid("participant"):null;return a==null?this["throw"]("to have participant for status msg"):{type:"status",author:a}}else return this.attrFromJidPhoneChat()};e.attrFromJid=function(){var a=this.attrJidWithType();if(a.jidType==="status"){var b=this.hasAttr("participant")?this.attrPhoneDeviceJid("participant"):null;return b==null?this["throw"]("to have participant for status msg"):{type:"status",author:b}}if(a.jidType==="newsletter")return{type:"newsletter",newsletterJid:a.newsletterJid};if(a.jidType==="hosted")return{type:"hosted",hostedDeviceJid:a.hostedDeviceJid};return a.jidType==="hostedLid"?{type:"hostedLid",hostedLidDeviceJid:a.hostedLidDeviceJid}:this.attrFromJidChat()};e.attrJidWithType=function(a){a===void 0&&(a="from");var b=this.attrString(a),c=d("WAJids").interpretAndValidateJid(b);return c.jidType==="unknown"?this["throw"]('to have "'+a+'"={Jid}, but instead has "'+b+'"'):c};e.attrWapJid=function(a){a===void 0&&(a="from");a=this.attrString(a);var b=d("WAJids").interpretAndValidateJid(a);return b.jidType==="unknown"?d("WAWapJid").WapJid.create(null,a):d("WAWap").JID(d("WAJids").extractFromJid(b))};e.attrLongInt=function(a){a=this.attrString(a);return d("WALongInt").decimalStringToLongInt(a)};e.attrTime=function(a){return d("WATimeUtils").castToUnixTime(this.attrInt(a))};e.attrFutureTime=function(a){a=this.attrInt(a);return d("WATimeUtils").futureUnixTime(a)};e.contentString=function(){if(this.hasChildren())return this["throw"]("to have string content, but has children instead");else if(this.hasContent()){var a=new(d("WABinary").Binary)(this.contentBytes());return a.readString(a.size())}else return this["throw"]("to have content")};e.decodeAsString=function(a){return d("WAWap").decodeAsString(a)};e.contentSerializedPubKey=function(){if(this.hasContent())return d("WASignalKeys").serializeIdentity(this.contentBytes());else return this["throw"]("to have content")};e.createParseError=function(a){return new j(this.name(),"expected <"+this.tag()+"> "+a)};e["throw"]=function(a){throw this.createParseError(a)};return b}(d("WAParsableXmlNode").ParsableXmlNode);g.XmppParsingFailure=j;g.ParsableWapNode=a}),98);
__d("WADeprecatedWapParser",["WAErr","WAParsableWapNode"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b){this.$1=a,this.$2=b}var b=a.prototype;b.parse=function(a){a=new(d("WAParsableWapNode").ParsableWapNode)(this.$1,a);try{return{success:this.$2(a)}}catch(a){if(a instanceof d("WAParsableWapNode").XmppParsingFailure)return{error:a};else throw a}};b.parseOrThrow=function(a){a=this.parse(a);if(a.error)throw c("WAErr")(String(a.error));return a.success};return a}();g["default"]=a}),98);
__d("WAAckParser",["WADeprecatedWapParser","WAJids"],(function(a,b,c,d,e,f,g){"use strict";b=new(c("WADeprecatedWapParser"))("ack",function(a){a.assertTag("ack");return{id:a.attrString("id"),ts:a.maybeAttrString("t"),"class":a.attrString("class"),type:a.maybeAttrString("type"),from:a.attrJidWithType(),participant:a.hasAttr("participant")?a.attrDeviceJid("participant"):null,recipient:a.hasAttr("recipient")?a.attrUserJid("recipient"):null}});function a(a,b){return a.id===b.id&&(b["class"]===void 0||a["class"]===b["class"])&&(b.type===void 0||a.type===b.type)&&(b.from===void 0||h(a.from,b.from))&&(b.participant===void 0||a.participant===b.participant)&&(b.recipient===void 0||a.recipient===b.recipient)&&(b.ts===void 0||a.ts===b.ts)}function h(a,b){if(d("WAJids").extractFromJid(a)===b)return!0;if(a.userJid!=null)return d("WAJids").defaultDeviceJidForUser(a.userJid)===b;if(a.deviceJid!=null){a=a.deviceJid;return d("WAJids").extractDeviceId(a)===0&&d("WAJids").extractUserJid(a)===b}return!1}g.AckParser=b;g.ackMatchesTemplate=a;g.fromJidsAreEqual=h}),98);
__d("WAArrayUtils",["regeneratorRuntime"],(function(a,b,c,d,e,f){"use strict";var g=b("regeneratorRuntime").mark(c);function a(a,b){var c=a.pop();b<a.length&&(a[b]=c)}function c(a,c){var d;return b("regeneratorRuntime").wrap(function(b){while(1)switch(b.prev=b.next){case 0:d=0;case 1:if(!(d<a.length)){b.next=7;break}b.next=4;return a.slice(d,d+c);case 4:d+=c;b.next=1;break;case 7:case"end":return b.stop()}},g,this)}f.removeIndexWithoutPreservingOrder=a;f.peekEvery=c}),66);
__d("WAErrors",["WACustomError"],(function(a,b,c,d,e,f,g){"use strict";b=(a=d("WACustomError")).customError("BufferTooLarge",!1);c=a.customError("Disconnected",!1);e=a.customError("Offline",!1,c);f=a.customError("MaxRetries",!1);g.BufferTooLargeError=b;g.Disconnected=c;g.Offline=e;g.MaxRetries=f}),98);
__d("WANotifyConnectionChangeFactory",[],(function(a,b,c,d,e,f){"use strict";var g=15e3;function a(a,b,c){c===void 0&&(c=g);var d={timeoutID:null,connectionStatus:"disconnected",optimismLevel:"optimist"},e=function(){var a=d.optimismLevel,e=d.connectionStatus;a==="optimist"?d.timeoutID=setTimeout(function(){d.optimismLevel="realist",b(e)},c):b(e)};return function(c){d.connectionStatus=c,c==="disconnected"?e():c==="in_handshake"?e():(c,d.timeoutID!=null&&(clearTimeout(d.timeoutID),d.timeoutID=null),b(c)),a(c)}}f.notifyConnectionChangeFactory=a}),66);
__d("WAPromiseBackoffs",["Promise","WAErr"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){if(a===0)return 0;var c=o(b.algo);for(var d=1;d<a;d++)c();return j(b,c())}function i(a){var b=a.relativeDelay,c=b===void 0?!1:b,d=null,e=o(a.algo);return function(){var b=d;if(b==null){d=c?Date.now():0;return 0}var f=j(a,e());if(c){var g=Date.now();b=g-b;b>0&&(f=Math.max(0,f-b));d=g}return f}}function d(a){var c=i(a);return function(a){return new(h||(h=b("Promise")))(function(b){var d=c();d>0?setTimeout(b,d,a):b(a)})}}function j(a,b){var c=a.max,d=a.min;a=a.jitter;a=a===void 0?.1:a;b=b;c!=null&&b>c&&(b=c);d!=null&&b<d&&(b=d);a!==0&&(b=Math.ceil(b*(1+a*Math.random())));return b}function k(a){var b=a.second-a.first,c=a.first-b;return function(){var a=b+c;c=b;b=a;return a}}function l(a){var b=a.base,c=b===void 0?2:b,d=a.first;return function(){var a=d;d*=c;return a}}function m(a){var b=a.delay;return function(){return b}}function n(a){var b=a.toMs;a=a.backoff;var c=o(a);return function(){return b(c())}}function o(a){switch(a.type){case"fibonacci":return k(a);case"exponential":return l(a);case"constant":return m(a);case"adjust":return n(a);default:a;throw c("WAErr")("makeTimeFunc unrecognized backoff "+a.type)}}g.getDelay=a;g.createTimer=i;g.createPromiseTimer=d}),98);
__d("WAPromiseRetryLoop",["Promise","WAErr","WALogger","WAPromiseBackoffs","WAPromiseDelays","WAResolvable"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["PromiseRetryLoop: retrying "," in ","ms"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["PromiseRetryLoop: resetting ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["PromiseRetryLoop was called several times. You may have race conditions"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["PromiseRetryLoop: starting ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["PromiseRetryLoop: resetting ",""]);m=function(){return a};return a}a=function(){function a(a){var b=this;this.$2=new(d("WAResolvable").Resolvable)();this.$3=null;this.$4=null;this.$5=0;this.endWithValue=function(a){b.$5++,b.$2.resolve(a)};this.$1=a}var e=a.prototype;e.resetTimeoutAfter=function(a){this.$4=Date.now()+a};e.cancelReset=function(){this.$4=null};e.reset=function(){if(this.$2.resolveWasCalled())return;d("WALogger").LOG(m(),this.$1.name);this.$5++;this.$6()};e.start=function(){if(this.$2.resolveWasCalled())return;d("WALogger").LOG(l(),this.$1.name);this.$5!==0&&d("WALogger").ERROR(k());this.$5++;this.$6()};e.$6=function(){var a=this,c=this.$1,e=this.$5,f=d("WAPromiseBackoffs").createTimer(this.$1.timer);f();var g=function b(){if(a.$2.resolveWasCalled())return;if(e!==a.$5)return;var g=Date.now();a.$3=c.code(a.endWithValue).then(function(){if(a.$2.resolveWasCalled())return;var e=c.resetDelay;(e!==void 0&&Date.now()>=g+e||a.$4!=null&&a.$4<=Date.now())&&(d("WALogger").LOG(j(),c.name),f=d("WAPromiseBackoffs").createTimer(a.$1.timer));a.$4=null;e=f();d("WALogger").LOG(i(),c.name,e);return d("WAPromiseDelays").delayMs(e).then(b)});return a.$3};this.$3=(h||(h=b("Promise"))).resolve().then(g)};e.promise=function(){var a=this;if(this.$2.resolveWasCalled())return this.$2.promise;return!this.$3?(h||(h=b("Promise"))).reject(c("WAErr")("PromiseRetryLoop "+this.$1.name+" had promise() called before start()")):(h||(h=b("Promise"))).race([this.$2.promise,this.$3.then(function(){return a.$2.promise})])};return a}();g.PromiseRetryLoop=a}),98);
__d("WASmaxInPingsEnums",["WAJids"],(function(a,b,c,d,e,f,g){a={validators:[d("WAJids").validateDomainJid,d("WAJids").validateUserJid],typeName:"DomainJid|UserJid"};g.DOMAINJID_USERJID=a}),98);
__d("WADeepEquals",[],(function(a,b,c,d,e,f){"use strict";function g(a,b){if(a===b)return!0;if(!a||!b||typeof a!=="object"&&typeof b!=="object")return!1;var c=Array.isArray(a),d=Array.isArray(b);if(c!==d)return!1;d=!0;if(c){c=a.length;if(c!==b.length)return!1;for(var e=0;d&&e<c;e++)d=g(a[e],b[e]);return d}c=Object.keys(a);for(e=0;d&&e<c.length;e++){var f=c[e];d=b.propertyIsEnumerable(f)&&g(a[f],b[f])}return d&&Object.keys(b).length===c.length}f.deepEqual=g}),66);
__d("WASmaxParseUtils",["WABase64","WABinary","WACryptoUtils","WADeepEquals","WAHasProperty","WAResultOrError","WAStanzaUtils","WAWapJid"],(function(a,b,c,d,e,f,g){"use strict";var h=d("WAResultOrError").makeResult();function a(a,b){return a.tag!==b?H(a,"to be <"+b+">"):h}function i(a,b){return!I(a,b)?H(a,'to have attribute "'+b+'"'):J(a,a.attrs[b])}function j(a,b,c,e){var f=i(a,b);if(!f.success)return f;c=c(f.value);return c!=null?d("WAResultOrError").makeResult(c):H(a,'to have "'+b+'"={'+e+'}, but instead has "'+f.value+'"')}function k(a,b,c){var e=B(a);if(!e.success)return e;b=b(e.value);return b!=null?d("WAResultOrError").makeResult(b):H(a,"to have "+c+' content, but instead has "'+e.value+'"')}function b(a,b,c){var d=i(a,b);if(!d.success)return d;else if(d.value!==c)return H(a,'to have "'+b+'"="'+c+'", but instead has "'+d.value+'"');return h}function e(a,b){return j(a,b,d("WAStanzaUtils").toStanzaId,"stanzaID")}function l(a,b){return j(a,b,K,"integer")}function f(a,b,c,e){var f=l(a,b);if(!f.success)return f;f=f.value;if(c!==void 0&&f<c)return H(a,'to have "'+b+'"={at least '+c+"} but has value "+f);else if(e!==void 0&&f>e)return H(a,'to have "'+b+'"={at most '+e+"} but has value "+f);return d("WAResultOrError").makeResult(f)}function m(a){var b=a.content;return b instanceof Uint8Array?H(a,"to have children"):d("WAResultOrError").makeResult(b)}function n(a,b){var c=m(a);if(!c.success)return c;c=c.value;if(c==null)return h;var e=null;for(var f=0;f<c.length;f++){var g=c[f];if(g.tag===b){if(e!=null)return H(a,"to have 1 child <"+b+">, but found more than 1");e=g}}return d("WAResultOrError").makeResult(e)}function o(a,b,c){a=n(a,b);if(!a.success)return a;return a.value==null?h:c(a.value)}function p(a,b,c){c=o(a,b,c);if(!c.success)return c;c=c.value;return c==null?H(a,"to have 1 child <"+b+">, but found 0"):d("WAResultOrError").makeResult(c)}function q(a,b){var c=n(a,b);if(!c.success)return c;return c.value==null?H(a,"to have 1 child <"+b+">, but found 0"):d("WAResultOrError").makeResult(c.value)}function r(a,b,c,e,f){a=L(a,b,c,e);if(!a.success)return a;b=[];for(c=0;c<a.value.length;c++){e=f(a.value[c]);if(!e.success)return e;b.push(e.value)}return d("WAResultOrError").makeResult(b)}function s(a,b,c,e,f){a=L(a,b,c,e);if(!a.success)return a;b=a.value.length;for(c=0;c<b;c++){e=f(a.value[c]);if(!e.success)return e}return d("WAResultOrError").makeResult(b)}function t(a,b,c){b=r(a,b,0,Infinity,c);if(!b.success)return b;for(c=0;c<b.value.length;c++)if(!d("WADeepEquals").deepEqual(b.value[0],b.value[c]))return H(a,"to have homogeneous children, but found two children that are not equal");return b}function u(a,b,c){a=t(a,b,c);return!a.success?a:d("WAResultOrError").makeResult(a.value.length)}function v(a,b,c,d,e){return I(b,c)?a(b,c,d,e):h}function w(a,b,c,e){if(e==null)return h;a=v(a,b,c);if(!a.success)return a;if(a.value===e)return d("WAResultOrError").makeResult(e);return a.value==null?h:H(b,'to have "'+c+'"={'+e+'}, but instead has "'+a.value+'"')}function x(a,b,c,e){a=a(b,c);if(!a.success)return a;return a.value===e?d("WAResultOrError").makeResult(e):H(b,'to have "'+c+'"={'+e+'}, but instead has "'+a.value+'"')}function y(a,b,c){a=a(b);if(!a.success)return a;return a.value===c?d("WAResultOrError").makeResult(c):H(b,'to have content "'+c+'", but instead has "'+a.value+'"')}function z(a,b,c){var e=i(a,b);if(!e.success)return e;var f=c[e.value];if(f!=null)return d("WAResultOrError").makeResult(f);f=Object.values(c).join("|");return H(a,'to have "'+b+'"={'+f+'}, but instead has "'+e.value+'"')}function A(a,b){var c=B(a);if(!c.success)return c;var e=b[c.value];if(e!=null)return d("WAResultOrError").makeResult(e);e=Object.values(b).join("|");return H(a,'to have content "'+e+'", but instead has "'+c.value+'"')}function B(a){var b=C(a);if(!b.success)return b;else try{b=new(d("WABinary").Binary)(b.value);b=b.readString(b.size());return d("WAResultOrError").makeResult(b)}catch(b){return H(a,"to have string content, but run into decoding error: "+b.message)}}function C(a){var b=a.content;if(b==null)return H(a,"to have content");else if(Array.isArray(b))return H(a,"to have content, but has children instead");else return d("WAResultOrError").makeResult(b)}function D(a,b){var c=C(a);if(!c.success)return c;return d("WACryptoUtils").uint8ArraysEqual(c.value,b)?d("WAResultOrError").makeResult(b):H(a,'to have content ":binary:'+d("WABase64").encodeB64(b)+'", but instead has ":binary:'+d("WABase64").encodeB64(c.value)+'"')}function E(a,b,c){var e=a.content;if(e==null)if(b===void 0||b<1)return d("WAResultOrError").makeResult(new Uint8Array([]));else return H(a,"to have content");else if(Array.isArray(e))return H(a,"to have content, but has children instead");else{var f=e.length;if(b!==void 0&&f<b)return H(a,"to have binary content at least "+b+" bytes but has "+f+" bytes");else if(c!==void 0&&f>c)return H(a,"to have binary content at most "+c+" bytes but has "+f+" bytes");return d("WAResultOrError").makeResult(e)}}function F(a){return k(a,K,"integer")}function G(a){return a}function H(a,b){return d("WAResultOrError").makeError("expected <"+a.tag+">: "+b)}function I(a,b){return c("WAHasProperty")(a.attrs,b)}function J(a,b){if(b instanceof d("WAWapJid").WapJid)return d("WAResultOrError").makeResult(b.toString());return typeof b==="string"?d("WAResultOrError").makeResult(b):H(a,"decodeAsString: attribute is "+typeof b+" not a string: "+String(b))}function K(a){a=parseInt(a,10);return Number.isNaN(a)?null:a}function L(a,b,c,e){var f=m(a);if(!f.success)return f;f=f.value;if(f==null)if(c!==0)return H(a,"to have at least "+c+" <"+b+"> children, but found 0");else return d("WAResultOrError").makeResult([]);var g=[];for(var h=0;h<f.length;h++){var i=f[h];i.tag===b&&g.push(i)}i=g.length;if(i<c)return H(a,"to have at least "+c+" <"+b+"> children, but found "+i);else if(i>e)return H(a,"to have at most "+e+" <"+b+"> children, but found "+i);return d("WAResultOrError").makeResult(g)}var M={};function N(a,b,c){var d=b.map(function(a,b){return a+": "+c[b].error});return H(a,["to match any of following mixins: "+b.join(", ")+", but all mixins failed."].concat(d).join(" "))}g.voidSuccess=h;g.assertTag=a;g.attrString=i;g.attrValidate=j;g.contentValidate=k;g.assertAttr=b;g.attrStanzaId=e;g.attrInt=l;g.attrIntRange=f;g.maybeChildren=m;g.optionalChild=n;g.optionalChildWithTag=o;g.childWithTag=p;g.flattenedChildWithTag=q;g.mapChildrenWithTag=r;g.countChildrenWithTag=s;g.mapHomogeneousChildrenWithTag=t;g.countHomogeneousChildrenWithTag=u;g.optional=v;g.optionalLiteral=w;g.literal=x;g.literalContent=y;g.attrStringEnum=z;g.contentStringEnum=A;g.contentString=B;g.contentBytes=C;g.contentLiteralBytes=D;g.contentBytesRange=E;g.contentInt=F;g.identity=G;g.errorMessage=H;g.emptyObject=M;g.errorMixinDisjunction=N}),98);
__d("WASmaxParseJid",["WAJids","WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return d("WASmaxParseUtils").attrValidate(a,b,d("WAJids").validateUserJid,"UserJid")}function b(a,b){return d("WASmaxParseUtils").attrValidate(a,b,d("WAJids").validateDeviceJid,"DeviceJid")}function c(a,b){return d("WASmaxParseUtils").attrValidate(a,b,d("WAJids").validateGroupJid,"GroupJid")}function e(a,b){return d("WASmaxParseUtils").attrValidate(a,b,d("WAJids").validateCallJid,"CallJid")}function f(a,b){return d("WASmaxParseUtils").attrValidate(a,b,d("WAJids").validateDomainJid,"DomainJid")}function h(a,b){return d("WASmaxParseUtils").attrValidate(a,b,d("WAJids").validateBroadcastJid,"BroadcastJid")}function i(a,b){return d("WASmaxParseUtils").attrValidate(a,b,d("WAJids").validateStatusJid,"StatusJid")}function j(a,b){return d("WASmaxParseUtils").attrValidate(a,b,d("WAJids").validateNewsletterJid,"NewsletterJid")}function k(a,b,c){var e=d("WASmaxParseUtils").attrString(a,b);if(!e.success)return e;var f=c.validators;c=c.typeName;for(var g=0;g<f.length;g++){var h=f[g](e.value);if(h!=null)return d("WAResultOrError").makeResult(h)}return d("WASmaxParseUtils").errorMessage(a,'to have "'+b+'"={'+c+'}, but instead has "'+e.value+'"')}function l(a,b,c,e){a=a(b,c);if(!a.success)return a;return a.value===e?a:d("WASmaxParseUtils").errorMessage(b,'to have "'+c+'"={'+e+'}, but instead has "'+a.value+'"')}function m(a,b,c,e){a=d("WASmaxParseUtils").optional(a,b,c);if(!a.success)return a;return a.value==null||a.value===e?a:d("WASmaxParseUtils").errorMessage(b,'to have "'+c+'"={'+e+'}, but instead has "'+a.value+'"')}g.attrUserJid=a;g.attrDeviceJid=b;g.attrGroupJid=c;g.attrCallJid=e;g.attrDomainJid=f;g.attrBroadcastJid=h;g.attrStatusJid=i;g.attrNewsletterJid=j;g.attrJidEnum=k;g.literalJid=l;g.optionalLiteralJid=m}),98);
__d("WASmaxParseReference",["WAHasProperty","WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,c,d,e){b=j(b,c);if(!b.success)return l(b);a=a(b.value,c[c.length-1],d,e);return!a.success?l(a):a}function a(a,b,c,e,f){return k(b,c)?h(a,b,c,e,f):d("WASmaxParseUtils").voidSuccess}function i(a,b){return h(d("WASmaxParseUtils").attrString,a,b)}function b(a,b){return k(a,b)?i(a,b):d("WASmaxParseUtils").voidSuccess}function e(a,b){a=j(a,b);if(!a.success)return l(a);b=d("WASmaxParseUtils").contentString(a.value);return!b.success?l(b):b}function j(a,b){var c=b.length;a=a;for(var e=0;e<c-1;e++){var f=b[e];f=d("WASmaxParseUtils").flattenedChildWithTag(a,f);if(!f.success)return f;a=f.value}return d("WAResultOrError").makeResult(a)}function k(a,b){a=j(a,b);return a.success&&c("WAHasProperty")(a.value.attrs,b[b.length-1])}function l(a){return d("WAResultOrError").makeError("in the reference, "+a.error)}g.attrFromReference=h;g.optionalAttrFromReference=a;g.attrStringFromReference=i;g.optionalAttrStringFromReference=b;g.contentStringFromReference=e}),98);
__d("WASmaxInPingsClientResponseServerResponse",["WAResultOrError","WASmaxInPingsEnums","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseJid").attrJidEnum(a,"from",d("WASmaxInPingsEnums").DOMAINJID_USERJID);if(!c.success)return c;var e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");if(!e.success)return e;b=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",b.value);if(!b.success)return b;b=d("WASmaxParseUtils").attrInt(a,"t");return!b.success?b:d("WAResultOrError").makeResult({from:c.value,type:e.value,t:b.value})}g.parseClientResponseServerResponse=a}),98);
__d("WASmaxJsx",["WAWap"],(function(a,b,c,d,e,f,g){"use strict";g.smax=d("WAWap").wap}),98);
__d("WASmaxMixins",["WAArrayBufferUtils","WAWapJid"],(function(a,b,c,d,e,f,g){"use strict";var h="smax$any";function i(a,b){j(a,b);k(a,b);b.content instanceof Uint8Array?m(a,b.content):b.content!=null&&n(a,b.content);return a}function a(a,b,c,d){return c!=null?a(b,c,d):b}function j(a,b){a=a.tag;b=b.tag;if(b===h)return;if(a!==b)throw new Error("tag mismatch: "+a+" != "+b)}function k(a,b){var c=a.attrs,d=b.attrs;Object.keys(d).forEach(function(a){var b=d[a],e=c[a];if(b!=null&&e!=null){if(l(b,e))return;throw new Error("conflict for key: "+a)}c[a]=b})}function l(a,b){if(typeof a==="string"&&typeof b==="string")return a===b;return a instanceof d("WAWapJid").WapJid&&b instanceof d("WAWapJid").WapJid?a.toString()===b.toString():!1}function m(a,b){var c=a.content;if(c instanceof Uint8Array){if(!d("WAArrayBufferUtils").uint8ArraysEqualUNSAFE(c,b))throw new Error("elementValue mismatch: bytes dose not equal");return}if(c!=null)throw new Error("elementValue mismatch: destination has children");a.content=b}function n(a,b){var c=a.content;if(c instanceof Uint8Array)throw new Error("children mismatch: destination has element value");if(c==null||c.length===0){a.content=b;return}if(!o(c,b))throw new Error("children mismatch: child counts are not compatible");var d=[],e=Array.from(c);b.forEach(function(a){var b=e.findIndex(function(b){return b.tag===a.tag});if(b===-1)d.push(a);else{b=e.splice(b,1);b=i(b[0],a);d.push(b)}});e.forEach(function(a){return d.push(a)});a.content=d}function o(a,b){b=p(b);a=p(a);var c=Object.keys(b);for(var d=0;d<c.length;d++){var e=c[d],f=b[e];e=a[e];if(f!=null&&e!=null&&f!==e)return!1}return!0}function p(a){return a.reduce(function(a,b){b=b.tag;var c=a[b];a[b]=c==null?1:c+1;return a},{})}g.mergeStanzas=i;g.optionalMerge=a}),98);
__d("WASmaxOutPingsClientWellFormedToMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("iq",{to:d("WAWap").S_WHATSAPP_NET});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeClientWellFormedToMixin=a}),98);
__d("WASmaxOutPingsClientRequest",["WASmaxJsx","WASmaxOutPingsClientWellFormedToMixin","WAWap"],(function(a,b,c,d,e,f,g){function a(){var a=d("WASmaxOutPingsClientWellFormedToMixin").mergeClientWellFormedToMixin(d("WASmaxJsx").smax("iq",{id:d("WAWap").generateId(),type:"get",xmlns:"w:p"}));return a}g.makeClientRequest=a}),98);
__d("WAComms",["Promise","WAArrayUtils","WAErr","WAErrors","WALogger","WANotifyConnectionChangeFactory","WAPromiseRetryLoop","WAResolvable","WAResultOrError","WAShiftTimer","WASmaxInPingsClientResponseServerResponse","WASmaxOutPingsClientRequest","WASmaxParseUtils","WATimeUtils","WAWap","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms has no open socket"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms: closeSocket called"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms: Socket "," closed"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms: socketLoopIteration failed ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms: socketLoopIteration socket closed while in noise handshake"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms: socketLoopIteration socket disconnected while in noise handshake"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms: socketLoopIteration socket closed while in noise handshake using treasureHunt strategy"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms: Socket "," closed"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms: Socket "," opened"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms: Socket "," opening"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms: maybeResetSocketLoop"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms: closeSocketAndPreventRetry called"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleAck: unrecognized ",""]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms: job response is NO_ACK"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms: job response is CLOSE_SOCKET"]);w=function(){return a};return a}function x(){var a=babelHelpers.taggedTemplateLiteralLoose(["--- Receiving ---\n",""],["--- Receiving ---\\n",""]);x=function(){return a};return a}function y(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failure parsing stanza!"]);y=function(){return a};return a}function z(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms.startHandlingRequests"]);z=function(){return a};return a}function A(){var a=babelHelpers.taggedTemplateLiteralLoose(["castStanza error ",""]);A=function(){return a};return a}function B(){var a=babelHelpers.taggedTemplateLiteralLoose(["castStanza async error ",""]);B=function(){return a};return a}function C(){var a=babelHelpers.taggedTemplateLiteralLoose(["--- Sending ---\n",""],["--- Sending ---\\n",""]);C=function(){return a};return a}function D(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error in onBeforeCastStanza, we consumed and continue with normal stanza sending to the server:\n",""],["Error in onBeforeCastStanza, we consumed and continue with normal stanza sending to the server:\\n",""]);D=function(){return a};return a}function E(){var a=babelHelpers.taggedTemplateLiteralLoose(["Dropping stanza since onBeforeCastStanza matched. We return mock response directly."]);E=function(){return a};return a}function F(){var a=babelHelpers.taggedTemplateLiteralLoose(["--- Receive (via SMAX+E2E) ---\n",""],["--- Receive (via SMAX+E2E) ---\\n",""]);F=function(){return a};return a}function G(){var a=babelHelpers.taggedTemplateLiteralLoose(["Dropping stanza since onBeforeCastStanza matched:\n",". We return mock response directly."],["Dropping stanza since onBeforeCastStanza matched:\\n",". We return mock response directly."]);G=function(){return a};return a}function H(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms has no open socket, will resend stanza when socket opens"]);H=function(){return a};return a}function I(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms: No stanzaId in ping request stanza"]);I=function(){return a};return a}function J(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms: sendPing ping still pending"]);J=function(){return a};return a}function K(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms: sendPing when socket dead"]);K=function(){return a};return a}function L(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms: Socket "," expired"]);L=function(){return a};return a}function M(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms: testing socket"]);M=function(){return a};return a}function N(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleIq no handler for iq"]);N=function(){return a};return a}function O(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleIq no handler for iq with id ",""]);O=function(){return a};return a}var P=null,Q=null,R=1,S=0,T=function(){function a(a,c,e){var f=this;this.nextSocketId=1;this.pendingIqs=new Map();this.ackHandlers=[];this.pendingSmaxStanzas=new Map();this.$2=new(d("WAResolvable").Resolvable)();this.socketAbortController=null;this.activePing=null;this.$3=new Set();this.socketId=S;this.socket=null;this.softCloseSocket=null;this.handleStanza=function(a,b,c){var e=d("WASmaxParseUtils").attrString(a,"id");if(e.success&&a.tag!=="receipt"){e=e.value;var g=f.pendingSmaxStanzas.get(e);if(g){f.pendingSmaxStanzas["delete"](e);g.resolve(a);f.maybeScheduleHealthCheck();return"NO_ACK"}}e=$(a);if(e!=null){g=f.pendingIqs.get(e);g?(f.pendingIqs["delete"](e),g.resolve(a),f.maybeScheduleHealthCheck()):(d("WALogger").WARN(O(),e),d("WALogger").ERROR(N()))}else if(a.tag==="ack")f.handleAck(a);else return a.tag==="failure"&&f.config.shouldBlockReceivingUntilSuccess?f.$1(a,b,c):f.$2.promise.then(function(){return f.$1(a,b,c)});return"NO_ACK"};this.healthCheckTimer=new(d("WAShiftTimer").ShiftTimer)(function(){d("WALogger").DEV(M());if(!f.socketId)return;f.sendPing()});this.deadSocketTimer=new(d("WAShiftTimer").ShiftTimer)(function(a){d("WALogger").LOG(L(),a);if(a!==f.socketId)return;f.softCloseSocket&&f.softCloseSocket()});this.sendPing=function(){var a,c,e,f,g,i,j,k;return b("regeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:a=Z("sendPing");if(a.socketId){l.next=4;break}d("WALogger").LOG(K());return l.abrupt("return",(h||(h=b("Promise"))).resolve());case 4:if(!(a.activePing&&a.activePing.socketId===a.socketId)){l.next=7;break}d("WALogger").LOG(J());return l.abrupt("return",(h||(h=b("Promise"))).resolve());case 7:a.activePing&&a.activePing.handler.resolve();c=d("WASmaxOutPingsClientRequest").makeClientRequest();e=c.attrs.id;if(!(typeof e!=="string")){l.next=13;break}d("WALogger").ERROR(I());return l.abrupt("return",(h||(h=b("Promise"))).resolve());case 13:f=new(d("WAResolvable").Resolvable)();a.activePing={socketId:a.socketId,stanzaId:e,handler:f};a.callStanza(c);l.next=18;return b("regeneratorRuntime").awrap(f.promise);case 18:g=l.sent,g&&(i=d("WASmaxInPingsClientResponseServerResponse").parseClientResponseServerResponse(g,c),i.success&&(j=d("WATimeUtils").castToUnixTime(i.value.t),k=Math.round(Date.now()/1e3-j),a.config.handlers.onClockSkewUpdate==null?void 0:a.config.handlers.onClockSkewUpdate(k)));case 20:case"end":return l.stop()}},null,this)};this.$1=a;this.onConnectionChange=d("WANotifyConnectionChangeFactory").notifyConnectionChangeFactory((a=c.handlers.onConnectionChange)!=null?a:function(){},(a=c.handlers.onOptimisticConnectionChange)!=null?a:function(){});this.gzipInflate=e;this.config=c;this.socketLoop=new(d("WAPromiseRetryLoop").PromiseRetryLoop)({name:"MainSocketLoop",code:W,timer:{jitter:.1,max:c.maxSocketLoopWaitTime,algo:{type:"fibonacci",first:1e4,second:1e4},relativeDelay:!0},resetDelay:3e4})}var e=a.prototype;e.filterPending=function(a){var b=[];function c(c){a(c)&&b.push(c)}this.pendingIqs.forEach(c);this.ackHandlers.forEach(c);this.pendingSmaxStanzas.forEach(c);return b};e.sendPendingStanza=function(a){a.cleanup==null?void 0:a.cleanup(),a.cleanup=void 0,this.callStanza(a.stanza)};e.maybeSendPendingStanza=function(a){if(a.attempt>=this.config.maxRetries)this.config.handlers.onDropStanza==null?void 0:this.config.handlers.onDropStanza(a),a.cleanup==null?void 0:a.cleanup(),a.cleanup=void 0,this.removeHandler(a,"max-retries");else if(this.socket){a.attempt+=1;this.sendPendingStanza(a);return}else d("WALogger").LOG(H())};e.callStanzaAsync=function(a,c){var d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(this.callStanza(a,c));case 2:d=e.sent;return e.abrupt("return",d);case 4:case"end":return e.stop()}},null,this)};e.callStanza=function(a,b){a=this.castStanza(a,b);this.deadSocketTimer.onOrBefore(this.config.deadSocketTime,this.socketId);this.healthCheckTimer.cancel();return a};e.castStanzaAsync=function(a){var c;return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:d.next=2;return b("regeneratorRuntime").awrap(this.castStanza(a));case 2:c=d.sent;return d.abrupt("return",c);case 4:case"end":return d.stop()}},null,this)};e.castStanza=function(a,c){var e=this;try{var f=this.config.handlers.onBeforeCastStanzaForE2E==null?void 0:this.config.handlers.onBeforeCastStanzaForE2E(a,c);if(f!=null){d("WALogger").DEV_XMPP(G(),a);d("WALogger").DEV_XMPP(F(),f);d("WALogger").ERROR(E());if(Array.isArray(f))return(h||(h=b("Promise"))).all(f.map(function(a){return(h||(h=b("Promise"))).resolve(e.handleStanza(a,e.socketId,S))}));else{this.handleStanza(f,this.socketId,S);return(h||(h=b("Promise"))).resolve()}}}catch(a){d("WALogger").DEV_XMPP(D(),a)}f=this.socketOrThrow("castStanza");try{d("WALogger").DEV_XMPP(C(),a);return f.sendFrame(d("WAWap").encodeStanza(a)).then(function(){e.config.handlers.onCastStanza==null?void 0:e.config.handlers.onCastStanza(a,c)})["catch"](function(a){d("WALogger").ERROR(B(),a).devConsole(a);if(a instanceof d("WAErrors").BufferTooLargeError)return(h||(h=b("Promise"))).reject(a)})}catch(a){d("WALogger").ERROR(A(),a).devConsole(a)}return(h||(h=b("Promise"))).resolve()};e.socketOrThrow=function(a){var b=this.socket;if(b)return b;throw c("WAErr")("Comms."+a+" called while no socket")};e.startHandlingRequests=function(){d("WALogger").LOG(z());this.$2.resolve();return this.$2.promise.then(function(){})};e.parseAndHandleStanza=function(a,b){var c=this;a===this.socketId&&(this.deadSocketTimer.cancel(),Q&&(Q.resolve(),Q=null));var e=d("WAWap").decodeStanza(b,this.gzipInflate)["catch"](function(a){d("WALogger").ERROR(y()).devConsole(b);throw a}).then(function(e){d("WALogger").DEV_XMPP(x(),e);c.config.handlers.onHandleStanza==null?void 0:c.config.handlers.onHandleStanza(e,a,b.byteLength);var f=c.activePing;if(f&&f.socketId===a&&f.stanzaId===$(e)){c.activePing=null;f.handler.resolve(e);c.maybeScheduleHealthCheck();return"NO_ACK"}return c.handleStanza(e,a,b.byteLength)}).then(function(b){if(a!==c.socketId)return;if(b==="CLOSE_SOCKET"){d("WALogger").LOG(w());var e=c.socket;e&&e.close()}else b==="NO_ACK"?d("WALogger").DEV(v()):c.castStanza(b);return"NO_ACK"});this.$3.add(e);e["finally"](function(){return void c.$3["delete"](e)})};e.handleAck=function(a){var b=this.ackHandlers,c=-1,e=null;while(!e&&++c<b.length)e=b[c].parseAndTest(a);if(e){var f=b[c];d("WAArrayUtils").removeIndexWithoutPreservingOrder(b,c);this.config.handlers.onHandleAck==null?void 0:this.config.handlers.onHandleAck(a);f.resolve(e);this.maybeScheduleHealthCheck()}else d("WALogger").WARN(u(),a)};e.removeHandler=function(a,c){c===void 0&&(c="disconnect");if(a.type==="iq"||a.type==="smax"){var e=a.stanza.attrs.id;if(!e||typeof e!=="string")return;if(a.type==="iq"&&!this.pendingIqs["delete"](e)||a.type==="smax"&&!this.pendingSmaxStanzas["delete"](e))return}else{a.type;e=this.ackHandlers.indexOf(a);if(e===-1)return;d("WAArrayUtils").removeIndexWithoutPreservingOrder(this.ackHandlers,e)}c==="disconnect"?a.resolve((h||(h=b("Promise"))).reject(new(d("WAErrors").Disconnected)())):a.resolve((h||(h=b("Promise"))).reject(new(d("WAErrors").MaxRetries)()))};e.maybeScheduleHealthCheck=function(){if(this.healthCheckTimer.isScheduled())return;if(this.activePing||this.ackHandlers.length||this.pendingIqs.size||this.pendingSmaxStanzas.size)return;var a=this.config.healthCheckInterval;a=Math.ceil(a*1e3*(1+Math.random()));this.healthCheckTimer.onOrBefore(a)};return a}();function a(){return P}function e(a,b,c,d){d===void 0&&(d=!0);if(P)return;P=new T(a,b,c);d&&setTimeout(U,0)}function f(){var a=Z("stopComms");a.socketLoop.endWithValue();a.socket&&X();P=null}function aa(){var a=Z("closeSocketAndPreventRetry");a.socketLoop.endWithValue();a.socket&&(d("WALogger").LOG(t()),X())}function U(){Z("openSocketLoop").socketLoop.start()}function ba(){d("WALogger").LOG(s()),V()||Z("maybeResetSocketLoop").socketLoop.reset()}function ca(){Z("forceResetSocketLoop").socketLoop.reset()}function da(){var a,b=Z("socketAbortController");(a=b.socketAbortController)==null?void 0:a.abort();b.softCloseSocket==null?void 0:b.softCloseSocket()}function V(){var a;return!!((a=P)==null?void 0:a.socket)}function W(){var a=Z("socketLoopIteration"),b=a.nextSocketId++;d("WALogger").LOG(r(),b);var c=function(){a.onConnectionChange("in_handshake")};a.config.handlers.onSocketLoopIteration==null?void 0:a.config.handlers.onSocketLoopIteration(a.socketAbortController);typeof AbortController==="function"&&(a.socketAbortController=new AbortController());return a.config.openChatSocket(c,(c=a.socketAbortController)==null?void 0:c.signal).then(d("WAResultOrError").onResult(function(c){a.config.handlers.onSocketOpen==null?void 0:a.config.handlers.onSocketOpen();var e=new(d("WAResolvable").Resolvable)();d("WALogger").LOG(q(),b);a.socketId=b;a.socket=c;a.softCloseSocket=function(){a.softCloseSocket=null,a.socket&&a.config.shouldCloseStaleSocket&&(X(),a.socket=null),e.resolve()};a.socketLoop.resetTimeoutAfter(1e4);a.deadSocketTimer.cancel();a.maybeScheduleHealthCheck();c.setOnFrame(function(c){return a.parseAndHandleStanza(b,c)});c.setOnClose(function(){d("WALogger").LOG(p(),b);a.activePing&&b===a.activePing.socketId&&(a.activePing.handler.resolve(),a.activePing=null);a.filterPending(function(a){return a.attachedToSocketId===b}).forEach(function(b){return void a.removeHandler(b)});if(b!==a.socketId)return;a.socketId=S;a.socket=null;a.onConnectionChange("disconnected");a.config.handlers.onDisconnect==null?void 0:a.config.handlers.onDisconnect();e.resolve()});a.onConnectionChange("connected");a.config.handlers.onConnect==null?void 0:a.config.handlers.onConnect();a.filterPending(function(a){return!a.attachedToSocketId}).sort(function(a,b){return a.orderedId-b.orderedId}).forEach(function(b){switch(b.type){case"smax":case"iq":a.maybeSendPendingStanza(b);break;case"ack":a.callStanza(b.stanza);break;default:b.type;break}});return e.promise})).then(d("WAResultOrError").catchError(function(a){switch(a){case"max-hunters":d("WALogger").WARN(o());break;case"disconnected":d("WALogger").WARN(n());break;default:a;return}}))["catch"](function(a){a instanceof d("WAErrors").Disconnected?d("WALogger").LOG(m()):d("WALogger").ERROR(l(),a).devConsole(a)})}function X(){var a=Z("closeSocket");a.socket&&(d("WALogger").LOG(k(),a.socketId),d("WALogger").LOG(j()),a.socket.close())}function ea(){Z("onStreamErrorReceived").socketLoop.cancelReset()}function fa(){Z("waitForConnection").sendPing();Q||(Q=new(d("WAResolvable").Resolvable)());return Q.promise}function ga(a,b){var c=Z("castStanza");c.socket?c.castStanza(a,b):d("WALogger").LOG(i())}function ha(a){var b=Z("castStanza");return b.socketId===a}function Y(a,e,f,g,i){f===void 0&&(f=0);i===void 0&&(i="iq");return new(h||(h=b("Promise")))(function(j){var k=Z("sendIq"),l=a.attrs.id;if(!l||typeof l!=="string")throw c("WAErr")("Comms:sendIq given iq without id: "+String(a));var m=k.socketId;if(e&&!m){j((h||(h=b("Promise"))).reject(new(d("WAErrors").Offline)()));return}var n=function(){var a=i==="iq"?k.pendingIqs.get(l):k.pendingSmaxStanzas.get(l);if(!a){j((h||(h=b("Promise"))).reject(c("WAErr")("Comms:_sendIq unexisting stanza to be cancelled: "+l)));return}k.removeHandler(a)},o=null;if(f>0){var p=setTimeout(n,f*1e3);o=function(){clearTimeout(p)}}if(g!=null)if(g.aborted){j((h||(h=b("Promise"))).reject(new(d("WAErrors").Disconnected)()));return}else g.addEventListener("abort",n),o=function(){g.removeEventListener("abort",n)};m={resolve:j,stanza:a,attachedToSocketId:e?m:S,orderedId:R++,attempt:0,cleanup:o};if(i==="iq"){o=babelHelpers["extends"]({type:i},m);k.pendingIqs.set(l,o);k.config.handlers.onSendIq==null?void 0:k.config.handlers.onSendIq(a);k.maybeSendPendingStanza(o)}else{i;o=babelHelpers["extends"]({type:i},m);k.pendingSmaxStanzas.set(l,o);k.maybeSendPendingStanza(o)}})}function ia(a,b){var c,d;c=(c=b==null?void 0:b.withoutRetry)!=null?c:!1;d=(d=b==null?void 0:b.timeoutSeconds)!=null?d:0;b=(b=b==null?void 0:b.signal)!=null?b:null;return Y(a,c,d,b,"smax")}function ja(){var a=Z("sendPing");return a.sendPing()}function ka(){return Z("startHandlingRequests").startHandlingRequests()}function la(){P&&P.deadSocketTimer.cancel()}function Z(a){if(P)return P;throw c("WAErr")("Comms::"+a+" called before startComms")}function $(a){if(a.tag==="iq"){var b=a.attrs.type;if(b==="result"||b==="error")return d("WAWap").decodeAsString(a.attrs.id)||null}return null}function ma(){return R++}function na(){P=null,Q=new(d("WAResolvable").Resolvable)(),R=1}g.DEFAULT_SOCKET_ID=S;g.getComms=a;g.startComms=e;g.stopComms=f;g.closeSocketAndPreventRetry=aa;g.openSocketLoop=U;g.maybeResetSocketLoop=ba;g.forceResetSocketLoop=ca;g.forceAbortSocketConnection=da;g.isSocketConnected=V;g.socketLoopIteration=W;g.closeSocket=X;g.onStreamErrorReceived=ea;g.waitForConnection=fa;g.castSmaxStanza=ga;g.isActiveSocket=ha;g._sendIq=Y;g.sendSmaxStanza=ia;g.sendPing=ja;g.startHandlingRequests=ka;g.cancelDeadSocketTimer=la;g.singletonOrThrowIfUninitialized=Z;g.getAndIncrementNextOrderedId=ma;g.resetStateForTests=na}),98);
__d("WAParseIqResponse",["WAWap"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c){var e=a.content;if(e&&Array.isArray(e)&&e[0]){e=e[0];if(e.tag==="error"){var f=e.attrs||{},g;c&&(typeof c==="function"?g=c(a):g=c.parseOrThrow(e));c=g;return{success:!1,errorCode:parseInt(f.code,10),errorText:d("WAWap").decodeAsString(f.text)||"",errorType:d("WAWap").decodeAsString(f.type)||"",errorBackoff:parseInt(f.backoff,10),toString:h,customError:c}}}if(typeof b==="function")return{success:!0,result:b(a)};else return{success:!0,result:b.parseOrThrow(a)}}function h(){return"IqError "+this.errorCode+": "+this.errorText}g.parseIqResponse=a}),98);
__d("WADeprecatedSendIq",["Promise","WAAckParser","WAArrayUtils","WAComms","WALogger","WAParseIqResponse"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms has no open socket, will send stanza when socket opens"]);i=function(){return a};return a}function a(a,b){return d("WAComms")._sendIq(a,!1).then(function(a){return d("WAParseIqResponse").parseIqResponse(a,b)})}function c(a,b,c){return d("WAComms")._sendIq(a,!1).then(function(a){return d("WAParseIqResponse").parseIqResponse(a,b,c)})}function e(a,b,c){return d("WAComms")._sendIq(a,!1,c).then(function(a){return d("WAParseIqResponse").parseIqResponse(a,b)})}function f(a,b){return d("WAComms")._sendIq(a,!0).then(function(a){return d("WAParseIqResponse").parseIqResponse(a,b)})}function j(a,b){return k(a,b).then(function(){})}function k(a,c){return new(h||(h=b("Promise")))(function(e){var f=d("WAComms").singletonOrThrowIfUninitialized("deprecatedSendStanzaAndReturnAck"),g=function(a){var b=d("WAAckParser").AckParser.parse(a);return!b.error&&d("WAAckParser").ackMatchesTemplate(b.success,c)?a:null},j={type:"ack",parseAndTest:g,resolve:e,stanza:a,attachedToSocketId:d("WAComms").DEFAULT_SOCKET_ID,orderedId:d("WAComms").getAndIncrementNextOrderedId()};f.ackHandlers.push(j);if(!f.socket){d("WALogger").LOG(i());return}f.callStanza(a)["catch"](function(a){var c=f.ackHandlers.indexOf(j);if(c===-1)return;d("WAArrayUtils").removeIndexWithoutPreservingOrder(f.ackHandlers,c);j.resolve((h||(h=b("Promise"))).reject(a))})})}function l(a,b){d("WAComms").castSmaxStanza(a,b)}g.deprecatedSendIq=a;g.deprecatedSendIqErrorParser=c;g.deprecatedSendIqIfConnectedWithin=e;g.deprecatedSendIqWithoutRetry=f;g.deprecatedSendStanzaAndWaitForAck=j;g.deprecatedSendStanzaAndReturnAck=k;g.deprecatedCastStanza=l}),98);
__d("MAWAcceptGroupInvite",["MAWDbChatId","MAWGlobals","MAWJids","WADeprecatedSendIq","WADeprecatedWapParser","WAJids","WALogger","WAPersistedJobManager","WATimeUtils","WAWap","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["acceptGroupInvite failed to get group invite info ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["acceptGroupInvite failed to get group jid for ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["acceptGroupInvite failed to get thread jid for ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["acceptGroupInvite called"]);k=function(){return a};return a}var l=new(c("WADeprecatedWapParser"))("getAcceptGroupInviteResponse",function(a){a.assertTag("iq"),a.assertAttr("type","result")});a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("saveAndPassOff",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").LOG(k());var b=a.chatId,c=a.inviteCode,e=a.invitedParticipantUserId,f=a.inviteExpirationTs;a=a.inviterUserId;b=d("MAWDbChatId").unsafeCoerceToChatId(b);a=d("MAWJids").toUserJid(a);e=d("MAWJids").toUserJid(e);var g=(yield d("MAWGlobals").getDbImpls().getThreadJidByChatId(b)),m;if(c!=null&&f!=null){if(g==null){d("WALogger").DEV(j(),b);return!1}m=d("WAJids").interpretAsGroupJid(g);if(m==null){d("WALogger").DEV(i(),g);return!1}c=c;f=f}else{b=(yield d("MAWGlobals").getDbImpls().getGroupInvite(b,a,e));if(!b.success){d("WALogger").DEV(h(),b.error);return!1}m=b.value.groupJid;c=b.value.groupInvite.inviteCode;f=b.value.groupInvite.inviteExpirationTs}b=d("WAWap").wap("iq",{id:d("WAWap").generateId(),to:d("WAWap").GROUP_JID(m),type:"set",xmlns:"w:g2"},d("WAWap").wap("accept",{admin:d("WAWap").USER_JID(a),code:d("WAWap").CUSTOM_STRING(c),expiration:d("WAWap").LONG_INT(f)}));m=(yield d("WADeprecatedSendIq").deprecatedSendIq(b,l));if(!m.success){a=m.errorCode.toString().startsWith("5");if(a)throw new(d("WAPersistedJobManager").RetryOnBackoff)({algo:{first:d("WATimeUtils").HOUR_MILLISECONDS/60,type:"exponential"},jitter:.1});return!1}g!=null&&(yield d("MAWGlobals").getDbImpls().removeGroupInvites(g,e));return!0});return function(b){return a.apply(this,arguments)}}()).end();g.acceptGroupInvite=a}),98);
__d("WAAckLevel",[],(function(a,b,c,d,e,f){"use strict";a={SENDER_BACKFILL_SENT:-7,INACTIVE_RECEIVED:-6,CONTENT_UNUPLOADABLE:-5,CONTENT_TOO_BIG:-4,CONTENT_GONE:-3,EXPIRED:-2,FAILED:-1,CLOCK:0,SENT:1,RECEIVED:2,READ:3,PLAYED:4};f.ACK=a}),66);
__d("WAMsgUtils",["WAJids"],(function(a,b,c,d,e,f,g){"use strict";var h="Facebook User";function a(a){return a==null||a===""}function b(a){return a==null||a===""?h:a}function c(a){return a!=null?d("WAJids").userIdFromJid(a):h}function e(a,b){b===void 0&&(b=2);a=a.slice(0,b);return[a.map(function(){return void 0}),a.reduce(function(a,b){return[].concat(a,[b])},[])]}g.UNKNOWN_USER=h;g.isUnknownName=a;g.maybeUnknownParticipantName=b;g.createAdminMsgContactId=c;g.getParticipantsAndUnknownNameJids=e}),98);
__d("WACreateParticipantAdminMsg",["WAGlobals","WAMsgUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,c){switch(a){case 1:return{adminMsgContent:[b],adminType:"participantAddedYou"};case 2:return{adminMsgContent:[b,c],adminType:"participantAddedYouAndOneUser"};default:return{adminMsgContent:[b,a.toString()],adminType:"participantAddedYouAndMoreThanOneUsers"}}}function i(a,b,c){switch(a){case 1:return{adminMsgContent:[b],adminType:"currentUserAddedOneParticipant"};case 2:return{adminMsgContent:[b,c],adminType:"currentUserAddedTwoParticipant"};default:return{adminMsgContent:[b,a.toString()],adminType:"currentUserAddedMoreThanTwoParticipant"}}}function j(a,b,c,d){switch(a){case 1:return{adminMsgContent:[b,c],adminType:"participantAddedOneUser"};case 2:return{adminMsgContent:[b,c,d],adminType:"participantAddedTwoUser"}}return{adminMsgContent:[b,c,a.toString()],adminType:"participantAddedMoreThanTwoUser"}}function a(a,b,c,e){e=e==null?b.map(d("WAMsgUtils").createAdminMsgContactId):e;var f=e[0];e=e[1];c=c==null?d("WAMsgUtils").createAdminMsgContactId(a):d("WAMsgUtils").maybeUnknownParticipantName(c);if(a===d("WAGlobals").getMyUserJid())return i(b.length,d("WAMsgUtils").maybeUnknownParticipantName(f),d("WAMsgUtils").maybeUnknownParticipantName(e));return b.includes(d("WAGlobals").getMyUserJid())?h(b.length,d("WAMsgUtils").maybeUnknownParticipantName(c),d("WAMsgUtils").maybeUnknownParticipantName(b[0]===d("WAGlobals").getMyUserJid()?e:f)):j(b.length,c,d("WAMsgUtils").maybeUnknownParticipantName(f),d("WAMsgUtils").maybeUnknownParticipantName(e))}g.createParticipantAdminMessage=a}),98);
__d("WARemoveParticipantAdminMsg",["WAGlobals","WAMsgUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,c){switch(a){case 1:return{adminMsgContent:[b],adminType:"participantRemovedYou"};case 2:return{adminMsgContent:[b,c],adminType:"participantRemovedYouAndOneUser"};default:return{adminMsgContent:[b,a.toString()],adminType:"participantRemovedYouAndMoreThanOneUsers"}}}function i(a,b,c,d){switch(a){case 1:return d?{adminMsgContent:[],adminType:"currentUserLeftGroup"}:{adminMsgContent:[b],adminType:"currentUserRemovedOneParticipant"};case 2:return{adminMsgContent:[b,c],adminType:"currentUserRemovedTwoParticipant"};default:return{adminMsgContent:[b,a.toString()],adminType:"currentUserRemovedMoreThanTwoParticipant"}}}function j(a,b,c,d,e){switch(a){case 1:return e?{adminMsgContent:[b],adminType:"participantLeftGroup"}:{adminMsgContent:[b,c],adminType:"participantRemovedOneUser"};case 2:return{adminMsgContent:[b,c,d],adminType:"participantRemovedTwoUser"}}return{adminMsgContent:[b,c,a.toString()],adminType:"participantRemovedMoreThanTwoUser"}}function a(a,b,c,e){e=e==null?b.map(d("WAMsgUtils").createAdminMsgContactId):e;var f=e[0];e=e[1];var g=c==null?d("WAMsgUtils").createAdminMsgContactId(a):d("WAMsgUtils").maybeUnknownParticipantName(c);if(a===d("WAGlobals").getMyUserJid())return i(b.length,d("WAMsgUtils").maybeUnknownParticipantName(f),d("WAMsgUtils").maybeUnknownParticipantName(e),b[0]===d("WAGlobals").getMyUserJid());return b.includes(d("WAGlobals").getMyUserJid())?h(b.length,d("WAMsgUtils").maybeUnknownParticipantName(c),d("WAMsgUtils").maybeUnknownParticipantName(b[0]===d("WAGlobals").getMyUserJid()?e:f)):j(b.length,g,d("WAMsgUtils").maybeUnknownParticipantName(f),d("WAMsgUtils").maybeUnknownParticipantName(e),b[0]===a)}g.removeParticipantAdminMessage=a}),98);
__d("WAAdminMsgHelpers",["WAAckLevel","WACreateParticipantAdminMsg","WAGlobals","WAJids","WARemoveParticipantAdminMsg","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h="Facebook User";function a(a,b,c){return{type:"Admin",ack:d("WAAckLevel").ACK.SENT,msgContent:d("WACreateParticipantAdminMsg").createParticipantAdminMessage(c==="@me"?d("WAGlobals").getMyUserJid():c,b),id:{chat:a,author:d("WAJids").AUTHOR_SYSTEM,externalId:d("WAGlobals").getDependencies().generateExternalId()},ts:d("WATimeUtils").unixTime()}}function b(a,b,c){return{type:"Admin",ack:d("WAAckLevel").ACK.SENT,msgContent:d("WARemoveParticipantAdminMsg").removeParticipantAdminMessage(c==="@me"?d("WAGlobals").getMyUserJid():c,b),id:{chat:a,author:d("WAJids").AUTHOR_SYSTEM,externalId:d("WAGlobals").getDependencies().generateExternalId()},ts:d("WATimeUtils").unixTime()}}function c(a,b,c){var e,f=d("WAGlobals").getMyUserJid();c=c==="@me"?f:c;if(c===f)e={adminMsgContent:[d("WAJids").userIdFromJid(b)],adminType:"currentUserPromotedParticipant"};else if(c==null)e=b===f?{adminMsgContent:[],adminType:"currentUserGotPromoted"}:{adminMsgContent:[d("WAJids").userIdFromJid(b)],adminType:"participantGotPromoted"};else{c=d("WAJids").userIdFromJid(c);e=b===f?{adminMsgContent:[c],adminType:"participantPromotedYou"}:{adminMsgContent:[c,d("WAJids").userIdFromJid(b)],adminType:"participantPromotedParticipant"}}return{type:"Admin",ack:d("WAAckLevel").ACK.SENT,msgContent:e,id:{chat:a,author:d("WAJids").AUTHOR_SYSTEM,externalId:d("WAGlobals").getDependencies().generateExternalId()},ts:d("WATimeUtils").unixTime()}}function e(a,b,c){var e,f=d("WAGlobals").getMyUserJid();c=c==="@me"?f:c;if(c===f)e=b===f?{adminType:"currentUserSelfDemoted",adminMsgContent:[]}:{adminMsgContent:[d("WAJids").userIdFromJid(b)],adminType:"currentUserDemotedParticipant"};else if(c==null)e=b===f?{adminMsgContent:[],adminType:"currentUserGotDemoted"}:{adminMsgContent:[d("WAJids").userIdFromJid(b)],adminType:"participantGotDemoted"};else{var g=d("WAJids").userIdFromJid(c);e=b===f?{adminMsgContent:[g],adminType:"participantDemotedYou"}:{adminMsgContent:[g,d("WAJids").userIdFromJid(b)],adminType:c===b?"participantSelfDemoted":"participantDemotedParticipant"}}return{type:"Admin",ack:d("WAAckLevel").ACK.SENT,msgContent:e,id:{chat:a,author:d("WAJids").AUTHOR_SYSTEM,externalId:d("WAGlobals").getDependencies().generateExternalId()},ts:d("WATimeUtils").unixTime()}}function f(a,b,c){var e=[],f=b.subject.content;if(f==null)return;b.subject.user===d("WAGlobals").getMyUserJid()?(b="currentUserNamedGroup",e.push(f)):c==null?(b="unkonwnUserNamedGroup",e.push(f)):(b="participantNamedGroup",e.push(c,f));return{type:"Admin",ack:d("WAAckLevel").ACK.SENT,msgContent:{adminType:b,adminMsgContent:e},id:{chat:a,author:d("WAJids").AUTHOR_SYSTEM,externalId:d("WAGlobals").getDependencies().generateExternalId()},ts:d("WATimeUtils").unixTime()}}function i(a,b,c){var e,f=[];if(c===d("WAGlobals").getMyUserJid())switch(b){case"all_member_add":e="currentUserSetAddModeAllMembers";break;case"admin_add":e="currentUserSetAddModeAdminOnly";break}else if(c!=null){f.push(d("WAJids").userIdFromJid(c));switch(b){case"all_member_add":e="participantSetAddModeAllMembers";break;case"admin_add":e="participantSetAddModeAdminOnly";break}}else switch(b){case"all_member_add":e="serverSetAddModeAllMembers";break;case"admin_add":e="serverSetAddModeAdminOnly";break}if(e==null)return;return{type:"Admin",ack:d("WAAckLevel").ACK.SENT,msgContent:{adminType:e,adminMsgContent:f},id:{chat:a,author:d("WAJids").AUTHOR_SYSTEM,externalId:d("WAGlobals").getDependencies().generateExternalId()},ts:d("WATimeUtils").unixTime()}}g.UNKNOWN_USER=h;g.createParticipantAddAdminMessage=a;g.createParticipantRemoveAdminMsg=b;g.createParticipantPromoteAdminMsg=c;g.createParticipantDemoteAdminMsg=e;g.createGroupNameChangeAdminMsg=f;g.createMemberAddModeChangeAdminMsg=i}),98);
__d("WADevicesState",["Promise","WAErr","WALogger","WAResolvable"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["GetDevices cahce is already initialized"]);i=function(){return a};return a}var j=null;function a(a){if(j!=null){d("WALogger").WARN(i());return}j=new k(a)}function e(){if(j==null)throw c("WAErr")("GetDevices cache is not initialized");return j}var k=function(){function a(a){this.$1=new Map(),this.$2=a}var c=a.prototype;c.waitForUserDevices=function(a,c){var e=this;c===void 0&&(c=!1);var f=new Map(),g=[];a.forEach(function(a){var b=e.$1.get(a);if(b==null){var c=new(d("WAResolvable").Resolvable)();f.set(a,c);e.$1.set(a,c.promise)}else g.push(b)});return(f.size>0?this.$2.fetchAndSaveDevices(new Set(f.keys()),c):(h||(h=b("Promise"))).resolve(new Map())).then(function(a){for(var b=f,c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(c){if(d>=b.length)break;g=b[d++]}else{d=b.next();if(d.done)break;g=d.value}g=g;var h=g[0];g=g[1];var i=a.get(h);(i==null?void 0:i.success)?g.resolve():(g.reject("Failed to fetch devices for user: "+h),e.$1["delete"](h))}})["catch"](function(a){for(var b=f,c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(c){if(d>=b.length)break;g=b[d++]}else{d=b.next();if(d.done)break;g=d.value}g=g;var h=g[0];g=g[1];g.reject(a);e.$1["delete"](h)}}).then(function(){return(h||(h=b("Promise"))).all([].concat(g,Array.from(f.values()).map(function(a){return a.promise}))).then(function(){})})};c.reset=function(a){var c=this;a.forEach(function(a){return c.$1["delete"](a)});return(h||(h=b("Promise"))).resolve()};return a}();g.initDevicesState=a;g.getDevicesState=e}),98);
__d("WAGetDevices",["Promise","WADevicesState","WAJobs","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["fetchAndSaveDevices: ",""]);i=function(){return a};return a}function j(a,c,e){e===void 0&&(e=!1);d("WALogger").LOG(i(),c);return(h||(h=b("Promise"))).resolve().then(function(){if(e)return d("WADevicesState").getDevicesState().reset(Array.from(a))}).then(function(){return d("WADevicesState").getDevicesState().waitForUserDevices(Array.from(a),e)})}a=d("WAJobs").getPersistedJobsApi().definePersistedJob().finalStep("getDevices",function(a){var b=a.users,c=a.reason;a=a.ignoreDhash;return j(b,c,a)}).end();g.fetchAndSaveDevices=j;g.getDevices=a}),98);
__d("MAWCreateGroupInvitesStep",["MAWGlobals","MAWJobDefinitions","WAAddGroupParticipantsApi","WAGetDevices","WAJids","asyncToGeneratorRuntime","isGroupInvitesEnabled"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c,d){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f){f===void 0&&(f=!0);if(!c("isGroupInvitesEnabled")()||e.length===0)return[];var g=e.map(function(a){return a.user}),h=e.map(function(a){return{addressable:!0,type:"invitedParticipant",user:a.user}});yield d("WAGetDevices").fetchAndSaveDevices(new Set(g),"create-group-invite");f||(yield d("WAAddGroupParticipantsApi").addGroupParticipants(null,a,d("WAJids").AUTHOR_ME,h,!0));e.forEach(function(c){var e=c.user,f=c.inviteCode;c=c.expiration;d("MAWGlobals").getJobManager().fireAndForget(d("MAWJobDefinitions").jobSerializers.sendGroupInviteMsg({expiration:c,groupJid:a,inviteCode:f,invitedParticipantUserJid:e,inviterUserJid:b}))});return h});return h.apply(this,arguments)}g.createGroupInvitesStep=a}),98);
__d("WASmaxInGroupsIQErrorBadRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","bad-request");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",400);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorBadRequestMixin=a}),98);
__d("WASmaxInGroupsIQErrorFallbackClientMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"text");if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(a,"code",400,499);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorFallbackClientMixin=a}),98);
__d("WASmaxInGroupsIQErrorForbiddenMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","forbidden");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",403);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorForbiddenMixin=a}),98);
__d("WASmaxInGroupsIQErrorItemNotFoundMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","item-not-found");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",404);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorItemNotFoundMixin=a}),98);
__d("WASmaxInGroupsIQErrorLockedMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","locked");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",423);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorLockedMixin=a}),98);
__d("WASmaxInGroupsIQErrorNotAllowedMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","not-allowed");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",405);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorNotAllowedMixin=a}),98);
__d("WASmaxInGroupsIQErrorNotAuthorizedMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","not-authorized");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",401);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorNotAuthorizedMixin=a}),98);
__d("WASmaxInGroupsIQErrorRateOverlimitMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","rate-overlimit");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",429);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorRateOverlimitMixin=a}),98);
__d("WASmaxInGroupsAddParticipantsClientErrors",["WAResultOrError","WASmaxInGroupsIQErrorBadRequestMixin","WASmaxInGroupsIQErrorFallbackClientMixin","WASmaxInGroupsIQErrorForbiddenMixin","WASmaxInGroupsIQErrorItemNotFoundMixin","WASmaxInGroupsIQErrorLockedMixin","WASmaxInGroupsIQErrorNotAllowedMixin","WASmaxInGroupsIQErrorNotAuthorizedMixin","WASmaxInGroupsIQErrorRateOverlimitMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:b.value});var c=d("WASmaxInGroupsIQErrorItemNotFoundMixin").parseIQErrorItemNotFoundMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IQErrorItemNotFound",value:c.value});var e=d("WASmaxInGroupsIQErrorNotAuthorizedMixin").parseIQErrorNotAuthorizedMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"IQErrorNotAuthorized",value:e.value});var f=d("WASmaxInGroupsIQErrorForbiddenMixin").parseIQErrorForbiddenMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"IQErrorForbidden",value:f.value});var g=d("WASmaxInGroupsIQErrorRateOverlimitMixin").parseIQErrorRateOverlimitMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"IQErrorRateOverlimit",value:g.value});var h=d("WASmaxInGroupsIQErrorNotAllowedMixin").parseIQErrorNotAllowedMixin(a);if(h.success)return d("WAResultOrError").makeResult({name:"IQErrorNotAllowed",value:h.value});var i=d("WASmaxInGroupsIQErrorLockedMixin").parseIQErrorLockedMixin(a);if(i.success)return d("WAResultOrError").makeResult({name:"IQErrorLocked",value:i.value});var j=d("WASmaxInGroupsIQErrorFallbackClientMixin").parseIQErrorFallbackClientMixin(a);return j.success?d("WAResultOrError").makeResult({name:"IQErrorFallbackClient",value:j.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorBadRequest","IQErrorItemNotFound","IQErrorNotAuthorized","IQErrorForbidden","IQErrorRateOverlimit","IQErrorNotAllowed","IQErrorLocked","IQErrorFallbackClient"],[b,c,e,f,g,h,i,j])}g.parseAddParticipantsClientErrors=a}),98);
__d("WASmaxInGroupsIQErrorResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","error");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQErrorResponseMixin=a}),98);
__d("WASmaxInGroupsAddParticipantsResponseClientError",["WAResultOrError","WASmaxInGroupsAddParticipantsClientErrors","WASmaxInGroupsIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInGroupsIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInGroupsAddParticipantsClientErrors").parseAddParticipantsClientErrors(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorAddParticipantsClientErrors:b.value}))}g.parseAddParticipantsResponseClientError=a}),98);
__d("WASmaxInGroupsIQErrorFallbackServerMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"text");if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(a,"code",500,599);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorFallbackServerMixin=a}),98);
__d("WASmaxInGroupsIQErrorInternalServerErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","internal-server-error");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",500);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorInternalServerErrorMixin=a}),98);
__d("WASmaxInGroupsIQErrorPartialServerErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","partial-server-error");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",530);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorPartialServerErrorMixin=a}),98);
__d("WASmaxInGroupsIQErrorServiceUnavailableMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","service-unavailable");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",503);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorServiceUnavailableMixin=a}),98);
__d("WASmaxInGroupsServerErrors",["WAResultOrError","WASmaxInGroupsIQErrorFallbackServerMixin","WASmaxInGroupsIQErrorInternalServerErrorMixin","WASmaxInGroupsIQErrorPartialServerErrorMixin","WASmaxInGroupsIQErrorServiceUnavailableMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorInternalServerError",value:b.value});var c=d("WASmaxInGroupsIQErrorServiceUnavailableMixin").parseIQErrorServiceUnavailableMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IQErrorServiceUnavailable",value:c.value});var e=d("WASmaxInGroupsIQErrorPartialServerErrorMixin").parseIQErrorPartialServerErrorMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"IQErrorPartialServerError",value:e.value});var f=d("WASmaxInGroupsIQErrorFallbackServerMixin").parseIQErrorFallbackServerMixin(a);return f.success?d("WAResultOrError").makeResult({name:"IQErrorFallbackServer",value:f.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorInternalServerError","IQErrorServiceUnavailable","IQErrorPartialServerError","IQErrorFallbackServer"],[b,c,e,f])}g.parseServerErrors=a}),98);
__d("WASmaxInGroupsBaseServerErrorMixin",["WAResultOrError","WASmaxInGroupsIQErrorResponseMixin","WASmaxInGroupsServerErrors","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInGroupsIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInGroupsServerErrors").parseServerErrors(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorServerErrors:b.value}))}g.parseBaseServerErrorMixin=a}),98);
__d("WASmaxInGroupsAddParticipantsResponseServerError",["WASmaxInGroupsBaseServerErrorMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxInGroupsBaseServerErrorMixin").parseBaseServerErrorMixin(a,b);return!c.success?c:c}g.parseAddParticipantsResponseServerError=a}),98);
__d("WASmaxInGroupsParticipantConflictMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"error","409");return!b.success?b:d("WAResultOrError").makeResult({error:b.value})}g.parseParticipantConflictMixin=a}),98);
__d("WASmaxInGroupsEnums",["WAJids"],(function(a,b,c,d,e,f,g){a={304:"304",419:"419"};b={403:"403",404:"404",406:"406",419:"419"};c={404:"404",406:"406"};e={404:"404",419:"419"};f={406:"406",500:"500"};var h={accept:"accept",auto_add:"auto_add",default_sub_group_admin_add:"default_sub_group_admin_add",general_chat_auto_add:"general_chat_auto_add",invite:"invite",invite_auto_add:"invite_auto_add",linked_group_join:"linked_group_join",sub_group_suggestion_approved:"sub_group_suggestion_approved"},i={accept:"accept",default_sub_group_promote:"default_sub_group_promote",invite:"invite",invite_auto_add:"invite_auto_add",linked_group_join:"linked_group_join"},j={account_setting:"account_setting",bulk_change:"bulk_change",chat_setting:"chat_setting"},k={admin:"admin",creator:"creator"},l={admin:"admin",superadmin:"superadmin"},m={approved:"approved",cancelled:"cancelled",rejected:"rejected"},n={delete_parent:"delete_parent",integrity_delete_parent:"integrity_delete_parent"},o={delete_parent:"delete_parent",integrity_delete_parent:"integrity_delete_parent",unlink_group:"unlink_group"},p={e2ee_migration:"e2ee_migration",regular:"regular",rtc:"rtc"},q={"false":"false","true":"true"},r={image:"image",preview:"preview"},s={invite_link:"invite_link",linked_group_join:"linked_group_join",non_admin_add:"non_admin_add"},t={lid:"lid",pn:"pn"},u={parent_group:"parent_group",sibling_group:"sibling_group",sub_group:"sub_group"};d={validators:[d("WAJids").validateDomainJid,d("WAJids").validateGroupJid],typeName:"DomainJid|GroupJid"};g.ENUM_304_419=a;g.ENUM_403_404_406_419=b;g.ENUM_404_406=c;g.ENUM_404_419=e;g.ENUM_406_500=f;g.ENUM_ACCEPT_AUTOADD_DEFAULTSUBGROUPADMINADD_GENERALCHATAUTOADD_INVITE_INVITEAUTOADD_LINKEDGROUPJOIN_SUBGROUPSUGGESTIONAPPROVED=h;g.ENUM_ACCEPT_DEFAULTSUBGROUPPROMOTE_INVITE_INVITEAUTOADD_LINKEDGROUPJOIN=i;g.ENUM_ACCOUNTSETTING_BULKCHANGE_CHATSETTING=j;g.ENUM_ADMIN_CREATOR=k;g.ENUM_ADMIN_SUPERADMIN=l;g.ENUM_APPROVED_CANCELLED_REJECTED=m;g.ENUM_DELETEPARENT_INTEGRITYDELETEPARENT=n;g.ENUM_DELETEPARENT_INTEGRITYDELETEPARENT_UNLINKGROUP=o;g.ENUM_E2EEMIGRATION_REGULAR_RTC=p;g.ENUM_FALSE_TRUE=q;g.ENUM_IMAGE_PREVIEW=r;g.ENUM_INVITELINK_LINKEDGROUPJOIN_NONADMINADD=s;g.ENUM_LID_PN=t;g.ENUM_PARENTGROUP_SIBLINGGROUP_SUBGROUP=u;g.DOMAINJID_GROUPJID=d}),98);
__d("WASmaxInGroupsParticipantGroupJoinRequestMixin",["WAResultOrError","WASmaxInGroupsEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"membership_approval_request");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"error","421");if(!a.success)return a;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,b.value,"error",d("WASmaxInGroupsEnums").ENUM_304_419);return!b.success?b:d("WAResultOrError").makeResult({error:a.value,membershipApprovalRequestError:b.value})}g.parseParticipantGroupJoinRequestMixin=a}),98);
__d("WASmaxInGroupsParticipantHasInvalidPNMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"error","404");return!b.success?b:d("WAResultOrError").makeResult({error:b.value})}g.parseParticipantHasInvalidPNMixin=a}),98);
__d("WASmaxInGroupsParticipantInBanListMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"error","402");return!b.success?b:d("WAResultOrError").makeResult({error:b.value})}g.parseParticipantInBanListMixin=a}),98);
__d("WASmaxInGroupsParticipantNotAcceptableMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"error","406");return!b.success?b:d("WAResultOrError").makeResult({error:b.value})}g.parseParticipantNotAcceptableMixin=a}),98);
__d("WASmaxInGroupsParticipantNotAddressableMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"addressable","false");return!b.success?b:d("WAResultOrError").makeResult({addressable:b.value})}g.parseParticipantNotAddressableMixin=a}),98);
__d("WASmaxInGroupsParticipantNotAuthorizedMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"error","401");return!b.success?b:d("WAResultOrError").makeResult({error:b.value})}g.parseParticipantNotAuthorizedMixin=a}),98);
__d("WASmaxInGroupsParticipantRequestCodeCanBeSentMixin",["WAResultOrError","WASmaxInGroupsParticipantNotAddressableMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"add_request");if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"error","403");if(!c.success)return c;var e=d("WASmaxParseUtils").attrString(b.value,"code");if(!e.success)return e;b=d("WASmaxParseUtils").attrIntRange(b.value,"expiration",0,void 0);if(!b.success)return b;a=d("WASmaxInGroupsParticipantNotAddressableMixin").parseParticipantNotAddressableMixin(a);return d("WAResultOrError").makeResult({error:c.value,addRequestCode:e.value,addRequestExpiration:b.value,participantNotAddressableMixin:a.success?a.value:null})}g.parseParticipantRequestCodeCanBeSentMixin=a}),98);
__d("WASmaxInGroupsParticipantRequestCodeCannotBeCreatedForLegalConcernsMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"error","451");return!b.success?b:d("WAResultOrError").makeResult({error:b.value})}g.parseParticipantRequestCodeCannotBeCreatedForLegalConcernsMixin=a}),98);
__d("WASmaxInGroupsParticipantResourceConstraintMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"error","500");return!b.success?b:d("WAResultOrError").makeResult({error:b.value})}g.parseParticipantResourceConstraintMixin=a}),98);
__d("WASmaxInGroupsParticipantResourceLimitMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"error","419");return!b.success?b:d("WAResultOrError").makeResult({error:b.value})}g.parseParticipantResourceLimitMixin=a}),98);
__d("WASmaxInGroupsParticipantTemporarilyBlockedFromDefaultSubGroupMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"error","417");return!b.success?b:d("WAResultOrError").makeResult({error:b.value})}g.parseParticipantTemporarilyBlockedFromDefaultSubGroupMixin=a}),98);
__d("WASmaxInGroupsParticipantTemporarilyBlockedMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"error","408");return!b.success?b:d("WAResultOrError").makeResult({error:b.value})}g.parseParticipantTemporarilyBlockedMixin=a}),98);
__d("WASmaxInGroupsAddParticipantsParticipantMixins",["WAResultOrError","WASmaxInGroupsParticipantConflictMixin","WASmaxInGroupsParticipantGroupJoinRequestMixin","WASmaxInGroupsParticipantHasInvalidPNMixin","WASmaxInGroupsParticipantInBanListMixin","WASmaxInGroupsParticipantNotAcceptableMixin","WASmaxInGroupsParticipantNotAddressableMixin","WASmaxInGroupsParticipantNotAuthorizedMixin","WASmaxInGroupsParticipantRequestCodeCanBeSentMixin","WASmaxInGroupsParticipantRequestCodeCannotBeCreatedForLegalConcernsMixin","WASmaxInGroupsParticipantResourceConstraintMixin","WASmaxInGroupsParticipantResourceLimitMixin","WASmaxInGroupsParticipantTemporarilyBlockedFromDefaultSubGroupMixin","WASmaxInGroupsParticipantTemporarilyBlockedMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsParticipantGroupJoinRequestMixin").parseParticipantGroupJoinRequestMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"ParticipantGroupJoinRequest",value:b.value});var c=d("WASmaxInGroupsParticipantNotAuthorizedMixin").parseParticipantNotAuthorizedMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"ParticipantNotAuthorized",value:c.value});var e=d("WASmaxInGroupsParticipantInBanListMixin").parseParticipantInBanListMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"ParticipantInBanList",value:e.value});var f=d("WASmaxInGroupsParticipantRequestCodeCanBeSentMixin").parseParticipantRequestCodeCanBeSentMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"ParticipantRequestCodeCanBeSent",value:f.value});var g=d("WASmaxInGroupsParticipantRequestCodeCannotBeCreatedForLegalConcernsMixin").parseParticipantRequestCodeCannotBeCreatedForLegalConcernsMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"ParticipantRequestCodeCannotBeCreatedForLegalConcerns",value:g.value});var h=d("WASmaxInGroupsParticipantHasInvalidPNMixin").parseParticipantHasInvalidPNMixin(a);if(h.success)return d("WAResultOrError").makeResult({name:"ParticipantHasInvalidPN",value:h.value});var i=d("WASmaxInGroupsParticipantTemporarilyBlockedMixin").parseParticipantTemporarilyBlockedMixin(a);if(i.success)return d("WAResultOrError").makeResult({name:"ParticipantTemporarilyBlocked",value:i.value});var j=d("WASmaxInGroupsParticipantConflictMixin").parseParticipantConflictMixin(a);if(j.success)return d("WAResultOrError").makeResult({name:"ParticipantConflict",value:j.value});var k=d("WASmaxInGroupsParticipantResourceLimitMixin").parseParticipantResourceLimitMixin(a);if(k.success)return d("WAResultOrError").makeResult({name:"ParticipantResourceLimit",value:k.value});var l=d("WASmaxInGroupsParticipantResourceConstraintMixin").parseParticipantResourceConstraintMixin(a);if(l.success)return d("WAResultOrError").makeResult({name:"ParticipantResourceConstraint",value:l.value});var m=d("WASmaxInGroupsParticipantNotAcceptableMixin").parseParticipantNotAcceptableMixin(a);if(m.success)return d("WAResultOrError").makeResult({name:"ParticipantNotAcceptable",value:m.value});var n=d("WASmaxInGroupsParticipantNotAddressableMixin").parseParticipantNotAddressableMixin(a);if(n.success)return d("WAResultOrError").makeResult({name:"ParticipantNotAddressable",value:n.value});var o=d("WASmaxInGroupsParticipantTemporarilyBlockedFromDefaultSubGroupMixin").parseParticipantTemporarilyBlockedFromDefaultSubGroupMixin(a);return o.success?d("WAResultOrError").makeResult({name:"ParticipantTemporarilyBlockedFromDefaultSubGroup",value:o.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["ParticipantGroupJoinRequest","ParticipantNotAuthorized","ParticipantInBanList","ParticipantRequestCodeCanBeSent","ParticipantRequestCodeCannotBeCreatedForLegalConcerns","ParticipantHasInvalidPN","ParticipantTemporarilyBlocked","ParticipantConflict","ParticipantResourceLimit","ParticipantResourceConstraint","ParticipantNotAcceptable","ParticipantNotAddressable","ParticipantTemporarilyBlockedFromDefaultSubGroup"],[b,c,e,f,g,h,i,j,k,l,m,n,o])}g.parseAddParticipantsParticipantMixins=a}),98);
__d("WASmaxInGroupsPhoneNumberMixin",["WAResultOrError","WASmaxParseJid"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseJid").attrUserJid(a,"phone_number");return!a.success?a:d("WAResultOrError").makeResult({phoneNumber:a.value})}g.parsePhoneNumberMixin=a}),98);
__d("WASmaxInGroupsAddParticipantsParticipantAddedResponseMixin",["WAResultOrError","WASmaxInGroupsAddParticipantsParticipantMixins","WASmaxInGroupsPhoneNumberMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"jid");if(!b.success)return b;var c=d("WASmaxInGroupsPhoneNumberMixin").parsePhoneNumberMixin(a);a=d("WASmaxInGroupsAddParticipantsParticipantMixins").parseAddParticipantsParticipantMixins(a);return d("WAResultOrError").makeResult({jid:b.value,phoneNumberMixin:c.success?c.value:null,addParticipantsParticipantMixins:a.success?a.value:null})}g.parseAddParticipantsParticipantAddedResponseMixin=a}),98);
__d("WASmaxInGroupsParticipantRequestCodeCanBeSentOrRequestCodeCannotBeCreatedForLegalConcernsOrHasInvalidPNMixinGroup",["WAResultOrError","WASmaxInGroupsParticipantHasInvalidPNMixin","WASmaxInGroupsParticipantRequestCodeCanBeSentMixin","WASmaxInGroupsParticipantRequestCodeCannotBeCreatedForLegalConcernsMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsParticipantRequestCodeCanBeSentMixin").parseParticipantRequestCodeCanBeSentMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"ParticipantRequestCodeCanBeSent",value:b.value});var c=d("WASmaxInGroupsParticipantRequestCodeCannotBeCreatedForLegalConcernsMixin").parseParticipantRequestCodeCannotBeCreatedForLegalConcernsMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"ParticipantRequestCodeCannotBeCreatedForLegalConcerns",value:c.value});var e=d("WASmaxInGroupsParticipantHasInvalidPNMixin").parseParticipantHasInvalidPNMixin(a);return e.success?d("WAResultOrError").makeResult({name:"ParticipantHasInvalidPN",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["ParticipantRequestCodeCanBeSent","ParticipantRequestCodeCannotBeCreatedForLegalConcerns","ParticipantHasInvalidPN"],[b,c,e])}g.parseParticipantRequestCodeCanBeSentOrRequestCodeCannotBeCreatedForLegalConcernsOrHasInvalidPNMixinGroup=a}),98);
__d("WASmaxInGroupsNonRegisteredWaUserParticipantErrorLidResponseMixin",["WAResultOrError","WASmaxInGroupsParticipantRequestCodeCanBeSentOrRequestCodeCannotBeCreatedForLegalConcernsOrHasInvalidPNMixinGroup","WASmaxInGroupsPhoneNumberMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxInGroupsPhoneNumberMixin").parsePhoneNumberMixin(a);if(!b.success)return b;a=d("WASmaxInGroupsParticipantRequestCodeCanBeSentOrRequestCodeCannotBeCreatedForLegalConcernsOrHasInvalidPNMixinGroup").parseParticipantRequestCodeCanBeSentOrRequestCodeCannotBeCreatedForLegalConcernsOrHasInvalidPNMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{participantRequestCodeCanBeSentOrRequestCodeCannotBeCreatedForLegalConcernsOrHasInvalidPNMixinGroup:a.value}))}g.parseNonRegisteredWaUserParticipantErrorLidResponseMixin=a}),98);
__d("WASmaxInGroupsAddParticipantsParticipantAddedOrNonRegisteredWaUserParticipantErrorLidResponseMixinGroup",["WAResultOrError","WASmaxInGroupsAddParticipantsParticipantAddedResponseMixin","WASmaxInGroupsNonRegisteredWaUserParticipantErrorLidResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsAddParticipantsParticipantAddedResponseMixin").parseAddParticipantsParticipantAddedResponseMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"AddParticipantsParticipantAddedResponse",value:b.value});var c=d("WASmaxInGroupsNonRegisteredWaUserParticipantErrorLidResponseMixin").parseNonRegisteredWaUserParticipantErrorLidResponseMixin(a);return c.success?d("WAResultOrError").makeResult({name:"NonRegisteredWaUserParticipantErrorLidResponse",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["ParticipantAddedResponse","NonRegisteredWaUserParticipantErrorLidResponse"],[b,c])}g.parseAddParticipantsParticipantAddedOrNonRegisteredWaUserParticipantErrorLidResponseMixinGroup=a}),98);
__d("WASmaxInGroupsGroupAddressingModeMixin",["WAResultOrError","WASmaxInGroupsEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrStringEnum(a,"addressing_mode",d("WASmaxInGroupsEnums").ENUM_LID_PN);return!a.success?a:d("WAResultOrError").makeResult({addressingMode:a.value})}g.parseGroupAddressingModeMixin=a}),98);
__d("WASmaxInGroupsAddParticipantsResponseSuccess",["WAResultOrError","WASmaxInGroupsAddParticipantsParticipantAddedOrNonRegisteredWaUserParticipantErrorLidResponseMixinGroup","WASmaxInGroupsGroupAddressingModeMixin","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxInGroupsAddParticipantsParticipantAddedOrNonRegisteredWaUserParticipantErrorLidResponseMixinGroup").parseAddParticipantsParticipantAddedOrNonRegisteredWaUserParticipantErrorLidResponseMixinGroup(a);return!b.success?b:d("WAResultOrError").makeResult({addParticipantsParticipantAddedOrNonRegisteredWaUserParticipantErrorLidResponseMixinGroup:b.value})}function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"add");if(!c.success)return c;var e=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!e.success)return e;e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",e.value);if(!e.success)return e;e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");if(!e.success)return e;b=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",b.value);if(!b.success)return b;b=d("WASmaxInGroupsGroupAddressingModeMixin").parseGroupAddressingModeMixin(a);a=d("WASmaxParseUtils").mapChildrenWithTag(c.value,"participant",1,19999,h);return!a.success?a:d("WAResultOrError").makeResult({type:e.value,groupAddressingModeMixin:b.success?b.value:null,addParticipant:a.value})}g.parseAddParticipantsResponseSuccessAddParticipant=h;g.parseAddParticipantsResponseSuccess=a}),98);
__d("WASmaxChildren",["WADeepEquals"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){if(b==null)return null;else return a(b)}function b(a,b){if(b==null)return null;else if(b)return a()}function c(a,b){if(b)for(var c=1;c<b.length;c++)if(!d("WADeepEquals").deepEqual(b[c],b[0]))throw new Error("expected all homogeneous children to be equal, but they were not");c=h(a,b,0,Infinity);return c}function e(a,b){return i(a,b,0,Infinity)}function h(a,b,c,d){if(b==null){if(c>0)throw new Error("expected at least "+c+" children, but none provided");return[]}var e=b.length;if(e<c)throw new Error("expected at least "+c+" children, but found "+e);else if(e>d)throw new Error("expected at most "+d+" children, but found "+e);return b.map(function(b){return a(b)})}function i(a,b,c,d){if(b===0){if(c>0)throw new Error("expected at least "+c+" children, but none provided");return[]}if(b<c)throw new Error("expected at least "+c+" children, but found "+b);else if(b>d)throw new Error("expected at most "+d+" children, but found "+b);c=[];for(d=0;d<b;d++)c.push(a());return c}g.OPTIONAL_CHILD=a;g.HAS_OPTIONAL_CHILD=b;g.HOMOGENEOUS_CHILD=c;g.HOMOGENEOUS_CHILD_COUNT=e;g.REPEATED_CHILD=h;g.REPEATED_CHILD_COUNT=i}),98);
__d("WASmaxOutGroupsBaseIQSetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("iq",{id:d("WAWap").generateId(),type:"set"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBaseIQSetRequestMixin=a}),98);
__d("WASmaxOutGroupsBaseSetGroupMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutGroupsBaseIQSetRequestMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.iqTo;a=d("WASmaxOutGroupsBaseIQSetRequestMixin").mergeBaseIQSetRequestMixin(d("WASmaxJsx").smax("iq",{to:d("WAWap").GROUP_JID(a),xmlns:"w:g2"}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBaseSetGroupMixin=a}),98);
__d("WASmaxOutGroupsPhoneNumberMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.anyPhoneNumber;a=d("WASmaxJsx").smax("smax$any",{phone_number:d("WAWap").USER_JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergePhoneNumberMixin=a}),98);
__d("WASmaxOutGroupsAddParticipantsRequest",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutGroupsBaseSetGroupMixin","WASmaxOutGroupsPhoneNumberMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.participantJid;a=a.phoneNumberMixinArgs;b=d("WASmaxMixins").optionalMerge(d("WASmaxOutGroupsPhoneNumberMixin").mergePhoneNumberMixin,d("WASmaxJsx").smax("participant",{jid:d("WAWap").USER_JID(b)}),a);return b}function a(a){var b=a.participantArgs;b=d("WASmaxOutGroupsBaseSetGroupMixin").mergeBaseSetGroupMixin(d("WASmaxJsx").smax("iq",null,d("WASmaxJsx").smax("add",null,d("WASmaxChildren").REPEATED_CHILD(h,b,1,1024))),a);return b}g.makeAddParticipantsRequestAddParticipant=h;g.makeAddParticipantsRequest=a}),98);
__d("WASmaxParsingFailure",[],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var c;c=a.call(this,"SmaxParsingFailure: "+b)||this;c.name="SmaxParsingFailure";c.reason=b;return c}var c=b.prototype;c.toString=function(){return"SmaxParsingFailure: "+this.reason};return b}(babelHelpers.wrapNativeSuper(Error));f.SmaxParsingFailure=a}),66);
__d("WASmaxRpcUtils",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){var c=Object.keys(b).map(function(a){var c=a==="Request"?"<request>":'<response name="'+a+'">';return"Tried "+c+", but failed with "+b[a].error+"."}).join(" ");return'Failed to parse incoming stanza of <rpc name="'+a+'">. '+c}f.errorMessageRpcParsing=a}),66);
__d("WASmaxGroupsAddParticipantsRPC",["WAComms","WASmaxInGroupsAddParticipantsResponseClientError","WASmaxInGroupsAddParticipantsResponseServerError","WASmaxInGroupsAddParticipantsResponseSuccess","WASmaxOutGroupsAddParticipantsRequest","WASmaxParsingFailure","WASmaxRpcUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:e=d("WASmaxOutGroupsAddParticipantsRequest").makeAddParticipantsRequest(a);j.next=3;return b("regeneratorRuntime").awrap(d("WAComms").sendSmaxStanza(e,c));case 3:f=j.sent;g=d("WASmaxInGroupsAddParticipantsResponseSuccess").parseAddParticipantsResponseSuccess(f,e);if(!g.success){j.next=7;break}return j.abrupt("return",{name:"AddParticipantsResponseSuccess",value:g.value});case 7:h=d("WASmaxInGroupsAddParticipantsResponseClientError").parseAddParticipantsResponseClientError(f,e);if(!h.success){j.next=10;break}return j.abrupt("return",{name:"AddParticipantsResponseClientError",value:h.value});case 10:i=d("WASmaxInGroupsAddParticipantsResponseServerError").parseAddParticipantsResponseServerError(f,e);if(!i.success){j.next=13;break}return j.abrupt("return",{name:"AddParticipantsResponseServerError",value:i.value});case 13:throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("AddParticipants",{Success:g,ClientError:h,ServerError:i}));case 14:case"end":return j.stop()}},null,this)}g.sendAddParticipantsRPC=a}),98);
__d("MAWAddGroupParticipants",["MAWCreateGroupInvitesStep","MAWGlobals","MAWODSProxy","WAAddGroupParticipantsApi","WAGlobals","WAGroupInviteUtils","WAJids","WALogger","WAOdsEnums","WAResultOrError","WASmaxGroupsAddParticipantsRPC","WATimeUtils","asyncToGeneratorRuntime","nullthrows"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to add participant: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to add participant: ",""]);i=function(){return a};return a}a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("addGroupParticipants",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.group;a=a.users;var e=d("WAGlobals").getJidUtilsApi(),f=e.toUserJid;e=a.map(function(a){return f(a)});if(e.length===0)return d("WAResultOrError").makeResult({groupJid:b,participants:[]});a=(yield d("WASmaxGroupsAddParticipantsRPC").sendAddParticipantsRPC({iqTo:b,participantArgs:e.map(function(a){return{participantJid:a}})}));d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.GROUP_ADD_PARTICIPANT,key:a.name==="AddParticipantsResponseSuccess"?"success":"fail"});if(a.name==="AddParticipantsResponseClientError"){e=a.value.errorAddParticipantsClientErrors.name;d("WALogger").ERROR(i(),e);return d("WAResultOrError").makeError(e)}if(a.name==="AddParticipantsResponseServerError"){e=a.value.errorServerErrors.name;d("WALogger").ERROR(h(),e);return d("WAResultOrError").makeError(e)}a.name;e=a.value.addParticipant.filter(function(a){a=a.addParticipantsParticipantAddedOrNonRegisteredWaUserParticipantErrorLidResponseMixinGroup;a=a.value.addParticipantsParticipantMixins;return(a==null?void 0:a.value.error)==null}).map(function(a){a=a.addParticipantsParticipantAddedOrNonRegisteredWaUserParticipantErrorLidResponseMixinGroup;a=a.value;var b=a.addParticipantsParticipantMixins;a=a.jid;a=c("nullthrows")(a);return{addressable:(b==null?void 0:b.name)!=="ParticipantNotAddressable",type:"participant",user:a}});yield d("WAAddGroupParticipantsApi").addGroupParticipants(null,b,d("WAJids").AUTHOR_ME,e,!0);a=(yield d("MAWCreateGroupInvitesStep").createGroupInvitesStep(b,d("WAGlobals").getMyUserJid(),a.value.addParticipant.map(function(a){a=a.addParticipantsParticipantAddedOrNonRegisteredWaUserParticipantErrorLidResponseMixinGroup;a=a.value;var b=a.addParticipantsParticipantMixins;a=a.jid;a=c("nullthrows")(a);return(b==null?void 0:b.name)==="ParticipantRequestCodeCanBeSent"?{expiration:d("WATimeUtils").castToUnixTime(b.value.addRequestExpiration),inviteCode:d("WAGroupInviteUtils").toInviteCode(b.value.addRequestCode),user:a}:void 0}).filter(Boolean),!1));e=[].concat(e,a);a=(yield d("MAWGlobals").getJobResultConvertersImpls().convertAddGroupParticipantsResult==null?void 0:d("MAWGlobals").getJobResultConvertersImpls().convertAddGroupParticipantsResult(b,e));return a?d("WAResultOrError").makeResult(a):d("WAResultOrError").makeResult({groupJid:b,participants:e})});return function(b){return a.apply(this,arguments)}}()).end();g.addGroupParticipants=a}),98);
__d("MAWAddQPLPointForHandleIncomingMsgApi",["MAWDexieTable","gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){if(!c("gkx")("23963"))return;var e=d("MAWDexieTable").getDexiePSDItem("transactorQPLEvent"),f=d("MAWDexieTable").getDexiePSDItem("offlineQueueSize");f===1&&(e==null?void 0:e.addPoint(a,b))}g.addQPLPointForHIMApi=a}),98);
__d("MAWDbParticipant",["MAWDbChatId","WAJids"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return a+"_"+b}function b(a){a=a.split("_");var b=d("MAWDbChatId").unsafeCoerceToChatId(parseInt(a[0],10));a=d("WAJids").unsafeCoerceToUserJid(a[1]);return{threadId:b,userJid:a}}g.craftParticipantId=a;g.getThreadIdAndUserJidFromParticipantId=b}),98);
__d("MAWBridgeTypesCreators",["I64","MAWDbMsg","MAWDbParticipant","MAWGlobals","MAWImageUtils","MAWMsgType","WAAssertUnreachable","WAJids","WAMediaUtils","WATimeUtils","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){return{threadId:b,threadJid:a}}function i(a){var b,c=a.ts;switch(a.type){case d("MAWMsgType").MSG_TYPE.REVOKED:c=(b=a.originalTs)!=null?b:a.ts;break;default:c=d("MAWDbMsg").getCanonicalTsFromMsg(a)}return{msgId:a.msgId,threadId:a.thread,ts:c}}function b(a,b,c){c=c.map(i);return{messages:c,threadId:a,threadJid:b}}function e(a){return{ravenMsgId:a.msgId,threadId:a.thread,threadJid:a.threadJid}}function f(a,b,e,f,g,h,i){var j,k=e.msgIds.filter(function(b){return d("MAWDbMsg").getThreadIdFromMsgId(b)===a});switch(e.mediaType){case"Image":return{duration:null,ephemeralMediaState:h==null?void 0:h.ephemeralMediaState,ephemeralMediaViewMode:h==null?void 0:h.ephemeralMediaViewMode,filesize:e.size,hasMedia:f,mediaId:e.mediaId,mediaType:e.mediaType,msgIds:k,offlineAttachmentId:i,previewHeight:(j=e.validatedImageInfo)==null?void 0:j.jpegThumbnailHeight,previewHeightLarge:(j=e.validatedImageInfo)==null?void 0:j.height,previewWidth:(j=e.validatedImageInfo)==null?void 0:j.jpegThumbnailWidth,previewWidthLarge:(j=e.validatedImageInfo)==null?void 0:j.width,threadId:a,threadJid:b,ts:d("WATimeUtils").castToUnixTime(g!=null?g/1e3:e.ts)};case"Video":return{duration:((j=e.validatedVideoInfo)==null?void 0:j.duration)!=null?((j=e.validatedVideoInfo)==null?void 0:j.duration)*1e3:0,ephemeralMediaState:h==null?void 0:h.ephemeralMediaState,ephemeralMediaViewMode:h==null?void 0:h.ephemeralMediaViewMode,filesize:e.size,hasMedia:f,mediaId:e.mediaId,mediaType:e.mediaType,msgIds:k,offlineAttachmentId:i,previewHeight:(j=e.validatedVideoInfo)==null?void 0:j.jpegThumbnailHeight,previewHeightLarge:(h=e.validatedVideoInfo)==null?void 0:h.height,previewWidth:(j=e.validatedVideoInfo)==null?void 0:j.jpegThumbnailWidth,previewWidthLarge:(h=e.validatedVideoInfo)==null?void 0:h.width,threadId:a,threadJid:b,ts:d("WATimeUtils").castToUnixTime(g!=null?g/1e3:e.ts)};case"Ptt":return{duration:((j=e.validatedAudioInfo)==null?void 0:j.duration)?e.validatedAudioInfo.duration*1e3:null,filesize:e.size,hasMedia:f,mediaId:e.mediaId,mediaType:e.mediaType,msgIds:k,offlineAttachmentId:i,previewHeight:null,previewHeightLarge:null,previewWidth:null,previewWidthLarge:null,threadId:a,threadJid:b,ts:d("WATimeUtils").castToUnixTime(g!=null?g/1e3:e.ts)};case"Gif":return{duration:null,filesize:e.size,hasMedia:f,mediaId:e.mediaId,mediaType:e.mediaType,msgIds:e.msgIds,offlineAttachmentId:i,previewHeight:(h=e.validatedImageInfo)==null?void 0:h.jpegThumbnailHeight,previewHeightLarge:(j=e.validatedImageInfo)==null?void 0:j.height,previewWidth:(h=e.validatedImageInfo)==null?void 0:h.jpegThumbnailWidth,previewWidthLarge:(j=e.validatedImageInfo)==null?void 0:j.width,threadId:a,threadJid:b,ts:d("WATimeUtils").castToUnixTime(g!=null?g/1e3:e.ts)};case"Sticker":h=d("MAWImageUtils").boundHeightWidth((h=e.validatedImageInfo)==null?void 0:h.jpegThumbnailHeight,(j=e.validatedImageInfo)==null?void 0:j.jpegThumbnailWidth,128);j=h.height;h=h.width;return{duration:null,filesize:e.size,hasMedia:f,mediaId:e.mediaId,mediaType:e.mediaType,msgIds:e.msgIds,offlineAttachmentId:i,previewHeight:j,previewHeightLarge:j,previewWidth:h,previewWidthLarge:h,threadId:a,threadJid:b,ts:d("WATimeUtils").castToUnixTime(g!=null?g/1e3:e.ts)};case"DocumentFile":j={};for(var h=e.mediaEntries,l=Array.isArray(h),m=0,h=l?h:h[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var n;if(l){if(m>=h.length)break;n=h[m++]}else{m=h.next();if(m.done)break;n=m.value}n=n;var o=n[0];n=n[1];n=d("WAMediaUtils").mediaEntryDataToRawData(e.plaintextHash,n);n=n.filename;n!=null&&(j[o]=n)}return{defaultFilename:(o=e.validatedDocumentFileInfo)==null?void 0:o.filename,duration:null,filenames:j,filesize:e.size,hasMedia:f,mediaId:e.mediaId,mediaType:e.mediaType,msgIds:k,offlineAttachmentId:i,previewHeight:null,previewHeightLarge:null,previewWidth:null,previewWidthLarge:null,threadId:a,threadJid:b,ts:d("WATimeUtils").castToUnixTime(g!=null?g/1e3:e.ts)};default:return c("WAAssertUnreachable")(e.mediaType)}}function j(a,b,c,e,f,g){return{chatJid:b,deliveredWatermarkTs:(b=e)!=null?b:d("WATimeUtils").castToUnixTime(0),fbid:c,lastReadActionTs:(e=g)!=null?e:d("WATimeUtils").castToUnixTime(0),lastReadWatermarkTs:(b=f)!=null?b:d("WATimeUtils").castToUnixTime(0),threadId:a}}function k(a){var b=a.cannotReplyReason,c=a.folder,d=a.fromCheckIfParticipant,e=a.muteExpireTimeMs,f=a.snippetParams,g=a.snippetSenderContactId,h=a.snippetType,i=a.threadId;a=a.threadJid;return{cannotReplyReason:b,folder:c,fromCheckIfParticipant:d,muteExpireTimeMs:e,snippetContactIDs:f==null?void 0:f.contactIDs,snippetMentionJIDs:f==null?void 0:f.mentionJIDs,snippetParams:f==null?void 0:f.strings,snippetSenderContactId:g,snippetType:h,threadId:i,threadJid:a}}function l(a){return{chatJid:a.groupJid,memberAddMode:a.memberAddMode,threadId:a.threadId,threadName:a.name}}function m(a,b,c,e,f,g,i,j,k){return{description:j,lastActivityTs:c,lastMsgExternalId:k!==void 0?(h||(h=d("I64"))).of_string_opt(k):void 0,lastReadTs:(j=e)!=null?j:d("WATimeUtils").castToMillisTime(0),snippetContactIDs:g.contactIDs,snippetMentionJIDs:(c=g.mentionJIDs)!=null?c:[],snippetParams:g.strings,snippetSenderContactId:i,snippetType:f,threadId:a,threadJid:b}}function n(a,b,c,d,e,f,g,h,i){return{bumpTimestampMs:c,description:g,isCurrentDeviceSendingMsg:h,skipServerThreadBump:(c=i)!=null?c:!1,snippetContactIDs:e.contactIDs,snippetMentionJIDs:(g=e.mentionJIDs)!=null?g:[],snippetParams:e.strings,snippetSenderContactId:f,snippetType:d,threadId:a,threadJid:b}}function o(a){return c("gkx")("239")?0:d("MAWDbMsg").getOriginalTsFromMsg(a)*1e3}function p(a,b,d,e,f,g,h){h===void 0&&(h="before");d=d;if(d.length===0)return{chatJid:b,rangeExtensionType:null,threadId:a};if(e)return{chatJid:b,rangeExtensionType:{hasMoreBefore:f,maxMsgId:d[0].msgId,minMsgId:d[d.length-1].msgId,minMsgTs:o(d[d.length-1]),rangeKind:"initial"},threadId:a};return c("gkx")("23927")?{chatJid:b,rangeExtensionType:{hasMoreAfter:g,hasMoreBefore:f,maxMsgId:d[0].msgId,maxMsgTs:o(d[0]),minMsgId:d[d.length-1].msgId,minMsgTs:o(d[d.length-1]),rangeKind:h==="before"?"before":"after"},threadId:a}:{chatJid:b,rangeExtensionType:{hasMoreBefore:f,minMsgId:d[d.length-1].msgId,minMsgTs:o(d[d.length-1]),rangeKind:"extensionBefore"},threadId:a}}function q(a,b,c,d,e,f){c=c;return{offsetMsgId:f,rangeExtensionType:c.length===0?null:{hasMoreAfter:e,hasMoreBefore:d,maxMsgId:c[c.length-1].msgId,maxMsgTs:o(c[c.length-1]),minMsgId:c[0].msgId,minMsgTs:o(c[0]),rangeKind:"extension"},threadId:a,threadJid:b}}function r(a){var b=d("WAJids").extractDeviceIDParts(d("MAWGlobals").getMyDeviceJid()).userId,c=a.author,e=a.chatId,f=a.chatJid,g=a.reaction,h=a.reactToMsgId;a=a.ts;return{actorId:d("WAJids").authorToUserId(c,b),chatJid:f,messageId:h,reaction:g,threadId:e,ts:a}}function s(a){return{hasMoreAfter:!1,hasMoreBefore:!1,maxMsgId:a.newestMsg,maxMsgTs:a.newestMsgTs,minMsgId:a.oldestMsg,minMsgTs:d("WATimeUtils").castToMillisTime(0),threadId:a.chatId,threadJid:a.jid}}function t(a){var b=d("WAJids").extractDeviceIDParts(d("MAWGlobals").getMyDeviceJid()).userId,c=a.author,e=a.chatId,f=a.chatJid;a=a.reactToMsgId;return{actorId:d("WAJids").authorToUserId(c,b),chatJid:f,messageId:a,threadId:e}}function u(a){return{creationTs:a.creationTs,creator:a.creator,groupJid:a.groupJid,msgExpiration:a.msgExpiration,name:a.name,nameOwner:a.nameOwner,nameTs:a.nameTs,participantVersion:a.participantVersion,threadId:a.threadId}}function v(a){var b=d("MAWDbParticipant").getThreadIdAndUserJidFromParticipantId(a.invitedParticipantId);b=b.threadId;var c=a.threadJid,e=a.inviteeJid;return{caption:a.caption,inviteCode:a.inviteCode,inviteeId:e,inviteExpireTs:a.inviteExpirationTs,inviterId:d("WAJids").extractUserId(a.inviterJid),threadId:b,threadJid:c}}function w(a,b){return{threadId:a,threadJid:b}}function x(a,b,c,e){return{senderId:d("WAJids").extractUserId(c),state:e,threadId:a,threadJid:b}}g.createBridgeUpdateE2EEMetadataParticipants=a;g.createBridgeDeleteMessages=b;g.createBridgeRavenAction=e;g.createBridgeMedia=f;g.createBridgeReceivedReceipt=j;g.createBridgeUpdatedThread=k;g.createBridgeUpdatedGroupInfo=l;g.createBridgeBumpedThread=m;g.createBridgeBumpedThreadV2=n;g.createBridgeMsgsLoadedInfo=p;g.createBridgeMsgRangeLoadedInfo=q;g.createBridgeUpsertReaction=r;g.createBridgeUpdateMessageRange=s;g.createBridgeDeleteReaction=t;g.createBridgeGroupInfo=u;g.createBridgeGroupInvite=v;g.createBridgeDeleteGroupInvite=w;g.createBridgeReceivedChatState=x}),98);
__d("WAErrorMessage",[],(function(a,b,c,d,e,f){"use strict";var g="NoErrorMessageProvided";function a(a){var b;a instanceof Error?b=a.message:typeof a==="string"?b=a:typeof a==="object"?typeof (a==null?void 0:a.description)==="string"?b=a.description:typeof (a==null?void 0:a.message)==="string"?b=a.message:b=g:b=g;return b}f.NO_ERROR_MESSAGE_PROVIDED=g;f.maybeGetMessageFromError=a}),66);
__d("MAWDbChunkTxns",["MAWMediaUtils","WAErrorMessage","WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to add chunk. Possible duplicate? Will attempt a retry. Error: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to add chunk. Possible duplicate? Will attempt a retry. For hashedPlaintextHash: ",". Error: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to add chunk after retry. Error: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to add chunk for hashedPlaintextHash: ",". Error: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Chunk found after retry for hashedPlaintextHash: ",""]);l=function(){return a};return a}var m=d("WATagsLogger").TAGS(["MAWDbChunkTxns"]);b=function a(b,c,e,f,g){g===void 0&&(g=0);var n=d("MAWMediaUtils").genHMACPlaintextHash(c);return b.chunk.where("hashedPlaintextHash").equals(n).first().then(function(o){if(o){g>0&&m.LOG(l(),n);return o}else{var p={blobData:e,hashedPlaintextHash:n,mimetype:f,plaintextHash:c};return b.chunk.add(p).then(function(a){return babelHelpers["extends"]({},p,{chunkId:a})})["catch"](function(l){var o=d("WAErrorMessage").maybeGetMessageFromError(l);if(g>0){m.WARN(k(),n,o);m.ERROR(j(),o);throw l}else{m.WARN(i(),n,o);m.ERROR(h(),o);return a(b,c,e,f,g+1)}})}})};c=function(a,b){return n(a,b).then(function(a){return a!=null})};var n=function(a,b){return a.chunk.where("hashedPlaintextHash").equals(b).first()};e=function(a,b){return a.chunk.where("hashedPlaintextHash").anyOf(b).toArray().then(function(a){return new Map(a.map(function(a){return[a.hashedPlaintextHash,a]}))})};function a(a,b){return a.chunk.bulkGet(b)}f=function(a,b){b=d("MAWMediaUtils").genHMACPlaintextHash(b);return a.chunk.get({hashedPlaintextHash:b})};g.getOrCreateMediaChunk=b;g.hasMediaChunk=c;g.maybeGetChunkFromHash=n;g.maybeBulkGetChunksFromHash=e;g.bulkGetChunks=a;g.maybeGetChunkByPlaintextHash=f}),98);
__d("MAWJidUtils",["FBLogger","WAGlobals","WAJids"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,e){if(d("WAJids").isAuthorSystem(a)||b==null||e==null){c("FBLogger")("messenger_e2ee_web").warn("Failed to create protocolMsgId with externalId %s for a msg to edit",e);return}return{author:a,chat:b,externalId:e}}function a(a){var b;return h(a.author,a.threadJid,(b=a.externalId)!=null?b:a.editExternalId)}function b(a){return d("WAJids").isAuthorMe(a)?d("WAGlobals").getMyUserJid():a}g.maybeToProtocolMsgId=h;g.toProtocolMsgId=a;g.getAuthorJid=b}),98);
__d("MAWLoadReplyMediaTxns",["MAWDbChunkTxns","MAWDbMedia","MAWDbMsg","MAWDbXMATxns","MAWDexieTable","MAWGlobals","MAWJidUtils","MAWMsgType","MAWXMAUtils","WAAssertUnreachable","WAJids","WALogger","WAMsgType","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unable to fetch reply media XMA with id ",": ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unable to fetch reply media with id ",": ",""]);i=function(){return a};return a}function j(a,b){return a.media.get(b).then(function(b){return b==null?[void 0,void 0]:d("MAWDbChunkTxns").maybeGetChunkFromHash(a,b.hashedPlaintextHash).then(function(a){return a==null?[void 0,void 0]:[a,b]})})}var k=new Set([(e=d("MAWDbMedia")).MEDIA_TYPE.IMAGE,e.MEDIA_TYPE.GIF,e.MEDIA_TYPE.PTT,e.MEDIA_TYPE.STICKER,e.MEDIA_TYPE.VIDEO,e.MEDIA_TYPE.DOCUMENT_FILE]);function l(a){var b;switch(a.mediaType){case d("MAWDbMedia").MEDIA_TYPE.IMAGE:case d("MAWDbMedia").MEDIA_TYPE.GIF:case d("MAWDbMedia").MEDIA_TYPE.STICKER:b=a.validatedImageInfo;break;case d("MAWDbMedia").MEDIA_TYPE.VIDEO:b=a.validatedVideoInfo;break}a=b||{};var c=a.jpegThumbnailHeight;a=a.jpegThumbnailWidth;return{replyMediaPreviewHeight:c,replyMediaPreviewWidth:a}}function m(a){switch(a.type){case d("MAWMsgType").MSG_TYPE.IMAGE:case d("MAWMsgType").MSG_TYPE.VIDEO:case d("MAWMsgType").MSG_TYPE.PTT:case d("MAWMsgType").MSG_TYPE.GIF:case d("MAWMsgType").MSG_TYPE.STICKER:case d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:return!0;case d("MAWMsgType").MSG_TYPE.XMA:return d("MAWXMAUtils").isXMAShare(a.xmaMessageType);case d("MAWMsgType").MSG_TYPE.TEXT:case d("MAWMsgType").MSG_TYPE.UNAVAILABLE:case d("MAWMsgType").MSG_TYPE.REVOKED:case d("MAWMsgType").MSG_TYPE.EXPIRED_EPHEMERAL:case d("MAWMsgType").MSG_TYPE.GROUP_INVITE:case d("MAWMsgType").MSG_TYPE.CIPHERTEXT:case d("WAMsgType").NOTE_REPLY:return!1;default:return c("WAAssertUnreachable")(a.type)}}function n(a,b){return b==null?d("MAWDexieTable").dexieResolve():j(a,b).then(function(a){var c=a[0];a=a[1];if(c==null||a==null)return d("WAResultOrError").makeError("reply_media_not_found");if(!k.has(a.mediaType))return d("WAResultOrError").makeError("reply_media_type_unknown");a=l(a);var e=a.replyMediaPreviewHeight;a=a.replyMediaPreviewWidth;return d("WAResultOrError").makeResult({replyMediaId:b,replyMediaPreviewHeight:e,replyMediaPreviewWidth:a,replyMediaUrlMimeType:c.mimetype})}).then(function(a){if(a.success!==!0){d("WALogger").ERROR(i(),b,a.error);return}return a.value})}function o(a,b){var c=b.defaultPreviewMediaId;return c==null?d("MAWDexieTable").dexieResolve({replyXMAId:b.xmaId}):j(a,c).then(function(a){var c=a[0];a=a[1];if(c==null||a==null)return d("WAResultOrError").makeError("reply_xma_media_not_found");if(!k.has(a.mediaType))return d("WAResultOrError").makeError("reply_xma_media_type_unknown");a=l(a);var e=a.replyMediaPreviewHeight;a=a.replyMediaPreviewWidth;return d("WAResultOrError").makeResult({replyMediaPreviewHeight:e,replyMediaPreviewWidth:a,replyMediaUrlMimeType:c.mimetype,replyXMAId:b.xmaId})}).then(function(a){if(a.success!==!0){d("WALogger").ERROR(h(),b.xmaId,a.error);return}return a.value})}function a(a,b){var c,e;c=((c=b.quote)==null?void 0:c.content)||{};var f=c.author,g=c.externalId,h=c.mediaId;c=c.xmaMessageType;if(((e=b.quote)==null?void 0:e.content)==null||!m((e=b.quote)==null?void 0:e.content))return d("MAWDexieTable").dexieResolve();e=b.threadJid;b=f===d("MAWGlobals").getMyUserJid();b=b?d("WAJids").AUTHOR_ME:f;return d("MAWXMAUtils").isXMAShare(c)?p(a,d("MAWJidUtils").maybeToProtocolMsgId(b,e,g)):n(a,h)}function p(a,b){return b==null?d("MAWDexieTable").dexieResolve():d("MAWDbXMATxns").maybeGetXMAFromProtocolMsgId(a,b).then(function(b){if(b==null||d("MAWXMAUtils").isXMAExpired(b.isTombstoned,b.targetExpiringAtSec))return;return o(a,b)})}function b(a,b){var c=b.author,e=b.externalId,f=b.mediaId,g=b.threadJid,h=b.xmaMessageType;h=d("MAWXMAUtils").isXMAShare(h);return!d("MAWDbMsg").isMediaMsg(b)&&!h?d("MAWDexieTable").dexieResolve():h?p(a,d("MAWJidUtils").maybeToProtocolMsgId(c,g,e)):n(a,f)}g.isMediaReplyContent=m;g.getReplyMediaForMsgQuote=a;g.getReplyMediaForMsg=b}),98);
__d("WAMsgMap",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){var b=this;this.$1=new Map();a==null?void 0:a.forEach(function(a){var c=a[0];a=a[1];b.set(c,a)})}var b=a.prototype;b.clear=function(){this.$1.clear()};b["delete"]=function(a){var b;(b=this.$1.get(a.externalId))==null?void 0:(b=b.get(a.author))==null?void 0:b["delete"](a.chat)};b.get=function(a){var b;return(b=this.$1.get(a.externalId))==null?void 0:(b=b.get(a.author))==null?void 0:b.get(a.chat)};b.has=function(a){var b;return(b=(b=this.$1.get(a.externalId))==null?void 0:(b=b.get(a.author))==null?void 0:b.has(a.chat))!=null?b:!1};b.set=function(a,b){var c,d;c=(c=this.$1.get(a.externalId))!=null?c:new Map();this.$1.has(a.externalId)||this.$1.set(a.externalId,c);d=(d=c.get(a.author))!=null?d:new Map();c.has(a.author)||c.set(a.author,d);d.set(a.chat,b);return this};b.keys=function(){var a=[],b=this.$1;for(var c=b.keys(),d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f,g;if(d){if(e>=c.length)break;g=c[e++]}else{e=c.next();if(e.done)break;g=e.value}g=g;f=(f=b.get(g))!=null?f:new Map();for(var h=f.keys(),i=Array.isArray(h),j=0,h=i?h:h[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var k,l;if(i){if(j>=h.length)break;l=h[j++]}else{j=h.next();if(j.done)break;l=j.value}l=l;k=(k=f.get(l))!=null?k:new Map();for(var k=k.keys(),m=Array.isArray(k),n=0,k=m?k:k[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var o;if(m){if(n>=k.length)break;o=k[n++]}else{n=k.next();if(n.done)break;o=n.value}o=o;a.push({externalId:g,author:l,chat:o})}}}return a};b.entries=function(){var a=[],b=this.$1;for(var c=b.keys(),d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f,g;if(d){if(e>=c.length)break;g=c[e++]}else{e=c.next();if(e.done)break;g=e.value}g=g;f=(f=b.get(g))!=null?f:new Map();for(var h=f.keys(),i=Array.isArray(h),j=0,h=i?h:h[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var k,l;if(i){if(j>=h.length)break;l=h[j++]}else{j=h.next();if(j.done)break;l=j.value}l=l;k=(k=f.get(l))!=null?k:new Map();for(var m=k.keys(),n=Array.isArray(m),o=0,m=n?m:m[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var p;if(n){if(o>=m.length)break;p=m[o++]}else{o=m.next();if(o.done)break;p=o.value}p=p;var q=k.get(p);q!=null&&a.push([{externalId:g,author:l,chat:p},q])}}}return a};b.values=function(){return this.entries().map(function(a){return a[1]})};return a}();f.MsgMap=a}),66);
__d("MAWDbMsgUtil",["WAJids","WALogger","WAMsgMap"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Invalid author when converting msg array to map"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Missing jid prevents adding message to array map"]);i=function(){return a};return a}function a(a){return a.reduce(function(a,b){var c=b.threadJid;if(c==null){d("WALogger").ERROR(i());return a}if(b.author==="@system"){d("WALogger").ERROR(h());return a}a.set({author:b.author,chat:c,externalId:b.externalId},b);return a},new(d("WAMsgMap").MsgMap)())}function b(a){return d("WAJids").isAuthorSystem(a.author)||a.threadJid==null?null:{author:a.author,chat:a.threadJid,externalId:a.externalId}}g.convertMsgArrayToMap=a;g.getProtocolMsgIdFromDbMsg=b}),98);
__d("MAWDbUnrenderedMsgTxns",["MAWAckLevel","MAWDbMsg","MAWDbMsgUtil","MAWDexieTable","WAJids","WALogger","WAMsgMap","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["bulkUpdateSystemAck on sent message"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["bulkUpdateSystemAck on incoming message"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["updateSystemAckForUnrenderedMsg on non existing message"]);j=function(){return a};return a}function a(a,b){var c=b.author,e=b.chat,f=b.externalId;return a.threads.get({jid:e}).then(function(b){return b==null?d("WAResultOrError").makeError("missing_thread_unrendered_msg"):k(a,f,b.chatId,c).then(function(a){return a==null?d("WAResultOrError").makeError("missing_unrendered_msg"):d("WAResultOrError").makeResult(a)})})}function b(a,b){var c=b.map(function(a){a=a.externalId;return a});return a.unrenderedMessages.where("externalId").anyOf(c).toArray().then(function(a){var c=d("MAWDbMsgUtil").convertMsgArrayToMap(a),e=new(d("WAMsgMap").MsgMap)();b.forEach(function(a){var b=c.get(a);b!=null&&e.set(a,b)});return e})}function k(a,b,c,d){return a.unrenderedMessages.where("externalId").equals(b).filter(function(a){return a.author===d&&a.thread===c}).first()}function l(a,b){return a+"_"+b}function c(a,b){var c=b.map(function(a){a=a.externalId;return a}),e=Array.from(new Set(b.map(function(a){return a.chat})));return d("MAWDexieTable").dexieAll([a.threads.where("jid").anyOf(e).toArray(),a.unrenderedMessages.where("externalId").anyOf(c).toArray()]).then(function(a){var c=a[0];a=a[1];if(a.length===0||c.length===0)return{msgs:[],threadIdToJid:new Map()};var d=new Map();c.forEach(function(a){return d.set(a.chatId,a.jid)});var e=new Map();b.forEach(function(a){var b=a.author,c=a.chat;a=a.externalId;var d=e.get(a)||new Set();d.add(l(b,c));e.set(a,d)});return{msgs:a.filter(function(a){var b=a.author,c=a.externalId;a=a.thread;a=d.get(a);c=e.get(c);return c!=null&&a!=null&&c.has(l(b,a))}),threadIdToJid:d}})}function e(a,b,c){return m(a,[{ack:c,msgId:b}]).then(function(a){a=a[0];if(a==null){d("WALogger").LOG(j());return null}return a})}function m(a,b){var c=b.map(function(a){return a.msgId}),e=new Map();b.forEach(function(a){return e.set(a.msgId,{ack:a.ack})});return a.unrenderedMessages.where("msgId").anyOf(c).toArray().then(function(b){if(b.length===0)return b;var c=[],f=[];b.forEach(function(a){var b;if(a.author!==d("WAJids").AUTHOR_ME){d("WALogger").ERROR(i());c.push(a);return}if(a.ack>d("MAWAckLevel").ACK.clock){d("WALogger").LOG(h());c.push(a);return}b=(b=e.get(a.msgId))==null?void 0:b.ack;if(b==null)return null;a=babelHelpers["extends"]({},a,{ack:b});b===d("MAWAckLevel").ACK.sent&&delete a.resendCount;f.push(a)});return a.unrenderedMessages.bulkPut(f).then(function(){return[].concat(f,c)})})}function f(a,b){b=b.map(function(b){return a.unrenderedMessages.get({msgId:b})});return d("MAWDexieTable").dexieAll(b)}function n(a,b){return a.unrenderedMessages.where("msgId").between(d("MAWDbMsg").msgIdsInChatLowerBound(b.chatId),d("MAWDbMsg").msgIdsInChatUpperBound(b.chatId)).last().then(function(a){a=a==null?0:d("MAWDbMsg").getInChatMsgIdFromMsgId(a.msgId);return a+1})}g.maybeGetUnrenderedMsgByProtocolMsgId=a;g.getUnrenderedMsgMapByProtocolMsgId=b;g.maybeGetUnrenderedMsgByExternalId=k;g.getUnrenderedMsgsByProtocolMsgId=c;g.updateSystemAckForUnrenderedMsg=e;g.bulkUpdateSystemAckForUnrenderedMsgs=m;g.getUnrenderedMsgsByMsgIds=f;g.getNextUnrenderedMsgIdNumberForThread=n}),98);
__d("MAWDbMsgTxns",["MAWAckLevel","MAWBridgeMsg","MAWDbMsg","MAWDbMsgUtil","MAWDbUnrenderedMsgTxns","MAWDbXMATxns","MAWDexieTable","MAWEBUploadTrackingUtils","MAWIndexedDb","MAWJidUtils","MAWLoadReplyMediaTxns","MAWMsgType","MAWSharedMsgIdUtil","MAWUpdateThreadMsgMetadataApi","ODS","Random","WAGlobals","WAJids","WALogger","WAMsgMap","WAResultOrError","WATimeUtils","err","gkx","justknobx","nullthrows","promiseDone","qex"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Successfull deleted "," messages"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["updateMediaId on message "," that already has this mediaId ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Replacing mediaId for message with pre-existing media. type=",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["updateMediaId on message "," that already has this mediaId ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["getFutureproofMsg gets a message "," with unsupported type ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Inconsistent getMsgsFromOffset return between legacy and v2. Reason: ",".\n    Thread chatId: ",", jid: ",".\n    Legacy result length: ",", V2 result length: ",".\n    Legacy result first sortOrderMs: ",".\n    Legacy result last sortOrderMs: ",".\n    V2 result first sortOrderMs: ",".\n    V2 result last sortOrderMs: ",".\n    Input params: offsetMsgId: ",", numMsgs: ",", includeOffset: ",", includeExpired: ",", direction: ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["getMsgsFromOffsetV2 newest msg thread jid is not equal to thread jid.\n            msg.threadJid: ",",\n            msg.thread: ",",\n            thread.jid: ",",\n            thread.chatId: ",",\n            threadId: ",",\n            offsetMsgId: ","."]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["Invalid sortOrder in getMsgsFromOffset. Offset msg sortOrderMs out of bound - oldest: ","(msgType=","), offset: ","(msgType=","), newest: ","(msgType=","). Thread chatId: ","."]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["Invalid sortOrder in getMsgsFromOffset. Some msg has null sortOrderMs - oldest: ","(msgType=","), offset: ","(msgType=","), newest: ","(msgType=","). Thread chatId: ","."]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["Invalid sortOrder in getMsgsFromOffset. Some msg is null - oldest: ",", newest: ",", offset: ",". Thread chatId: ","."]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["maybeUpdateThreadMsgsForUndefinedOldestOrNewestMsgs fixes an incorrect newest/oldest values:\n    thread id: ",", thread jid: ",", oldestMsgId: ",", newestMsgId: ",",\n    validOldestMsg: ",", validNewestMsg: ",""]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["bulkUpdateSystemAck on sent message"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["bulkUpdateSystemAck on incoming message"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["updateSystemAck on non existing message"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose(["[maybeGetMsgByExternalId] Found "," messages with external id ",""]);w=function(){return a};return a}function x(){var a=babelHelpers.taggedTemplateLiteralLoose(["[maybeGetMsgByProtocolMsgId] Suspected multiple instances of same message!"]);x=function(){return a};return a}function y(){var a=babelHelpers.taggedTemplateLiteralLoose(["[maybeGetMsgByProtocolMsgId] Can't have "," messages with the same protocolMsgId!"]);y=function(){return a};return a}var z=c("gkx")("289");function a(a,b){return b==null?d("MAWDexieTable").dexieResolve():a.messages.get({msgId:b})}function A(a,b,c,d){return a.messages.where(["threadJid","sortOrderMs"]).between([b,Number.MIN_SAFE_INTEGER],[b,Number.MAX_SAFE_INTEGER],c,d)}function B(a,b){return A(a,b,!1,!1).last()}function b(a,b){return c("qex")._("867")===!0?B(a,b.jid).then(function(a){return a==null?void 0:a.msgId}):d("MAWDexieTable").dexieResolve(b.newestMsg)}function e(a,b){return c("qex")._("867")===!0?B(a,b.jid).then(function(a){return a==null?void 0:a.sortOrderMs}):d("MAWDexieTable").dexieResolve(b.newestMsgTs==null?b.newestMsgTs:d("WATimeUtils").fromMillisTime(b.newestMsgTs))}function f(a,b,c){return A(a,b,!1,!1).reverse().limit(c).toArray()}function C(a,b){return A(a,b,!1,!1).first()}function D(a,b){return c("qex")._("867")===!0?C(a,b.jid).then(function(a){return a==null?void 0:a.msgId}):d("MAWDexieTable").dexieResolve(b.oldestMsg)}function E(a,b,c,d){return a.messages.where("[thread+serverTs]").between([b,Number.MIN_SAFE_INTEGER],[b,Number.MAX_SAFE_INTEGER],c,d)}function F(a,b){return E(a,b,!1,!1).last()}function G(a,b,c){return E(a,b,!1,!1).reverse().limit(c).toArray()}function H(a,b){return a.messages.where("externalId").equals(b.externalId).filter(function(a){return a.author===b.author&&a.threadJid===b.chat}).toArray().then(function(a){if(a.length>1){var b=a.map(function(a){var b;return a.type+":"+((b=a.serverTs)!=null?b:0).toString()+":"+((b=a.ts)!=null?b:0).toString()});b=new Set(b).size===1;!b?d("WALogger").ERROR(y(),a.length):d("WALogger").ERROR(x())}return a[0]})}function I(a,b){return a.messages.where("msgId").equals(b).toArray()}function J(a,b){return M(a,b).then(function(a){return a.success?a:a})}function K(a,b){var c=b.map(function(a){a=a.externalId;return a});return a.messages.where("externalId").anyOf(c).toArray().then(function(a){var c=d("MAWDbMsgUtil").convertMsgArrayToMap(a),e=new(d("WAMsgMap").MsgMap)();b.forEach(function(a){var b=c.get(a);b!=null&&e.set(a,b)});return e})}function L(a,b){return a.messages.where("msgId").equals(b).first().then(function(a){return a==null?void 0:a.sortOrderMs})}function M(a,b){var c=b.author,e=b.chat,f=b.externalId;return a.threads.get({jid:e}).then(function(b){return b==null?d("WAResultOrError").makeError("missing_thread_msg"):O(a,f,b.chatId,c).then(function(a){return a==null?d("WAResultOrError").makeError("missing_msg"):d("WAResultOrError").makeResult(a)})})}function N(a,b){var c=b.author,d=b.chat,e=b.externalId;return a.threads.get({jid:d}).then(function(b){if(b==null)return;return a.messages.where("revokedExternalId").equals(e).filter(function(a){return a.author===c&&a.thread===b.chatId&&a.type==="Revoked"}).first()})}function O(a,b,c,e){return a.messages.where("externalId").equals(b).filter(function(a){return a.author===e&&a.thread===c}).toArray().then(function(a){a.length>1&&d("WALogger").ERROR(w(),a.length,b);return a[0]})}function P(a,b,c,e){var f=a.messages.where("revokedExternalId").equals(b).filter(function(a){return a.author===e&&a.thread===c&&a.type===d("MAWMsgType").MSG_TYPE.REVOKED}).first();a=d("MAWDbUnrenderedMsgTxns").maybeGetUnrenderedMsgByExternalId(a,b,c,e).then(function(a){if((a==null?void 0:a.type)===d("MAWMsgType").MSG_TYPE.DELETE_FOR_ME)return a});return d("MAWDexieTable").dexieAll([f,a]).then(function(a){var b=a[0];a=a[1];return b!=null||a!=null})}function Q(a,b){var c=new Array(b.length),e=new Set();b.forEach(function(a){c.push(a.externalId),e.add(d("MAWSharedMsgIdUtil").convertWAMsgIdToStringId(a))});return a.messages.where("externalId").anyOf(c).filter(function(a){return e.has(d("MAWSharedMsgIdUtil").convertWAMsgIdToStringId({author:a.author,chat:a.threadJid,externalId:a.externalId}))}).toArray()}function aa(a,b,c,e,f){return R(a,[{ack:c,msgId:b,reportingMeta:f,serverTs:e}]).then(function(a){a=a.find(function(a){return a.msgId===b});if(a==null){d("WALogger").LOG(v());return null}return a})}function R(a,b){var c=b.map(function(a){return a.msgId});return d("MAWDbXMATxns").getXMAMsgIdsFromAssociatedMsgIds(a,c).then(function(e){var f=new Map();b.forEach(function(a){f.set(a.msgId,{ack:a.ack,reportingMeta:a.reportingMeta,serverTs:a.serverTs});var b=e.get(a.msgId);b!=null&&f.set(b,{ack:a.ack,reportingMeta:a.reportingMeta,serverTs:a.serverTs})});var g=Array.from(new Set(c.concat(Array.from(e.values()))));return a.messages.where("msgId").anyOf(g).toArray().then(function(b){if(b.length===0)return b;var c=[],e=[];b.forEach(function(a){var b,g;if(a.author!==d("WAJids").AUTHOR_ME){d("WALogger").ERROR(u());c.push(a);return}if(a.ack>d("MAWAckLevel").ACK.clock){d("WALogger").LOG(t());c.push(a);return}b=(b=f.get(a.msgId))==null?void 0:b.ack;g=(g=f.get(a.msgId))==null?void 0:g.serverTs;if(b==null)return null;var h=babelHelpers["extends"]({},a,{ack:b});g!=null&&(h.serverTs=g);a=(g=f.get(a.msgId))==null?void 0:g.reportingMeta;a!=null&&(h.reportingMeta=a);b===d("MAWAckLevel").ACK.sent&&delete h.resendCount;e.push(h);d("WAGlobals").getConfig().useEbUploadQueue()||d("MAWEBUploadTrackingUtils").maybeStartTrackingForMiddleware(h,"send")});return a.messages.bulkPut(e).then(function(){return d("MAWDexieTable").dexieAll(e.map(function(b){return d("MAWLoadReplyMediaTxns").getReplyMediaForMsgQuote(a,b)}))}).then(function(a){e.forEach(function(b,c){d("MAWIndexedDb").afterTransaction({tag:"MsgUpdated",value:d("MAWBridgeMsg").createBridgeMsg(b,void 0,a[c])})});return[].concat(e,c)})})})}function ba(a,b,e,f){return a.threads.get(b).then(function(g){if(g==null||f==null||g.oldestMsg!==e&&g.newestMsg!==e)return;var h=c("gkx")("289")?[a.messages.where(["threadJid","sortOrderMs"]).above([g.jid,f]).first(),a.messages.where(["threadJid","sortOrderMs"]).below([g.jid,f]).last()]:[a.messages.where("msgId").above(e).first(),a.messages.where("msgId").below(e).last()];return d("MAWDexieTable").dexieAll(h).then(function(c){var f=c[0];c=c[1];return a.threads.update(b,{newestMsg:g.newestMsg===e?c==null?void 0:c.msgId:g.newestMsg,newestMsgTs:g.newestMsg===e?(c==null?void 0:c.ts)==null?null:d("WATimeUtils").castUnixTimeToMillisTime(c.ts):g.newestMsgTs,oldestMsg:g.oldestMsg===e?f==null?void 0:f.msgId:g.oldestMsg}).then(function(){})})})}function S(a,b,e,f,g){if(b===(e==null?void 0:e.msgId)&&f===(g==null?void 0:g.msgId))return d("MAWDexieTable").dexieResolve();d("WALogger").ERROR(s(),a.chatId,a.jid,b,f,e==null?void 0:e.msgId,g==null?void 0:g.msgId);d("MAWIndexedDb").afterTransactionEffect(function(){c("promiseDone")(c("MAWUpdateThreadMsgMetadataApi")(a,b,e,f,g))})}function ca(a,b,c,e){var f;if(b==null||c==null||e==null){d("WALogger").ERROR(r(),b==null,c==null,e==null,a);return{hasMoreAfter:!1,hasMoreBefore:!1,msgs:[]}}if(c.sortOrderMs==null||e.sortOrderMs==null){d("WALogger").ERROR(q(),b==null?void 0:b.sortOrderMs,b==null?void 0:b.type,e==null?void 0:e.sortOrderMs,e==null?void 0:e.type,c==null?void 0:c.sortOrderMs,c==null?void 0:c.type,a);return{hasMoreAfter:!1,hasMoreBefore:!1,msgs:[]}}if(e.sortOrderMs>c.sortOrderMs||e.sortOrderMs<((f=b.sortOrderMs)!=null?f:0)){d("WALogger").ERROR(p(),b==null?void 0:b.sortOrderMs,b==null?void 0:b.type,e==null?void 0:e.sortOrderMs,e==null?void 0:e.type,c==null?void 0:c.sortOrderMs,c==null?void 0:c.type,a);return{hasMoreAfter:!1,hasMoreBefore:!1,msgs:[]}}}function T(a,b,e,f,g,h,i){g===void 0&&(g=!1);h===void 0&&(h=!1);i===void 0&&(i="before");return f===0?d("MAWDexieTable").dexieResolve({hasMoreAfter:!1,hasMoreBefore:!1,msgs:[],threadJid:null}):d("MAWDexieTable").dexieAll([a.threads.get(b),e==null?d("MAWDexieTable").dexieResolve(null):a.messages.get({msgId:e})]).then(function(j){var k=j[0],l=j[1],m=k==null?void 0:k.oldestMsg,n=k==null?void 0:k.newestMsg;if(k==null||e!=null&&l==null)return{hasMoreAfter:!1,hasMoreBefore:!1,msgs:[],threadJid:null};var p=h?function(a){return!0}:function(a){return a.messageExpirationTs==null||a.messageExpirationTs>d("WATimeUtils").unixTime()};j=d("MAWDexieTable").dexieResolve([]);f===1&&g&&l!=null&&(j=d("MAWDexieTable").dexieResolve([l].filter(p)));return j.then(function(h){h=h.length>0?d("MAWDexieTable").dexieResolve(h):pa(a,k.jid,l,g,f,p,i);var j=c("gkx")("23927");return d("MAWDexieTable").dexieAll([h,B(a,k.jid),C(a,k.jid)]).then(function(a){var c=a[0],g=a[1];a=a[2];S(k,m,a,n,g);if(c.length===0)return{hasMoreAfter:!1,hasMoreBefore:!1,msgs:[],threadJid:k.jid};var h=c[c.length-1],i=c[0];h=j?h.msgId!==(a==null?void 0:a.msgId):h.msgId!==(a==null?void 0:a.msgId)&&c.length===f;a=j?i.msgId!==(g==null?void 0:g.msgId):!1;i.threadJid!==k.jid&&d("WALogger").ERROR(o(),i.threadJid,i.thread,k.jid,k.chatId,b,e);return{hasMoreAfter:a,hasMoreBefore:h,msgs:c,threadJid:k.jid}})})})}function da(a,b,e,f,g,h,i){g===void 0&&(g=!1);h===void 0&&(h=!1);i===void 0&&(i="before");var j=d("Random").coinflip(c("justknobx")._("1707")),k=j?c("qex")._("794")===!0:c("qex")._("546")===!0,l={hasMoreAfter:!1,hasMoreBefore:!1,msgs:[]};return d("MAWDexieTable").dexieAll([!k||j?U(a,b,e,f,g,h,i):d("MAWDexieTable").dexieResolve(l),k||j?T(a,b,e,f,g,h,i):d("MAWDexieTable").dexieResolve(babelHelpers["extends"]({},l,{threadJid:null}))]).then(function(a){var c=a[0];a=a[1];j&&ea(c,a,b,e,f,g,h,i);a.threadJid;a=babelHelpers.objectWithoutPropertiesLoose(a,["threadJid"]);return k?a:c})}function ea(a,b,c,e,f,g,i,j){g===void 0&&(g=!1);i===void 0&&(i=!1);j===void 0&&(j="before");var k=b.hasMoreAfter===a.hasMoreAfter&&b.hasMoreBefore===a.hasMoreBefore&&b.msgs.length===a.msgs.length&&b.msgs.every(function(b,c){c=a.msgs[c];return b.msgId===c.msgId});(h||(h=d("ODS"))).bumpEntityKey(3185,"armadillo_get_msgs_from_offset_v2",k?"consistent":"inconsistent");if(!k){k=b.hasMoreAfter!==a.hasMoreAfter?"inconsistent_hasMoreAfter":b.hasMoreBefore!==a.hasMoreBefore?"inconsistent_hasMoreBefore":b.msgs.length>a.msgs.length?"inconsistent_v2LengthGreater":b.msgs.length<a.msgs.length?"inconsistent_legacyLengthGreater":"inconsistent_other";(h||(h=d("ODS"))).bumpEntityKey(3185,"armadillo_get_msgs_from_offset_v2",k);d("WALogger").ERROR(n(),k,c,b.threadJid,a.msgs.length,b.msgs.length,(k=a.msgs[0])==null?void 0:k.sortOrderMs,(c=a.msgs[a.msgs.length-1])==null?void 0:c.sortOrderMs,(k=b.msgs[0])==null?void 0:k.sortOrderMs,(c=b.msgs[b.msgs.length-1])==null?void 0:c.sortOrderMs,e,f,g,i,j)}}function U(a,b,e,f,g,h,i){g===void 0&&(g=!1);h===void 0&&(h=!1);i===void 0&&(i="before");if(f===0)return d("MAWDexieTable").dexieResolve({hasMoreAfter:!1,hasMoreBefore:!1,msgs:[]});var j=c("qex")._("863")===!0;return a.threads.get(b).then(function(b){var k=b==null?void 0:b.oldestMsg,l=b==null?void 0:b.newestMsg;return b==null||k==null||l==null?{hasMoreAfter:!1,hasMoreBefore:!1,msgs:[]}:d("MAWDexieTable").dexieAll([j?C(a,b.jid):a.messages.where("msgId").aboveOrEqual(k).first(),j?B(a,b.jid):a.messages.where("msgId").belowOrEqual(l).last(),e==null?d("MAWDexieTable").dexieResolve(null):a.messages.get({msgId:e})]).then(function(e){var j=e[0],m=e[1];e=e[2];var n=(e=e)!=null?e:m,o=j==null?void 0:j.msgId;e=n==null?void 0:n.msgId;var p=m==null?void 0:m.msgId,q=d("WATimeUtils").unixTime();S(b,k,j,l,m);var r=ca(b.chatId,j,m,n);if(r!=null)return r;r=d("MAWDexieTable").dexieResolve([]);var s=h?function(a){return!0}:function(a){return a.messageExpirationTs==null||a.messageExpirationTs>q};f===1&&g&&(r=a.messages.get({msgId:e}).then(function(a){return a!=null?[a].filter(s):[]}));return r.then(function(e){e=e.length>0?d("MAWDexieTable").dexieResolve(e):qa(a,b.jid,c("nullthrows")(j),c("nullthrows")(m),c("nullthrows")(n),g,f,s,i);return e.then(function(a){if(a.length===0)return{hasMoreAfter:!1,hasMoreBefore:!1,msgs:[]};var b=a[a.length-1],d=a[0];b=c("gkx")("23927")?b.msgId!==o:b.msgId!==o&&a.length===f;d=c("gkx")("23927")?d.msgId!==p:!1;return{hasMoreAfter:d,hasMoreBefore:b,msgs:a}})})})})}function fa(a){return a.messages.where("altIndex").equals(d("MAWDbMsg").FUTUREPROOF_ALT_INDEX).toArray().then(function(a){var b=[];a.forEach(function(a){if(a.type!==d("MAWMsgType").MSG_TYPE.FUTUREPROOF){d("WALogger").ERROR(m(),a.msgId,a.type);return}b.push(a)});return b})}function V(a){return a.toString()}function ga(a,b,c){var e=b.mediaId;if(e===c){d("WALogger").LOG(l(),b.msgId,c);return d("MAWDexieTable").dexieResolve()}e=e!=null?a.media.get(e):d("MAWDexieTable").dexieResolve();return e.then(function(e){e&&d("WALogger").ERROR(k(),b.type);e=babelHelpers["extends"]({},b,{mediaId:c});return a.messages.put(e).then(function(){})})}function ha(a,b){var e=Array.from(b.keys());return a.messages.where("msgId").anyOf(e).toArray().then(function(e){var f=[];e.map(function(a){var e=b.get(a.msgId),g=a.mediaId;if(g!=null&&g!==e){if(e!=null)throw c("err")("mediaId "+V(g)+" in message "+a.msgId+" is different with the "+V(e)+" in bulkUpdateMediaId");d("WALogger").LOG(j(),a.msgId,e);return}g=babelHelpers["extends"]({},a,{mediaId:e});f.push(g)});return a.messages.bulkPut(f).then(function(){})})}function ia(a,b){return W(a,[b]).then(function(){})}function W(a,b){return a.messages.where("msgId").anyOf(b).toArray().then(function(b){var c=b.map(function(a){return babelHelpers["extends"]({},a,{isExpiredXmaMsg:!0})});return a.messages.bulkPut(c).then(function(){return c})})}function X(a,b,c,e){if(e!=null&&e<=0)return d("MAWDexieTable").dexieResolve([]);a=a.messages.where("altIndex").equals(d("MAWDbMsg").craftToBeReadAltIndex(b)).filter(c);e!=null&&(a=a.limit(e));return a.toArray()}function Y(a,b,c,d){return X(a,b,function(a){return a.msgId<=c},d)}function Z(a,b,c,e){return X(a,b,function(a){return d("MAWDbMsg").getSortOrderWithFallback(a)<=c},e)}function ja(a,b,c){return Y(a,b,c).then(function(b){var c=b.map(function(a){return babelHelpers["extends"]({altIndex:null},a)});return a.messages.bulkPut(c).then(function(){return c})})}function ka(a,b,c){return Z(a,b,c).then(function(b){var c=b.map(function(a){return babelHelpers["extends"]({altIndex:null},a)});return a.messages.bulkPut(c).then(function(){return c})})}function la(a,b){return a.messages["delete"](b)}function ma(a,b,c){var e=b.map(function(a){return a.rowId});b=c!=null?b.map(function(a){a=d("MAWJidUtils").toProtocolMsgId(a);if(!a)return;return babelHelpers["extends"]({},a,{reason:c})}).filter(Boolean):[];return d("MAWDexieTable").dexieAll([a.deletedMessages.bulkAdd(b),a.messages.bulkDelete(e)]).then(function(a){a[0];a=a[1];d("WALogger").LOG(i(),a)})}function na(a,b){return a.messages.where("msgId").anyOf(b).toArray()}function oa(a){return a.messages.where("altIndex").anyOf([d("MAWDbMsg").SPAM_ALT_INDEX,d("MAWDbMsg").FUTUREPROOF_SPAM_ALT_INDEX]).toArray()}function pa(a,b,c,e,f,g,h){h===void 0&&(h="before");c=c==null?null:d("MAWDbMsg").getSortOrderWithFallback(c);if(h==="before"){return a.messages.where(["threadJid","sortOrderMs"]).between([b,Number.MIN_SAFE_INTEGER],[b,(h=c)!=null?h:Number.MAX_SAFE_INTEGER],!0,e).reverse().filter(g).limit(f).toArray()}else{return a.messages.where(["threadJid","sortOrderMs"]).between([b,(h=c)!=null?h:Number.MIN_SAFE_INTEGER],[b,Number.MAX_SAFE_INTEGER],e,!0).filter(g).limit(f).toArray().then(function(a){return a.sort(function(a,b){return b.ts-a.ts})})}}function qa(a,b,c,e,f,g,h,i,j){j===void 0&&(j="before");c=d("MAWDbMsg").getSortOrderWithFallback(c);f=d("MAWDbMsg").getSortOrderWithFallback(f);e=d("MAWDbMsg").getSortOrderWithFallback(e);if(j==="before")return a.messages.where(["threadJid","sortOrderMs"]).between([b,c],[b,f],!0,g).reverse().filter(i).limit(h).toArray();else return a.messages.where(["threadJid","sortOrderMs"]).between([b,f],[b,e],g,!0).filter(i).limit(h).toArray().then(function(a){return a.sort(function(a,b){return b.ts-a.ts})})}function ra(a,b,c,e,f){var g=e.msgId;if(b==null&&c==null)return d("MAWDexieTable").dexieResolve({newestMsg:g,oldestMsg:g});if(f==null){var h;return d("MAWDexieTable").dexieResolve({newestMsg:g,oldestMsg:(h=b)!=null?h:g})}return d("MAWDexieTable").dexieAll([b!=null?a.messages.get({msgId:b}):null,c!=null?a.messages.get({msgId:c}):null]).then(function(a){var b=a[0];a=a[1];b=[b,a,e].filter(Boolean);return{newestMsg:b.reduce(function(a,b){return $(b,g,f)>=$(a,g,f)?b:a}).msgId,oldestMsg:b.reduce(function(a,b){return $(a,g,f)<$(b,g,f)?a:b}).msgId}})}function $(a,b,c){return a.msgId===b?c:d("MAWDbMsg").getSortOrderWithFallback(a)}function sa(a,b){return a.messages.where("msgId").between(d("MAWDbMsg").msgIdsInChatLowerBound(b.chatId),d("MAWDbMsg").msgIdsInChatUpperBound(b.chatId)).last().then(function(a){a=a==null?0:d("MAWDbMsg").getInChatMsgIdFromMsgId(a.msgId);return a+1})}g.IS_SORT_ORDER_COMPARISON_ENABLED=z;g.maybeGetMsg=a;g.getThreadMessagesBySortOrder=A;g.getThreadNewestMessageBySortOrder=B;g.getThreadNewestMessageIdBySortOrder=b;g.getThreadNewestMessageTsBySortOrder=e;g.getThreadNewestNumMessagesBySortOrder=f;g.getThreadOldestMessageIdBySortOrder=D;g.getThreadMessagesByServerTs=E;g.getThreadNewestMessageByServerTs=F;g.getThreadNewestNumMessagesByServerTs=G;g.maybeGetMsgByProtocolMsgId=H;g.maybeGetMsgListByMsgId_I_KNOW_WHAT_I_AM_DOING=I;g.maybeGetMsgResultByProtocolMsgId=J;g.getMsgMapByProtocolMsgId=K;g.getSortOrderFromMsgId=L;g.maybeGetRevokedMsgByProtocolMsgId=N;g.maybeGetMsgByExternalId=O;g.checkIfMsgIsDeletedForMeOrRevoked=P;g.getMsgsByProtocolMsgId=Q;g.updateSystemAck=aa;g.bulkUpdateSystemAck=R;g.maybeUpdateThreadMsgsForDeleteForMe=ba;g.getMsgsFromOffsetV2=T;g.getMsgsFromOffset=da;g.getMsgsFromOffsetLegacy=U;g.getFutureProofMsgs=fa;g.updateMediaId=ga;g.bulkUpdateMediaId=ha;g.updateDbMsgXMAExpiration=ia;g.bulkUpdateDbMsgXMAExpired=W;g.getMsgsNeedingRetroactiveReadReceiptsUpTo__DONOTUSE=Y;g.getMsgsNeedingRetroactiveReadReceiptsUpTo=Z;g.clearRetroactiveReadReceiptStatusFromMsgsUpTo__DONOTUSE=ja;g.clearRetroactiveReadReceiptStatusFromMsgsUpTo=ka;g.deleteDbMsg=la;g.deleteMessages=ma;g.getMsgsByMsgIds=na;g.getSpamMsgs=oa;g.calculateOldestAndNewestMsg=ra;g.getNextMsgIdNumberForThread=sa}),98);
__d("WAArrayZip",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){var c=Math.min(a.length,b.length);return a.slice(0,c).map(function(a,c){return[a,b[c]]})}f.zip=a}),66);
__d("MAWDbThreadTxns",["MAWBridgeTypesCreators","MAWDbMsgTxns","MAWDexieTable","MAWFolderTypes","MAWIndexedDb","WAArrayZip","WALogger","WAResultOrError","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["markCutoverThreadAsNotMigratedLocally failed because thread is already unmigrated"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["markThreadAsMigratedLocally failed because thread is already migrated"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["markThreadAsMigratedLocally failed to get the thread"]);j=function(){return a};return a}function a(a,b){return a.threads.get(b).then(function(a){return a==null?d("WAResultOrError").makeError("missing"):d("WAResultOrError").makeResult(a)})}function b(a,b){return a.threads.get({deduplicationKey:b}).then(function(a){return a==null?d("WAResultOrError").makeError("missing"):d("WAResultOrError").makeResult(a)})}function k(a,b){return a.threads.get({jid:b}).then(function(a){return a==null?d("WAResultOrError").makeError("missing"):d("WAResultOrError").makeResult(a)})}function c(a,b){return a.threads.where("jid").anyOf(b).toArray()}function e(a,b){return a.threads.where("jid").startsWith(b+"@").first().then(function(a){return a==null?d("WAResultOrError").makeError("missing"):d("WAResultOrError").makeResult(a)})}function f(a,b){return a.threads["delete"](b).then(function(){})}function l(a,b){return a.participants.where("userJid").equals(b).toArray().then(function(b){b=b.map(function(a){return a.threadId});return a.threads.bulkGet(b).then(function(a){return a.filter(Boolean)})})}function m(a,b){return a.participants.where("userJid").anyOf(b).toArray().then(function(b){var c=new Map();b.forEach(function(a){var b;c.has(a.userJid)||c.set(a.userJid,[]);(b=c.get(a.userJid))==null?void 0:b.push(a.threadId)});b=Array.from(c.values()).reduce(function(a,b){return a.concat(b)},[]);b=Array.from(new Set(b));return a.threads.bulkGet(b).then(function(a){return a.reduce(function(a,b){b!=null&&b.chatId!=null&&a.set(b.chatId,b);return a},new Map())}).then(function(a){return new Map(Array.from(c.entries()).map(function(b){var c=b[0];b=b[1];return[c,b.map(function(b){return a.get(b)}).filter(Boolean)]}))})})}function n(a,b,c){return d("MAWDbMsgTxns").IS_SORT_ORDER_COMPARISON_ENABLED?(b==null?void 0:b.lastReadMsgReceiptSent)==null?d("MAWDexieTable").dexieResolve(!1):d("MAWDbMsgTxns").getSortOrderFromMsgId(a,b.lastReadMsgReceiptSent).then(function(a){return c.sortOrderMs==null||a==null?!1:c.sortOrderMs<=a}):d("MAWDexieTable").dexieResolve(b==null||b.lastReadMsgReceiptSent==null?!1:c.msgId<=b.lastReadMsgReceiptSent)}function o(a,b){return a.threads.get(b.thread).then(function(c){return n(a,c,b)})}function p(a,b){var c=b.map(function(a){return a.thread});return a.threads.bulkGet(c).then(function(c){return d("MAWDexieTable").dexieAll(d("WAArrayZip").zip(b,c).map(function(b){var c=b[0];b=b[1];return n(a,b,c)}))})}function q(a,b,c){return a.threads.bulkGet(b).then(function(b){var e=b.filter(Boolean).map(function(a){return babelHelpers["extends"]({},a,{archived:!0,cannotReplyReason:c?"viewer_not_subscribed":a.cannotReplyReason,folder:d("MAWFolderTypes").FOLDER_ID.ARCHIVED})});return a.threads.bulkPut(e).then(function(){e.forEach(function(a){c&&d("WALogger").LOG(["[Occamadillo] Leaving a group thread\n          "+a.jid.toString()+", showing a VIEWER_NOT_SUBSCRIBED composer blocker"]),d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread({cannotReplyReason:a.cannotReplyReason,folder:d("MAWFolderTypes").FOLDER_ID.ARCHIVED,threadId:a.chatId,threadJid:a.jid})})})})})}function r(a,b){return a.threads.bulkGet(b).then(function(c){var b=c.filter(Boolean).map(function(a){return babelHelpers["extends"]({},a,{cannotReplyReason:null})});return a.threads.bulkPut(b).then(function(){b.forEach(function(a){a={cannotReplyReason:null,threadId:a.chatId,threadJid:a.jid};d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread(a)})})})})}function s(a,b){return a.threads.bulkGet(b).then(function(b){var c=b.filter(Boolean).map(function(a){return babelHelpers["extends"]({},a,{archived:!1,cannotReplyReason:a.cannotReplyReason==="viewer_not_subscribed"?a.cannotReplyReason:null,folder:d("MAWFolderTypes").FOLDER_ID.INBOX})});return a.threads.bulkPut(c).then(function(){c.forEach(function(a){d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread({cannotReplyReason:a.cannotReplyReason,folder:d("MAWFolderTypes").FOLDER_ID.INBOX,threadId:a.chatId,threadJid:a.jid})})})})})}function t(a,b){return a.threads.bulkGet(b)}function u(a,b){return a.threads.bulkGet(b).then(function(b){var c=b.filter(Boolean).map(function(a){return babelHelpers["extends"]({},a,{cannotReplyReason:"viewer_not_subscribed"})});return a.threads.bulkPut(c).then(function(){c.forEach(function(a){var b={cannotReplyReason:"viewer_not_subscribed",threadId:a.chatId,threadJid:a.jid};d("WALogger").LOG(["[Occamadillo] User is unsubscribed from thread\n          "+a.jid.toString()+", showing a VIEWER_NOT_SUBSCRIBED composer blocker"]);d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread(b)})})})})}function v(a,b){return k(a,b).then(function(b){if(!b.success){d("WALogger").WARN(j());return}b=b.value;if(b.isMigratedLocally===!0){d("WALogger").WARN(i());return}b=babelHelpers["extends"]({},b,{isMigratedLocally:!0});return a.threads.put(b).then(function(){})})}function w(a,b){if(b.isMigratedLocally===!1){d("WALogger").WARN(h());return d("MAWDexieTable").dexieResolve(b)}var c=babelHelpers["extends"]({},b,{isMigratedLocally:!1});return a.threads.put(c).then(function(){return c})}function x(a,b){return a.threads.put(b).then(function(){})}function y(a,b,c,e,f,g){c=c===(e==null?void 0:e.msgId);f=f===(g==null?void 0:g.msgId);return c&&f?d("MAWDexieTable").dexieResolve():a.threads.update(b.chatId,{newestMsg:g==null?void 0:g.msgId,newestMsgTs:f?b.newestMsgTs:(g==null?void 0:g.ts)==null?null:d("WATimeUtils").castUnixTimeToMillisTime(g.ts),oldestMsg:e==null?void 0:e.msgId})}g.getThread=a;g.getThreadByDeduplicationKey=b;g.getThreadByJid=k;g.getThreadsByJids=c;g.getThreadByJidPrimaryId=e;g.deleteThreadRow=f;g.getAllThreadsForUser=l;g.getAllThreadsForUsers=m;g.needsRetroactiveReadReceiptInThread=o;g.bulkNeedsRetroactiveReadReceiptInThread=p;g.archiveThreads=q;g.subscribeToThreads=r;g.unarchiveThreads=s;g.getThreads=t;g.unsubscribeFromThreads=u;g.markCutoverThreadAsMigratedLocally=v;g.markCutoverThreadAsNotMigratedLocally=w;g.updateThread=x;g.updateThreadMsgsForUndefinedOldestOrNewestMsgs=y}),98);
__d("MAWDbMediaTxns",["MAWDbMsg","MAWDexieTable","MAWMediaUtils","MAWMsgType","WALogger","WAResultOrError","err"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["mediaId is null for media msg with msgId: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["mediaId is null for media msg with msgId: ",""]);i=function(){return a};return a}function a(a,b){return b==null?d("MAWDexieTable").dexieResolve():a.media.get({mediaId:b})}function j(a,b){return a.media.where("hashedPlaintextHash").equals(b).first()}function b(a,b){b=d("MAWMediaUtils").genHMACPlaintextHash(b);return j(a,b)}function e(a,b){return a.media.where("hashedPlaintextHash").anyOf(b).toArray()}function f(a,b){return b==null?d("MAWDexieTable").dexieResolve():k(a,b).then(function(c){c=c==null?void 0:c.mediaId;return c!=null?a.media.get({mediaId:c}):a.media.get({objectId:b})})}function k(a,b){return b==null?d("MAWDexieTable").dexieResolve():a.mediaBackup.get({objectId:b})}function l(a,b){a=a.mediaBackup.where("objectId").anyOf(b).toArray();return a.then(function(a){return new Map(a.map(function(a){return[a.objectId,a]}))})}function m(a,b){return l(a,b).then(function(b){b=Array.from(b.values()).map(function(a){return a.mediaId});return a.media.bulkGet(b)})}function n(a,b){if(b==null)return d("MAWDexieTable").dexieResolve();a=a.mediaBackup.where("msgId").equals(b).toArray();return a}function o(a,b){if(b.length===0)return d("MAWDexieTable").dexieResolve([]);b=b.filter(d("MAWDbMsg").isMediaMsg);var e=b.reduce(function(a,b){if(b.mediaId==null){d("WALogger").ERROR(i(),b.msgId);return a}return a.set(b.mediaId,b)},new Map());b=Array.from(e.keys());return r(a,b).then(function(a){var b=[];a.forEach(function(a){if(a==null)throw c("err")("Error missing media");var d=e.get(a.mediaId);if(d==null)throw c("err")("Error missing media");b.push([d,a])});return b})}function p(a,b){if(b.length===0)return d("MAWDexieTable").dexieResolve([]);b=b.filter(d("MAWDbMsg").isMediaMsg).map(function(a){var b=a.mediaId;if(b==null){d("WALogger").ERROR(h(),a.msgId);throw c("err")("mediaId is missing")}else return b});return r(a,b).then(function(a){var b=[];a.forEach(function(a){a!=null&&b.push(a)});return b})}function q(a,b){if(b.type===d("MAWMsgType").MSG_TYPE.DELETE_FOR_ME||d("MAWDbMsg").isMediaMsg(b)){var c=b.mediaId;return c==null?b.type===d("MAWMsgType").MSG_TYPE.DELETE_FOR_ME?d("MAWDexieTable").dexieResolve(d("WAResultOrError").makeResult()):d("MAWDexieTable").dexieResolve(d("WAResultOrError").makeError("missing")):a.media.get(c).then(function(a){return a==null?d("WAResultOrError").makeError("missing"):d("WAResultOrError").makeResult(a)})}else return d("MAWDexieTable").dexieResolve(d("WAResultOrError").makeResult())}function r(a,b){return a.media.bulkGet(b)}function s(a,b){var c=b.previewMediaIds!=null?r(a,b.previewMediaIds):d("MAWDexieTable").dexieResolve(),e=b.headerMediaId!=null?a.media.get(b.headerMediaId):d("MAWDexieTable").dexieResolve();a=b.faviconMediaId!=null?a.media.get(b.faviconMediaId):d("MAWDexieTable").dexieResolve();return d("MAWDexieTable").dexieAll([c,e,a]).then(function(a){var c=a[0],e=a[1];a=a[2];if(b.headerMediaId!=null&&e==null)return d("WAResultOrError").makeError("missing");if(b.faviconMediaId!=null&&a==null)return d("WAResultOrError").makeError("missing");if(c==null)return d("WAResultOrError").makeError("missing");var f=[];for(var c=c,g=Array.isArray(c),h=0,c=g?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i;if(g){if(h>=c.length)break;i=c[h++]}else{h=c.next();if(h.done)break;i=h.value}i=i;if(i==null)return d("WAResultOrError").makeError("missing");else f.push(i)}return d("WAResultOrError").makeResult({favicon:a,header:e,previews:f})})}function t(a,b,c){b=babelHelpers["extends"]({},b,c);return a.media.put(b)}g.maybeGetMediaFromMediaId=a;g.maybeGetMediaFromHashedPlaintextHash=j;g.maybeGetMediaFromPlaintextHash=b;g.maybeBulkGetMediaFromHashedPlaintextHash=e;g.maybeGetMediaFromObjectId=f;g.maybeGetMediaBackupRowFromObjectId=k;g.maybeGetMediaBackupRowsFromObjectIds=l;g.maybeGetBulkMediaFromObjectIds=m;g.maybeGetMediaBackupRowFromMsgId=n;g.getMsgMediaPairFromMsgs=o;g.getMediaFromMsgs=p;g.getAndCheckMediaFromMsg=q;g.bulkGetMedias=r;g.getMediaForXMA=s;g.updateMedia=t}),98);
__d("MAWDbXMATxns",["MAWDbMediaTxns","MAWDbMsg","MAWDbMsgTxns","MAWDbThreadTxns","MAWDexieTable","MAWJidUtils","MAWXMAUtils","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return a.xma.bulkGet(b)}function b(a,b){return b==null?d("MAWDexieTable").dexieResolve():a.xma.get({xmaId:b})}function h(a,b){return b==null?d("MAWDexieTable").dexieResolve():a.xma.where("associatedMessageId").equals(b).first()}function i(a,b){return b==null?d("MAWDexieTable").dexieResolve():a.xma.where("externalId").equals(b.externalId).filter(function(a){return a.author===b.author&&a.threadJid===b.chat}).first()}function c(a,b){return i(a,b).then(function(b){return b==null?d("WAResultOrError").makeError("missing"):d("MAWDexieTable").dexieAll([d("MAWDbMediaTxns").getMediaForXMA(a,b),d("MAWDbMsgTxns").maybeGetMsg(a,b.associatedMessageId)]).then(function(a){var c=a[0];a=a[1];if(!c.success)return d("WAResultOrError").makeError("missing");c=c.value;var e=c.favicon,f=c.header;c=c.previews;return d("WAResultOrError").makeResult({associatedMessage:a,favicon:e,header:f,previews:c,xma:b})})})}function e(a,b){return h(a,b).then(function(b){if(b==null)return;return d("MAWDbMsgTxns").maybeGetMsg(a,b.msgId)})}function f(a,b){if(b.length===0)return d("MAWDexieTable").dexieResolve([]);b=b.filter(d("MAWDbMsg").isXMAMsg).map(function(a){return d("MAWJidUtils").maybeToProtocolMsgId(a.author,a.threadJid,a.externalId)}).filter(Boolean);b=b.map(function(b){return i(a,b)});return d("MAWDexieTable").dexieAll(b).then(function(a){return a.filter(Boolean)})}function j(a,b){return a.xma.where("associatedMessageId").anyOf(b).toArray().then(function(a){a=a.filter(function(a){return a.msgId!=null&&d("MAWXMAUtils").isXMAShare(a.targetType)});return a.reduce(function(a,b){return b.associatedMessageId!=null&&b.msgId!=null?a.set(b.associatedMessageId,b.msgId):a},new Map())})}function k(a,b){return a.xma.where("associatedMessageId").equals(b).first()}function l(a,b){return a.xma.where("associatedMessageId").equals(b).first().then(function(b){if(b==null)return;b=d("MAWJidUtils").maybeToProtocolMsgId(b.author,b.threadJid,b.externalId);if(b==null)return;return d("MAWDbMsgTxns").maybeGetMsgByProtocolMsgId(a,b)})}function m(a,b){return k(a,b).then(function(b){return b==null?d("WAResultOrError").makeResult():d("MAWDexieTable").dexieAll([d("MAWDbMediaTxns").getMediaForXMA(a,b),d("MAWDbMsgTxns").maybeGetMsg(a,b.associatedMessageId)]).then(function(a){var c=a[0];a=a[1];if(!c.success)return d("WAResultOrError").makeError("missing");c=c.value;var e=c.favicon,f=c.header;c=c.previews;return d("WAResultOrError").makeResult({associatedMessage:a,favicon:e,header:f,previews:c,xma:b})})})}function n(a,b,c){return d("MAWDbThreadTxns").getThreadByJid(a,c).then(function(c){if(!c.success)return;c=c.value;if(b==null)return d("MAWDexieTable").dexieResolve();c={author:b.author,chat:c.jid,externalId:b.externalId};return d("MAWDbMsgTxns").maybeGetMsgByProtocolMsgId(a,c)})}g.bulkGetXMAs=a;g.maybeGetXMAFromXMAId=b;g.maybeGetXMAFromAssociatedMsgId=h;g.maybeGetXMAFromProtocolMsgId=i;g.maybeGetXMAPayloadFromProtocolMsgId=c;g.getDbXMAMsgFromAssociatedMsgId=e;g.getXMAFromMsgs=f;g.getXMAMsgIdsFromAssociatedMsgIds=j;g.maybeGetDbXMAMsgByAssociatedMsgId=l;g.maybeGetXMAPayloadFromAssociatedMsgId=m;g.maybeGetAssociatedXMAMsg=n}),98);
__d("MAWUpdateThreadMsgMetadataApi",["MAWDbThreadTxns","MAWDexieTable","MAWIndexedDb","MAWTransactionMode","WALogger","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["updated oldestMsg from id "," to id "," when oldestMsg is undefined"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["updated newestMsg from id "," to id ",", and newestMsgTs from "," to "," when newestMsg is undefined"]);i=function(){return a};return a}a=d("MAWIndexedDb").makeMsgrTransactor({threads:d("MAWTransactionMode").READWRITE},"updateThreadMsgMetadataApiTransactor",function(a){return function(b,c,e,f,g){var j=c===(e==null?void 0:e.msgId),k=f===(g==null?void 0:g.msgId);if(j&&k)return d("MAWDexieTable").dexieResolve();k||d("WALogger").ERROR(i(),f,g==null?void 0:g.msgId,b.newestMsgTs,(g==null?void 0:g.ts)==null?null:d("WATimeUtils").castUnixTimeToMillisTime(g.ts));j||d("WALogger").ERROR(h(),c,e==null?void 0:e.msgId);return d("MAWDbThreadTxns").updateThreadMsgsForUndefinedOldestOrNewestMsgs(a,b,c,e,f,g).then(function(){})}});b=a;g["default"]=b}),98);
__d("WAArmadilloApplication.pb",["WAArmadilloXMA.pb","WACommon.pb","WAProtoConst"],(function(a,b,c,d,e,f,g){var h,i;a={ES_OPEN:1,ES_CLOSE:2};b={PAYMENT_UNKNOWN:-1,REQUEST_INITED:4,REQUEST_DECLINED:5,REQUEST_TRANSFER_INITED:6,REQUEST_TRANSFER_COMPLETED:7,REQUEST_TRANSFER_FAILED:8,REQUEST_CANCELED:9,REQUEST_EXPIRED:10,TRANSFER_INITED:11,TRANSFER_PENDING:12,TRANSFER_PENDING_RECIPIENT_VERIFICATION:13,TRANSFER_CANCELED:14,TRANSFER_COMPLETED:15,TRANSFER_NO_RECEIVER_CREDENTIAL_NO_RTS_PENDING_CANCELED:16,TRANSFER_NO_RECEIVER_CREDENTIAL_NO_RTS_PENDING_OTHER:17,TRANSFER_REFUNDED:18,TRANSFER_PARTIAL_REFUND:19,TRANSFER_CHARGED_BACK:20,TRANSFER_EXPIRED:21,TRANSFER_DECLINED:22,TRANSFER_UNAVAILABLE:23};c={SCREENSHOT_IMAGE:1,SCREEN_RECORDING:2};e={PLAYED:0,SCREENSHOT:1,FORCE_DISABLE:2};f={VIEW_ONCE:0,ALLOW_REPLAY:1,KEEP_IN_CHAT:2};var j={SMALL_LIKE:1,MEDIUM_LIKE:2,LARGE_LIKE:3},k={},l={},m={},n={},o={},p={},q={},r={},s={},t={},u={},v={},w={},x={},y={},z={},A={},B={},C={},D={},E={},F={},G={},H={},I={},J={},K={},L={},M={};k.internalSpec={payload:[1,(h=d("WAProtoConst")).TYPES.MESSAGE,m],metadata:[2,h.TYPES.MESSAGE,l]};l.internalSpec={};m.internalSpec={content:[1,h.TYPES.MESSAGE,D],applicationData:[2,h.TYPES.MESSAGE,r],signal:[3,h.TYPES.MESSAGE,o],subProtocol:[4,h.TYPES.MESSAGE,n],__oneofs__:{payload:["content","applicationData","signal","subProtocol"]}};n.internalSpec={futureProof:[1,h.TYPES.ENUM,(i=d("WACommon.pb")).FUTURE_PROOF_BEHAVIOR]};o.internalSpec={encryptedBackupsSecrets:[1,h.TYPES.MESSAGE,p],__oneofs__:{signal:["encryptedBackupsSecrets"]}};p.internalSpec={backupId:[1,h.TYPES.UINT64],serverDataId:[2,h.TYPES.UINT64],epoch:[3,h.FLAGS.REPEATED|h.TYPES.MESSAGE,q],tempOcmfClientState:[4,h.TYPES.BYTES],mailboxRootKey:[5,h.TYPES.BYTES],obliviousValidationToken:[6,h.TYPES.BYTES]};q.internalSpec={id:[1,h.TYPES.UINT64],anonId:[2,h.TYPES.BYTES],rootKey:[3,h.TYPES.BYTES],status:[4,h.TYPES.ENUM,a]};r.internalSpec={metadataSync:[1,h.TYPES.MESSAGE,C],aiBotResponse:[2,h.TYPES.MESSAGE,s],__oneofs__:{applicationData:["metadataSync","aiBotResponse"]}};s.internalSpec={summonToken:[1,h.TYPES.STRING],messageText:[2,h.TYPES.STRING],serializedExtras:[3,h.TYPES.STRING]};t.internalSpec={actionTimestamp:[1,h.TYPES.INT64],chatAction:[101,h.TYPES.MESSAGE,w],messageAction:[102,h.TYPES.MESSAGE,u],__oneofs__:{actionType:["chatAction","messageAction"]}};u.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec],messageDelete:[101,h.TYPES.MESSAGE,v],__oneofs__:{action:["messageDelete"]}};v.internalSpec={};w.internalSpec={chatId:[1,h.TYPES.STRING],chatArchive:[101,h.TYPES.MESSAGE,z],chatDelete:[102,h.TYPES.MESSAGE,y],chatRead:[103,h.TYPES.MESSAGE,x],__oneofs__:{action:["chatArchive","chatDelete","chatRead"]}};x.internalSpec={messageRange:[1,h.TYPES.MESSAGE,B],read:[2,h.TYPES.BOOL]};y.internalSpec={messageRange:[1,h.TYPES.MESSAGE,B]};z.internalSpec={messageRange:[1,h.TYPES.MESSAGE,B],archived:[2,h.TYPES.BOOL]};A.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec],timestamp:[2,h.TYPES.INT64]};B.internalSpec={lastMessageTimestamp:[1,h.TYPES.INT64],lastSystemMessageTimestamp:[2,h.TYPES.INT64],messages:[3,h.FLAGS.REPEATED|h.TYPES.MESSAGE,A]};C.internalSpec={actions:[2,h.FLAGS.REPEATED|h.TYPES.MESSAGE,t]};D.internalSpec={commonSticker:[1,h.TYPES.MESSAGE,M],screenshotAction:[3,h.TYPES.MESSAGE,I],extendedContentMessage:[4,h.TYPES.MESSAGE,d("WAArmadilloXMA.pb").ExtendedContentMessageSpec],ravenMessage:[5,h.TYPES.MESSAGE,L],ravenActionNotifMessage:[6,h.TYPES.MESSAGE,K],extendedMessageContentWithSear:[7,h.TYPES.MESSAGE,J],imageGalleryMessage:[8,h.TYPES.MESSAGE,H],paymentsTransactionMessage:[10,h.TYPES.MESSAGE,E],bumpExistingMessage:[11,h.TYPES.MESSAGE,G],noteReplyMessage:[13,h.TYPES.MESSAGE,F],__oneofs__:{content:["commonSticker","screenshotAction","extendedContentMessage","ravenMessage","ravenActionNotifMessage","extendedMessageContentWithSear","imageGalleryMessage","paymentsTransactionMessage","bumpExistingMessage","noteReplyMessage"]}};E.internalSpec={transactionId:[1,h.TYPES.UINT64],amount:[2,h.TYPES.STRING],currency:[3,h.TYPES.STRING],paymentStatus:[4,h.TYPES.ENUM,b],extendedContentMessage:[5,h.TYPES.MESSAGE,d("WAArmadilloXMA.pb").ExtendedContentMessageSpec]};F.internalSpec={noteId:[1,h.TYPES.STRING],noteText:[2,h.TYPES.MESSAGE,i.MessageTextSpec],noteTimestampMs:[3,h.TYPES.INT64],textContent:[4,h.TYPES.MESSAGE,i.MessageTextSpec],stickerContent:[5,h.TYPES.MESSAGE,i.SubProtocolSpec],videoContent:[6,h.TYPES.MESSAGE,i.SubProtocolSpec],__oneofs__:{noteReplyContent:["textContent","stickerContent","videoContent"]}};G.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec]};H.internalSpec={images:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,i.SubProtocolSpec]};I.internalSpec={screenshotType:[1,h.TYPES.ENUM,c]};J.internalSpec={searId:[1,h.TYPES.STRING],payload:[2,h.TYPES.BYTES],nativeUrl:[3,h.TYPES.STRING],searAssociatedMessage:[4,h.TYPES.MESSAGE,i.SubProtocolSpec],searSentWithMessageId:[5,h.TYPES.STRING]};K.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec],actionTimestamp:[2,h.TYPES.INT64],actionType:[3,h.TYPES.ENUM,e]};L.internalSpec={ephemeralType:[1,h.TYPES.ENUM,f],imageMessage:[2,h.TYPES.MESSAGE,i.SubProtocolSpec],videoMessage:[3,h.TYPES.MESSAGE,i.SubProtocolSpec],__oneofs__:{mediaContent:["imageMessage","videoMessage"]}};M.internalSpec={stickerType:[1,h.TYPES.ENUM,j]};g.ARMADILLO_SIGNAL_ENCRYPTED_BACKUPS_SECRETS_EPOCH_EPOCH_STATUS=a;g.ARMADILLO_CONTENT_PAYMENTS_TRANSACTION_MESSAGE_PAYMENT_STATUS=b;g.ARMADILLO_CONTENT_SCREENSHOT_ACTION_SCREENSHOT_TYPE=c;g.ARMADILLO_CONTENT_RAVEN_ACTION_NOTIF_MESSAGE_ACTION_TYPE=e;g.ARMADILLO_CONTENT_RAVEN_MESSAGE_EPHEMERAL_TYPE=f;g.ARMADILLO_CONTENT_COMMON_STICKER_STICKER_TYPE=j;g.ArmadilloSpec=k;g.Armadillo$MetadataSpec=l;g.Armadillo$PayloadSpec=m;g.Armadillo$SubProtocolPayloadSpec=n;g.Armadillo$SignalSpec=o;g.Armadillo$Signal$EncryptedBackupsSecretsSpec=p;g.Armadillo$Signal$EncryptedBackupsSecrets$EpochSpec=q;g.Armadillo$ApplicationDataSpec=r;g.Armadillo$ApplicationData$AIBotResponseMessageSpec=s;g.Armadillo$ApplicationData$MetadataSyncActionSpec=t;g.Armadillo$ApplicationData$MetadataSyncAction$SyncMessageActionSpec=u;g.Armadillo$ApplicationData$MetadataSyncAction$SyncMessageAction$ActionMessageDeleteSpec=v;g.Armadillo$ApplicationData$MetadataSyncAction$SyncChatActionSpec=w;g.Armadillo$ApplicationData$MetadataSyncAction$SyncChatAction$ActionChatReadSpec=x;g.Armadillo$ApplicationData$MetadataSyncAction$SyncChatAction$ActionChatDeleteSpec=y;g.Armadillo$ApplicationData$MetadataSyncAction$SyncChatAction$ActionChatArchiveSpec=z;g.Armadillo$ApplicationData$MetadataSyncAction$SyncActionMessageSpec=A;g.Armadillo$ApplicationData$MetadataSyncAction$SyncActionMessageRangeSpec=B;g.Armadillo$ApplicationData$MetadataSyncNotificationSpec=C;g.Armadillo$ContentSpec=D;g.Armadillo$Content$PaymentsTransactionMessageSpec=E;g.Armadillo$Content$NoteReplyMessageSpec=F;g.Armadillo$Content$BumpExistingMessageSpec=G;g.Armadillo$Content$ImageGalleryMessageSpec=H;g.Armadillo$Content$ScreenshotActionSpec=I;g.Armadillo$Content$ExtendedContentMessageWithSearSpec=J;g.Armadillo$Content$RavenActionNotifMessageSpec=K;g.Armadillo$Content$RavenMessageSpec=L;g.Armadillo$Content$CommonStickerSpec=M}),98);
__d("MAWEphemeralUtils",["MAWEphemeralGatingUtil","MAWGlobals","MAWLocalizationType","WAArmadilloApplication.pb","WAJids","err"],(function(a,b,c,d,e,f,g){"use strict";var h=60,i=60*h,j=24*i;function a(a,b,c,e){var f=[],g=b===j&&d("MAWEphemeralGatingUtil").isSendBasedDisappearingMessageEnabled(),l=a===d("MAWGlobals").getMyUserJid();if(e)e=d("MAWLocalizationType").LOCALIZATION_TYPE.EPHEMERAL_SETTINGS_AUTO_RESET;else if(!l||a==null)b===0?e=d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_OFF:b<h?(e=c?d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_SECONDS:d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_SECONDS,f.push(b.toString())):b<i?(e=c?d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_MINUTES:d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_MINUTES,f.push((b/h).toString())):b<j||g?(e=c?d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_HOURS:d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_HOURS,f.push((b/i).toString())):(e=c?d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_DAYS:d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_DAYS,f.push((b/j).toString()));else{a=d("WAJids").extractUserId(a).toString();b===0?l?e=d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_OFF:(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_OFF,f.push(a)):b<h?(l?e=c?d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_SECONDS:d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_SECONDS:(e=c?d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_SECONDS:d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_SECONDS,f.push(a)),f.push(b.toString())):b<i?(l?e=c?d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_MINUTES:d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_MINUTES:(e=c?d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_MINUTES:d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_MINUTES,f.push(a)),f.push((b/h).toString())):b<j||g?(l?e=c?d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_HOURS:d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_HOURS:(e=c?d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_HOURS:d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_HOURS,f.push(a)),f.push((b/i).toString())):(l?e=c?d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_DAYS:d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_DAYS:(e=c?d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_DAYS:d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_DAYS,f.push(a)),f.push((b/j).toString()))}return{ephemeralSettingChangeContent:f,ephemeralSettingChangeType:k(e)}}function k(a){return!d("MAWEphemeralGatingUtil").isSendBasedDisappearingMessageEnabled()||!(a in l)?a:l[a.toString()]}function b(a,b,e){var f,g=[];b=d("WAJids").extractUserId(b).toString();switch(a){case d("WAArmadilloApplication.pb").ARMADILLO_CONTENT_SCREENSHOT_ACTION_SCREENSHOT_TYPE.SCREENSHOT_IMAGE:e?f=d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_TAKE_SCREENSHOT:(f=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_TAKE_SCREENSHOT,g.push(b));break;case d("WAArmadilloApplication.pb").ARMADILLO_CONTENT_SCREENSHOT_ACTION_SCREENSHOT_TYPE.SCREEN_RECORDING:e?f=d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_RECORD_SCREEN:(f=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_RECORD_SCREEN,g.push(b));break;default:throw c("err")("Received unexpected screenshot action type")}return{ephemeralScreenshotActionContent:g,ephemeralScreenshotActionType:f}}var l=(e={},e[(f=d("MAWLocalizationType")).LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_SECONDS]=f.LOCALIZATION_TYPE.SEND_BASED_UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_SECONDS,e[f.LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_MINUTES]=f.LOCALIZATION_TYPE.SEND_BASED_UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_MINUTES,e[f.LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_HOURS]=f.LOCALIZATION_TYPE.SEND_BASED_UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_HOURS,e[f.LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_DAYS]=f.LOCALIZATION_TYPE.SEND_BASED_UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_DAYS,e[f.LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_SECONDS]=f.LOCALIZATION_TYPE.SEND_BASED_YOU_EPHEMERAL_SETTING_TURNED_ON_SECONDS,e[f.LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_MINUTES]=f.LOCALIZATION_TYPE.SEND_BASED_YOU_EPHEMERAL_SETTING_TURNED_ON_MINUTES,e[f.LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_HOURS]=f.LOCALIZATION_TYPE.SEND_BASED_YOU_EPHEMERAL_SETTING_TURNED_ON_HOURS,e[f.LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_DAYS]=f.LOCALIZATION_TYPE.SEND_BASED_YOU_EPHEMERAL_SETTING_TURNED_ON_DAYS,e[f.LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_SECONDS]=f.LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_SECONDS,e[f.LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_MINUTES]=f.LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_MINUTES,e[f.LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_HOURS]=f.LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_HOURS,e[f.LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_DAYS]=f.LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_DAYS,e[f.LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_SECONDS]=f.LOCALIZATION_TYPE.SEND_BASED_UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_SECONDS,e[f.LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_MINUTES]=f.LOCALIZATION_TYPE.SEND_BASED_UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_MINUTES,e[f.LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_HOURS]=f.LOCALIZATION_TYPE.SEND_BASED_UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_HOURS,e[f.LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_DAYS]=f.LOCALIZATION_TYPE.SEND_BASED_UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_DAYS,e[f.LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_SECONDS]=f.LOCALIZATION_TYPE.SEND_BASED_YOU_EPHEMERAL_SETTING_CHANGE_SECONDS,e[f.LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_MINUTES]=f.LOCALIZATION_TYPE.SEND_BASED_YOU_EPHEMERAL_SETTING_CHANGE_MINUTES,e[f.LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_HOURS]=f.LOCALIZATION_TYPE.SEND_BASED_YOU_EPHEMERAL_SETTING_CHANGE_HOURS,e[f.LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_DAYS]=f.LOCALIZATION_TYPE.SEND_BASED_YOU_EPHEMERAL_SETTING_CHANGE_DAYS,e[f.LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_SECONDS]=f.LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_CHANGE_SECONDS,e[f.LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_MINUTES]=f.LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_CHANGE_MINUTES,e[f.LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_HOURS]=f.LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_CHANGE_HOURS,e[f.LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_DAYS]=f.LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_CHANGE_DAYS,e);g.getEphemeralSettingChangeData=a;g.getEphemeralScreenshotActionData=b}),98);
__d("MAWDbGroupInfoTxns",["MAWBridgeTypesCreators","MAWIndexedDb","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c){return h(a,c.jid).then(function(d){var e=c.participantVersion;d.success&&d.value.participantVersion!=null&&c.participantVersion==null&&(e=d.value.participantVersion);d=c.subject.content;d!=null&&d.length===0&&(d=void 0);var f={creationTs:c.creationTs,creator:c.creator,groupJid:c.jid,inviter:c.inviter,memberAddMode:c.memberAddMode,name:d,nameOwner:c.subject.user,nameTs:c.subject.ts,participantVersion:e,threadId:b};return i(a,f).then(function(){return f})})}function h(a,b){return a.groupInfo.get({groupJid:b}).then(function(a){return a==null?d("WAResultOrError").makeError("missing"):d("WAResultOrError").makeResult(a)})}function i(a,b){return a.groupInfo.put(b).then(function(){d("MAWIndexedDb").afterTransaction({tag:"GroupInfoUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedGroupInfo(b)})})}function b(a,b){return a.groupInfo.bulkPut(b).then(function(){b.forEach(function(a){return d("MAWIndexedDb").afterTransaction({tag:"GroupInfoUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedGroupInfo(a)})})})}function c(a,b){return a.groupInfo.bulkGet(b)}function e(a,b){return a.groupInfo["delete"](b)}g.putGroupInfo=a;g.getGroupInfo=h;g.updateGroupInfo=i;g.bulkUpdateGroupInfo=b;g.getGroupInfos=c;g.deleteGroupInfo=e}),98);
__d("MAWLocalizationUtils",["MAWAckLevel","MAWGlobals","MAWLocalizationType","MAWMsgType","WAJids","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c,e,f){return{ack:d("MAWAckLevel").ACK.sent,altIndex:(f=f)!=null?f:void 0,author:d("WAJids").AUTHOR_SYSTEM,externalId:d("MAWGlobals").getDependencies().generateExternalId(),msgContent:a,thread:b,threadJid:c,ts:(f=e)!=null?f:d("WATimeUtils").unixTime(),type:d("MAWMsgType").MSG_TYPE.ADMIN}}function b(a){switch(a){case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_NAMED_GROUP:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_NAMED_GROUP:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_NAMED_GROUP:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_ONE_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_TWO_PARTICIPANTS:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_MORE_THAN_TWO_PARTICIPANTS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU_AND_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU_AND_MORE_THAN_ONE_USERS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_MORE_THAN_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_ONE_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_TWO_PARTICIPANTS:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_MORE_THAN_TWO_PARTICIPANTS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU_AND_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU_AND_MORE_THAN_ONE_USERS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_MORE_THAN_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_LEFT_GROUP:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SELF_DEMOTED:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_PROMOTED_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_DEMOTED_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_GOT_PROMOTED:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_GOT_DEMOTED:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_GOT_PROMOTED:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_GOT_DEMOTED:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_PROMOTED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_DEMOTED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_PROMOTED_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SELF_DEMOTED:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_DEMOTED_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_UPDATED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_UPDATED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_HOTLIKE:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_THEME:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_PHOTO:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_HOTLIKE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_THEME:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_PHOTO:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_PARTICIPANT_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CLEAR_PARTICIPANT_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_CURRENT_USER_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SET_OWN_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CLEAR_OWN_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CLEAR_PARTICIPANT_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SET_OWN_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CLEAR_OWN_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CLEAR_CURRENT_USER_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_MINUTES:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_MINUTES:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_HOURS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_HOURS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_DAYS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_DAYS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_OFF:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_SECONDS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_SECONDS:case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_MINUTES:case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_CHANGE_MINUTES:case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_HOURS:case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_CHANGE_HOURS:case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_DAYS:case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_CHANGE_DAYS:case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_SECONDS:case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_CHANGE_SECONDS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_TAKE_SCREENSHOT:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_RECORD_SCREEN:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SET_ADD_MODE_ADMIN_ONLY:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SET_ADD_MODE_ALL_MEMBERS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SET_ADD_MODE_ADMIN_ONLY:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SET_ADD_MODE_ALL_MEMBERS:case d("MAWLocalizationType").LOCALIZATION_TYPE.SERVER_SET_ADD_MODE_ADMIN_ONLY:case d("MAWLocalizationType").LOCALIZATION_TYPE.SERVER_SET_ADD_MODE_ALL_MEMBERS:return!0}return!1}function c(a){switch(a){case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_UPDATED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_UPDATED_DEVICE:return!0}return!1}function e(a){switch(a){case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_ONE_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_TWO_PARTICIPANTS:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_MORE_THAN_TWO_PARTICIPANTS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU_AND_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU_AND_MORE_THAN_ONE_USERS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_MORE_THAN_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_YOU_AND_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_YOU_AND_MORE_THAN_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_MORE_THAN_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_ONE_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_TWO_PARTICIPANTS:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_MORE_THAN_TWO_PARTICIPANTS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU_AND_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU_AND_MORE_THAN_ONE_USERS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_MORE_THAN_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_REMOVED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_REMOVED_YOU_AND_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_REMOVED_YOU_AND_MORE_THAN_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_REMOVED_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_REMOVED_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_REMOVED_MORE_THAN_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_LEFT_GROUP:return!0}return!1}g.buildUnstoredDbAdminMsg=a;g.isAdminMsgNormalized=b;g.isDeviceChangeAdminMsg=c;g.isParticipantChangeAdminMsg=e}),98);
__d("MAWThreadSnippetForAdminOrEphemeralMsg",["MAWAdminMsgNormalized","MAWLocalizationUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var c=a.msgContent.adminType;a=d("MAWLocalizationUtils").isAdminMsgNormalized(c)?d("MAWAdminMsgNormalized").deconstructContactIdsFromAdminContent(c,a.msgContent.adminMsgContent):{contactIds:[],contents:a.msgContent.adminMsgContent};var e=a.contactIds;a=a.contents;return{snippetParams:{contactIDs:[].concat(e),strings:[].concat(a)},snippetSenderContactId:b,snippetType:c}}g["default"]=a}),98);
__d("MAWThreadSnippetForDocumentFileMsg",["MAWLocalizationType","WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Document file message can not have AUTHOR_SYSTEM"]);h=function(){return a};return a}function a(a,b){var c,e=d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET;c={contactIDs:[],mentionJIDs:(c=a.msgContent)==null?void 0:c.mentionedJids,strings:[]};d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_ATTACHMENT:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(h()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_ATTACHMENT,c.contactIDs.push(b));return{snippetParams:c,snippetSenderContactId:b,snippetType:e}}g["default"]=a}),98);
__d("MAWThreadSnippetForGifMsg",["MAWLocalizationType","WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Animated message can not have AUTHOR_SYSTEM"]);h=function(){return a};return a}function a(a,b){var c,e=d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET;c={contactIDs:[],mentionJIDs:(c=a.msgContent)==null?void 0:c.mentionedJids,strings:[]};d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_GIF:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(h()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_GIF,c.contactIDs.push(b));return{snippetParams:c,snippetSenderContactId:b,snippetType:e}}g["default"]=a}),98);
__d("MAWThreadSnippetForImageMsg",["MAWLocalizationType","WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Image message can not have AUTHOR_SYSTEM"]);h=function(){return a};return a}function a(a,b){var c,e=d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET;c={contactIDs:[],mentionJIDs:(c=a.msgContent)==null?void 0:c.mentionedJids,strings:[]};d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_IMAGE:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(h()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_IMAGE,c.contactIDs.push(b));return{snippetParams:c,snippetSenderContactId:b,snippetType:e}}g["default"]=a}),98);
__d("MAWThreadSnippetForPttMsg",["MAWLocalizationType","WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Ptt message can not have AUTHOR_SYSTEM"]);h=function(){return a};return a}function a(a,b){var c,e=d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET;c={contactIDs:[],mentionJIDs:(c=a.msgContent)==null?void 0:c.mentionedJids,strings:[]};d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_AUDIO:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(h()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_AUDIO,c.contactIDs.push(b));return{snippetParams:c,snippetSenderContactId:b,snippetType:e}}g["default"]=a}),98);
__d("MAWThreadSnippetForRevokedMsg",["MAWLocalizationType","WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Revoked message can not have AUTHOR_SYSTEM"]);h=function(){return a};return a}function a(a,b){var c,e=d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET;c={contactIDs:[],mentionJIDs:(c=a.msgContent)==null?void 0:c.mentionedJids,strings:[]};d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_UNSENT_MESSAGE:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(h()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_UNSENT_MESSAGE,c.contactIDs.push(b));return{snippetParams:c,snippetSenderContactId:b,snippetType:e}}g["default"]=a}),98);
__d("MAWThreadSnippetForStickerMsg",["MAWLocalizationType","WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Sticker message can not have AUTHOR_SYSTEM"]);h=function(){return a};return a}function a(a,b){var c,e=d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET;c={contactIDs:[],mentionJIDs:(c=a.msgContent)==null?void 0:c.mentionedJids,strings:[]};d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_STICKER:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(h()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_STICKER,c.contactIDs.push(b));return{snippetParams:c,snippetSenderContactId:b,snippetType:e}}g["default"]=a}),98);
__d("MAWThreadSnippetForTextMsg",["MAWLocalizationType","MAWVault","WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Text message can not have AUTHOR_SYSTEM"]);h=function(){return a};return a}function a(a,b,c){var e=d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET,f={contactIDs:[],mentionJIDs:a.msgContent.mentionedJids,strings:[]};d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_TEXT:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(h()):(e=c?d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_TEXT_IN_GROUP:d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_TEXT,f.contactIDs.push(b));if(a.specialTextSize===1||a.specialTextSize===2||a.specialTextSize===3){c=d("MAWVault").unvault(a.msgContent.content);f.strings.push(c==="\ud83d\udc4d"?"(Y)":a.msgContent.content)}else f.strings.push(a.msgContent.content);return{snippetParams:f,snippetSenderContactId:b,snippetType:e}}g["default"]=a}),98);
__d("MAWThreadSnippetForVideoMsg",["MAWLocalizationType","WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Video message can not have AUTHOR_SYSTEM"]);h=function(){return a};return a}function a(a,b){var c,e=d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET;c={contactIDs:[],mentionJIDs:(c=a.msgContent)==null?void 0:c.mentionedJids,strings:[]};d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_VIDEO:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(h()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_VIDEO,c.contactIDs.push(b));return{snippetParams:c,snippetSenderContactId:b,snippetType:e}}g["default"]=a}),98);
__d("MAWThreadSnippetForXMAMsg",["MAWJids","MAWLocalizationType","WAArmadilloXMA.pb","WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Encountered unexpected XMAMessageType when building a thread snippet"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA story mentions must have a target Jid"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]);w=function(){return a};return a}function x(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]);x=function(){return a};return a}function y(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA message does not have xmaMessageType"]);y=function(){return a};return a}function a(a,b){var c,e=d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET;c={contactIDs:[],mentionJIDs:(c=a.msgContent)==null?void 0:c.mentionedJids,strings:[]};a.xmaMessageType==null&&d("WALogger").ERROR(y());switch(a.xmaMessageType){case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_GAMING_CUSTOM_UPDATE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_RECEIVER_FETCH:d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_ATTACHMENT:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(x()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_ATTACHMENT,c.contactIDs.push(b));break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_EXTERNAL_LINK_SHARE:if(d("WAJids").isAuthorMe(a.author)){var f;if(a.msgContent!=null&&((f=a.msgContent)==null?void 0:f.content)!=null){e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_TEXT;c.strings.push((f=a.msgContent)==null?void 0:f.content)}else e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_ATTACHMENT}else if(d("WAJids").isAuthorSystem(a.author)||b==null)d("WALogger").ERROR(w());else{e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_TEXT;c.contactIDs.push(b);if(a.msgContent!=null&&((f=a.msgContent)==null?void 0:f.content)!=null){c.strings.push((f=a.msgContent)==null?void 0:f.content)}}break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_SHARE:d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SENT_STORY:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(v()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SENT_STORY,c.contactIDs.push(b));break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_CLIPS_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_SHORT:d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SENT_REEL:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(u()):e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SENT_REEL;break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_POST_PRIVATE_REPLY:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_MULTIPOST_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SINGLE_IMAGE_POST_SHARE:d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SENT_POST:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(t()):e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SENT_POST;break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_REPLY:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_REACTION:d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SENT_STORY:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(s()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SENT_STORY,c.contactIDs.push(b));break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_HIGHLIGHT_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_HIGHLIGHT_SHARE:d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SENT_STORY_HIGHLIGHT:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(r()):e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SENT_STORY_HIGHLIGHT;break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_MENTION:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_MENTION:if(d("WAJids").isAuthorMe(a.author)){e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_MENTIONED_STORY_IG;f=a.threadJid;var g;f!=null&&(g=d("WAJids").interpretAsUserJid(f));if(g!=null){f=d("MAWJids").userIdFromJid(g);c.contactIDs.push(f)}else d("WALogger").ERROR(q())}else d("WAJids").isAuthorSystem(a.author)?d("WALogger").ERROR(p()):e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_RECEIVED_STORY_MENTION_IG;break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_AUDIO_CALL:d("WAJids").isAuthorMe(a.author)&&b!=null?(e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_AUDIO_CALLED,c.contactIDs.push(b)):d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(o()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_AUDIO_CALLED,c.contactIDs.push(b));break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_VIDEO_CALL:d("WAJids").isAuthorMe(a.author)&&b!=null?(e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_VIDEO_CALLED,c.contactIDs.push(b)):d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(n()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_VIDEO_CALLED,c.contactIDs.push(b));break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_AUDIO_CALL:d("WAJids").isAuthorMe(a.author)&&b!=null?(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_MISSED_AUDIO_CALL,c.contactIDs.push(b)):d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(m()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_MISSED_AUDIO_CALL,c.contactIDs.push(b));break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_VIDEO_CALL:d("WAJids").isAuthorMe(a.author)&&b!=null?(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_MISSED_VIDEO_CALL,c.contactIDs.push(b)):d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(l()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_MISSED_VIDEO_CALL,c.contactIDs.push(b));break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_AUDIO_CALL:d("WAJids").isAuthorMe(a.author)&&b!=null?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_STARTED_GROUP_AUDIO_CALL:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(k()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_STARTED_GROUP_AUDIO_CALL,c.contactIDs.push(b));break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_VIDEO_CALL:d("WAJids").isAuthorMe(a.author)&&b!=null?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_STARTED_GROUP_VIDEO_CALL:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(j()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_STARTED_GROUP_VIDEO_CALL,c.contactIDs.push(b));break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_EVENT:d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SENT_EVENT:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(i()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SENT_EVENT,c.contactIDs.push(b));break;default:d("WALogger").ERROR(h())}return{snippetParams:c,snippetSenderContactId:b,snippetType:e}}g["default"]=a}),98);
__d("MAWEphemeralMsgUtils",[],(function(a,b,c,d,e,f){"use strict";function a(a){return function(b){return!a.has(b.msgId)&&b.ephemeralMsgDisappeared!==!0}}f.filterNonExpiredMsg=a}),66);
__d("MAWThreadSnippetUtils",["MAWEphemeralMsgUtils","MAWLocalizationType","MAWLocalizationUtils","MAWMsgType","MAWXMAUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(a){var b;if(a.type===d("MAWMsgType").MSG_TYPE.REVOKED)return!0;if(d("MAWXMAUtils").isXMAStoryReply(a.xmaMessageType))return!0;b=((b=a.msgContent)==null?void 0:b.adminType)!=null?d("MAWLocalizationUtils").isDeviceChangeAdminMsg(a.msgContent.adminType):!1;if(a.type!==d("MAWMsgType").MSG_TYPE.ADMIN)return!1;a=a.msgContent.adminType;return a===d("MAWLocalizationType").LOCALIZATION_TYPE.DEBUG_MSG?!0:b}function a(a,b,c){return a.messages.where("[threadJid+sortOrderMs]").between([b.jid,Number.MIN_SAFE_INTEGER],[b.jid,Number.MAX_SAFE_INTEGER],!1,!1).filter(function(a){return(c==null||d("MAWEphemeralMsgUtils").filterNonExpiredMsg(c)(a))&&!h(a)}).reverse().first()}g.isDbMsgDisabledForThreadSnippet=h;g.findMostRecentSnippetMsgFromThread=a}),98);
__d("WAProtocolMsgId",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){return a.externalId===b.externalId&&a.author===b.author&&a.chat===b.chat}f.equals=a}),66);
__d("MAWThreadSnippetBuildTxns",["FBLogger","I64","MAWBridgeTypesCreators","MAWCalculateBumpTimestampMs","MAWDbGroupInfoTxns","MAWDbMsg","MAWDexieTable","MAWGlobals","MAWIndexedDb","MAWJidUtils","MAWJids","MAWLocalizationType","MAWMsgType","MAWThreadSnippetForAdminOrEphemeralMsg","MAWThreadSnippetForDocumentFileMsg","MAWThreadSnippetForGifMsg","MAWThreadSnippetForImageMsg","MAWThreadSnippetForPttMsg","MAWThreadSnippetForRevokedMsg","MAWThreadSnippetForStickerMsg","MAWThreadSnippetForTextMsg","MAWThreadSnippetForVideoMsg","MAWThreadSnippetForXMAMsg","MAWThreadSnippetUtils","WAJids","WAProtocolMsgId","WATimeUtils","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a){return/^\d+$/.test(a)}function j(a){if(d("WAJids").isAuthorSystem(a))return;a=d("WAJids").isAuthorMe(a)?d("MAWJids").userIdFromJid(d("MAWGlobals").getMyUserJid()):d("MAWJids").userIdFromJid(a);if(!i(a)){c("FBLogger")("mpf_web_foundations").mustfix("[MAWThreadSnippetBuildTxns] Snippet sender contact id is invalid");return}return a}function k(a,b,e){var f=j(b.author);return d("MAWDexieTable").dexieAll([d("MAWDbGroupInfoTxns").getGroupInfo(a,d("MAWJids").toGroupJid(e.jid))]).then(function(a){a=a[0];a=a.success;switch(b.type){case d("MAWMsgType").MSG_TYPE.TEXT:return c("MAWThreadSnippetForTextMsg")(b,f,a);case d("MAWMsgType").MSG_TYPE.IMAGE:return c("MAWThreadSnippetForImageMsg")(b,f);case d("MAWMsgType").MSG_TYPE.VIDEO:return c("MAWThreadSnippetForVideoMsg")(b,f);case d("MAWMsgType").MSG_TYPE.PTT:return c("MAWThreadSnippetForPttMsg")(b,f);case d("MAWMsgType").MSG_TYPE.ADMIN:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION:return c("MAWThreadSnippetForAdminOrEphemeralMsg")(b,f);case d("MAWMsgType").MSG_TYPE.GIF:return c("MAWThreadSnippetForGifMsg")(b,f);case d("MAWMsgType").MSG_TYPE.STICKER:return c("MAWThreadSnippetForStickerMsg")(b,f);case d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:return c("MAWThreadSnippetForDocumentFileMsg")(b,f);case d("MAWMsgType").MSG_TYPE.REVOKED:return c("MAWThreadSnippetForRevokedMsg")(b,f);case d("MAWMsgType").MSG_TYPE.XMA:return c("MAWThreadSnippetForXMAMsg")(b,f);default:return{snippetParams:{contactIDs:[],strings:[]},snippetSenderContactId:f,snippetType:d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET}}})}function a(a,b,c,e){return d("MAWDexieTable").dexieAll([d("MAWDbGroupInfoTxns").getGroupInfo(a,d("MAWJids").toGroupJid(e))]).then(function(a){a=a[0];a=a.success;return l(b,c,a)})}function l(a,b,e){var f;d("WAJids").isAuthorMe(a)?(c("FBLogger")("mpf_web_foundations").warn("[MAWThreadSnippetBuildTxns] Reaction snippet author should not be @me"),f=d("MAWJids").userIdFromJid(d("MAWGlobals").getMyUserJid())):f=d("MAWJids").userIdFromJid(a);a={contactIDs:[],strings:[]};e=e?d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REACT_MESSAGE_IN_GROUP:d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REACT_MESSAGE;a.contactIDs.push(f);a.strings.push(b);return{snippetParams:a,snippetSenderContactId:f,snippetType:e}}function b(a,b,c,e){var f=c.newestReaction,g=c.reactionsToClear;if(f!=null&&d("WATimeUtils").castUnixTimeToMillisTime(f.ts)>((c=b.snippetMsgTs)!=null?c:0))return d("MAWDexieTable").dexieResolve(m(b,f,e));return g!=null&&b.snippetMsg!=null?a.reactions.get({reactionId:b.snippetMsg}).then(function(c){var e=!1;if(c==null)e=!0;else{var f=d("MAWJidUtils").maybeToProtocolMsgId(c.author,c.threadJid,c.reactToExternalId);f!=null&&(e=g.some(function(a){a=d("MAWJidUtils").maybeToProtocolMsgId(a.author,a.threadJid,a.reactToExternalId);return a!=null&&d("WAProtocolMsgId").equals(a,f)}))}return e?n(a,b):d("MAWDexieTable").dexieResolve(b)}):d("MAWDexieTable").dexieResolve(b)}function m(a,b,e){var f=d("WATimeUtils").castUnixTimeToMillisTime(b.ts);e=l(b.author,b.reaction,e);var g=e.snippetParams,i=e.snippetSenderContactId;e=e.snippetType;if(!c("gkx")("23996"))d("MAWIndexedDb").afterTransaction({tag:"ThreadBumped",value:d("MAWBridgeTypesCreators").createBridgeBumpedThread(a.chatId,a.jid,f,a.lastReadMsgTs,e,g,i,"newReaction",b.externalId)}),d("MAWIndexedDb").afterTransaction({tag:"ThreadBumpedServer",value:{description:"newReaction",isCurrentDeviceSendingMsg:!1,lastActivityTs:f,lastMsgExternalId:(h||(h=d("I64"))).of_string_opt(b.externalId),threadId:a.chatId,threadJid:a.jid}});else{var j=b.externalId!==void 0?(h||(h=d("I64"))).of_string_opt(b.externalId):void 0;f=d("MAWCalculateBumpTimestampMs").calculateBumpTimestampMs(f,j);d("MAWIndexedDb").afterTransaction({tag:"ThreadBumpedV2",value:d("MAWBridgeTypesCreators").createBridgeBumpedThreadV2(a.chatId,a.jid,f,e,g,i,"newReaction",!1)})}return babelHelpers["extends"]({},a,{snippetMsg:b.reactionId,snippetMsgTs:d("WATimeUtils").castUnixTimeToMillisTime(b.ts)})}function n(a,b){return d("MAWThreadSnippetUtils").findMostRecentSnippetMsgFromThread(a,b).then(function(c){if(c==null){d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread({snippetParams:{contactIDs:[],strings:[]},snippetSenderContactId:"0",snippetType:d("MAWLocalizationType").LOCALIZATION_TYPE.EMPTY_SNIPPET,threadId:b.chatId,threadJid:b.jid})});return babelHelpers["extends"]({},b,{snippetMsg:void 0,snippetMsgTs:void 0})}return k(a,c,b).then(function(a){var e=a.snippetParams,f=a.snippetSenderContactId;a=a.snippetType;d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread({snippetParams:e,snippetSenderContactId:f,snippetType:a,threadId:b.chatId,threadJid:b.jid})});return babelHelpers["extends"]({},b,{snippetMsg:c.msgId,snippetMsgTs:d("WATimeUtils").castUnixTimeToMillisTime(d("MAWDbMsg").getCanonicalTsFromMsg(c))})})})}function e(a,b){return n(a,b).then(function(b){return a.threads.put(b).then(function(){})})}g.getSnippetContactId=j;g.buildThreadSnippet=k;g.buildReactionThreadSnippet=a;g.getThreadChangesetForReactionChanges=b;g.refreshThreadSnippet=e}),98);
__d("MAWEphemeralAdminMsgBuildTxns",["MAWAckLevel","MAWBridgeMsg","MAWBridgeTypesCreators","MAWDbMsgTxns","MAWDexieTable","MAWEphemeralUtils","MAWGlobals","MAWIndexedDb","MAWMsgType","MAWThreadSnippetBuildTxns","MAWWriteMsgTxns","WAJids","err"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,e,f,g,h,i,j){if(e<0)throw c("err")("Received unexpected ephemeral time setting");e=d("MAWEphemeralUtils").getEphemeralSettingChangeData(b,e,h,i);h=e.ephemeralSettingChangeContent;i=e.ephemeralSettingChangeType;var k={ack:d("MAWAckLevel").ACK.sent,altIndex:void 0,author:(e=b)!=null?e:d("WAJids").AUTHOR_SYSTEM,msgContent:{adminMsgContent:h,adminType:i,version:1},type:d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN};e=j!=null&&b!=null?d("MAWDbMsgTxns").maybeGetMsgByExternalId(a,j,g.chatId,b):d("MAWDexieTable").dexieResolve();return e.then(function(b){if(b==null){var c,e=babelHelpers["extends"]({},k,{externalId:(c=j)!=null?c:d("MAWGlobals").getDependencies().generateExternalId(),thread:g.chatId,threadJid:g.jid,ts:f});return d("MAWWriteMsgTxns").writeMsg(a,e,g).then(function(a){return babelHelpers["extends"]({},e,{msgId:a.msgId,rowId:a.rowId})})}else if(b.type===d("MAWMsgType").MSG_TYPE.CIPHERTEXT){var h=babelHelpers["extends"]({},b,k);return a.messages.put(h).then(function(){d("MAWIndexedDb").afterTransaction({tag:"DeleteMessages",value:d("MAWBridgeTypesCreators").createBridgeDeleteMessages(b.thread,b.threadJid,[b])});d("MAWIndexedDb").afterTransaction({tag:"NewMsg",value:d("MAWBridgeMsg").createBridgeMsg(h)});return h.msgId===g.newestMsg?d("MAWThreadSnippetBuildTxns").buildThreadSnippet(a,h,g).then(function(a){var b=a.snippetParams,c=a.snippetSenderContactId;a=a.snippetType;d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread({snippetParams:b,snippetSenderContactId:c,snippetType:a,threadId:g.chatId,threadJid:g.jid})});return h}):h})}else return null})}function b(a,b,c,e,f,g,h){var i=b===d("MAWGlobals").getMyUserJid(),j=d("MAWEphemeralUtils").getEphemeralScreenshotActionData(f,b,i),k=j.ephemeralScreenshotActionContent;j=j.ephemeralScreenshotActionType;if(h==null){var l={ack:d("MAWAckLevel").ACK.received,altIndex:void 0,author:i?d("WAJids").AUTHOR_ME:b,externalId:g,msgContent:{adminMsgContent:k,adminType:j,screenshotActionType:f,version:1},thread:c.chatId,threadJid:c.jid,ts:e,type:d("MAWMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION};return d("MAWWriteMsgTxns").writeMsg(a,l,c).then(function(a){return babelHelpers["extends"]({},l,{msgId:a.msgId,rowId:a.rowId})})}else if(h.type===d("MAWMsgType").MSG_TYPE.CIPHERTEXT){var m=babelHelpers["extends"]({},h,{ack:d("MAWAckLevel").ACK.received,altIndex:void 0,author:i?d("WAJids").AUTHOR_ME:b,msgContent:{adminMsgContent:k,adminType:j,screenshotActionType:f,version:1},type:d("MAWMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION});return a.messages.put(m).then(function(){d("MAWIndexedDb").afterTransaction({tag:"DeleteMessages",value:d("MAWBridgeTypesCreators").createBridgeDeleteMessages(h.thread,h.threadJid,[h])});d("MAWIndexedDb").afterTransaction({tag:"NewMsg",value:d("MAWBridgeMsg").createBridgeMsg(m)});return m.msgId===c.newestMsg?d("MAWThreadSnippetBuildTxns").buildThreadSnippet(a,m,c).then(function(a){var b=a.snippetParams,e=a.snippetSenderContactId;a=a.snippetType;d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread({snippetParams:b,snippetSenderContactId:e,snippetType:a,threadId:c.chatId,threadJid:c.jid})});return m}):m})}else return d("MAWDexieTable").dexieResolve(null)}g.writeEphemeralSettingAdminMsg=a;g.writeEphemeralScreenshotActionMsg=b}),98);
__d("MAWBridgeMsgCountdown",["MAWDbMsg","MAWLoggerUtils","WATagsLogger","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["createBridgeMsgsStartCountdown: msg ",", expiration ",", ms until countdown ",", duration ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Calling the messages starting countdown bridge event with remaning time less or equal to 0 (expired message)"]);i=function(){return a};return a}var j=d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.Ephemeral,d("MAWLoggerUtils").Tag.Countdown]);function a(a){return{msgs:a.map(function(a){var b,c=a.messageExpirationTs;b=(b=a.ephemeralSetting)==null?void 0:b.ephemeralExpirationInSec;if(c==null||b==null)return;var e=d("WATimeUtils").cappedMillisecondsUntil(c);if(e<=0){j.LOG(i());return}var f=b*1e3;e>f&&(e=f);j.LOG(h(),a.msgId,c,e,b);return{chatId:a.thread,countdownTs:c,millisecondsUntilCountdownTs:e,msgId:a.msgId,threadJid:a.threadJid,ts:d("MAWDbMsg").getCanonicalTsFromMsg(a)}}).filter(Boolean)}}function b(a,b){return{countdownTs:b,msgId:a}}g.createBridgeMsgsStartCountdown=a;g.createBridgeMsgClearCountdown=b}),98);
__d("MAWMsgCleaner",["MAWLoggerUtils","Promise","WAAssertUnreachable","WAShiftTimer","WATagsLogger","WATimeUtils","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["","::_purgeNow "," msgs' content cleaned"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["","::_purgeNow"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["","::update ",""]);k=function(){return a};return a}a="Unsend";e="Ephemeral";f="DeleteForMe";var l="PendingStanza",m="Xma",n="IGDDM";f={DELETE_FOR_ME:f,EPHEMERAL:e,IGDDM:n,PENDING_STANZA:l,UNSEND:a,XMA:m};e=function(){function a(a,b){var e=this;this.$1=new(d("WAShiftTimer").ShiftTimer)(function(){c("promiseDone")(e.$2())});this.getNextTs=a.getNextTs;this.removeExpired=a.removeExpired;this.cleanerType=b;this.purgeEnabled=a.purgeEnabled;this.$1.forceRunNow()}var e=a.prototype;e.update=function(a){var b=o(this.cleanerType);d("WATagsLogger").TAGS([b,d("MAWLoggerUtils").Tag.MsgCleaner,d("MAWLoggerUtils").Tag.CleanerUpdate]).LOG(k(),b,a);this.$1.onOrBefore(d("WATimeUtils").cappedMillisecondsUntil(a))};e.$2=function(){var a=this;if(!this.purgeEnabled())return(h||(h=b("Promise"))).resolve();var c=o(this.cleanerType);d("WATagsLogger").TAGS([c,d("MAWLoggerUtils").Tag.MsgCleaner,d("MAWLoggerUtils").Tag.CleanerPurge]).LOG(j(),c);return this.removeExpired().then(function(b){b>0&&d("WATagsLogger").TAGS([c,d("MAWLoggerUtils").Tag.MsgCleaner,d("MAWLoggerUtils").Tag.CleanerPurge]).LOG(i(),c,b);return a.getNextTs()}).then(function(b){b!=null&&a.update(b)})};return a}();function o(a){switch(a){case"Unsend":return"UnsendMsgCleaner";case"Ephemeral":return"EphemeralCleaner";case"DeleteForMe":return"DeleteForMeCleaner";case"PendingStanza":return"PendingStanzaCleaner";case"Xma":return"XmaCleaner";case"IGDDM":return"IGDDisappearingMsgCleaner";default:return c("WAAssertUnreachable")(a)}}n=e;g.CLEANER_TYPE=f;g.MsgCleaner=e;g.MSG_CLEANER_FOR_TESTING_ONLY=n}),98);
__d("MAWEphemeralCleaner",["MAWLoggerUtils","MAWMsgCleaner","WATagsLogger","err"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["EphemeralCleaner: Adding timestamps for UI(",") and backend(",")"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["startEphemeralCleaner invoked"]);j=function(){return a};return a}var k=null;function a(a){var b=a.backendFns;a=a.uiFns;d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.Ephemeral,d("MAWLoggerUtils").Tag.MsgCleaner,d("MAWLoggerUtils").Tag.CleanerStart]).LOG(j());if(k==null){var c;k={backend:new((c=d("MAWMsgCleaner")).MsgCleaner)(b,c.CLEANER_TYPE.EPHEMERAL),ui:new c.MsgCleaner(a,c.CLEANER_TYPE.EPHEMERAL)}}}function b(a,b){if(k==null){var e="Trying to add new ephemeral timestamp before the cleaner is initialized!";d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.Ephemeral,d("MAWLoggerUtils").Tag.MsgCleaner,d("MAWLoggerUtils").Tag.CleanerTimestamp]).ERROR(i(),e);throw c("err")(e)}else{e=k;var f=e.backend;e=e.ui;d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.Ephemeral,d("MAWLoggerUtils").Tag.MsgCleaner,d("MAWLoggerUtils").Tag.CleanerTimestamp]).DEV(h(),a,b);e.update(a);f.update(b)}}function e(){return k}function f(){k=null}g.startEphemeralCleaner=a;g.addNewEphemeralTimestamp=b;g.getEphemeralCleaner_FOR_TESTING_ONLY=e;g.resetEphemeralCleaner_FOR_TESTING_ONLY=f}),98);
__d("MAWEphemeralMsgTxns",["MAWBridgeMsgCountdown","MAWBridgeTypesCreators","MAWDbMsg","MAWDbMsgTxns","MAWDbThreadTxns","MAWDbXMATxns","MAWDexieTable","MAWEphemeralCleaner","MAWEphemeralConsts","MAWEphemeralMsgUtils","MAWEphemeralSettingsTxns","MAWIndexedDb","MAWLocalizationType","MAWLoggerUtils","MAWThreadSnippetBuildTxns","MAWThreadSnippetUtils","MAWXMAUtils","WAGetHashFromProtocolMsgId","WAJids","WATagsLogger","WATimeUtils","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["incoming msg is not out of sync"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["incoming msg is out of sync: correct duration ",", correct timestamp ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["incoming msg is ephemeral: duration ",", timestamp ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["incoming msg is non-ephemeral"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["maybeUpdateEphemeralSettingOrCheckOutOfSyncAfterWritingIncomingMsg: Message from ",", chat ",", type ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["trying to update ephemeral timestamp to a later ts then previously set - expiration: "," ",", deletion: ","  ",", storedTs: ",", readTs: ",", ephemeralDuration ","  - ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["updating ephemeral timestamp msg ",", existing expiration ",", existing deletion ",", updated expiration ",", updated deletion ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["markEphemeralMessageAsSent EphemeralCounter: Showing UI counter for ",""]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["bulkMarkEphemeralMessageAsRead EphemeralCounter: Showing UI counter for ",""]);q=function(){return a};return a}var r=d("WATagsLogger").TAGS([(h=d("MAWLoggerUtils")).Tag.Ephemeral,h.Tag.SettingSync,h.Tag.Incoming]),s=d("WATagsLogger").TAGS([h.Tag.Ephemeral,h.Tag.OnRead,h.Tag.Countdown]);function t(a,b,c,e,f){f===void 0&&(f=function(){return!0});b=d("MAWDbMsgTxns").IS_SORT_ORDER_COMPARISON_ENABLED?d("MAWDbMsgTxns").getThreadMessagesBySortOrder(a,b,!1,!0):a.messages.where("msgId").between(c,e,!1,!0);return b.filter(f).limit(1).toArray().then(function(a){return{needsUpdate:!0,value:(a=a[0])!=null?a:null}})}function u(a,b,e){return e.size===0?d("MAWDexieTable").dexieResolve():d("MAWDbThreadTxns").getThread(a,b).then(function(f){if(!f.success)return;var g=f.value,h=g.oldestMsg,i=g.newestMsg;if(h==null||i==null)return;f=d("MAWEphemeralMsgUtils").filterNonExpiredMsg(e);var j=e.has(h)?t(a,g.jid,h,i,f):d("MAWDexieTable").dexieResolve({needsUpdate:!1}),k=c("gkx")("289")?d("MAWDbMsgTxns").getThreadMessagesBySortOrder(a,g.jid,!0,!1):a.messages.where("msgId").between(h,i,!0,!1);k=e.has(i)?k.filter(f).reverse().limit(1).toArray().then(function(b){b=b[0];return b!=null&&d("MAWThreadSnippetUtils").isDbMsgDisabledForThreadSnippet(b)?d("MAWThreadSnippetUtils").findMostRecentSnippetMsgFromThread(a,g,e).then(function(a){return{needsUpdate:!0,value:(a=a)!=null?a:null}}):{needsUpdate:!0,value:(b=b)!=null?b:null}}):d("MAWDexieTable").dexieResolve({needsUpdate:!1});return d("MAWDexieTable").dexieAll([j,k]).then(function(c){var e=c[0],f=c[1];if(!e.needsUpdate&&!f.needsUpdate)return;c=f.needsUpdate?(c=(c=f.value)==null?void 0:c.msgId)!=null?c:void 0:i;var j=f.needsUpdate?f.value!=null?d("WATimeUtils").castUnixTimeToMillisTime(d("MAWDbMsg").getCanonicalTsFromMsg(f.value)):void 0:g.snippetMsgTs,k=babelHelpers["extends"]({},g,{newestMsg:c,oldestMsg:e.needsUpdate?(e=(e=e.value)==null?void 0:e.msgId)!=null?e:null:h,snippetMsg:c,snippetMsgTs:j});return a.threads.put(k).then(function(){if(f.needsUpdate){var c=f.value;if(c==null)d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread({snippetParams:{contactIDs:[],strings:[]},snippetSenderContactId:"0",snippetType:d("MAWLocalizationType").LOCALIZATION_TYPE.EMPTY_SNIPPET,threadId:b,threadJid:k.jid})});else return d("MAWThreadSnippetBuildTxns").buildThreadSnippet(a,c,k).then(function(a){var c=a.snippetParams,e=a.snippetSenderContactId;a=a.snippetType;d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread({snippetParams:c,snippetSenderContactId:e,snippetType:a,threadId:b,threadJid:k.jid})})})}})})})}function a(a,b){var c={};b.map(function(a){var b=a.msgId;a=a.ts;b=d("WAGetHashFromProtocolMsgId").getHashFromProtocolMsgId(b);c[b]=a});return d("MAWDbMsgTxns").getMsgsByProtocolMsgId(a,b.map(function(a){return babelHelpers["extends"]({},a.msgId)})).then(function(b){b=b.map(function(a){var b,e=a.author;if(a.threadJid==null||d("WAJids").isAuthorSystem(e))return null;e=d("WAGetHashFromProtocolMsgId").getHashFromProtocolMsgId({author:e,chat:a.threadJid,externalId:a.externalId});e=c[e];b=(b=a.ephemeralSetting)==null?void 0:b.ephemeralExpirationInSec;if(b==null||b===0)return null;b=d("WATimeUtils").castToUnixTime(e+b);var f=d("WATimeUtils").castToUnixTime(b+d("MAWEphemeralConsts").ephemeralReportingWindowInSeconds);return{messageDeleteTs:f,messageExpirationTs:b,msgId:a.msgId,readTsForLogging:e}}).filter(Boolean);return v(a,b,"bulkMarkEphemeralMessageAsRead")}).then(function(a){var b=a[0],c=a[1];a=a[2];a.length>0&&(s.LOG(q(),a.map(function(a){return a.msgId})),d("MAWIndexedDb").afterTransaction({tag:"MsgsStartCountdown",value:d("MAWBridgeMsgCountdown").createBridgeMsgsStartCountdown(a)}));b!=null&&c!=null&&d("MAWEphemeralCleaner").addNewEphemeralTimestamp(b,c)})}function b(a,b){if(b==null||b.ephemeralSetting==null||b.ephemeralSetting.ephemeralExpirationInSec===0)return d("MAWDexieTable").dexieResolve(b);var c=d("WATimeUtils").castToUnixTime(b.ts+b.ephemeralSetting.ephemeralExpirationInSec),e=d("WATimeUtils").castToUnixTime(c+d("MAWEphemeralConsts").ephemeralReportingWindowInSeconds);return v(a,[{messageDeleteTs:e,messageExpirationTs:c,msgId:b.msgId,readTsForLogging:b.ts}]).then(function(a){var b=a[0],c=a[1];a=a[2];a.length>0&&(s.LOG(p(),a.map(function(a){return a.msgId})),d("MAWIndexedDb").afterTransaction({tag:"MsgsStartCountdown",value:d("MAWBridgeMsgCountdown").createBridgeMsgsStartCountdown(a)}));b!=null&&c!=null&&d("MAWEphemeralCleaner").addNewEphemeralTimestamp(b,c);return a[0]})}function v(a,b,c){var e=b.map(function(a){return a.msgId});return d("MAWDbXMATxns").getXMAMsgIdsFromAssociatedMsgIds(a,e).then(function(d){var f=new Map();b.forEach(function(a){f.set(a.msgId,{messageDeleteTs:a.messageDeleteTs,messageExpirationTs:a.messageExpirationTs,readTsForLogging:a.readTsForLogging});var b=d.get(a.msgId);b!=null&&f.set(b,{messageDeleteTs:a.messageDeleteTs,messageExpirationTs:a.messageExpirationTs,readTsForLogging:a.readTsForLogging})});var g=null,h=null,i=[],j=Array.from(new Set(e.concat(Array.from(d.values()))));return a.messages.where("msgId").anyOf(j).toArray().then(function(b){if(b.length===0)return;b.forEach(function(a){var b=a.messageExpirationTs,d=a.messageDeleteTs,e=f.get(a.msgId),j=e==null?void 0:e.messageExpirationTs,k=e==null?void 0:e.messageDeleteTs;e=e==null?void 0:e.readTsForLogging;s.LOG(o(),a.msgId,b,d,j,k);if(j==null||k==null)return;if(b!=null&&j>b||d!=null&&j>d){s.ERROR(n(),j,b,k,d,a.ts,e,(b=a.ephemeralSetting)==null?void 0:b.ephemeralExpirationInSec,c);return}if(a.ephemeralCounterStarted===!0)return;g==null?g=j:j<g&&(g=j);h==null?h=k:k<h&&(h=k);d=babelHelpers["extends"]({},a,{ephemeralCounterStarted:!0,messageDeleteTs:k,messageExpirationTs:j});i.push(d)});return a.messages.bulkPut(i)}).then(function(){return[g,h,i]})})}function e(a,b){if(b.size===0)return d("MAWDexieTable").dexieResolve();var c=[];b.forEach(function(b,d){c.push(u(a,d,b))});return d("MAWDexieTable").dexieAll(c).then(function(){})}function f(a,b,c){if(b==null||b.ephemeralSetting==null||b.ephemeralSetting.ephemeralExpirationInSec===0)return d("MAWDexieTable").dexieResolve();var e=d("WATimeUtils").castToUnixTime(c+d("MAWEphemeralConsts").ephemeralMaxDelectionWindowForUnseenMessage);return d("MAWDbXMATxns").getDbXMAMsgFromAssociatedMsgId(a,b.msgId).then(function(c){var f=[babelHelpers["extends"]({},b,{messageDeleteTs:e,messageExpirationTs:e})];c!=null&&d("MAWXMAUtils").isXMAShare(c.xmaMessageType)&&f.push(babelHelpers["extends"]({},c,{messageDeleteTs:e,messageExpirationTs:e}));return a.messages.bulkPut(f).then(function(){})})}function w(a,b,c,e,f,g){if(b==null||f==null)return d("MAWDexieTable").dexieResolve();r.LOG(m(),c,e.jid,b.type);var h=d("MAWDexieTable").dexieResolve();if(b.ephemeralSetting==null)d("WAJids").switchOnMsgrChatJidType(e.jid,{group:function(){return d("MAWEphemeralSettingsTxns").maybeResetEphemeralSyncResponseBackoffInfo(a,c).then(function(){})},user:function(){d("MAWDbMsg").isMsgEligibleForTriggeringEphemeralSyncResponse(b)&&(r.LOG(l()),h=d("MAWEphemeralSettingsTxns").getOutOfSyncEphemeralSettingForIncomingNonEphemeralMsg(a,e.jid).then(function(a){return a==null?void 0:(a=a.value)==null?void 0:a.outOfSyncEphemeralSetting}))}});else if(b.messageExpirationTs!=null&&b.messageDeleteTs!=null){var n=b.ephemeralSetting,o=b.messageDeleteTs,p=b.messageExpirationTs;r.LOG(k(),n.ephemeralExpirationInSec,n.ephemeralLastUpdatedOrSetTimestamp);d("MAWEphemeralCleaner").addNewEphemeralTimestamp(p,o);h=d("MAWEphemeralSettingsTxns").handleAndWriteIncomingEphemeralSetting(a,c,f,n.ephemeralExpirationInSec,n.ephemeralLastUpdatedOrSetTimestamp,!1,e,g,null,!0).then(function(a){return a==null?void 0:a.outOfSyncEphemeralSetting})}return h.then(function(b){if(b!=null){r.LOG(j(),b.correctEphemeralExpirationInSec,b.correctEphemeralLastUpdatedOrSetTimestamp);return b}else{r.LOG(i());return d("MAWEphemeralSettingsTxns").maybeResetEphemeralSyncResponseBackoffInfo(a,c).then(function(){})}})}g.bulkMarkEphemeralMessageAsRead=a;g.markEphemeralMessageAsSent=b;g.bulkUpdateEphemeralMessageTimestamps=v;g.updateThreadsOnMessagesExpiredFromUi=e;g.maybeUpdateEphemeralMessageWhenMarkedSent=f;g.syncEphemeralSettingOnIncomingMsg=w}),98);
__d("MAWDbContactsTxns",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){return a.contacts.where("contactJid").anyOf(b).toArray()}function b(a,b){return a.contacts.get({contactJid:b})}f.getContacts=a;f.getContact=b}),66);
__d("MAWEphemeralSettingsCache",["MAWBridge","WATimeUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h=new Map();function i(a,b){h.set(a,b)}function a(a){var b={ephemeralExpirationInSec:0,ephemeralLastUpdatedOrSetTimestamp:d("WATimeUtils").castToUnixTime(0)};return(a=h.get(a))!=null?a:b}function c(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b={ephemeralExpirationInSec:0,ephemeralLastUpdatedOrSetTimestamp:d("WATimeUtils").castToUnixTime(0)};if(!h.has(a)){var c=(yield d("MAWBridge").getBridge().sendAndReceive("event","getLSDBEphemeralSetting",{chatJid:a}));i(a,(a=c)!=null?a:b)}});return j.apply(this,arguments)}g.setEphemeralSettingCache=i;g.getEphemeralSettingCache=a;g.requestLSDBCacheForJid=c}),98);
__d("MAWEphemeralUtil",["MAWAckLevel","MAWBridgeMsgCountdown","MAWGlobals","MAWIndexedDb","MAWLocalizationType","MAWMsgType","WAArmadilloApplication.pb","WAJids","WALogger","err"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["The new ephemeral setting timestamp should be greater than the existing timestamp"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["New ephemeral duration should be different from the existing duration"]);i=function(){return a};return a}function a(a,b,c){var e=d("MAWGlobals").getMyDeviceJid();e=b.ephemeralExpirationInSec!==a.ephemeralExpirationInSec&&b.ephemeralLastUpdatedOrSetTimestamp===a.ephemeralLastUpdatedOrSetTimestamp&&e<=c;return e||a.ephemeralLastUpdatedOrSetTimestamp>b.ephemeralLastUpdatedOrSetTimestamp}function b(a,b,c){if(a==null)return!0;a=a.ephemeralSetting;if(a!=null&&a.ephemeralExpirationInSec===b){d("WALogger").ERROR(i());return!1}if(a!=null&&a.ephemeralLastUpdatedOrSetTimestamp>c){d("WALogger").ERROR(h());return!1}return!0}function e(a){a={ack:d("MAWAckLevel").ACK.sent,altIndex:void 0,author:d("WAJids").AUTHOR_SYSTEM,externalId:d("MAWGlobals").getDependencies().generateExternalId(),msgContent:{adminMsgContent:[],adminType:d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_MINUTES},ts:a,type:d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN};return{unstoredDbMedia:null,unstoredDbMsg:a,unstoredDbReaction:null}}function f(a,b){var e;switch(b){case d("WAArmadilloApplication.pb").ARMADILLO_CONTENT_SCREENSHOT_ACTION_SCREENSHOT_TYPE.SCREENSHOT_IMAGE:e=d("WAArmadilloApplication.pb").ARMADILLO_CONTENT_SCREENSHOT_ACTION_SCREENSHOT_TYPE.SCREENSHOT_IMAGE;break;case d("WAArmadilloApplication.pb").ARMADILLO_CONTENT_SCREENSHOT_ACTION_SCREENSHOT_TYPE.SCREEN_RECORDING:e=d("WAArmadilloApplication.pb").ARMADILLO_CONTENT_SCREENSHOT_ACTION_SCREENSHOT_TYPE.SCREEN_RECORDING;break;default:throw c("err")("Received unexpected screenshot action type")}b={ack:d("MAWAckLevel").ACK.sent,altIndex:void 0,author:d("WAJids").AUTHOR_SYSTEM,externalId:d("MAWGlobals").getDependencies().generateExternalId(),msgContent:{adminMsgContent:[],adminType:d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_TAKE_SCREENSHOT,screenshotActionType:e},ts:a,type:d("MAWMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION};return{unstoredDbMedia:null,unstoredDbMsg:b,unstoredDbReaction:void 0}}function j(a){return d("WAJids").switchOnMsgrChatJidType(a,{group:function(a){throw c("err")("Received invalid chatJid. We only support ephemeral messaging in 1:1 threads.")},user:function(a){return a}})}function k(a){a!=null&&a.messageExpirationTs!=null&&a.ephemeralCounterStarted===!0&&d("MAWIndexedDb").afterTransaction({tag:"MsgClearCountdown",value:d("MAWBridgeMsgCountdown").createBridgeMsgClearCountdown(a.msgId,a.messageExpirationTs)})}g.isLocalSettingOutdated=a;g.shouldUpdateForOutgoingUserEphemeralSettingChange=b;g.buildUnstoredDbEphemeralSettingMsgWithoutContentPlaceholder=e;g.buildUnstoredDbEphemeralScreenshotActionMsgWithoutContentPlaceholder=f;g.getUserJidForEphemeralSetting=j;g.maybeClearEphemeralMsgCountdown=k}),98);
__d("MAWEphemeralSettingsTxns",["MAWDbContactsTxns","MAWDbThreadTxns","MAWDexieTable","MAWEphemeralAdminMsgBuildTxns","MAWEphemeralSettingsCache","MAWEphemeralUtil","MAWGlobals","MAWIndexedDb","MAWJids","MAWLoggerUtils","WAJids","WALogger","WAResultOrError","WATagsLogger","WATimeUtils","err","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["maybeResetEphemeralSyncResponseBackoffInfo reset for ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["maybeResetEphemeralSyncResponseBackoffInfo no op for ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["maybeResetEphemeralSyncResponseBackoffInfo but missing contact for ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Contact "," "," and ephemeral setting "," should not be null when receiving the server ack for outgoing ephemeral setting change"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Writing ephemeral duration "," with ts "," , previous duration "," with ts ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleAndWriteIncomingEphemeralSetting - ephemeral setting in sync"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleAndWriteIncomingEphemeralSetting - Sending Sync Response with duration ",", timestamp ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["Received invalid chat jid for incoming ephemeral settings"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleAndWriteIncomingEphemeralSetting - Handle Incoming Ephemeral Setting duration: ",", lastUpdated: ",""]);q=function(){return a};return a}var r=d("WATagsLogger").TAGS([(h=d("MAWLoggerUtils")).Tag.Ephemeral,h.Tag.SettingChange,h.Tag.Incoming]),s=d("WATagsLogger").TAGS([h.Tag.Ephemeral,h.Tag.SettingChange,h.Tag.Outgoing]);function t(){return c("gkx")("23920")}var u=null;function a(a,b,e,f,g,h,i,j,k,l){if(f<0||f>86400){var s=d("WAJids").interpretAndValidateJid(i.jid).toString();throw c("err")("EphemeralSetting duration is invalid "+f+", jidType: "+s)}var v={ephemeralExpirationInSec:f,ephemeralLastUpdatedOrSetTimestamp:g};d("WALogger").LOG(q(),f,g);s=d("WAJids").interpretAsUserJid(i.jid);var w=t();if(s==null){r.ERROR(p());return d("MAWDexieTable").dexieResolve(u)}var x=d("WAJids").isAuthorMe(b)?d("MAWGlobals").getMyUserJid():b,y=e!=null?d("MAWJids").toDeviceJid(x,e.id):null;return d("MAWDbContactsTxns").getContact(a,s).then(function(c){var e=w?d("MAWEphemeralSettingsCache").getEphemeralSettingCache(i.jid):c==null?void 0:c.ephemeralSetting,p=e==null?void 0:e.ephemeralExpirationInSec,q=e==null?void 0:e.ephemeralLastUpdatedOrSetTimestamp;if(l){if(e!=null&&y!=null&&!d("MAWEphemeralUtil").isLocalSettingOutdated(v,e,y))if(g!==q){d("WALogger").LOG(o(),p,q);return{dbMsg:null,outOfSyncEphemeralSetting:{chatJid:i.jid,correctEphemeralExpirationInSec:e.ephemeralExpirationInSec,correctEphemeralLastUpdatedOrSetTimestamp:e.ephemeralLastUpdatedOrSetTimestamp}}}else{d("WALogger").WARN(n());return u}d("MAWIndexedDb").afterTransaction({tag:"EphemeralSettingsUpdatedForUI",value:{author:d("MAWJids").userIdFromJid(x),chatJid:i.jid,ephemeralSettingArgs:v,isEphemeralSettingReset:h}});if(w)return u}c=babelHelpers["extends"]({},c,{contactJid:(q=c==null?void 0:c.contactJid)!=null?q:x,dhash:(q=c==null?void 0:c.dhash)!=null?q:void 0,ephemeralSetting:v,ephemeralSyncResponseBackoffInfo:void 0});return a.contacts.put(c).then(function(){if(!w&&(e==null||p!==f)){r.LOG(m(),f,g,e==null?void 0:e.ephemeralLastUpdatedOrSetTimestamp,e==null?void 0:e.ephemeralExpirationInSec);var c=(e==null||p===0)&&f>0;return d("MAWEphemeralAdminMsgBuildTxns").writeEphemeralSettingAdminMsg(a,b,f,j,i,c,h,k).then(function(a){return{dbMsg:a}})}else return u})})}function b(a,b,e,f,g){var h=e;if(h<0)throw c("err")("Ephemeral duration should be 0 or more");var i=d("MAWEphemeralUtil").getUserJidForEphemeralSetting(b);return d("MAWDbThreadTxns").getThreadByJid(a,b).then(function(b){return!b.success?{success:!1}:d("MAWDbContactsTxns").getContact(a,i).then(function(c){if(!d("MAWEphemeralUtil").shouldUpdateForOutgoingUserEphemeralSettingChange(c,h,f))return{success:!1};var e,j=!0;if(c==null)e={contactJid:i,dhash:void 0,ephemeralSetting:{ephemeralExpirationInSec:h,ephemeralLastUpdatedOrSetTimestamp:f}};else{var k=c.ephemeralSetting;j=k==null||k.ephemeralExpirationInSec===0;e=babelHelpers["extends"]({},c,{ephemeralSetting:{ephemeralExpirationInSec:h,ephemeralLastUpdatedOrSetTimestamp:f}})}k=t();return d("MAWDexieTable").dexieAll([a.contacts.put(e),k?d("MAWDexieTable").dexieResolve():d("MAWEphemeralAdminMsgBuildTxns").writeEphemeralSettingAdminMsg(a,d("MAWGlobals").getMyUserJid(),h,f,b.value,j,g)]).then(function(){return{success:!0}})})})}function e(a,b,e){var f=d("MAWEphemeralUtil").getUserJidForEphemeralSetting(b);return d("MAWDbContactsTxns").getContact(a,f).then(function(b){if(b==null||b.ephemeralSetting==null){s.ERROR(l(),f,b,b==null?void 0:b.ephemeralSetting);throw c("err")("Contact and ephemeral setting should not be null when receiving the server ack for outgoing ephemeral setting change")}b=babelHelpers["extends"]({},b,{ephemeralSetting:{ephemeralExpirationInSec:b.ephemeralSetting.ephemeralExpirationInSec,ephemeralLastUpdatedOrSetTimestamp:e}});return a.contacts.put(b).then(function(){})})}function f(a,b){var e=[d("WAJids").interpretAsUserJid(b),t()],f=e[0],g=e[1];if(f==null)throw c("err")("Unexpected chatJid input to isEphemeralMessagesEnabledForContact");var h=d("MAWEphemeralSettingsCache").getEphemeralSettingCache(b);return d("MAWDbContactsTxns").getContact(a,f).then(function(a){if(g&&h.ephemeralLastUpdatedOrSetTimestamp===d("WATimeUtils").castToUnixTime(0)||a==null)return d("WAResultOrError").makeError("no_ephemeral_setting");a=g?h:a.ephemeralSetting;return a!=null&&a.ephemeralExpirationInSec>0?d("WAResultOrError").makeResult({outOfSyncEphemeralSetting:{chatJid:b,correctEphemeralExpirationInSec:a.ephemeralExpirationInSec,correctEphemeralLastUpdatedOrSetTimestamp:a.ephemeralLastUpdatedOrSetTimestamp}}):d("WAResultOrError").makeError("no_ephemeral_setting")})}function v(a,b){return d("MAWDbContactsTxns").getContact(a,b).then(function(c){if(c==null){r.ERROR(k(),b);return d("WAResultOrError").makeError("missing_contact")}if(c.ephemeralSyncResponseBackoffInfo==null){r.LOG(j(),b);return d("WAResultOrError").makeResult()}c.ephemeralSyncResponseBackoffInfo=void 0;r.LOG(i(),b);return a.contacts.put(c).then(function(){return d("WAResultOrError").makeResult()})})}g.getOccamMIEnabled=t;g.handleAndWriteIncomingEphemeralSetting=a;g.handleAndWriteOutgoingUserEphemeralSettingChange=b;g.updateContactWhenEphemeralSettingChangeMarkedSent=e;g.getOutOfSyncEphemeralSettingForIncomingNonEphemeralMsg=f;g.maybeResetEphemeralSyncResponseBackoffInfo=v}),98);
__d("MAWBridgeThread",["MAWTimeUtils","WAJids","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c,e){var f=d("WAJids").switchOnMsgrChatJidType(a.jid,{group:function(a){return!0},user:function(a){return!1}});return{authoritativeThreadKey:c,cannotReplyReason:a.cannotReplyReason,chatId:a.chatId,clientThreadKey:b,description:e,folder:a.folder,isGroup:f,jid:a.jid,lastActivityTs:d("MAWTimeUtils").ensureValidMillisTime(a.snippetMsgTs!=null&&d("WATimeUtils").fromMillisTime(a.snippetMsgTs)!==0?a.snippetMsgTs:a.newestMsgTs)||d("WATimeUtils").castToMillisTime(0),lastReadTs:d("MAWTimeUtils").ensureValidMillisTime(a.lastReadMsgTs)||d("WATimeUtils").castToMillisTime(0),muteExpireTimeMs:(c=a.muteExpireTimeMs)!=null?c:0}}function b(a,b,c,d){return{lastActivityTimestampMs:d,lastReadWatermarkTs:c,threadId:b,threadJid:a}}g.createBridgeThread=a;g.createBridgeThreadTimestampsUpdated=b}),98);
__d("MAWGetOrCreateThreadTxns",["MAWAdminMsgTxns","MAWBridgeThread","MAWBridgeTypesCreators","MAWDbThread","MAWDexieTable","MAWFolderTypes","MAWIndexedDb","WATimeUtils","getErrorSafe"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){if(a!=null&&b!=null){var c=d("WATimeUtils").fromMillisTime(a),e=d("WATimeUtils").fromMillisTime(b);return d("WATimeUtils").castToMillisTime(Math.max(c,e))}return(c=a)!=null?c:b}function i(a,b){return a.threads.get({jid:b})}function a(a,b){var c=b.deduplicationKey,e=b.jid;c=b.deduplicationKey!=null?a.threads.get({deduplicationKey:c}):d("MAWDexieTable").dexieResolve();return d("MAWDexieTable").dexieAll([c,i(a,e)]).then(function(c){var d=c[0];c=c[1];if(d!=null)return{created:!1,thread:d};if(c==null)return j(a,b).then(function(a){return{created:!0,thread:a}});else return k(a,b,c).then(function(a){return{created:!1,thread:a}})})}function j(a,b){var e=b.authoritativeThreadKey,f=b.clientThreadKey,g=b.createTs,h=b.deduplicationKey,i=b.description,j=b.folder,k=b.jid,l=b.lastActivityTimestamp,m=b.lastReadWatermarkTimestamp,n=b.skipVerifyThread;b=(l=(b=l)!=null?b:g)!=null?l:d("WATimeUtils").millisTime();g=b!=null?d("WATimeUtils").castToMillisTime(Math.max(b-1,0)):null;m=(l=m)!=null?l:g;var o={authoritativeThreadKey:e!=null?e:void 0,deduplicationKey:h,folder:j!=null?j:d("MAWFolderTypes").FOLDER_ID.INBOX,jid:k,lastReadMsg:null,lastReadMsgReceiptSent:null,lastReadMsgTs:m,newestMsg:null,newestMsgTs:b,oldestMsg:null,optimisticThreadKey:(l=f)!=null?l:void 0,threadOrder:d("MAWDbThread").craftThreadOrder(b,k)};return a.threads.add(o).then(function(b){b=babelHelpers["extends"]({},o,{chatId:b});n!==!0&&d("MAWIndexedDb").afterTransaction({tag:"VerifyThreadExists",value:d("MAWBridgeThread").createBridgeThread(b,b.optimisticThreadKey,e,i)});return d("MAWAdminMsgTxns").writeE2EEThreadDescriptionMsg(a,b)})["catch"](function(a){a=c("getErrorSafe")(a);a.message="Error creating thread: "+a.message;throw a})}function k(a,b,e){var f=b.authoritativeThreadKey,g=b.clientThreadKey,i=b.deduplicationKey,j=b.description,k=b.folder,l=b.lastActivityTimestamp,m=b.lastReadWatermarkTimestamp,n=b.skipVerifyThread,o=babelHelpers["extends"]({},e,{authoritativeThreadKey:(b=f)!=null?b:e.authoritativeThreadKey,cannotReplyReason:k!=null||g!=null?null:e.cannotReplyReason,deduplicationKey:k!=null||g!=null?i:e.deduplicationKey,folder:(b=k)!=null?b:e.folder,lastReadMsgTs:h(e.lastReadMsgTs,m),newestMsgTs:h(e.newestMsgTs,l),optimisticThreadKey:(i=g)!=null?i:e.optimisticThreadKey});return a.threads.update(e.chatId,o).then(function(){var a;n!==!0&&d("MAWIndexedDb").afterTransaction({tag:"VerifyThreadExists",value:d("MAWBridgeThread").createBridgeThread(o,o.optimisticThreadKey,f,j)});d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread({folder:(a=o==null?void 0:o.folder)!=null?a:d("MAWFolderTypes").FOLDER_ID.INBOX,threadId:o.chatId,threadJid:o.jid})});return o})["catch"](function(a){a=c("getErrorSafe")(a);a.message="Error updating thread: "+a.message;throw a})}g.getExistingThread=i;g.getOrCreateThread=a;g.createThread=j;g.updateThread=k}),98);
__d("MAWAfterWriteMsgUtil",["ArmadilloDataTraceType","I64","MAWBridgeMsg","MAWBridgeTrace","MAWBridgeTypesCreators","MAWCalculateBumpTimestampMs","MAWDbMsg","MAWIndexedDb","MAWLocalizationType","MAWMsgType","MAWXMAUtils","WALogger","WATimeUtils","gkx","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Skipping local thread bump for threadId: ",", msgType: ",""]);i=function(){return a};return a}function a(a){var b=a.dbMsg,e=a.ebRestore,f=a.hasMoreAfter,g=a.hasMoreBefore,k=a.isFirstMsg,l=a.isOldestMsgUpdated,m=a.msgsLeftToRestoreForEB,n=a.openMessageOtid,o=a.openMessageParticipantCount,p=a.optimisticMsg,q=a.participantCount,r=a.prevOldestMsg,s=a.quotedReplyAttachmentMeta,t=a.snippet,u=a.updatedThread,v=u.authoritativeThreadKey,w=u.chatId,x=u.jid,y=u.lastReadMsgTs,z=u.newestMsgTs;u=u.oldestMsg;if(b.altIndex===d("MAWDbMsg").SPAM_ALT_INDEX||b.altIndex===d("MAWDbMsg").FUTUREPROOF_SPAM_ALT_INDEX)return;d("MAWIndexedDb").afterTransaction({tag:"StartTrace",value:d("MAWBridgeTrace").createBridgeStartTraceData(b,x,d("ArmadilloDataTraceType").armadilloMessageSend,n,k,o,q,v)});d("MAWXMAUtils").isXMAStoryReply(b.xmaMessageType)||d("MAWIndexedDb").afterTransaction({tag:"NewMsg",value:d("MAWBridgeMsg").createBridgeMsg(b,p,s)});n=j(a);n&&d("WALogger").LOG(i(),w,b.type);if(!n&&t!=null&&z!=null){k=t.snippetParams;o=t.snippetSenderContactId;q=t.snippetType;if(!c("gkx")("23996"))d("MAWIndexedDb").afterTransaction({tag:"ThreadBumped",value:d("MAWBridgeTypesCreators").createBridgeBumpedThread(w,x,z,y,q,k,o,"writeMsgAfterTransaction-"+b.type,b.externalId)});else{v=d("MAWCalculateBumpTimestampMs").calculateBumpTimestampMs(b.serverTs!=null?d("WATimeUtils").castUnixTimeToMillisTime(b.serverTs):z,(h||(h=d("I64"))).of_string_opt(b.externalId));d("MAWIndexedDb").afterTransaction({tag:"ThreadBumpedV2",value:d("MAWBridgeTypesCreators").createBridgeBumpedThreadV2(w,x,v,q,k,o,"writeMsgAfterTransaction-"+b.type,!1,!0)})}}p=e!=null&&e&&m!=null&&m<=1;if(r==null||p){d("MAWIndexedDb").afterTransaction({tag:"MsgsLoaded",value:d("MAWBridgeTypesCreators").createBridgeMsgsLoadedInfo(w,x,[b],!0,(s=g)!=null?s:!1,(a=f)!=null?a:!1)})}l&&u!=null&&d("MAWIndexedDb").afterTransaction({tag:"UpdateMinMessage",value:{minMessageId:u,minTimestampMs:d("MAWDbMsg").getCanonicalTsFromMsg(b)*1e3,threadId:w,threadJid:x}})}function j(a){var b=a.dbMsg,e=a.ebRestore;a=a.skipLocalThreadBump;a=a===void 0?!1:a;if(e!=null&&e)return!0;if(d("MAWXMAUtils").isXMAStoryReply(b.xmaMessageType))return!0;if(c("justknobx")._("2017")&&b.type===d("MAWMsgType").MSG_TYPE.ADMIN&&b.msgContent.adminType===d("MAWLocalizationType").LOCALIZATION_TYPE.E2EE_THREAD_DESCRIPTION)return!0;return a?!0:!1}g.writeMsgAfterTransaction=a}),98);
__d("MAWAdminMsgTxns",["MAWAfterWriteMsgUtil","MAWDbMsg","MAWDbThread","MAWDbThreadTxns","MAWLocalizationType","MAWLocalizationUtils","MAWThreadSnippetUtils","MAWTimeUtils","MAWWriteBulkWriteIncomingAdminMsgTxns","MAWWriteMsgTxns","WALogger","WATimeUtils","err"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["writeReachabilityErrorAdminMsg failed to create or get 1:1 thread"]);h=function(){return a};return a}function a(a,b){var c=a.ts;c=d("WATimeUtils").castUnixTimeToMillisTime(c);var e=d("MAWTimeUtils").ensureValidMillisTime(b.newestMsgTs)||d("WATimeUtils").castToMillisTime(0);c=c>e?c:e;e=d("MAWThreadSnippetUtils").isDbMsgDisabledForThreadSnippet(a);return babelHelpers["extends"]({},b,{newestMsg:a.msgId,newestMsgTs:c,oldestMsg:a.msgId,snippetMsg:e?void 0:a.msgId,snippetMsgTs:e?void 0:d("WATimeUtils").castUnixTimeToMillisTime(d("MAWDbMsg").getCanonicalTsFromMsg(a)),threadOrder:d("MAWDbThread").craftThreadOrder(c,b.jid)})}function b(a){a.forEach(function(a){return d("MAWAfterWriteMsgUtil").writeMsgAfterTransaction(a)})}function e(a,b){return d("MAWDbThreadTxns").getThreadByJid(a,b).then(function(b){if(!b.success){d("WALogger").WARN(h());return}b=b.value;var c=d("MAWLocalizationUtils").buildUnstoredDbAdminMsg({adminMsgContent:[],adminType:d("MAWLocalizationType").LOCALIZATION_TYPE.REACHABILITY_ERROR,version:0},b.chatId,b.jid,d("WATimeUtils").castMillisTimeToUnixTime(b.lastReadMsgTs));return d("MAWWriteMsgTxns").writeMsg(a,c,b).then(function(){})})}function f(a,b){return d("MAWWriteBulkWriteIncomingAdminMsgTxns").writeE2EEAdminMsgsForIncomingCreatedThreads(a,[b]).then(function(){return d("MAWDbThreadTxns").getThread(a,b.chatId).then(function(a){if(!a.success)throw c("err")("missing thread when write e2ee thread description");return a.value})})}function i(a){var b=d("MAWDbMsg").craftE2eeAdminMsgAltIndex(a.chatId);b=d("MAWLocalizationUtils").buildUnstoredDbAdminMsg({adminMsgContent:[],adminType:d("MAWLocalizationType").LOCALIZATION_TYPE.E2EE_THREAD_DESCRIPTION,version:0},a.chatId,a.jid,d("WATimeUtils").castToUnixTime(0),b);return babelHelpers["extends"]({},b,{msgId:d("MAWDbMsg").craftMsgIdV2(a.chatId,1,b),sortOrderMs:0})}g.getUpdatedThreadForAdminMsg=a;g.syncMsgsDataAfterTransaction=b;g.writeReachabilityErrorAdminMsg=e;g.writeE2EEThreadDescriptionMsg=f;g.buildE2EEThreadDescriptionMsg=i}),98);
__d("MAWWriteBulkWriteIncomingAdminMsgTxns",["MAWAdminMsgTxns","MAWDexieTable","MAWThreadSnippetBuildTxns","MAWThreadSnippetForAdminOrEphemeralMsg","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["OfflineBulkWriteAdminmsg - Missing thread when write e2ee thread description"]);h=function(){return a};return a}function i(a){var b=[],e=[],f=[];a.forEach(function(a){a==null&&d("WALogger").ERROR(h());var g=d("MAWAdminMsgTxns").buildE2EEThreadDescriptionMsg(a),i=d("MAWAdminMsgTxns").getUpdatedThreadForAdminMsg(g,a),j=c("MAWThreadSnippetForAdminOrEphemeralMsg")(g,d("MAWThreadSnippetBuildTxns").getSnippetContactId(g.author));b.push(g);f.push(i);e.push({dbMsg:g,isFirstMsg:!1,isOldestMsgUpdated:a.oldestMsg!=null&&g.msgId!==a.oldestMsg,prevOldestMsg:a.oldestMsg==null?void 0:a.oldestMsg,snippet:j,updatedThread:i})});return{afterTransactionSyncMsgsData:e,e2eeThreadAdminMsgs:b,threadsToUpdate:f}}function a(a,b){b=i(b);var c=b.afterTransactionSyncMsgsData,e=b.e2eeThreadAdminMsgs,f=b.threadsToUpdate;return d("MAWDexieTable").dexieAll([a.messages.bulkAdd(e),a.threads.bulkPut(f)]).then(function(){d("MAWAdminMsgTxns").syncMsgsDataAfterTransaction(c);return f})}g.writeE2EEAdminMsgsForIncomingCreatedThreads=a}),98);
__d("MAWBuildIncomingMsgs",["MAWAckLevel","MAWDbMsg","MAWMsgType","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h=6*d("WATimeUtils").HOUR_SECONDS;function a(a,b){var c=a.author;a=a.externalId;return{ack:d("MAWAckLevel").ACK.received,altIndex:void 0,author:c,externalId:a,serverTs:b,ts:b,type:d("MAWMsgType").MSG_TYPE.CIPHERTEXT}}function b(a,b){var c=a.author;a=a.externalId;return{ack:d("MAWAckLevel").ACK.failed,altIndex:void 0,author:c,externalId:a,serverTs:b,ts:b,type:d("MAWMsgType").MSG_TYPE.UNAVAILABLE}}function c(a,b){var c;return{ack:a.ack,author:a.author,externalId:a.externalId,messageDeleteForMeTs:d("WATimeUtils").castToUnixTime(d("WATimeUtils").unixTime()+h),msgContent:(c=d("MAWDbMsg").getMsgContent(a))==null?void 0:c.content,thread:b.chatId,threadJid:b.jid,ts:a.ts,type:d("MAWMsgType").MSG_TYPE.DELETE_FOR_ME}}function e(a,b,c){return{ack:a.ack,altIndex:void 0,author:a.author,externalId:c.externalId,msgContent:d("MAWDbMsg").getMsgContent(a),originalTs:a.ts,revokedExternalId:c.revokedExternalId,thread:b.chatId,threadJid:b.jid,ts:c.ts,type:d("MAWMsgType").MSG_TYPE.REVOKED,unsendMsgContentDeleteTs:d("WATimeUtils").castToUnixTime(d("WATimeUtils").unixTime()+h)}}g.REVOKE_CONTENT_EXPIRATION_IN_SEC=h;g.buildUnstoredCiphertextMsg=a;g.buildUnstoredUnavailableMsg=b;g.buildUnstoredDeleteForMeMsg=c;g.buildUnstoredRevokedMsg=e}),98);
__d("MAWDbPendingStanza",["WAAssertUnreachable"],(function(a,b,c,d,e,f,g){"use strict";var h="revoked",i="deleteForMe",j="deleteThread";b="Revoked";d="DeleteForMe";e="DeleteThread";f={DELETE_FOR_ME:d,DELETE_THREAD:e,REVOKED:b};function a(a){switch(a){case"Revoked":return h;case"DeleteForMe":return i;case"DeleteThread":return j;default:return c("WAAssertUnreachable")(a)}}g.PENDING_REVOKED=h;g.PENDING_DELETE_FOR_ME=i;g.REVOKED=b;g.DELETE_FOR_ME=d;g.PENDING_TYPE=f;g.getPendingSuffix=a}),98);
__d("MAWDeleteThreadUtil",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b=[];a.forEach(function(a){if(a.pendingContent.type==="DeleteThread"){a=a.pendingContent.content.metaSyncMessageRange.lastMessageTimestamp;a!=null&&b.push(a)}});if(b.length===0)return null;b.sort(function(a,b){return b-a});a=b[0];return{lastMessageTimestamp:a}}function b(a,b){return b!=null&&b.lastMessageTimestamp>=a}f.getLatestDeleteThreadInfo=a;f.isMsgDeletedViaDeleteThread=b}),66);
__d("MAWPendingStanzaCleaner",["MAWMsgCleaner","WALogger","err"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["PendingStanzaCleaner: Adding timestamps (",")"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);i=function(){return a};return a}var j=null;function a(a){j==null&&(j=new(d("MAWMsgCleaner").MsgCleaner)(a,d("MAWMsgCleaner").CLEANER_TYPE.PENDING_STANZA))}function b(a){if(j==null){var b="Trying to add new PendingStanzaCleanerTimestamp before the cleaner is initialized!";d("WALogger").ERROR(i(),b);throw c("err")(b)}else d("WALogger").DEV(h(),a),j.update(a)}function e(){return j}function f(){j=null}g.startPendingStanzaCleaner=a;g.addNewPendingStanzaCleanerTimestamp=b;g.getPendingStanzaCleaner_FOR_TESTING_ONLY=e;g.resetPendingStanzaCleaner_FOR_TESTING_ONLY=f}),98);
__d("MAWDbPendingStanzaTxns",["MAWDbPendingStanza","MAWDeleteThreadUtil","MAWPendingStanzaCleaner","WAJids","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,c,e,f){var g=d("MAWDbPendingStanza").getPendingSuffix(f);return a.pendingStanzas.where("externalIdWithType").equals(b+"_"+g).filter(function(a){a=a.pendingContent;return a.type===f&&a.content.author===c&&a.content.thread!=null&&a.content.thread===e}).first()}function a(a,b,c,e){return h(a,b,c,e,d("MAWDbPendingStanza").PENDING_TYPE.REVOKED)}function b(a,b,c,e){return h(a,b,c,e,d("MAWDbPendingStanza").PENDING_TYPE.DELETE_FOR_ME)}function c(a,b){var c=b.map(function(a){a=a.expirationInSeconds;return d("WATimeUtils").castToUnixTime(d("WATimeUtils").unixTime()+a)});b=b.map(function(a,b){var e=a.content,f=a.externalId;a=a.pendingStanzaType;return{deleteTs:c[b],externalIdWithType:f+"_"+d("MAWDbPendingStanza").getPendingSuffix(a),pendingContent:e}});return a.pendingStanzas.bulkAdd(b).then(function(){return c.forEach(d("MAWPendingStanzaCleaner").addNewPendingStanzaCleanerTimestamp)}).then(function(){})}function e(a,b,c,e,f){f=d("MAWDbPendingStanza").getPendingSuffix(f);var g=d("WATimeUtils").castToUnixTime(d("WATimeUtils").unixTime()+c);c={deleteTs:g,externalIdWithType:e+"_"+f,pendingContent:b};return a.pendingStanzas.add(c).then(function(){d("MAWPendingStanzaCleaner").addNewPendingStanzaCleanerTimestamp(g)})}function f(a,b){var c=d("MAWDbPendingStanza").getPendingSuffix(d("MAWDbPendingStanza").PENDING_TYPE.DELETE_THREAD);return a.pendingStanzas.where("externalIdWithType").equals(b+"_"+c).toArray().then(function(a){return d("MAWDeleteThreadUtil").getLatestDeleteThreadInfo(a)})}function i(a){return a.pendingStanzas.toArray()}function j(a,b){b=b.map(function(a){return a.rowId});return a.pendingStanzas.bulkDelete(b)}function k(a){var b;return(a==null?void 0:(b=a.pendingContent)==null?void 0:b.type)===d("MAWDbPendingStanza").PENDING_TYPE.REVOKED?a==null?void 0:(b=a.pendingContent)==null?void 0:b.content:null}function l(a,b){var c=d("MAWDbPendingStanza").getPendingSuffix(d("MAWDbPendingStanza").PENDING_TYPE.DELETE_THREAD);b=b.map(function(a){return a+"_"+c});return a.pendingStanzas.where("externalIdWithType").anyOf(b).toArray().then(function(a){a=a.reduce(function(a,b){var c=a.get(b.externalIdWithType);c==null?a.set(b.externalIdWithType,[b]):c.push(b);return a},new Map());var b=new Map();a.forEach(function(a,c){c=d("WAJids").unsafeCoerceToChatJid(c.split("_")[0]);a=d("MAWDeleteThreadUtil").getLatestDeleteThreadInfo(a);a!=null&&b.set(c,a)});return b})}g.maybeGetPendingStanzaByExternalId=h;g.maybeGetPendingRevokedStanza=a;g.maybeGetPendingDeletedStanza=b;g.bulkPutPendingStanzas=c;g.putPendingStanza=e;g.maybeGetDeleteThreadFromPendingStanza=f;g.getAllPendingStanzas=i;g.deletePendingStanzas=j;g.getRevokedContent=k;g.bulkGetDeleteThreadPendingStanzas=l}),98);
__d("MAWAuthor",["MAWGlobals","WAJids"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){return a==null||a===d("WAJids").AUTHOR_SYSTEM?null:d("WAJids").isAuthorMe(a)?d("MAWGlobals").getMyUserJid():d("WAJids").authorAsUserJid(a)};g.getAuthorUserJid=a}),98);
__d("MAWDbReactionsTxns",["FBLogger","MAWAuthor","MAWBridgeTypesCreators","MAWDbMsg","MAWDbMsgUtil","MAWDexieTable","MAWIndexedDb","WALogger","WAMsgMap"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Deleted "," reactions"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Successfully deleted: "," reactions rows."]);i=function(){return a};return a}var j=function(a){return a};function a(a,b,c){b=babelHelpers["extends"]({},b);return d("MAWDexieTable").dexieAll([a.threads.put(b),a.reactions.put(j(c))]).then(function(a){a=a[1];return a})}function b(a,b){return a.reactions.where("externalId").equals(b.externalId).filter(function(a){return a.author===b.author&&a.threadJid===b.chat}).first()}function k(a,b){var d=b.reduce(function(a,b){a.set(b.msgId,b);return a},new Map());return a.reactions.where("reactToMsgId").anyOf(b.map(function(a){return a.msgId})).toArray().then(function(a){var b=a.filter(function(a){var b=a.reactToExternalId;a=a.reactToMsgId;return a!=null&&b===((b=d.get(a))==null?void 0:b.externalId)});b.length<a.length&&c("FBLogger")("messenger_e2ee_web").mustfix("Reactions query by reactToMsgId returns reactions with mismatching externalId");return b})}function e(a,b){return k(a,[b])}function f(a,b){var c=b.author,d=b.chat;b=b.externalId;return a.reactions.where("externalId").equals(b).filter(function(a){return a.author===c&&a.threadJid===d}).first()}function l(a,b){var c=b.map(function(a){a=a.externalId;return a});return a.reactions.where("externalId").anyOf(c).toArray().then(function(a){var c=d("MAWDbMsgUtil").convertMsgArrayToMap(a),e=new(d("WAMsgMap").MsgMap)();b.forEach(function(a){var b=c.get(a);b!=null&&e.set(a,b)});return e})}function m(a,b){return d("MAWDexieTable").dexieAll(b.map(function(b){var c=b.author,e=b.chatId;b=b.externalId;var f=d("MAWAuthor").getAuthorUserJid(c);return a.reactions.where("reactToExternalId").equals(b).filter(function(a){return d("MAWAuthor").getAuthorUserJid(a.reactToAuthor)===f&&d("MAWDbMsg").getThreadIdFromMsgId(a.reactionId)===e}).toArray()})).then(function(b){b=b.reduce(function(a,b){return a.concat(b)},[]);b.forEach(function(a){var b=a.author,c=a.reactionId,e=a.reactToMsgId;a=a.threadJid;if(e==null)return;d("MAWIndexedDb").afterTransaction({tag:"DeleteReaction",value:d("MAWBridgeTypesCreators").createBridgeDeleteReaction({author:b,chatId:d("MAWDbMsg").getThreadIdFromMsgId(c),chatJid:a,reactToMsgId:e})})});d("WALogger").LOG(i(),b.length);return a.reactions.bulkDelete(b.map(function(a){return a.rowId}))})}function n(a,b){return a.reactions.where("reactToMsgId").anyOf(b.map(function(a){return a.msgId}))["delete"]().then(function(a){d("WALogger").LOG(h(),a)})}function o(a,b){return a.reactions.where("reactionId").between(d("MAWDbMsg").msgIdsInChatLowerBound(b.chatId),d("MAWDbMsg").msgIdsInChatUpperBound(b.chatId)).last().then(function(a){a=a==null?0:d("MAWDbMsg").getInChatMsgIdFromMsgId(a.reactionId);return a+1})}g.coerceToReaction=j;g.putReaction=a;g.getReaction=b;g.getReactionsFromMessages=k;g.getReactionsFromMessage=e;g.maybeGetReactionByProtocolMsgId=f;g.getReactionMapByProtocolMsgId=l;g.deleteReactionsByUniqueMsgIdentifiers=m;g.deleteAllReactionsForMessages=n;g.getNextReactionIdNumberForThread=o}),98);
__d("MAWDeleteForMeMsgContentCleaner",["MAWMsgCleaner","WALogger","err"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["DeleteForMeMsgContentCleaner: Adding timestamps (",")"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["startDeleteForMeMsgContentCleaner invoked"]);j=function(){return a};return a}var k=null;function a(a){d("WALogger").LOG(j()),k==null&&(k=new(d("MAWMsgCleaner").MsgCleaner)(a,d("MAWMsgCleaner").CLEANER_TYPE.DELETE_FOR_ME))}function b(a){if(k==null){var b="Trying to add new DeleteForMeContentCleanerTimestamp before the cleaner is initialized!";d("WALogger").ERROR(i(),b);throw c("err")(b)}else d("WALogger").DEV(h(),a),k.update(a)}function e(){return k}function f(){k=null}g.startDeleteForMeMsgContentCleaner=a;g.addNewDeleteForMeMsgContentCleanerTimestamp=b;g.getDeleteForMeMsgContentCleaner_FOR_TESTING_ONLY=e;g.resetDeleteForMeMsgContentCleaner_FOR_TESTING_ONLY=f}),98);
__d("MAWEBUploadMessageUtils",["I64","MAWDbMsg","MAWExtractMsFromExternalId","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[sortOrder] externalId is not a valid int64"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[sortOrder] Timestamp bits in externalId not valid"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[sortOrder] ExternalId is not present for ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["echoOverrideMessageSortOrder called without ID"]);l=function(){return a};return a}function a(a){var b=a.revokedExternalId!=null?a.revokedExternalId:a.externalId;b==null&&d("WALogger").ERROR(l());b=(h||(h=d("I64"))).of_string_opt(b);if(a.serverTs==null){if(a.sortOrderMs!=null)return a.sortOrderMs;b==null&&d("WALogger").WARN(k(),a.type);var c=b==null?null:d("MAWExtractMsFromExternalId").extractMsFromExternalId(b);return d("MAWDbMsg").getCanonicalTsFromMsg(a)*1e3+((c=c)!=null?c:0)}if(b!=null){c=d("MAWExtractMsFromExternalId").extractMsFromExternalId(b);if(c!=null){b=a.originalTs!=null?a.originalTs:a.serverTs;return Number(b)*1e3+c}else d("WALogger").WARN(j())}else d("WALogger").WARN(i());return d("MAWDbMsg").getSortOrderWithFallback(a)}g.echoOverrideMessageSortOrder=a}),98);
__d("MAWGetMsgQuoteTxn",["MAWDbMsgTxns","MAWDexieTable","MAWMsgType","WAJids","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h=function(a){return a==null||a===d("WAJids").AUTHOR_SYSTEM?null:d("WAJids").authorAsUserJid(a)};function i(a,b,c){var e=b.quote;b=(e==null?void 0:e.content)||{};var f=b.author;b=b.externalId;if(f==null)return d("MAWDexieTable").dexieResolve(null);f=d("WAJids").isAuthorMe(f)?d("WAJids").AUTHOR_ME:h(f);if(e==null||f==null||b==null)return d("MAWDexieTable").dexieResolve(null);f={author:f,chat:c,externalId:b};return d("MAWDbMsgTxns").maybeGetMsgByProtocolMsgId(a,f).then(function(b){if(b==null||!d("MAWMsgType").isQuotedMsgType(b.type))return{quote:e,quoteExternalId:e.content.externalId};var a=b.author,c=b.externalId,f=b.mediaId,g=b.msgContent,h=b.msgId,i=b.specialTextSize,j=b.ts,k=b.type,l=b.xmaMessageType;a={author:a,externalId:c,mediaId:f,msgContent:g,msgId:h,specialTextSize:i,ts:j,type:k,xmaMessageType:l};b.messageExpirationTs!=null&&b.messageExpirationTs<d("WATimeUtils").unixTime()&&(a=babelHelpers["extends"]({},a,{mediaId:void 0,msgContent:void 0,type:d("MAWMsgType").MSG_TYPE.EXPIRED_EPHEMERAL}));return{quote:babelHelpers["extends"]({},e,{content:a}),quoteExternalId:b.externalId}})}function a(a,b,c){return i(a,b,c).then(function(a){return babelHelpers["extends"]({},b,{quote:a==null?void 0:a.quote,quoteExternalId:a==null?void 0:a.quoteExternalId})})}g.getMsgQuoteInfo=i;g.enhanceMsgWithQuoteInfo=a}),98);
__d("MAWUpdateQuotedMsgTxns",["MAWAuthor","MAWBridgeMsg","MAWDexieTable","MAWIndexedDb","MAWMsgType"],(function(a,b,c,d,e,f,g){"use strict";var h=function(a,b,c,e,f,g,h){var i=d("MAWAuthor").getAuthorUserJid(e);return a.messages.where("quoteExternalId").equals(c).toArray().then(function(c){if(c.length===0)return;var e=c;(h==null||!h)&&(e=c.filter(function(a){var c=a.quote;a=a.thread;return d("MAWAuthor").getAuthorUserJid(c==null?void 0:c.content.author)===i&&a===b}));var j=e.map(function(a){var b;b=Object.assign({},(b=a.quote)==null?void 0:b.content,f.content);b=babelHelpers["extends"]({},a.quote,f,{content:b});b.content.msgId==null&&g!=null&&(b.content.msgId=g);return babelHelpers["extends"]({},a,{quote:b})});return a.messages.bulkPut(j).then(function(){return j})})},i=function(a,b,c,e,f){f===void 0&&(f=d("MAWMsgType").MSG_TYPE.UNAVAILABLE);f={content:{mediaId:void 0,msgContent:void 0,type:f}};return h(a,b,c,e,f).then(function(a){if(a==null)return;a.forEach(function(a){d("MAWIndexedDb").afterTransaction({tag:"MsgUpdated",value:d("MAWBridgeMsg").createBridgeMsg(a)})})})};a=function(a,b,c){c===void 0&&(c=d("MAWMsgType").MSG_TYPE.UNAVAILABLE);var e=b.author,f=b.chat,g=b.externalId;return a.threads.get({jid:f}).then(function(b){if(b==null)return;return i(a,b.chatId,g,e,c)})};b=function(a,b,c,e){var f=c.author,g=c.externalId,i=c.mediaId,j=c.msgContent,k=c.msgId,l=c.ts;c=c.type;if(!d("MAWMsgType").isQuotedMsgType(c))return d("MAWDexieTable").dexieResolve();i={author:f,externalId:g,mediaId:i,msgContent:j,ts:l,type:c};return h(a,b,g,f,{content:i},k,e)};g.disassociateQuotedMsg=i;g.disassociateQuotedMessageByProtocolMsgId=a;g.associateQuotedMessage=b}),98);
__d("MAWBridgeParticipants",["WAJids","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(a){var b=a.deliveredWatermarkTs,c=a.lastReadActionTs,e=a.lastReadWatermarkTs,f=a.threadId,g=a.threadJid,h=a.type;a=a.userJid;return{deliveredWatermarkTs:b||d("WATimeUtils").castToUnixTime(0),fbid:d("WAJids").extractUserId(a),isAdmin:h==="superadmin"||h==="admin",isInvited:h==="invitedParticipant",isSuperAdmin:h==="superadmin",lastReadActionTs:(b=c)!=null?b:d("WATimeUtils").castToUnixTime(0),readWatermarkTs:e||d("WATimeUtils").castToUnixTime(0),threadId:f,threadJid:g}}function a(a){return{participants:a.map(function(a){return h(a)})}}g.createBridgeParticipant=h;g.createBridgeParticipants=a}),98);
__d("MAWDbParticipantTxns",["MAWBridgeParticipants","MAWBridgeTypesCreators","MAWCurrentUser","MAWDbParticipant","MAWDexieTable","MAWIndexedDb","MAWODSProxy","WAJids","WAOdsEnums","WAResultOrError","WATimeUtils","err"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c,d,e,f){e===void 0&&(e="participant");return h(a,b,c,[{addressable:f,type:e,userJid:d}]).then(function(a){return a[0]})}function h(a,b,c,d){return i(a,d.map(function(a){return babelHelpers["extends"]({},a,{threadId:b,threadJid:c})}))}function i(a,b){if(b.length===0)return d("MAWDexieTable").dexieResolve([]);var c=[];b.forEach(function(a){var b=a.addressable,e=a.threadId,f=a.threadJid,g=a.type;a=a.userJid;c.push({addressable:b,deliveredWatermarkTs:d("WATimeUtils").castToUnixTime(0),id:d("MAWDbParticipant").craftParticipantId(e,a),lastReadWatermarkTs:d("WATimeUtils").castToUnixTime(0),threadId:e,threadJid:f,type:g,userJid:a})});return a.participants.bulkPut(c).then(function(){d("MAWIndexedDb").afterTransaction({tag:"ParticipantsUpdated",value:d("MAWBridgeParticipants").createBridgeParticipants(c)});return c})}function b(a,b,c,e){return o(a,c).then(function(f){var g=[],i=new Set(e.map(function(a){return a.userJid}));for(var j=f,l=Array.isArray(j),m=0,j=l?j:j[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var n;if(l){if(m>=j.length)break;n=j[m++]}else{m=j.next();if(m.done)break;n=m.value}n=n;var o=i.has(n.userJid);o||g.push([n.threadJid,n.userJid])}o=[];n=new Set(f.map(function(a){return a.userJid}));for(m=0;m<e.length;m++){l=e[m];j=n.has(l.userJid);j||o.push(l)}g.length>0&&d("MAWODSProxy").odsBumpEntityKey({amount:1,entity:d("WAOdsEnums").Entity.MAW_ONE_TO_ONE_THREAD_PARTICIPANT_CLEANUP,key:d("MAWCurrentUser").isEmployee()?"employee":"public"});return d("MAWDexieTable").dexieAll([h(a,b,c,o),k(a,g)]).then(function(a){var b=a[0];a[1];a=e.reduce(function(a,c){var d=b.find(function(a){return a.userJid===c.userJid}),e=f.find(function(a){return a.userJid===c.userJid});d!=null&&e==null?a.push(d):e!=null&&a.push(e);return a},[]);return a})})}function e(a,b){return a.participants.bulkPut(b).then(function(){b.length>0&&d("MAWIndexedDb").afterTransaction({tag:"ParticipantsUpdated",value:d("MAWBridgeParticipants").createBridgeParticipants(b)});return b})}function f(a,b,c){if(c.length===0)return d("MAWDexieTable").dexieResolve();c=c.map(function(a){return[b,a]});return k(a,c)}function j(a,b,c){if(b.length===0)return d("MAWDexieTable").dexieResolve();b=b.map(function(a){return[a,c]});return k(a,b)}function k(a,b){return a.participants.where(["threadJid","userJid"]).anyOf(b).toArray().then(function(b){return a.participants.bulkDelete(b.map(function(a){return a.id})).then(function(){return a.threads.where("jid").anyOf(Array.from(new Set(b.map(function(a){return a.threadJid})))).toArray()}).then(function(a){var c=new Map(a.map(function(a){return[a.jid,a.chatId]}));b.forEach(function(a){var b=c.get(a.threadJid);b!=null&&d("MAWIndexedDb").afterTransaction({tag:"ParticipantRemoved",value:{threadId:b,threadJid:a.threadJid,userId:d("WAJids").extractUserId(a.userJid)}})})})})}function l(a,b){return a.participants.where("threadJid").equals(b)["delete"]()}function m(a,b,c,d,e){return n(a,[{deliveredWatermarkTs:c,lastReadActionTs:e,lastReadWatermarkTs:d,participantKey:b}]).then(function(a){return a[0]})}function n(a,b){if(b.length===0)return d("MAWDexieTable").dexieResolve([]);var c=new Map(),e=[];b.forEach(function(a){e.push(a.participantKey),c.set(JSON.stringify(a.participantKey),a)});return a.participants.where(["threadJid","userJid"]).anyOf(e).toArray().then(function(b){var e=[],f=[];b.forEach(function(a){var b=c.get(JSON.stringify([a.threadJid,a.userJid]));if(b==null)return;var d=b.deliveredWatermarkTs,g=b.lastReadActionTs;b=b.lastReadWatermarkTs;var h=a.deliveredWatermarkTs,i=a.lastReadWatermarkTs,j=a.lastReadActionTs,k=d>h,l=b>i,m=j==null||g>j;if(!k&&!l&&!m){f.push(a);return}e.push(babelHelpers["extends"]({},a,{deliveredWatermarkTs:k?d:h,lastReadActionTs:m?g:j,lastReadWatermarkTs:l?b:i}))});return a.participants.bulkPut(e).then(function(){e.forEach(function(a){d("MAWIndexedDb").afterTransaction({tag:"ReceivedReceipt",value:d("MAWBridgeTypesCreators").createBridgeReceivedReceipt(a.threadId,a.threadJid,d("WAJids").extractUserId(a.userJid),a.deliveredWatermarkTs,a.lastReadWatermarkTs,a.lastReadActionTs)})});return[].concat(e,f)})})}function o(a,b){return a.participants.where("threadJid").equals(b).toArray()}function p(a,b){return a.participants.where("threadJid").anyOf(b).toArray()}function q(a,b){return o(a,b).then(function(a){return a.filter(function(a){return a.type==="invitedParticipant"})})}function r(a,b,c){return a.participants.get(d("MAWDbParticipant").craftParticipantId(b,c)).then(function(a){return a==null?d("WAResultOrError").makeError("missing"):d("WAResultOrError").makeResult(a)})}function s(a,b){var d=Array.from(b.keys()).filter(Boolean);return a.participants.where("threadId").anyOf(d).toArray().then(function(d){var e=d.map(function(a){return[a.threadJid,a.userJid]}),f=d.map(function(a){var d=b.get(a.threadId);if(d==null)throw c("err")("New Thread Id is null - should not happen flow");return{addressable:a.addressable,threadId:d,threadJid:a.threadJid,type:a.type,userJid:a.userJid}});return k(a,e).then(function(){return i(a,f)}).then(function(){})})}function t(a,b){return a.participants.where(["threadJid","userJid"]).anyOf(b).toArray().then(function(a){var c=new Map(a.map(function(a){return[JSON.stringify([a.threadJid,a.userJid]),a]}));return b.map(function(a){return c.get(JSON.stringify(a))})})}g.addParticipant=a;g.bulkAddParticipants=h;g.bulkAddParticipantsInThreads=i;g.bulkUpsertParticiantsInThread=b;g.bulkUpdateParticipants=e;g.bulkDeleteParticipantsInThread=f;g.bulkDeleteParticipantAcrossThreads=j;g.bulkDeleteParticipants=k;g.deleteAllParticipantsForThread=l;g.updateParticipantTimestamps=m;g.bulkUpdateParticipantTimestamps=n;g.getParticipantsInThread=o;g.getParticipantsInThreads=p;g.getInvitedParticipantsInThread=q;g.getParticipant=r;g.bulkMigrateParticipantsToNewThreads=s;g.bulkGetParticipants=t}),98);
__d("MAWWriteMsgSideEffectTxns",["MAWDbMsg","MAWDbParticipantTxns","MAWDexieTable"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var c=d("MAWDbMsg").getCanonicalTsFromMsg(b),e=b.author;return e!=="@me"&&e!=="@system"?d("MAWDbParticipantTxns").updateParticipantTimestamps(a,[b.threadJid,e],c,c,c):d("MAWDexieTable").dexieResolve()}g.updateParticipantTimestampsForMsg=a}),98);
__d("MAWWriteDeleteMessageTxns",["MAWAckLevel","MAWBridgeTypesCreators","MAWDbMsg","MAWDbMsgTxns","MAWDbPendingStanza","MAWDbReactionsTxns","MAWDbThreadTxns","MAWDbXMATxns","MAWDeleteForMeMsgContentCleaner","MAWDexieTable","MAWIndexedDb","MAWMsgType","MAWPendingStanzaCleaner","MAWThreadSnippetBuildTxns","MAWUpdateQuotedMsgTxns","MAWUploadMessagesBackup","MAWXMAUtils","WAResultOrError","WATimeUtils","gkx","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h=6*d("WATimeUtils").HOUR_SECONDS,i=30*d("WATimeUtils").DAY_SECONDS;function a(a,b){var c=b.protocolMsgId,e=c.author;b=c.chat;var f=c.externalId;return d("MAWDexieTable").dexieAll([d("MAWDbThreadTxns").getThreadByJid(a,b),a.unrenderedMessages.get({externalId:f})]).then(function(b){var g=b[0];b=b[1];if(!g.success)return d("WAResultOrError").makeError("missing_thread");return b!=null&&b.thread===g.value.chatId&&b.author===e?d("WAResultOrError").makeError("duplicate_delete_for_me"):d("MAWDbMsgTxns").maybeGetMsgByProtocolMsgId(a,c).then(function(b){if(b==null){var h={ack:d("MAWAckLevel").ACK.received,author:e,externalId:f,thread:g.value.chatId,threadJid:g.value.jid,type:d("MAWMsgType").MSG_TYPE.DELETE_FOR_ME},k=d("WATimeUtils").castToUnixTime(d("WATimeUtils").unixTime()+i);h={deleteTs:k,externalIdWithType:f+"_"+d("MAWDbPendingStanza").PENDING_DELETE_FOR_ME,pendingContent:{content:h,type:d("MAWDbPendingStanza").PENDING_TYPE.DELETE_FOR_ME}};return a.pendingStanzas.add(h).then(function(){d("MAWPendingStanzaCleaner").addNewPendingStanzaCleanerTimestamp(k);return d("WAResultOrError").makeResult()})}return d("MAWDexieTable").dexieResolve(j(a,b,e,c.chat,g.value)).then(function(){return d("WAResultOrError").makeResult()})})})}function j(a,b,e,f,g){var i,j=d("MAWDexieTable").dexieResolve();d("MAWXMAUtils").isXMAStoryReply((i=b.quote)==null?void 0:i.content.xmaMessageType)&&(j=k(a,b));var l={ack:b.ack,author:e,externalId:b.externalId,mediaId:b.mediaId,messageDeleteForMeTs:d("WATimeUtils").castToUnixTime(d("WATimeUtils").unixTime()+h),msgContent:(i=d("MAWDbMsg").getMsgContent(b))==null?void 0:i.content,msgId:b.msgId,quote:b.quote,reportingMeta:b.reportingMeta,serverTs:c("justknobx")._("1753")?void 0:b.serverTs,thread:b.thread,threadJid:f,ts:b.ts,type:d("MAWMsgType").MSG_TYPE.DELETE_FOR_ME,xmaMessageType:b.xmaMessageType};i=d("MAWDexieTable").dexieAll([d("MAWDbMsgTxns").deleteDbMsg(a,b.rowId),j]).then(function(){d("MAWIndexedDb").afterTransaction({tag:"DeleteMessages",value:d("MAWBridgeTypesCreators").createBridgeDeleteMessages(b.thread,b.threadJid,[b])});c("gkx")("23914")&&c("justknobx")._("1071")&&d("MAWUploadMessagesBackup").sendDeleteEchoMessage(b,g.jid);if(d("MAWDbMsg").isMediaMsg(b)){var e=b.mediaId;e!=null&&d("MAWIndexedDb").afterTransaction({tag:"MediaExpired",value:{mediaId:e,msgId:b.msgId,threadId:b.thread,threadJid:b.threadJid}})}return d("MAWThreadSnippetBuildTxns").refreshThreadSnippet(a,g)});return d("MAWDexieTable").dexieAll([i,a.unrenderedMessages.add(l),d("MAWDbReactionsTxns").deleteReactionsByUniqueMsgIdentifiers(a,[{author:e,chatId:b.thread,externalId:b.externalId}]),d("MAWUpdateQuotedMsgTxns").disassociateQuotedMsg(a,b.thread,b.externalId,b.author,d("MAWMsgType").MSG_TYPE.REVOKED)]).then(function(){return d("MAWDbMsgTxns").maybeUpdateThreadMsgsForDeleteForMe(a,g.chatId,b.msgId,b.sortOrderMs).then(function(){d("MAWDeleteForMeMsgContentCleaner").addNewDeleteForMeMsgContentCleanerTimestamp(l.messageDeleteForMeTs);return d("WAResultOrError").makeResult()})})}function k(a,b){return d("MAWDbXMATxns").maybeGetXMAFromAssociatedMsgId(a,b.msgId).then(function(b){return d("MAWDbMsgTxns").maybeGetMsg(a,b==null?void 0:b.msgId).then(function(b){if(b!=null)return d("MAWDbMsgTxns").deleteDbMsg(a,b.rowId)})})}g.REVOKE_CONTENT_EXPIRATION_IN_SEC=h;g.handleDeleteForMe=a;g.deleteXMAStoryReplyMsg=k}),98);
__d("MAWDbDeletedMessages",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum")({ChatDelete:"chat_delete",Revoke:"revoke"});f.DbDeletedMsgReasonEnum=a}),66);
__d("MAWUnsendMsgContentCleaner",["MAWMsgCleaner","WALogger","err"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["UnsendMsgContentCleaner: Adding timestamps (",")"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["startUnsendMsgContentCleaner invoked"]);j=function(){return a};return a}var k=null;function a(a){d("WALogger").LOG(j()),k==null&&(k=new(d("MAWMsgCleaner").MsgCleaner)(a,d("MAWMsgCleaner").CLEANER_TYPE.UNSEND))}function b(a){if(k==null){var b="Trying to add new UnsendMsgContentCleanerTimestamp before the cleaner is initialized!";d("WALogger").ERROR(i(),b);throw c("err")(b)}else d("WALogger").DEV(h(),a),k.update(a)}function e(){return k}function f(){k=null}g.startUnsendMsgContentCleaner=a;g.addNewUnsendMsgContentCleanerTimestamp=b;g.getUnsendMsgContentCleaner_FOR_TESTING_ONLY=e;g.resetUnsendMsgContentCleaner_FOR_TESTING_ONLY=f}),98);
__d("MAWWriteRevokeMessageTxns",["FBLogger","MAWAckLevel","MAWBridgeMsg","MAWBridgeTypesCreators","MAWDbDeletedMessages","MAWDbMsg","MAWDbMsgTxns","MAWDbPendingStanza","MAWDbReactionsTxns","MAWDexieTable","MAWEphemeralUtil","MAWIndexedDb","MAWJidUtils","MAWMsgType","MAWPendingStanzaCleaner","MAWThreadSnippetBuildTxns","MAWUnsendMsgContentCleaner","MAWUpdateQuotedMsgTxns","MAWUploadMessagesBackup","MAWWriteDeleteMessageTxns","MAWXMAUtils","WATimeUtils","err"],(function(a,b,c,d,e,f,g){"use strict";var h=6*d("WATimeUtils").HOUR_SECONDS,i=30*d("WATimeUtils").DAY_SECONDS;function a(a,b,e,f,g){var h=d("WATimeUtils").castToUnixTime(d("WATimeUtils").unixTime()+i),k=b.author,m=b.externalId,n=b.revokedExternalId,o=g!=null?l(a,g):d("MAWDexieTable").dexieResolve();return(f==null?d("MAWDbMsgTxns").maybeGetMsgByExternalId(a,b.revokedExternalId,e.chatId,b.author):d("MAWDexieTable").dexieResolve(f)).then(function(g){(f==null||g!=null)&&c("FBLogger")("messenger_e2ee_web").warn("Revoked message missing originalMsg incorrectly");if(g==null){var i={deleteTs:h,externalIdWithType:n+"_"+d("MAWDbPendingStanza").PENDING_REVOKED,pendingContent:{content:{ack:d("MAWAckLevel").ACK.received,altIndex:void 0,author:k,externalId:m,revokedExternalId:n,thread:e.chatId,threadJid:e.jid,ts:b.ts,type:"Revoked"},type:d("MAWDbPendingStanza").PENDING_TYPE.REVOKED}};return d("MAWDexieTable").dexieAll([a.pendingStanzas.add(i),o]).then(function(b){b[0];b=b[1];d("MAWPendingStanzaCleaner").addNewPendingStanzaCleanerTimestamp(h);b===!0&&d("MAWThreadSnippetBuildTxns").refreshThreadSnippet(a,e)})}return o.then(function(){return j(a,g,e,b.externalId,b.revokedExternalId,b.serverTs,b.ts,!1)})})}function j(a,b,c,e,f,g,i,j){var l=babelHelpers["extends"]({},b,{altIndex:void 0,externalId:e,msgContent:d("MAWDbMsg").getMsgContent(b),originalTs:(e=b.serverTs)!=null?e:b.ts,revokedExternalId:f,serverTs:g,threadJid:c.jid,ts:i,type:"Revoked",unsendMsgContentDeleteTs:d("WATimeUtils").castToUnixTime(d("WATimeUtils").unixTime()+h)});if(j){d("MAWUploadMessagesBackup").sendDeleteEchoMessage(b,c.jid);return d("MAWDexieTable").dexieResolve(l)}return k(a,b,l,c).then(function(){return l})}function k(a,b,c,e,f){var g;f===void 0&&(f=!1);g=d("MAWXMAUtils").isXMAStoryReply((g=b.quote)==null?void 0:g.content.xmaMessageType)?d("MAWWriteDeleteMessageTxns").deleteXMAStoryReplyMsg(a,b):d("MAWDexieTable").dexieResolve();var h=d("MAWJidUtils").toProtocolMsgId(b);h=h!=null?a.deletedMessages.add(babelHelpers["extends"]({},h,{reason:d("MAWDbDeletedMessages").DbDeletedMsgReasonEnum.Revoke})):d("MAWDexieTable").dexieResolve();return d("MAWDexieTable").dexieAll([a.messages.put(c),d("MAWDbReactionsTxns").deleteReactionsByUniqueMsgIdentifiers(a,[{author:c.author,chatId:c.thread,externalId:c.revokedExternalId}]),d("MAWUpdateQuotedMsgTxns").disassociateQuotedMsg(a,c.thread,c.revokedExternalId,c.author,d("MAWMsgType").MSG_TYPE.REVOKED),g,h]).then(function(){f||d("MAWUnsendMsgContentCleaner").addNewUnsendMsgContentCleanerTimestamp(c.unsendMsgContentDeleteTs);return d("MAWThreadSnippetBuildTxns").refreshThreadSnippet(a,e)}).then(function(){b!=null&&d("MAWUploadMessagesBackup").sendDeleteEchoMessage(b,b.threadJid);d("MAWIndexedDb").afterTransaction({tag:"MsgUpdated",value:d("MAWBridgeMsg").createBridgeMsg(c)});if(b!=null&&d("MAWDbMsg").isMediaMsg(b)){var a=b.mediaId;a!=null&&d("MAWIndexedDb").afterTransaction({tag:"MediaExpired",value:{mediaId:a,msgId:b.msgId,threadId:b.thread,threadJid:b.threadJid}})}d("MAWEphemeralUtil").maybeClearEphemeralMsgCountdown(b)})}function b(a,b,e){if(b.type!==d("MAWMsgType").MSG_TYPE.REVOKED)throw c("err")("Cant mark unrevoked message revoked");var f=d("MAWJidUtils").toProtocolMsgId(b);f=f!=null?a.deletedMessages.add(babelHelpers["extends"]({},f,{reason:d("MAWDbDeletedMessages").DbDeletedMsgReasonEnum.Revoke})):d("MAWDexieTable").dexieResolve();return d("MAWDexieTable").dexieAll([d("MAWDbReactionsTxns").deleteReactionsByUniqueMsgIdentifiers(a,[{author:b.author,chatId:b.thread,externalId:b.revokedExternalId}]),d("MAWThreadSnippetBuildTxns").refreshThreadSnippet(a,e),f]).then(function(){d("MAWUnsendMsgContentCleaner").addNewUnsendMsgContentCleanerTimestamp(b.unsendMsgContentDeleteTs),d("MAWIndexedDb").afterTransaction({tag:"NewMsg",value:d("MAWBridgeMsg").createBridgeMsg(b)})})}function l(a,b){return b.type===d("MAWMsgType").MSG_TYPE.CIPHERTEXT?a.messages["delete"](b.rowId).then(function(){d("MAWIndexedDb").afterTransaction({tag:"DeleteMessages",value:d("MAWBridgeTypesCreators").createBridgeDeleteMessages(b.thread,b.threadJid,[b])});return!0}):d("MAWDexieTable").dexieResolve(!1)}g.REVOKE_CONTENT_EXPIRATION_IN_SEC=h;g.writeIncomingRevokeMsg=a;g.revokeUnstoredMsg=j;g.markExistingMsgRevoked=k;g.markIncomingMessageRevoked=b}),98);
__d("MAWBridgeUpload",[],(function(a,b,c,d,e,f){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l){return{actionType:g,authTs:d,echoDocument:f,echoEncodingLatencyNs:e,errorCode:h,errorMessage:i,messageId:a,protoMsg:l,sortOrderMs:c,threadId:b,traceId:j,uploadTrackingInstanceKey:k}}function b(a,b,c,d,e,f){return{actionType:f,echoDocument:e,folderType:b,threadId:a,transportKey:c,ts:d}}function c(a,b,c,d,e,f,g,h,i){return{chatId:a,deliveryObjectId:b,mediaType:c,messageId:d,productType:e,threadId:f,threadJid:g,traceId:i,ts:h}}f.createBridgeUploadMessage=a;f.createBridgeDeleteMessagesOfThread=b;f.createBridgeUploadAttachment=c}),66);
__d("MAWUploadThreadTxns",["$InternalEnum","MAWFolderTypes"],(function(a,b,c,d,e,f,g){"use strict";var h=b("$InternalEnum")({INBOX:0,PENDING:1,OTHER:2,SPAM:3,ARCHIVED:4,HIDDEN:5});function i(a){switch(a){case d("MAWFolderTypes").FOLDER_ID.INBOX:return h.INBOX;case d("MAWFolderTypes").FOLDER_ID.PENDING:return h.PENDING;case d("MAWFolderTypes").FOLDER_ID.ARCHIVED:return h.ARCHIVED;default:return h.INBOX}}function a(a){return i(a).toString()}g.FolderType=h;g.getFolderTypeAsText=a}),98);
__d("MAWBridgeEventTransmitter",["MAWBridge","MAWBridgeMsg","MAWBridgeTrace","MAWBridgeTypesCreators","MAWBridgeUpload","MAWIndexedDb","MAWTimeUtils","MAWUploadThreadTxns","WAJids","WATimeUtils","qpl"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c,e,f){d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:[{tag:"IssuePointQuery",value:{jid:f,messageId:a,startSortKey:c,taskSource:e,threadId:b}}]})}function b(a){d("MAWIndexedDb").afterTransaction({tag:"DeleteMessagesOfThread",value:d("MAWBridgeUpload").createBridgeDeleteMessagesOfThread(d("WAJids").threadIdForChatJid(a.jid),d("MAWUploadThreadTxns").getFolderTypeAsText(a.folder),"AdvancedCrypto",(a=d("MAWTimeUtils").ensureValidMillisTime(a.newestMsgTs))!=null?a:d("WATimeUtils").castToMillisTime(1),null,2)})}function e(a,b,c,e,f,g){d("MAWIndexedDb").afterTransaction({tag:"MsgsLoaded",value:d("MAWBridgeTypesCreators").createBridgeMsgsLoadedInfo(a,b,c,e,f,g)})}function f(a,b,c){d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:[{tag:"StartTrace",value:d("MAWBridgeTrace").createBridgeStartTraceData(a,b,c)}]})}function h(a,b,e){var f=c("qpl")._(521482576,"1069");(e==null?void 0:e.get(a.externalId))!=null?d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:[{tag:"NewMsg",value:d("MAWBridgeMsg").createBridgeMsg(a,e.get(a.externalId),void 0,f,b,"EncryptedBackups")}]}):d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:[{tag:"NewMsg",value:d("MAWBridgeMsg").createBridgeMsg(a,void 0,void 0,f,b,"EncryptedBackups")}]})}function i(a,b,c,e){d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:[{tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread({cannotReplyReason:a,folder:b,threadId:c,threadJid:e})}]})}function j(a,b,c,e){d("MAWIndexedDb").afterTransaction({tag:"DeleteMessageRangesV2",value:{minMsgId:a,minTimestampMs:b,threadId:c,threadJid:e}})}g.issuePointQueryOutsideTxn=a;g.deleteMessagesOfThreadAfterTxn=b;g.issueMsgLoadedEventAfterTxn=e;g.startTraceOutsideTxn=f;g.issueNewMsgUiEventOutsideTxn=h;g.updateThreadOutsideTxn=i;g.deleteMessageRangesV2AfterTxn=j}),98);
__d("MAWConstants",[],(function(a,b,c,d,e,f){"use strict";a=5;b="Facebook user";c="Instagram user";d=24;e=3;var g=50;f.MESSAGE_RETRY_COUNT_LIMIT=a;f.FB_UNKNOWN_USER=b;f.INS_UNKNOWN_USER=c;f.MAX_APPDATA_RECIPIENTS=d;f.CURRENT_REGISTRATION_VERSION=e;f.BRIDGE_UPLOAD_BATCH_SIZE=g}),66);
__d("MAWEBBackendQPLUtils",["MAWEBSwitch","MAWQplProxy","Random","WAHashStringToNumber","gkx","hashString","qpl"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){b=(b=b)!=null?b:c("Random").uint32();d("MAWQplProxy").startQplUserFlow(c("qpl")._(521479468,"1752"),{"int":{numMessagesRestored:0},string:{threadId:a}},b);return b}function b(a,b){d("MAWQplProxy").sendQPLSuccessThroughBridge(c("qpl")._(521479468,"1752"),{string:{threadId:b}},a)}function e(a){return a.dyiBatch.each(function(a){if(a.isThread===!1)return;d("MAWQplProxy").sendQPLFailThroughBridge(c("qpl")._(521479468,"1752"),"dyi_backup_restore_error",{string:{threadId:a.threadId}},a.qplInstanceKeyForThread)})}function f(a,b){if(b.qplInstanceKeyForThread==null)return;a=a===!1?"dyi_backup_restore_continuing":"dyi_backup_restore_finished";var e=b.qplInstanceKeyForThread;d("MAWQplProxy").sendQplPointThroughBridge(c("qpl")._(521479468,"1752"),a,{annotations:{"int":{numMessages:b.numMessages,numMessagesRestored:b.numMessagesRestored},string:{threadId:b.threadId}},instanceKey:(a=e)!=null?a:void 0})}function h(a,b){if(a==null)return;d("MAWQplProxy").sendQPLErrorThroughBridge(c("qpl")._(521479468,"1752"),"dyi_backup_restore_thread_halted",{debugInfo:"DYI attempting to re-restore previous batch - halting DYI for thread "+b,instanceKey:a})}function i(a,b){if(a==null)return;d("MAWQplProxy").sendQPLErrorThroughBridge(c("qpl")._(521479468,"1752"),"dyi_backup_restore_batch_not_in_progress",{debugInfo:"DYI for thread with jid "+b+" is not currently in progress",instanceKey:a})}function j(a,b){if(a==null)return;d("MAWQplProxy").sendQPLErrorThroughBridge(c("qpl")._(521479468,"1752"),"dyi_backup_restore_stopping_dyi",{debugInfo:"Error occurred on restore - stopping DYI for thread with chat jid "+b,instanceKey:a})}function k(a,b){if(a==null)return;d("MAWQplProxy").sendQplPointThroughBridge(c("qpl")._(521478596,"1329"),"dyi_get_thread_list",{annotations:{"int":{threadsToRestore:b}},instanceKey:a})}function l(a){return c("hashString")(a)}function m(a,b){if(c("gkx")("23946")!==!0)return;var e=l(b);d("MAWQplProxy").startQplUserFlow(c("qpl")._(521485625,"1876"),{bool:{eb_switch:c("MAWEBSwitch").isEnabled(),is_retroactive_backups_upload:a},string:{trace_id:b}},e)}function n(a,b,e){if(c("gkx")("23946")!==!0||a==null)return;a=l(a);d("MAWQplProxy").sendQplPointThroughBridge(c("qpl")._(521485625,"1876"),b,{annotations:e,instanceKey:a})}function o(a,b,e){if(c("gkx")("23946")!==!0||a==null)return;a=l(a);d("MAWQplProxy").sendQPLFailThroughBridge(c("qpl")._(521485625,"1876"),b,e,a)}function p(a,b,e){if(a==null)return;a=d("WAHashStringToNumber").hashStringToNumber(a);d("MAWQplProxy").sendQplPointThroughBridge(c("qpl")._(521485815,"2166"),b,{annotations:e,instanceKey:a})}function q(a,b,e){if(a==null)return;a=d("WAHashStringToNumber").hashStringToNumber(a);d("MAWQplProxy").sendQPLFailThroughBridge(c("qpl")._(521485815,"2166"),b,e,a)}g.startDYIBackupRestoreQplUserFlow=a;g.endSuccessDYIBackupRestoreQplUserFlow=b;g.cleanupDYIBackupRestoreQplUserFlow=e;g.addPointDYIBackupRestoreQplUserFlow=f;g.markErrorDyiBackupRestoreThreadHalt=h;g.markErrorDyiBackupRestoreBatchNotInProgress=i;g.markErrorDyiBackupRestoreStoppingDyi=j;g.logDyiE2EGetThreadList=k;g.getQplInstanceKey=l;g.startEBBackupUploadQplUserFlow=m;g.addPointEBBackupUpload=n;g.endFailEBBackupUpload=o;g.logMediaRestoreFromMIQPLPoint=p;g.logMediaRestoreFromMIQPLEndFailure=q}),98);
__d("MAWEncryptedBackupCacheManager",[],(function(a,b,c,d,e,f){"use strict";var g=new Map(),h=new Map(),i=new Map();function a(a,b){h.set(a,{cache:b,status:"restoring"})}function b(a){a.forEach(function(a){var b=h.get(a);b!=null&&h.set(a,{cache:b.cache,status:"done"})})}function c(a){a=h.get(a);if(a!=null)return a.status;else return"none"}function d(a){return(a=h.get(a))==null?void 0:a.cache}function e(a){return h["delete"](a)}function j(a,b){var c=g.get(a)||new Set();c.add(b);g.set(a,c)}function k(a,b){a=g.get(a);return a!=null?a==null?void 0:a.has(b):!1}function l(a,b){a=g.get(a);a!=null&&a["delete"](b)}function m(a){return h.has(a)}function n(a){return i.has(a)}function o(a){return i.get(a)}function p(a){n(a)&&i["delete"](a)}function q(a,b){i.set(a,b)}f.restoredCache=h;f.addMsgEntryToRestoredCache=a;f.setRestoredCacheStatusAsDone=b;f.getRestoredCacheStatus=c;f.getRestoredCache=d;f.removeFromRestoredCache=e;f.addMsgEntryToReuploadCache=j;f.checkForMsgEntryInReuploadCache=k;f.removeMsgEntryFromReuploadCache=l;f.peekRestoreCache=m;f.peekPendingStanzaCache=n;f.getPendingStanzaCacheValue=o;f.removePendingStanzaCacheValue=p;f.addPendingStanzaToPendingStanzaCache=q}),66);
__d("MAWReStoreDb",["MAWIndexedDb","MAWReStoreDbSetup"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){h==null&&(d("MAWIndexedDb").willSetupDB()?h=d("MAWIndexedDb").getDB().then(function(){return d("MAWReStoreDbSetup").getDB()}):h=d("MAWReStoreDbSetup").getDB());return h}g.getDB=a}),98);
__d("MAWReStoreTiming",["FBLogger","MAWErrorObject","MAWLLAMigrationUtils","MAWQplProxy","MAWReStoreDb","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h=["MWPTransactor"];function i(a){a=d("MAWLLAMigrationUtils").getTransactorQPLParam(a);a=a.length===2?a:[null,void 0];var b=a[0];a=a[1];return b!=null?d("MAWQplProxy").startQplUserFlow(b,a):null}var j=c("FBLogger")("messenger_e2ee_web");function k(a){if(a)return j.catching(a);else return j}function a(a,c){return b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=(yield d("MAWReStoreDb").getDB()),e=i(a),f;try{e==null?void 0:e.addPoint("transactor_execution_start");for(var g=arguments.length,j=new Array(g),l=0;l<g;l++)j[l]=arguments[l];f=(yield c.apply(void 0,[b].concat(j)));e==null?void 0:e.addPoint("transactor_execution_end");e==null?void 0:e.endSuccess()}catch(b){var m;e==null?void 0:e.endFail("transaction_fail");var n=d("MAWErrorObject").getErrorObject(b);throw k(n).mustfixThrow("[%s] Error performing %s transaction",h.join("|"),(m=a)!=null?m:"")}return f})}g.measureDuration=a}),98);
__d("MAWUploadRetryStatusUtil",["FBLogger","MAWGlobals","MAWIndexedDb","MAWReStoreTiming","MAWTransactionMode","ReQL","WALogger","asyncToGeneratorRuntime","gkx","qex"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Unhandled error in postBackupWriteCompletionHook job: ",""]);h=function(){return a};return a}a=c("gkx")("23906")?d("MAWReStoreTiming").measureDuration("checkRetroactiveBackupsStateStore",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.tables.e2ee_retroactiveBackupsState,[])))!=null});return function(b){return a.apply(this,arguments)}}()):d("MAWIndexedDb").makeMsgrTransactor({retroactiveBackupsState:d("MAWTransactionMode").READONLY},"checkRetroactiveBackupsStateStore",function(a){return function(){return a.retroactiveBackupsState.count().then(function(a){return a>0?!0:!1})}});e=d("MAWIndexedDb").makeMsgrTransactor({uploadRetryStatus:d("MAWTransactionMode").READWRITE},"uploadRetry",function(a){return function(b){return a.uploadRetryStatus.bulkAdd(b.map(function(a){return{externalId:a.msg.externalId,lastRetryTs:a.lastRetryTs,retriedTimes:a.retriedTimes,traceId:a.traceId}})).then(function(a){})}});var i=d("MAWIndexedDb").makeMsgrTransactor({uploadRetryStatus:d("MAWTransactionMode").READWRITE},"bulkRemoveRetries",function(a){return function(b){return a.uploadRetryStatus.where("traceId").anyOf(b)["delete"]()}});f=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("postBackupWriteCompletionHook",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.traceIdArray;if(!(c("gkx")("23947")||c("qex")._("229")===!0))return;if(a==null||a.length===0){c("FBLogger")("labyrinth_web").info("[labyrinth_web] postBackupWriteCompletionHook get null/empty input.");return}try{yield i(a)}catch(a){d("WALogger").ERROR(h(),a)}});return function(b){return a.apply(this,arguments)}}()).end();g.checkRetroactiveBackupsStateStore=a;g.bulkInsert=e;g.bulkRemove=i;g.postBackupWriteCompletionHook=f}),98);
__d("MAWUploadMessagesBackup",["$InternalEnum","EchoBackupCompareUtils","EchoMessage","LSDataTraceCheckPoint","LSDataTraceType","LSEBPayloadSerializerError","LSIntEnum","LSMEBTaskCreationSource","MAWBridge","MAWBridgeEventTransmitter","MAWBridgeTrace","MAWBridgeUpload","MAWConstants","MAWDbMsg","MAWDbMsgTxns","MAWDbMsgUtil","MAWDbPendingStanza","MAWDbThreadTxns","MAWDbXMA","MAWDexieTable","MAWEBBackendQPLUtils","MAWEBSwitch","MAWEBUploadMessageUtils","MAWEBUploadTrackingUtils","MAWEncryptedBackupCacheManager","MAWGlobals","MAWHMACKey","MAWHandlePendingStanzasInRestoreV2","MAWIndexedDb","MAWQplProxy","MAWReceiveToUploadUtils","MAWTraceUtils","MAWTransactionMode","MAWUploadRetryStatusUtil","Promise","WAGlobals","WAJids","WALogger","WAProtocolMsgId","WAStanzaUtils","WATimeUtils","asyncToGeneratorRuntime","cr:5916","gkx","qex","qpl","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Cannot proceed with encodeAndSendEchoMessage: Encrypted Backups are not enabled"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Cannot proceed with encodeAndSendEchoMessage: Encrypted Backups are not enabled"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] ",""]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Duplicated upload stopped by cache, extId: ",""]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] threadJid is null for pendingStanza"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] thread is null for pendingStanza"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] externalId is null for pendingStanza"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] pendingStanzaMessageType: "," not supported"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Unhandled error in uploadMessagesBackup job: ",""]);v=function(){return a};return a}var w=c("requireDeferred")("EchoSerializationFailureFalcoEvent").__setRef("MAWUploadMessagesBackup"),x=c("requireDeferred")("EchoSerializationSuccessFalcoEvent").__setRef("MAWUploadMessagesBackup"),y=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("echoSerialization",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.messageIds,c=a.oldTraceIdMap,e=a.pendingStanzaIds,f=a.reactionIds,g=a.uploadTrackingInstanceMap;a=a.xmaIds;try{a=d("MAWDbXMA").convertNumbersToXMAIds(a);e=(e=e)!=null?e:[];yield A(b,e,f,a,c,g)}catch(a){d("WALogger").ERROR(v(),a)}});return function(b){return a.apply(this,arguments)}}()).end();function a(a){return a==null?[]:a.filter(Boolean).map(function(a){if(a!=null)return d("MAWDbMsg").toMsgId(a)}).filter(Boolean)}var z=b("$InternalEnum").Mirrored(["FATAL","WARN"]);function A(a,b,c,d,e,f){a=F(a,b,c,d).then(function(a){return R(a,void 0,!1,e,f)});return a.then(function(){})}function B(a,b){return a.messages.bulkGet(b).then(function(a){return a.filter(Boolean)})}function C(a,b){return a.pendingStanzas.bulkGet(b).then(function(a){return a.filter(Boolean).map(function(a){var b=a.pendingContent.type;if(b==null||b!==d("MAWDbPendingStanza").PENDING_TYPE.REVOKED&&b!==d("MAWDbPendingStanza").PENDING_TYPE.DELETE_FOR_ME){d("WALogger").WARN(u(),b);return}b=a.pendingContent.content.externalId;if(b==null){d("WALogger").WARN(t());return}b=a.pendingContent.content.thread;if(b==null){d("WALogger").WARN(s());return}b=a.pendingContent.content.threadJid;if(b==null){d("WALogger").WARN(r());return}d("MAWHandlePendingStanzasInRestoreV2").issuePointQueryForPendingStanza(a)})}).then(function(a){return[]})}function D(a,b){return a.reactions.bulkGet(b).then(function(b){b=b.filter(Boolean).map(function(b){return d("MAWDbThreadTxns").getThreadByJid(a,b.threadJid).then(function(e){var f=e.success?e.value:null;if(f!=null&&f.chatId!=null){e=b.reactToAuthor;e=e===d("WAGlobals").getMyUserJid()?d("WAJids").AUTHOR_ME:e;return d("MAWDbMsgTxns").maybeGetMsgByExternalId(a,b.reactToExternalId,f.chatId,e).then(function(a){if(a==null&&!d("MAWEncryptedBackupCacheManager").peekRestoreCache(b.reactToExternalId)){var e=d("WAJids").threadIdForChatJid(f.jid);d("MAWEncryptedBackupCacheManager").addMsgEntryToReuploadCache(f.chatId,b.reactToExternalId);d("MAWBridgeEventTransmitter").issuePointQueryOutsideTxn(b.reactToExternalId,e,void 0,c("LSMEBTaskCreationSource").EB_POINT_QUERY_IN_ACT,f.jid)}return a})}})});return d("MAWDexieTable").dexieAll(b).then(function(a){return a.filter(Boolean)})})}function E(a,b){b=b.filter(Boolean);return a.xma.bulkGet(b).then(function(b){b=b.map(function(a){return a==null?void 0:a.associatedMessageId}).filter(Boolean);return a.messages.where("msgId").anyOf(b).toArray()})}var F=d("MAWIndexedDb").makeMsgrTransactor({messages:(j=d("MAWTransactionMode")).READONLY,pendingStanzas:j.READONLY,reactions:j.READONLY,threads:j.READONLY,xma:j.READONLY},"uploadMsgBackupGetMsgs",function(a){return function(b,c,d,e){return T(a,b,c,d,e)}});function G(a,b,c){H({tag:"UploadMessageByBatch",value:{checkPoint:a,messages:b,qpl:c}})}function H(a){a=[a];d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:a})}function I(a,b,e){var f=[],g=[];if(a!=null){var h=c("gkx")("23946"),j=c("qpl")._(521485625,"1876");b.forEach(function(b){var c=b.checkPoint;b=b.pointName;h&&b!=null&&f.push({action:{name:b,type:"point"},annotations:null,event:j,instanceKey:d("MAWEBBackendQPLUtils").getQplInstanceKey(a),timestamp:d("MAWQplProxy").performanceAbsoluteNow()});g.push(d("MAWBridgeTrace").createBridgeTraceRecordCheckpointData((i||(i=d("LSIntEnum"))).ofNumber(c),(b=e)!=null?b:a,void 0,!1,-1,void 0))})}return{checkPointArray:g,qplArray:f}}function J(a,b,c,e,f,g){var h=b.xOfflineThreadingId;if(h==null)return!1;var i=d("WAStanzaUtils").toStanzaId(h);if(d("MAWEncryptedBackupCacheManager").getRestoredCacheStatus(i)==="done"){var j=d("EchoBackupCompareUtils").buildEchoDocCacheValue(b);j=d("EchoBackupCompareUtils").echoEquals(j,d("MAWEncryptedBackupCacheManager").getRestoredCache(i));d("MAWEncryptedBackupCacheManager").removeFromRestoredCache(i);if(j){d("WALogger").LOG(q(),i);return!1}}if(c!=null&&e!=null){j=window.performance.now();i=d("EchoMessage").encodeEchoMessage(b);var k=window.performance.now();a.push(d("MAWBridgeUpload").createBridgeUploadMessage(h,b.threadId,d("MAWEBUploadMessageUtils").echoOverrideMessageSortOrder(c),c.serverTs,(k-j)*1e6,i,1,null,null,e,O(g,c.externalId),f));P("point",g,c.externalId,"construct_echo_success");L(c.externalId,e);return!0}return!1}function K(a,b){a!=null&&d("MAWReceiveToUploadUtils").checkUploadEligbility(a)&&void w.load().then(function(c){return c.log(function(){return{message_id:a,trace_id:b}})})}function L(a,b){a!=null&&d("MAWReceiveToUploadUtils").checkUploadEligbility(a)&&void x.load().then(function(c){return c.log(function(){return{message_id:a,trace_id:b}})})}function M(a,b,c){if(a==null||b==null)return c;else{b=O(b,a.externalId);if(b!=null)return b.toString();else return c}}function N(a,e,f){var g=new Map();a.forEach(function(a){return g.set(a.dbMsg.externalId,a)});return S(a).then(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=[],h=[],j=[];a.forEach(function(a){var k,l=g.get(a.externalId)||{dbMsg:null,traceId:null},m=l.dbMsg;l=l.traceId;k=m!=null?(k=e==null?void 0:e.find(function(a){var b=d("MAWDbMsgUtil").getProtocolMsgIdFromDbMsg(m);return b==null?!1:d("WAProtocolMsgId").equals(a.msgId,b)}))!=null?k:void 0:void 0;var n=a.echoMessage,o=[],q=M(m,f,l);if(a.maybeErrorDetail!=null){a=a.maybeErrorDetail;if(m!=null&&l!=null)if(a.uploadErrorType===z.WARN||a.errorCode===c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID){var r;r=a.uploadErrorType===z.WARN?"possible error when constructing echo message: "+((r=a.errorMsg)!=null?r:""):"media info invalid thrown from constructEchoMessage, error msg: "+((r=a.errorMsg)!=null?r:"");d("WALogger").WARN(p(),r);P("success",f,m.externalId,"construct_echo_success_media/xma_warn/error",{string:{errorMsg:r}});K(m.externalId,l)}else{b.push(d("MAWBridgeUpload").createBridgeUploadMessage((r=n==null?void 0:n.xOfflineThreadingId)!=null?r:"0",(r=n==null?void 0:n.threadId)!=null?r:"0",d("MAWEBUploadMessageUtils").echoOverrideMessageSortOrder(m),m.serverTs,null,null,1,a.errorCode,a.errorMsg,l,O(f,m.externalId),k));P("fail",f,m.externalId,"construct_echo_failed",{string:{errorMsg:a.errorMsg}});L(m.externalId,l)}return}if((n==null?void 0:n.xOfflineThreadingId)==null){if(m!=null&&l!=null){b.push(d("MAWBridgeUpload").createBridgeUploadMessage("0",(r=n==null?void 0:n.threadId)!=null?r:"0",d("MAWEBUploadMessageUtils").echoOverrideMessageSortOrder(m),m.serverTs,null,null,1,c("LSEBPayloadSerializerError").OTID_NOT_FOUND_IN_ACT_MESSAGES,null,l,O(f,m.externalId),k));P("fail",f,m.externalId,"construct_echo_failed",{string:{errorMsg:"oitd not found"}});L(m.externalId,l)}}else{a=J(b,n,m,l,k,f);if(!a){m!=null&&P("success",f,m.externalId,"construct_echo_success_duplicate_message",{string:{errorMsg:"not unique from cache"}});return}}o.push({checkPoint:c("LSDataTraceCheckPoint").LABYRINTH_WEB_UPLOAD_ISSUE_MESSAGE_UPLOAD_UI_EVENT,pointName:"issue_message_upload_ui_event"});r=I(l,o,q);n=r.checkPointArray;k=r.qplArray;h.push.apply(h,k);j.push.apply(j,n);d("MAWTraceUtils").startNewTrace((i||(i=d("LSIntEnum"))).ofNumber(c("LSDataTraceType").ENCRYPTED_BACKUPS_UPLOAD),d("MAWTraceUtils").CONTEXT_BACKUP_UPLOAD,q);(b.length>=d("MAWConstants").BRIDGE_UPLOAD_BATCH_SIZE||j.length>=d("MAWConstants").BRIDGE_UPLOAD_BATCH_SIZE)&&(G(j.slice(),b.slice(),h.slice()),j.length=0,b.length=0,h.length=0)});(b.length>0||j.length>0)&&G(j,b,h);return a});return function(b){return a.apply(this,arguments)}}())}function O(a,b){return a.get(b)}function P(a,b,c,e,f){b=O(b,c);if(b!=null)switch(a){case"success":d("MAWEBUploadTrackingUtils").endSuccess(b,e,f);break;case"fail":d("MAWEBUploadTrackingUtils").endFail(b,e,f);break;case"point":d("MAWEBUploadTrackingUtils").addPoint(b,e,f);break}}function Q(a){var b=new Set(),c=[];a.forEach(function(a){var e=a.externalId+"|"+a.thread.toString()+"|"+a.author;d("MAWEncryptedBackupCacheManager").getRestoredCacheStatus(a.externalId)!=="restoring"&&!b.has(e)&&(b.add(e),c.push(a))});return c}function R(a,e,f,g,i,j){if(!c("MAWEBSwitch").isEnabled()){d("WALogger").LOG(o());i.forEach(function(a,b){d("MAWEBUploadTrackingUtils").endSuccess(a,"upload_tracking_cancelled_eb_turned_off_upload",{string:{externalId:b,from:"uploadUniqueMessage"}})});return(h||(h=b("Promise"))).resolve()}var k=Q(a).filter(function(a){return d("MAWEBUploadTrackingUtils").isUploadSupported(a)}).map(function(a){var b;P("point",i,a.externalId,"construct_echo_start",f!=null?{bool:{isRetroactiveBackupsUpload:f}}:void 0);b=((b=O(i,a.externalId))!=null?b:d("MAWTraceUtils").createTraceId()).toString();d("MAWEBBackendQPLUtils").startEBBackupUploadQplUserFlow(f,b);f!=null&&f&&d("MAWEBBackendQPLUtils").addPointEBBackupUpload(b,"retroactive_backup_upload_started");return{lastRetryTs:d("WATimeUtils").millisTime(),msg:a,retriedTimes:0,traceId:b}});return(c("gkx")("23947")||c("qex")._("229")===!0?d("MAWUploadRetryStatusUtil").bulkInsert(k):(h||(h=b("Promise"))).resolve()).then(function(a){return U(k.map(function(a){var b=a.msg.quoteExternalId;if(b!=null)return{dbMsg:a.msg,quotedMsg:e==null?void 0:e.get(b),traceId:a.traceId};else return{dbMsg:a.msg,traceId:a.traceId}}),g,j,i)}).then(function(){return(h||(h=b("Promise"))).resolve()})}function e(a,e,f){if(!c("MAWEBSwitch").isEnabled()){d("WALogger").LOG(n());e.forEach(function(a,b){d("MAWEBUploadTrackingUtils").endSuccess(a,"upload_tracking_cancelled_eb_turned_off_upload",{string:{externalId:b,from:"uploadMessageFromUploadQueue"}})});return(h||(h=b("Promise"))).resolve()}return U(a.filter(function(a){return d("MAWEBUploadTrackingUtils").isUploadSupported(a)}).map(function(a){var b;b=((b=O(e,a.externalId))!=null?b:d("MAWTraceUtils").createTraceId()).toString();return{dbMsg:a,traceId:b}}),void 0,f,e).then(function(){return(h||(h=b("Promise"))).resolve()})}var S=d("MAWIndexedDb").makeMsgrAndSignalTransactor({contacts:j.READONLY,editMsgHistory:j.READONLY,media:j.READONLY,mediaBackup:j.READONLY,messages:j.READONLY,reactions:j.READONLY,threads:j.READONLY,xma:j.READONLY},"constructEchoMessage",function(a){return function(){for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b("cr:5916").constructEchoMessage.apply(b("cr:5916"),[a].concat(d))}});function T(a,b,e,f,g){b=B(a,b);c("gkx")("23948")?C(a,e):d("MAWDexieTable").dexieResolve();e=D(a,f);f=E(a,g);return d("MAWDexieTable").dexieAll([b,e,f]).then(function(a){return a.flat()})}function U(a,e,f,g){var j=new Map();a.forEach(function(a){var b=a.dbMsg;a=a.traceId;d("MAWEBBackendQPLUtils").addPointEBBackupUpload(a,"echo_message_upload_begin",{string:{message_type:b.type}});var f=d("MAWQplProxy").startQplUserFlow(c("qpl")._(521475102,"868"),{bool:{eb_switch:c("MAWEBSwitch").isEnabled()},"int":{sort_order:b.sortOrderMs,timestamp:Date.now()},string:{hashed_msgid:V(b.externalId),message_id:b.externalId,message_type:b.type.toString(),org_trace_id:e==null?void 0:e.get(b.externalId),trace_id:a}});j.set(b.externalId,{constructEchoFlow:f,traceId:a})});a=N(a,f,g)["catch"](function(a){a="[labyrinth_web] Error while encode and upload message to backup: "+String(a);d("WALogger").ERROR(m(),a);for(var e of j.values())d("MAWEBBackendQPLUtils").endFailEBBackupUpload(e.traceId,"echo_message_upload_failure",{string:{error_message:a}}),d("MAWTraceUtils").recordFailureAndFlushForTraceId(e.traceId,(i||(i=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_WEB_ECHO_MESSAGE_UPLOAD_FAILURE),[],a),e.constructEchoFlow.endFail("serialisation_failure");return(h||(h=b("Promise"))).resolve()});return a.then(function(a){a==null?void 0:a.forEach(function(a){var b;b=(b=a.echoMessage)==null?void 0:b.messageId;if(b!=null&&j.has(d("WAStanzaUtils").toStanzaId(b))){var e;b=j.get(d("WAStanzaUtils").toStanzaId(b))||{constructEchoFlow:null,traceId:null};var f=b.constructEchoFlow;b=b.traceId;e=a==null?void 0:(e=a.maybeErrorDetail)==null?void 0:e.uploadErrorType;a=a==null?void 0:(a=a.maybeErrorDetail)==null?void 0:a.errorMsg;if(e!=null)switch(e){case z.WARN:a!=null&&d("WALogger").WARN(l(),a);f==null?void 0:f.endSuccess({bool:{is_skipped:!0}});b!=null&&(d("MAWEBBackendQPLUtils").addPointEBBackupUpload(b,"echo_message_upload_invalid_request"),d("MAWTraceUtils").recordInvalidUploadRequestAndFlushTrace(b,(i||(i=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_WEB_ECHO_MESSAGE_UPLOAD_INVALID_REQUEST),[]));break;case z.FATAL:a=(e=a)!=null?e:"[labyrinth_web] unknown error in the upload message flow";d("WALogger").ERROR(k(),a);b!=null&&(d("MAWEBBackendQPLUtils").endFailEBBackupUpload(b,"echo_message_upload_failure",{string:{error_message:a}}),d("MAWTraceUtils").recordFailureAndFlushForTraceId(b,(i||(i=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_WEB_ECHO_MESSAGE_UPLOAD_FAILURE),[],a));f==null?void 0:f.endFail("serialisation_failure");break}else f==null?void 0:f.endSuccess()}});return(h||(h=b("Promise"))).resolve()})}function V(a){if(a==null)return"";var b=d("MAWGlobals").getHMACKey();return d("MAWHMACKey").hmacTweetNaCl(a,b)}function f(a,b){var e=d("MAWTraceUtils").startNewTrace((i||(i=d("LSIntEnum"))).ofNumber(c("LSDataTraceType").ENCRYPTED_BACKUPS_UPLOAD),d("MAWTraceUtils").CONTEXT_BACKUP_UPLOAD);d("MAWTraceUtils").recordCheckpointForTrace(e,i.ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_WEB_ECHO_MESSAGE_UPLOAD_BEGIN),[d("MAWTraceUtils").getTagForMsgType(a.type)],!1);b=b==null?a.thread.toString():d("WAJids").threadIdForChatJid(b);d("MAWIndexedDb").afterTransaction({tag:"UploadMessage",value:d("MAWBridgeUpload").createBridgeUploadMessage(a.externalId,b,d("MAWEBUploadMessageUtils").echoOverrideMessageSortOrder(a),a.serverTs,null,null,2,null,null,e,null)})}g.uploadMessagesBackup=y;g.convertStringMsgIdtoMsgId=a;g.UploadErrorType=z;g.deduplicateMessageArray=Q;g.uploadUniqueMessage=R;g.uploadMessageFromUploadQueue=e;g.getMessagesBackupForUpload=T;g.sendDeleteEchoMessage=f}),98);
__d("MAWHandlePendingStanzasInRestoreV2",["I64","LSMEBTaskCreationSource","MAWBridgeEventTransmitter","MAWDbPendingStanza","MAWDbPendingStanzaTxns","MAWDbThreadTxns","MAWDexieTable","MAWEBUploadTrackingUtils","MAWEncryptedBackupCacheManager","MAWIndexedDb","MAWReStoreTiming","MAWRestoreDbState","MAWTransactionMode","MAWUploadMessagesBackup","MAWWriteRevokeMessageTxns","Promise","ReQL","WAJids","WALogger","cr:553","nullthrows","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] pendingStanza type "," is not supported"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] revokedExternalId is null for pendingStanza"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] revokedExternalId is null for pendingStanza"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] threadJid is null for pendingStanza"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] pendingStanzaTs is null for pendingStanza"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] revokedExternalId is null for pendingStanza"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] externalId is null for pendingStanza"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Could not find thread for chatId "," for pendingStanza"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Delete For Me pending stanza does not need to be applied."]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] thread is null"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] pendingStanza type "," is not supported"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Pending Stanza not found in the cache. This shouldn't happen."]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] externalId is null for pendingStanza"]);v=function(){return a};return a}var w=(a=b("cr:553"))==null?void 0:a.structuredClone;e=function(a,c,d){a=a.restoredMsgsData;if(a){var e=a.newlyAddedMsgs;e=e.concat(a.existingMsgs);return x(e,c,d)}return(i||(i=b("Promise"))).resolve()};var x=function(a,e,f){f==null?void 0:f.addPoint("apply_pending_stanza_start");var g=0,h=0,j=0,k=0,l=new Map();return F().then(function(a){a==null?void 0:a.map(function(a){var b=a.pendingContent.content.externalId;if(b==null){d("WALogger").WARN(v());return}l.set(a.externalIdWithType,a)}),k=l.size}).then(function(){var b=new Set();return B(a).then(function(f){return d("MAWDexieTable").dexieAll(a.map(function(a){var c=a.externalId;if(e)if(d("MAWEncryptedBackupCacheManager").peekPendingStanzaCache(c)){var i=d("MAWEncryptedBackupCacheManager").getPendingStanzaCacheValue(c);if(i==null){d("WALogger").ERROR(u());return}return A(i,a,f,e).then(function(a){a!=null&&b.add(i);d("MAWEncryptedBackupCacheManager").removePendingStanzaCacheValue(c);l["delete"](i.externalIdWithType);a=i.pendingContent.type;a===d("MAWDbPendingStanza").PENDING_TYPE.REVOKED&&g++;h++})}else l.clear();else{var k=c+"_"+d("MAWDbPendingStanza").PENDING_REVOKED,m=l.get(k);if(m!=null)return A(m,a,f,e).then(function(a){a!=null&&(b.add(m),g++,j++),l["delete"](m.externalIdWithType)})}})).then(function(){if(!e){var a=y(l);g+=a[1];h+=a[0]+a[1];c("promiseDone")(z(Array.from(b)))}})})}).then(function(a){f==null?void 0:f.addPoint("apply_pending_stanza_end",{"int":{initialRestorePendingStanzaCount:j,pendingStanzasToBeUploadedCount:k,pointRestorePendingStanzaCount:h,revokedCount:g}});return(i||(i=b("Promise"))).resolve()})},y=function(a){var b=0,c=0;a.forEach(function(a){var e=a.pendingContent.type;e===d("MAWDbPendingStanza").PENDING_TYPE.REVOKED?c++:e===d("MAWDbPendingStanza").PENDING_TYPE.DELETE_FOR_ME&&b++;E(a)});a.clear();return[b,c]},z=d("MAWIndexedDb").makeMsgrTransactor({pendingStanzas:d("MAWTransactionMode").READWRITE},"deletePendingStanzasFromIndexedDB",function(a){return function(b){return d("MAWDbPendingStanzaTxns").deletePendingStanzas(a,b)}}),A=function(a,e,f,g){var h=a.pendingContent.type;if(h===d("MAWDbPendingStanza").PENDING_TYPE.REVOKED)return D(a,e,f,g).then(function(a){if(a!=null){var b=d("MAWEBUploadTrackingUtils").genInstanceKeyOnly();d("MAWEBUploadTrackingUtils").startUploadTracking(a.externalId,a.type,"pendingstanza",b);c("promiseDone")(d("MAWUploadMessagesBackup").uploadUniqueMessage([a],void 0,!1,void 0,new Map([[a.externalId,b]])))}});else if(h===d("MAWDbPendingStanza").PENDING_TYPE.DELETE_FOR_ME)return C(a);else{d("WALogger").WARN(t(),h);return(i||(i=b("Promise"))).resolve()}},B=d("MAWIndexedDb").makeMsgrTransactor({threads:d("MAWTransactionMode").READONLY},"getThreadsForMessages",function(a){return function(b){var c=[];b.forEach(function(a){c.push(a.thread)});return d("MAWDbThreadTxns").getThreads(a,c).then(function(a){var b=new Map();a.forEach(function(a){if(a==null){d("WALogger").WARN(s());return d("MAWDexieTable").dexieResolve()}b.set(a.chatId,a)});return b})}}),C=d("MAWIndexedDb").makeMsgrTransactor({pendingStanzas:d("MAWTransactionMode").READWRITE},"deleteForMeMsg",function(a){return function(b){d("WALogger").LOG(r());return d("MAWDexieTable").dexieAll([a.pendingStanzas["delete"](b.rowId)]).then(function(){return d("MAWDexieTable").dexieResolve(b)})}}),D=d("MAWIndexedDb").makeMsgrTransactor({chunk:d("MAWTransactionMode").READONLY,deletedMessages:d("MAWTransactionMode").READWRITE,groupInfo:d("MAWTransactionMode").READWRITE,media:d("MAWTransactionMode").READONLY,messages:d("MAWTransactionMode").READWRITE,pendingStanzas:d("MAWTransactionMode").READWRITE,reactions:d("MAWTransactionMode").READWRITE,threads:d("MAWTransactionMode").READWRITE,xma:d("MAWTransactionMode").READONLY},"revokeMessage",function(a){return function(b,c,e,f){var g=c.thread;e=e.get(c.thread);if(e==null){d("WALogger").ERROR(q(),g);return d("MAWDexieTable").dexieResolve()}g=b.pendingContent.content.externalId;if(g==null){d("WALogger").ERROR(p());return d("MAWDexieTable").dexieResolve()}var h=b.pendingContent.content.revokedExternalId;if(h==null){d("WALogger").ERROR(o());return d("MAWDexieTable").dexieResolve()}var i=b.pendingContent.content.ts;if(i==null){d("WALogger").ERROR(n());return d("MAWDexieTable").dexieResolve()}return d("MAWWriteRevokeMessageTxns").revokeUnstoredMsg(a,c,e,g,h,c.serverTs,c.ts,f).then(function(c){a.pendingStanzas["delete"](b.rowId);return d("MAWDexieTable").dexieResolve(c)})}});function E(a){var b=a.pendingContent.content.threadJid;if(b==null){d("WALogger").WARN(m());return}var e=d("WAJids").threadIdForChatJid(b),f=a.pendingContent.type;if(f===d("MAWDbPendingStanza").PENDING_TYPE.REVOKED){var g=a.pendingContent.content.revokedExternalId;if(g==null){d("WALogger").WARN(l());return}g=g}else if(f===d("MAWDbPendingStanza").PENDING_TYPE.DELETE_FOR_ME){var h=a.pendingContent.content.externalId;if(h==null){d("WALogger").WARN(k());return}g=h}else{d("WALogger").WARN(j(),f);return}d("MAWEncryptedBackupCacheManager").addPendingStanzaToPendingStanzaCache(g,a);d("MAWBridgeEventTransmitter").issuePointQueryOutsideTxn(g,e,void 0,c("LSMEBTaskCreationSource").EB_POINT_QUERY_IN_ACT,b)}var F=d("MAWRestoreDbState").isUsingShim()?d("MAWReStoreTiming").measureDuration("getAllPendingStanzas",function(a){return d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.tables.e2ee_pendingStanzas).map(function(a){a=c("nullthrows")(w)(a);return babelHelpers["extends"]({},a,{rowId:(h||(h=d("I64"))).to_float(a.rowId)})}))}):d("MAWIndexedDb").makeMsgrTransactor({pendingStanzas:d("MAWTransactionMode").READONLY},"getAllPendingStanzas",function(a){return function(){return d("MAWDbPendingStanzaTxns").getAllPendingStanzas(a)}});g.applyPendingStanzas=e;g.issuePointQueryForPendingStanza=E}),98);
__d("MAWWriteMsgTxns",["I64","MAWAddQPLPointForHandleIncomingMsgApi","MAWAfterWriteMsgUtil","MAWBridgeMsg","MAWBridgeTypesCreators","MAWBuildIncomingMsgs","MAWCalculateBumpTimestampMs","MAWDbMsg","MAWDbMsgTxns","MAWDbPendingStanzaTxns","MAWDbReactionsTxns","MAWDbThread","MAWDbThreadTxns","MAWDbUnrenderedMsgTxns","MAWDeleteForMeMsgContentCleaner","MAWDeleteThreadUtil","MAWDexieTable","MAWEBUploadMessageUtils","MAWEBUploadTrackingUtils","MAWEphemeralGatingUtil","MAWEphemeralMsgTxns","MAWFolderTypes","MAWGetMsgQuoteTxn","MAWGetOrCreateThreadTxns","MAWIndexedDb","MAWLoadReplyMediaTxns","MAWLocalizationUtils","MAWMsgType","MAWThreadEvent","MAWThreadSnippetBuildTxns","MAWThreadSnippetUtils","MAWTimeUtils","MAWUpdateQuotedMsgTxns","MAWWriteMsgSideEffectTxns","MAWWriteRevokeMessageTxns","WAGlobals","WAJids","WALogger","WATimeUtils","err","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["handle"," Msg: Message from ",", chat ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["writeMsgAfterTransaction - sortOrderMs is in the future. sortOrderMs: ",", current time: ",", serverTs: ",", suppliedSortOrder: ",", ts: ",", originalTs: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["writeMsgAfterTransaction - sortOrderMs: ",""]);k=function(){return a};return a}function l(a,b,e,f){var g=e.ts;g=[d("WATimeUtils").castUnixTimeToMillisTime(g),e.type===d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN];var h=g[0],i=g[1];return d("MAWGetOrCreateThreadTxns").getExistingThread(a,b.jid).then(function(b){if(b==null)throw c("err")("at this point there's always a thread - checking for updates");return d("MAWDbMsgTxns").getNextMsgIdNumberForThread(a,b).then(function(c){var g,j=d("MAWTimeUtils").ensureValidMillisTime(b.newestMsgTs)||d("WATimeUtils").castToMillisTime(0),k=h>j&&!i?h:j;j=(j=d("MAWTimeUtils").ensureValidMillisTime(b.lastReadMsgTs))!=null?j:0;g=(g=d("MAWTimeUtils").ensureValidMillisTime(b.newestMsgTs))!=null?g:0;j=j<g;var l=e.author===d("WAJids").AUTHOR_ME||e.type===d("MAWMsgType").MSG_TYPE.ADMIN&&d("MAWLocalizationUtils").isParticipantChangeAdminMsg(e.msgContent.adminType)&&!j,m=babelHelpers["extends"]({},e,{msgId:d("MAWDbMsg").craftMsgIdV2(b.chatId,c,e)});return d("MAWDbMsgTxns").calculateOldestAndNewestMsg(a,b.oldestMsg,b.newestMsg,m,f).then(function(a){var c=a.newestMsg;a=a.oldestMsg;var f=d("MAWThreadSnippetUtils").isDbMsgDisabledForThreadSnippet(m);return{msgId:m.msgId,updatedThread:babelHelpers["extends"]({},b,{lastReadMsg:l?m.msgId:b.lastReadMsg,lastReadMsgTs:l?k:b.lastReadMsgTs,newestMsg:c,newestMsgTs:k,oldestMsg:a,snippetMsg:f?b.snippetMsg:m.msgId,snippetMsgTs:f?b.snippetMsgTs:d("WATimeUtils").castUnixTimeToMillisTime(d("MAWDbMsg").getCanonicalTsFromMsg(e)),threadOrder:d("MAWDbThread").craftThreadOrder(k,b.jid)})}})})})}function m(a,b,e,f,g,h,i,m,n){f===void 0&&(f={});f=f;var o=f.isFirstMsg,p=o===void 0?!1:o;o=f.isOutgoing;var q=o===void 0?!1:o,r=f.openMessageOtid,s=f.openMessageParticipantCount,t=f.optimisticMsg,u=f.participantCount,v=f.quotedReplyAttachmentMeta;o=f.skipLocalThreadBump;var w=o===void 0?!1:o,x=f.sortOrderMs;o=c("gkx")("23926");f=o?(f=x)!=null?f:d("MAWEBUploadMessageUtils").echoOverrideMessageSortOrder(b):x;o=o?(o=x)!=null?o:d("MAWEBUploadMessageUtils").echoOverrideMessageSortOrder(b):d("MAWEBUploadMessageUtils").echoOverrideMessageSortOrder(b);var y=babelHelpers["extends"]({},b,{sortOrderMs:o});return l(a,e,b,f).then(function(b){var c=b.msgId,f=b.updatedThread,l=e.oldestMsg!=null&&f.oldestMsg!==e.oldestMsg,o=babelHelpers["extends"]({},y,{msgId:c});return m!=null&&m?a.messages.add(o).then(function(a){return babelHelpers["extends"]({},o,{rowId:a})}):d("MAWDexieTable").dexieAll([a.messages.add(o).then(function(a){return babelHelpers["extends"]({},o,{rowId:a})}),a.threads.put(f),d("MAWThreadSnippetUtils").isDbMsgDisabledForThreadSnippet(o)?null:d("MAWThreadSnippetBuildTxns").buildThreadSnippet(a,o,e)]).then(function(a){var b=a[0];a[1];a=a[2];q&&(d("WALogger").LOG(k(),b.sortOrderMs),b.sortOrderMs!=null&&b.sortOrderMs>Date.now()+60*1e3&&d("WALogger").ERROR(j(),b.sortOrderMs,Date.now(),b.serverTs,x,b.ts,b.originalTs));d("MAWAfterWriteMsgUtil").writeMsgAfterTransaction({dbMsg:b,ebRestore:g,hasMoreAfter:i,hasMoreBefore:h,isFirstMsg:p,isOldestMsgUpdated:l,msgsLeftToRestoreForEB:n,openMessageOtid:r,openMessageParticipantCount:s,optimisticMsg:t,participantCount:u,prevOldestMsg:e.oldestMsg==null?void 0:e.oldestMsg,quotedReplyAttachmentMeta:v,skipLocalThreadBump:w,snippet:a,updatedThread:f});return b})})}function n(a,b,e){return d("MAWGetOrCreateThreadTxns").getExistingThread(a,e.jid).then(function(e){if(e==null)throw c("err")("at this point there's always a thread - checking for updates");return d("MAWDbUnrenderedMsgTxns").getNextUnrenderedMsgIdNumberForThread(a,e).then(function(c){var f=babelHelpers["extends"]({},b,{msgId:d("MAWDbMsg").craftUnrenderedMsgId(e.chatId,c)});return d("MAWDexieTable").dexieAll([a.unrenderedMessages.add(f),a.threads.put(e)]).then(function(a){var b=a[0];a[1];return babelHelpers["extends"]({},f,{rowId:b})})})})}function a(a,b,c){var e=[b.externalId,c.chatId,b.author],f=e[0],g=e[1];e=e[2];d("MAWAddQPLPointForHandleIncomingMsgApi").addQPLPointForHIMApi("msg_queries_start");return d("MAWDexieTable").dexieAll([d("MAWDbMsgTxns").maybeGetMsgByExternalId(a,f,g,e),d("MAWDbPendingStanzaTxns").maybeGetPendingRevokedStanza(a,f,e,g),d("MAWDbPendingStanzaTxns").maybeGetPendingDeletedStanza(a,f,e,g),d("MAWDbMsgTxns").checkIfMsgIsDeletedForMeOrRevoked(a,f,g,e),d("MAWDbPendingStanzaTxns").maybeGetDeleteThreadFromPendingStanza(a,c.jid).then(function(a){return d("MAWDeleteThreadUtil").isMsgDeletedViaDeleteThread(b.ts,a)})]).then(function(a){var b=a[0],c=a[1],e=a[2],f=a[3];a=a[4];d("MAWAddQPLPointForHandleIncomingMsgApi").addQPLPointForHIMApi("msg_queries_end");return{existingMsg:(b=b)!=null?b:null,isDeletedWithThread:a,isDeleteForMeOrRevoked:f,pendingDeleteForMeStanza:(b=e)!=null?b:null,pendingRevokedStanza:(a=c)!=null?a:null}})}function b(a,b,e){return d("MAWDbPendingStanzaTxns").maybeGetPendingRevokedStanza(a,b.externalId,b.author,e.chatId).then(function(f){if(f!=null)return o(a,b,e,f);f=b.author;d("WALogger").DEV(i(),b.type,f,e.jid);var g=babelHelpers["extends"]({},babelHelpers["extends"]({},b,{thread:e.chatId,threadJid:e.jid}));e.folder===d("MAWFolderTypes").FOLDER_ID.OTHER&&(g.altIndex=g.altIndex===d("MAWDbMsg").FUTUREPROOF_ALT_INDEX?d("MAWDbMsg").FUTUREPROOF_SPAM_ALT_INDEX:d("MAWDbMsg").SPAM_ALT_INDEX);return d("MAWGetMsgQuoteTxn").getMsgQuoteInfo(a,g,e.jid).then(function(b){b!=null&&(g=babelHelpers["extends"]({},g,{quote:b==null?void 0:b.quote,quoteExternalId:b==null?void 0:b.quoteExternalId}));return d("MAWDexieTable").dexieAll([d("MAWUpdateQuotedMsgTxns").associateQuotedMessage(a,e.chatId,g),d("MAWLoadReplyMediaTxns").getReplyMediaForMsgQuote(a,g),d("MAWLoadReplyMediaTxns").getReplyMediaForMsg(a,g)]).then(function(b){var f=b[0],i=b[1],j=b[2];d("MAWAddQPLPointForHandleIncomingMsgApi").addQPLPointForHIMApi("write_incoming_msg_start");d("WAGlobals").getConfig().useEbUploadQueue()||d("MAWEBUploadTrackingUtils").maybeStartTrackingForMiddleware(g,"receive");b=c("gkx")("23996")&&g.altIndex!==d("MAWDbMsg").SPAM_ALT_INDEX&&g.altIndex!==d("MAWDbMsg").FUTUREPROOF_SPAM_ALT_INDEX&&g.author!==d("WAJids").AUTHOR_ME;return m(a,g,e,{quotedReplyAttachmentMeta:i,skipLocalThreadBump:b}).then(function(b){g.altIndex!==d("MAWDbMsg").SPAM_ALT_INDEX&&g.altIndex!==d("MAWDbMsg").FUTUREPROOF_SPAM_ALT_INDEX&&g.author!==d("WAJids").AUTHOR_ME&&(!c("gkx")("23996")?d("MAWIndexedDb").afterTransaction({tag:"ThreadBumpedServer",value:{description:"writeNewMessage-"+g.type,isCurrentDeviceSendingMsg:!1,lastActivityTs:d("WATimeUtils").castUnixTimeToMillisTime(g.ts),lastMsgExternalId:(h||(h=d("I64"))).of_string_opt(g.externalId),threadId:e.chatId,threadJid:e.jid}}):d("MAWThreadSnippetBuildTxns").buildThreadSnippet(a,b,e).then(function(a){var b=a.snippetParams,c=a.snippetSenderContactId;a=a.snippetType;var f=g.externalId!==void 0?(h||(h=d("I64"))).of_string_opt(g.externalId):void 0;f=d("MAWCalculateBumpTimestampMs").calculateBumpTimestampMs(d("WATimeUtils").castUnixTimeToMillisTime(g.ts),f);d("MAWIndexedDb").afterTransaction({tag:"ThreadBumpedV2",value:d("MAWBridgeTypesCreators").createBridgeBumpedThreadV2(e.chatId,e.jid,f,a,b,c,"writeNewIncomingMsg-"+g.type,!1)})}));d("MAWAddQPLPointForHandleIncomingMsgApi").addQPLPointForHIMApi("write_msg_additional_steps");return d("MAWDexieTable").dexieAll([d("MAWWriteMsgSideEffectTxns").updateParticipantTimestampsForMsg(a,g),d("MAWEphemeralGatingUtil").isSendBasedDisappearingMessageEnabled()?d("MAWEphemeralMsgTxns").markEphemeralMessageAsSent(a,b):d("MAWDexieTable").dexieResolve(b)]).then(function(a){a=a[1];f!=null&&f.forEach(function(a){d("MAWIndexedDb").afterTransaction({tag:"MsgUpdated",value:d("MAWBridgeMsg").createBridgeMsg(a,void 0,j)})});d("MAWAddQPLPointForHandleIncomingMsgApi").addQPLPointForHIMApi("write_incoming_msg_end");return a||b})})})})})}function e(a,b,c,e){var f=babelHelpers["extends"]({},babelHelpers["extends"]({},b,{msgId:c.msgId,rowId:c.rowId,serverTs:c.serverTs,sortOrderMs:c.sortOrderMs,thread:c.thread,threadJid:e.jid,ts:c.ts}));return d("MAWDexieTable").dexieAll([d("MAWUpdateQuotedMsgTxns").associateQuotedMessage(a,e.chatId,f),d("MAWLoadReplyMediaTxns").getReplyMediaForMsgQuote(a,f),d("MAWLoadReplyMediaTxns").getReplyMediaForMsg(a,f),d("MAWGetMsgQuoteTxn").getMsgQuoteInfo(a,f,e.jid)]).then(function(b){var c=b[0],g=b[1],h=b[2];b=b[3];f=babelHelpers["extends"]({},f,{quote:b==null?void 0:b.quote,quoteExternalId:b==null?void 0:b.quoteExternalId});d("MAWAddQPLPointForHandleIncomingMsgApi").addQPLPointForHIMApi("handle_ciphertext_start");return a.messages.put(f).then(function(){return d("MAWDbThreadTxns").needsRetroactiveReadReceiptInThread(a,f)}).then(function(b){if(b){f.altIndex=d("MAWDbMsg").craftToBeReadAltIndex(f.thread);return a.messages.put(f)}}).then(function(){d("MAWIndexedDb").afterTransaction({tag:"MsgUpdated",value:d("MAWBridgeMsg").createBridgeMsg(f,void 0,h)});d("MAWIndexedDb").afterTransaction({tag:"MsgUpdated",value:d("MAWBridgeMsg").createBridgeMsg(f,void 0,g)});d("MAWIndexedDb").afterTransactionThreadEvent({chatJid:e.jid,msgId:f.msgId},d("MAWThreadEvent").PLACEHOLDER_CONVERT_SUBSCRIPTION);c!=null&&c.forEach(function(a){d("MAWIndexedDb").afterTransaction({tag:"MsgUpdated",value:d("MAWBridgeMsg").createBridgeMsg(a,void 0,h)})});if(f.msgId===e.newestMsg){var b=f;b.rowId;b=babelHelpers.objectWithoutPropertiesLoose(b,["rowId"]);return d("MAWDexieTable").dexieAll([d("MAWThreadSnippetBuildTxns").buildThreadSnippet(a,f,e),d("MAWWriteMsgSideEffectTxns").updateParticipantTimestampsForMsg(a,b)]).then(function(a){a=a[0];var b=a.snippetParams,c=a.snippetSenderContactId;a=a.snippetType;d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread({snippetParams:b,snippetSenderContactId:c,snippetType:a,threadId:e.chatId,threadJid:e.jid})});return f})}d("MAWAddQPLPointForHandleIncomingMsgApi").addQPLPointForHIMApi("handle_ciphertext_end");return f})})}function f(a,b,c,e){d("MAWAddQPLPointForHandleIncomingMsgApi").addQPLPointForHIMApi("handle_dfm_message_start");var f=d("MAWBuildIncomingMsgs").buildUnstoredDeleteForMeMsg(b,c);return d("MAWDexieTable").dexieAll([d("MAWDbReactionsTxns").deleteReactionsByUniqueMsgIdentifiers(a,[{author:f.author,chatId:f.thread,externalId:f.externalId}]),n(a,f,c),a.pendingStanzas["delete"](e.rowId)]).then(function(a){a[0];a=a[1];d("MAWAddQPLPointForHandleIncomingMsgApi").addQPLPointForHIMApi("handle_dfm_message_end");d("MAWDeleteForMeMsgContentCleaner").addNewDeleteForMeMsgContentCleanerTimestamp(f.messageDeleteForMeTs);return babelHelpers["extends"]({},f,{msgId:a.msgId,rowId:a.rowId})})}function o(a,b,e,f){var g=d("MAWDbPendingStanzaTxns").getRevokedContent(f);if(g==null)throw c("err")("missing revoked content");b=d("MAWBuildIncomingMsgs").buildUnstoredRevokedMsg(b,e,g);d("MAWAddQPLPointForHandleIncomingMsgApi").addQPLPointForHIMApi("handle_revoke_message_start");return d("MAWDexieTable").dexieAll([m(a,b,e),a.pendingStanzas["delete"](f.rowId)]).then(function(b){var c=b[0];return d("MAWWriteRevokeMessageTxns").markIncomingMessageRevoked(a,c,e).then(function(){d("MAWAddQPLPointForHandleIncomingMsgApi").addQPLPointForHIMApi("handle_revoke_message_end");return c})})}g.writeMsg=m;g.writeUnrenderedMsg=n;g.prepareMsgWriteData=a;g.writeNewIncomingMsg=b;g.writeCiphertextUpdate=e;g.handleDeleteForMeMessage=f;g.handleOutOfOrderRevokedMessage=o}),98);
__d("MAWAdminWriteUserDeviceMsgTxn",["MAWAckLevel","MAWDexieTable","MAWExternalId","MAWGlobals","MAWJids","MAWLocalizationType","MAWLocalizationUtils","MAWMsgType","MAWWriteMsgTxns","WAAdminMsgHelpers","WAJids","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";c={add:"add",remove:"remove",update:"update"};function h(a,b){switch(a){case"add":if(b)return d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_DEVICE;else return d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_DEVICE;case"remove":if(b)return d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_DEVICE;else return d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_DEVICE;case"update":if(b)return d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_UPDATED_DEVICE;else return d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_UPDATED_DEVICE}}function a(a,b,c,e,f){if(c.newestMsg==null)return d("MAWDexieTable").dexieResolve();var g=b===d("MAWGlobals").getMyUserJid();e=h(e,g);g=g?[]:[d("MAWJids").userIdFromJid(b)];b=d("MAWLocalizationUtils").buildUnstoredDbAdminMsg({adminMsgContent:g,adminType:e,version:1},c.chatId,c.jid,f);return d("MAWWriteMsgTxns").writeMsg(a,b,c).then(function(){})}function b(a,b,c,e){var f=d("WAAdminMsgHelpers").UNKNOWN_USER,g=b===d("MAWGlobals").getMyUserJid();b={ack:d("MAWAckLevel").ACK.received,altIndex:void 0,author:g?d("WAJids").AUTHOR_ME:b,externalId:d("MAWExternalId").generateExternalId(),msgContent:{adminType:d("MAWLocalizationType").LOCALIZATION_TYPE.ICDC_ALERT_ADMIN_MESSAGE,authorName:f},thread:c.chatId,threadJid:c.jid,ts:(g=e)!=null?g:d("WATimeUtils").unixTime(),type:d("MAWMsgType").MSG_TYPE.ICDC_ALERT};return d("MAWWriteMsgTxns").writeMsg(a,b,c).then(function(){})}g.DeviceChange=c;g.getUserDeviceAdminType=h;g.writeUserDeviceAdminMsg=a;g.writeICDCAlert=b}),98);
__d("WAConsumerApplication.pb",["WACommon.pb","WAProtoConst"],(function(a,b,c,d,e,f,g){var h;a={SMALL:1,MEDIUM:2,LARGE:3};b={SANS_SERIF:0,SERIF:1,NORICAN_REGULAR:2,BRYNDAN_WRITE:3,BEBASNEUE_REGULAR:4,OSWALD_HEAVY:5};c={NONE:0,VIDEO:1};e={};f={};var i={},j={},k={},l={},m={},n={},o={},p={},q={},r={},s={},t={},u={},v={},w={},x={},y={},z={},A={},B={},C={},D={},E={},F={},G={},H={},I={},J={},K={},L={},M={};e.internalSpec={payload:[1,(h=d("WAProtoConst")).TYPES.MESSAGE,f],metadata:[2,h.TYPES.MESSAGE,j]};f.internalSpec={content:[1,h.TYPES.MESSAGE,m],applicationData:[2,h.TYPES.MESSAGE,l],signal:[3,h.TYPES.MESSAGE,k],subProtocol:[4,h.TYPES.MESSAGE,i],__oneofs__:{payload:["content","applicationData","signal","subProtocol"]}};i.internalSpec={futureProof:[1,h.TYPES.ENUM,(d=d("WACommon.pb")).FUTURE_PROOF_BEHAVIOR]};j.internalSpec={specialTextSize:[1,h.TYPES.ENUM,a]};k.internalSpec={};l.internalSpec={revoke:[1,h.TYPES.MESSAGE,v],__oneofs__:{applicationContent:["revoke"]}};m.internalSpec={messageText:[1,h.TYPES.MESSAGE,d.MessageTextSpec],imageMessage:[2,h.TYPES.MESSAGE,I],contactMessage:[3,h.TYPES.MESSAGE,A],locationMessage:[4,h.TYPES.MESSAGE,D],extendedTextMessage:[5,h.TYPES.MESSAGE,C],statusTextMessage:[6,h.TYPES.MESSAGE,B],documentMessage:[7,h.TYPES.MESSAGE,F],audioMessage:[8,h.TYPES.MESSAGE,H],videoMessage:[9,h.TYPES.MESSAGE,G],contactsArrayMessage:[10,h.TYPES.MESSAGE,z],liveLocationMessage:[11,h.TYPES.MESSAGE,y],stickerMessage:[12,h.TYPES.MESSAGE,E],groupInviteMessage:[13,h.TYPES.MESSAGE,x],viewOnceMessage:[14,h.TYPES.MESSAGE,w],reactionMessage:[16,h.TYPES.MESSAGE,u],pollCreationMessage:[17,h.TYPES.MESSAGE,s],pollUpdateMessage:[18,h.TYPES.MESSAGE,r],editMessage:[19,h.TYPES.MESSAGE,n],__oneofs__:{content:["messageText","imageMessage","contactMessage","locationMessage","extendedTextMessage","statusTextMessage","documentMessage","audioMessage","videoMessage","contactsArrayMessage","liveLocationMessage","stickerMessage","groupInviteMessage","viewOnceMessage","reactionMessage","pollCreationMessage","pollUpdateMessage","editMessage"]}};n.internalSpec={key:[1,h.TYPES.MESSAGE,d.MessageKeySpec],message:[2,h.TYPES.MESSAGE,d.MessageTextSpec],timestampMs:[3,h.TYPES.INT64]};o.internalSpec={pollOption:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,t]};p.internalSpec={selectedOptions:[1,h.FLAGS.REPEATED|h.TYPES.BYTES],senderTimestampMs:[2,h.TYPES.INT64]};q.internalSpec={encPayload:[1,h.TYPES.BYTES],encIv:[2,h.TYPES.BYTES]};r.internalSpec={pollCreationMessageKey:[1,h.TYPES.MESSAGE,d.MessageKeySpec],vote:[2,h.TYPES.MESSAGE,q],addOption:[3,h.TYPES.MESSAGE,q]};s.internalSpec={encKey:[1,h.TYPES.BYTES],name:[2,h.TYPES.STRING],options:[3,h.FLAGS.REPEATED|h.TYPES.MESSAGE,t],selectableOptionsCount:[4,h.TYPES.UINT32]};t.internalSpec={optionName:[1,h.TYPES.STRING]};u.internalSpec={key:[1,h.TYPES.MESSAGE,d.MessageKeySpec],text:[2,h.TYPES.STRING],groupingKey:[3,h.TYPES.STRING],senderTimestampMs:[4,h.TYPES.INT64],reactionMetadataDataclassData:[5,h.TYPES.STRING],style:[6,h.TYPES.INT32]};v.internalSpec={key:[1,h.TYPES.MESSAGE,d.MessageKeySpec]};w.internalSpec={imageMessage:[1,h.TYPES.MESSAGE,I],videoMessage:[2,h.TYPES.MESSAGE,G],__oneofs__:{viewOnceContent:["imageMessage","videoMessage"]}};x.internalSpec={groupJid:[1,h.TYPES.STRING],inviteCode:[2,h.TYPES.STRING],inviteExpiration:[3,h.TYPES.INT64],groupName:[4,h.TYPES.STRING],jpegThumbnail:[5,h.TYPES.BYTES],caption:[6,h.TYPES.MESSAGE,d.MessageTextSpec]};y.internalSpec={location:[1,h.TYPES.MESSAGE,L],accuracyInMeters:[2,h.TYPES.UINT32],speedInMps:[3,h.TYPES.FLOAT],degreesClockwiseFromMagneticNorth:[4,h.TYPES.UINT32],caption:[5,h.TYPES.MESSAGE,d.MessageTextSpec],sequenceNumber:[6,h.TYPES.INT64],timeOffset:[7,h.TYPES.UINT32]};z.internalSpec={displayName:[1,h.TYPES.STRING],contacts:[2,h.FLAGS.REPEATED|h.TYPES.MESSAGE,A]};A.internalSpec={contact:[1,h.TYPES.MESSAGE,d.SubProtocolSpec]};B.internalSpec={text:[1,h.TYPES.MESSAGE,C],textArgb:[6,h.TYPES.FIXED32],backgroundArgb:[7,h.TYPES.FIXED32],font:[8,h.TYPES.ENUM,b]};C.internalSpec={text:[1,h.TYPES.MESSAGE,d.MessageTextSpec],matchedText:[2,h.TYPES.STRING],canonicalUrl:[3,h.TYPES.STRING],description:[4,h.TYPES.STRING],title:[5,h.TYPES.STRING],thumbnail:[6,h.TYPES.MESSAGE,d.SubProtocolSpec],previewType:[7,h.TYPES.ENUM,c]};D.internalSpec={location:[1,h.TYPES.MESSAGE,L],address:[2,h.TYPES.STRING]};E.internalSpec={sticker:[1,h.TYPES.MESSAGE,d.SubProtocolSpec]};F.internalSpec={document:[1,h.TYPES.MESSAGE,d.SubProtocolSpec],fileName:[2,h.TYPES.STRING]};G.internalSpec={video:[1,h.TYPES.MESSAGE,d.SubProtocolSpec],caption:[2,h.TYPES.MESSAGE,d.MessageTextSpec]};H.internalSpec={audio:[1,h.TYPES.MESSAGE,d.SubProtocolSpec],ptt:[2,h.TYPES.BOOL]};I.internalSpec={image:[1,h.TYPES.MESSAGE,d.SubProtocolSpec],caption:[2,h.TYPES.MESSAGE,d.MessageTextSpec]};J.internalSpec={polygonVertices:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,K],location:[2,h.TYPES.MESSAGE,L],__oneofs__:{action:["location"]}};K.internalSpec={x:[1,h.TYPES.DOUBLE],y:[2,h.TYPES.DOUBLE]};L.internalSpec={degreesLatitude:[1,h.TYPES.DOUBLE],degreesLongitude:[2,h.TYPES.DOUBLE],name:[3,h.TYPES.STRING]};M.internalSpec={protocol:[1,h.TYPES.MESSAGE,d.SubProtocolSpec]};g.CONSUMER_APPLICATION_METADATA_SPECIAL_TEXT_SIZE=a;g.CONSUMER_APPLICATION_STATUS_TEXT_MESAGE_FONT_TYPE=b;g.CONSUMER_APPLICATION_EXTENDED_TEXT_MESSAGE_PREVIEW_TYPE=c;g.ConsumerApplicationSpec=e;g.ConsumerApplication$PayloadSpec=f;g.ConsumerApplication$SubProtocolPayloadSpec=i;g.ConsumerApplication$MetadataSpec=j;g.ConsumerApplication$SignalSpec=k;g.ConsumerApplication$ApplicationDataSpec=l;g.ConsumerApplication$ContentSpec=m;g.ConsumerApplication$EditMessageSpec=n;g.ConsumerApplication$PollAddOptionMessageSpec=o;g.ConsumerApplication$PollVoteMessageSpec=p;g.ConsumerApplication$PollEncValueSpec=q;g.ConsumerApplication$PollUpdateMessageSpec=r;g.ConsumerApplication$PollCreationMessageSpec=s;g.ConsumerApplication$OptionSpec=t;g.ConsumerApplication$ReactionMessageSpec=u;g.ConsumerApplication$RevokeMessageSpec=v;g.ConsumerApplication$ViewOnceMessageSpec=w;g.ConsumerApplication$GroupInviteMessageSpec=x;g.ConsumerApplication$LiveLocationMessageSpec=y;g.ConsumerApplication$ContactsArrayMessageSpec=z;g.ConsumerApplication$ContactMessageSpec=A;g.ConsumerApplication$StatusTextMesageSpec=B;g.ConsumerApplication$ExtendedTextMessageSpec=C;g.ConsumerApplication$LocationMessageSpec=D;g.ConsumerApplication$StickerMessageSpec=E;g.ConsumerApplication$DocumentMessageSpec=F;g.ConsumerApplication$VideoMessageSpec=G;g.ConsumerApplication$AudioMessageSpec=H;g.ConsumerApplication$ImageMessageSpec=I;g.ConsumerApplication$InteractiveAnnotationSpec=J;g.ConsumerApplication$PointSpec=K;g.ConsumerApplication$LocationSpec=L;g.ConsumerApplication$MediaPayloadSpec=M}),98);
__d("WAMediaTransport.pb",["WACommon.pb","WAProtoConst"],(function(a,b,c,d,e,f,g){var h;a={NONE:0,LQ_4K:1,HQ_4K:2};b={NONE:0,GIPHY:1,TENOR:2};c={TALKING_A:0,IDLE_A:1,TALKING_B:2,IDLE_B:3,BACKGROUND:4};e={};f={};var i={},j={},k={},l={},m={},n={},o={},p={},q={},r={},s={},t={},u={},v={},w={},x={},y={},z={},A={},B={},C={},D={},E={};e.internalSpec={integral:[1,(h=d("WAProtoConst")).TYPES.MESSAGE,k],ancillary:[2,h.TYPES.MESSAGE,f]};f.internalSpec={fileLength:[1,h.TYPES.UINT64],mimetype:[2,h.TYPES.STRING],thumbnail:[3,h.TYPES.MESSAGE,i],objectId:[4,h.TYPES.STRING]};i.internalSpec={jpegThumbnail:[1,h.TYPES.BYTES],downloadableThumbnail:[2,h.TYPES.MESSAGE,j],thumbnailWidth:[3,h.TYPES.UINT32],thumbnailHeight:[4,h.TYPES.UINT32]};j.internalSpec={fileSha256:[1,h.TYPES.BYTES],fileEncSha256:[2,h.TYPES.BYTES],directPath:[3,h.TYPES.STRING],mediaKey:[4,h.TYPES.BYTES],mediaKeyTimestamp:[5,h.TYPES.INT64],objectId:[6,h.TYPES.STRING]};k.internalSpec={fileSha256:[1,h.TYPES.BYTES],mediaKey:[2,h.TYPES.BYTES],fileEncSha256:[3,h.TYPES.BYTES],directPath:[4,h.TYPES.STRING],mediaKeyTimestamp:[5,h.TYPES.INT64]};l.internalSpec={integral:[1,h.TYPES.MESSAGE,n],ancillary:[2,h.TYPES.MESSAGE,m]};m.internalSpec={height:[1,h.TYPES.UINT32],width:[2,h.TYPES.UINT32],scansSidecar:[3,h.TYPES.BYTES],scanLengths:[4,h.FLAGS.REPEATED|h.TYPES.UINT32],midQualityFileSha256:[5,h.TYPES.BYTES],hdType:[6,h.TYPES.ENUM,a]};n.internalSpec={transport:[1,h.TYPES.MESSAGE,e]};o.internalSpec={integral:[1,h.TYPES.MESSAGE,q],ancillary:[2,h.TYPES.MESSAGE,p]};p.internalSpec={seconds:[1,h.TYPES.UINT32],caption:[2,h.TYPES.MESSAGE,d("WACommon.pb").MessageTextSpec],gifPlayback:[3,h.TYPES.BOOL],height:[4,h.TYPES.UINT32],width:[5,h.TYPES.UINT32],sidecar:[6,h.TYPES.BYTES],gifAttribution:[7,h.TYPES.ENUM,b]};q.internalSpec={transport:[1,h.TYPES.MESSAGE,e]};r.internalSpec={integral:[1,h.TYPES.MESSAGE,v],ancillary:[2,h.TYPES.MESSAGE,s]};s.internalSpec={seconds:[1,h.TYPES.UINT32],avatarAudio:[2,h.TYPES.MESSAGE,t]};t.internalSpec={poseId:[1,h.TYPES.UINT32],avatarAnimations:[2,h.FLAGS.REPEATED|h.TYPES.MESSAGE,u]};u.internalSpec={fileSha256:[1,h.TYPES.BYTES],fileEncSha256:[2,h.TYPES.BYTES],directPath:[3,h.TYPES.STRING],mediaKey:[4,h.TYPES.BYTES],mediaKeyTimestamp:[5,h.TYPES.INT64],objectId:[6,h.TYPES.STRING],animationsType:[7,h.TYPES.ENUM,c]};v.internalSpec={transport:[1,h.TYPES.MESSAGE,e]};w.internalSpec={integral:[1,h.TYPES.MESSAGE,y],ancillary:[2,h.TYPES.MESSAGE,x]};x.internalSpec={pageCount:[1,h.TYPES.UINT32]};y.internalSpec={transport:[1,h.TYPES.MESSAGE,e]};z.internalSpec={integral:[1,h.TYPES.MESSAGE,B],ancillary:[2,h.TYPES.MESSAGE,A]};A.internalSpec={pageCount:[1,h.TYPES.UINT32],height:[2,h.TYPES.UINT32],width:[3,h.TYPES.UINT32],firstFrameLength:[4,h.TYPES.UINT32],firstFrameSidecar:[5,h.TYPES.BYTES],mustacheText:[6,h.TYPES.STRING],isThirdParty:[7,h.TYPES.BOOL],receiverFetchId:[8,h.TYPES.STRING]};B.internalSpec={transport:[1,h.TYPES.MESSAGE,e],isAnimated:[2,h.TYPES.BOOL],receiverFetchId:[3,h.TYPES.STRING]};C.internalSpec={integral:[1,h.TYPES.MESSAGE,E],ancillary:[2,h.TYPES.MESSAGE,D]};D.internalSpec={displayName:[1,h.TYPES.STRING]};E.internalSpec={vcard:[1,h.TYPES.STRING],downloadableVcard:[2,h.TYPES.MESSAGE,e],__oneofs__:{contact:["vcard","downloadableVcard"]}};g.IMAGE_TRANSPORT_ANCILLARY_HD_TYPE=a;g.VIDEO_TRANSPORT_ANCILLARY_ATTRIBUTION=b;g.AUDIO_TRANSPORT_ANCILLARY_AVATAR_AUDIO_ANIMATIONS_TYPE=c;g.WAMediaTransportSpec=e;g.WAMediaTransport$AncillarySpec=f;g.WAMediaTransport$Ancillary$ThumbnailSpec=i;g.WAMediaTransport$Ancillary$Thumbnail$DownloadableThumbnailSpec=j;g.WAMediaTransport$IntegralSpec=k;g.ImageTransportSpec=l;g.ImageTransport$AncillarySpec=m;g.ImageTransport$IntegralSpec=n;g.VideoTransportSpec=o;g.VideoTransport$AncillarySpec=p;g.VideoTransport$IntegralSpec=q;g.AudioTransportSpec=r;g.AudioTransport$AncillarySpec=s;g.AudioTransport$Ancillary$AvatarAudioSpec=t;g.AudioTransport$Ancillary$AvatarAudio$DownloadableAvatarAnimationsSpec=u;g.AudioTransport$IntegralSpec=v;g.DocumentTransportSpec=w;g.DocumentTransport$AncillarySpec=x;g.DocumentTransport$IntegralSpec=y;g.StickerTransportSpec=z;g.StickerTransport$AncillarySpec=A;g.StickerTransport$IntegralSpec=B;g.ContactTransportSpec=C;g.ContactTransport$AncillarySpec=D;g.ContactTransport$IntegralSpec=E}),98);
__d("validateMAWMediaAndComposeEntryForProtoMsg",["WAMediaUtils","err"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){if(b==null)throw c("err")("DbMedia is null in validateMediaAndComposeEntryForProtoMsg");if(!b.msgIds.includes(a))throw c("err")("the media ("+b.mediaId+") is not linked to the msg ("+a+")");a=b.mediaEntries.get(a);if(a==null)throw c("err")("media entry not found in validateMediaAndComposeEntryForProtoMsg");var e=b.plaintextHash,f=d("WAMediaUtils").mediaEntryDataToRawData(e,a);e=["fileSha256","mediaKey","fileEncSha256","directPath","mediaKeyTimestamp"];a=e.filter(function(a){return f[a]==null});if(a.length>0)throw c("err")("missing fields in mediaEntryData: "+a.toString());return[b,f]}g["default"]=a}),98);
__d("encodeMAWDocumentFileMessage",["WAMediaTransport.pb","encodeProtobuf","validateMAWMediaAndComposeEntryForProtoMsg"],(function(a,b,c,d,e,f,g){"use strict";var h="application/pdf";function a(a,b){return i(a.msgId,b)}function i(a,b){a=c("validateMAWMediaAndComposeEntryForProtoMsg")(a,b);b=a[0];a=a[1];return j(b,a)}function j(a,b){b={ancillary:{},integral:{transport:{ancillary:{fileLength:a.size,mimetype:h,objectId:b.objectId,thumbnail:{jpegThumbnail:new ArrayBuffer(1),thumbnailHeight:1,thumbnailWidth:1}},integral:{directPath:b.directPath,fileEncSha256:b.fileEncSha256,fileSha256:b.fileSha256,mediaKey:b.mediaKey,mediaKeyTimestamp:b.mediaKeyTimestamp}}}};b=d("encodeProtobuf").encodeProtobuf(d("WAMediaTransport.pb").DocumentTransportSpec,b);return{payload:{content:{documentMessage:{document:{payload:b.readBuffer(),version:1},fileName:(b=a.validatedDocumentFileInfo)==null?void 0:b.filename}}}}}g["default"]=a}),98);
__d("MAWAsConsumerApplication",["I64","LSIntEnum","MAWDbMedia","MAWGlobals","MAWJids","MAWMsgType","MAWVault","WAAssertUnreachable","WAConsumerApplication.pb","WAJids","WAMediaTransport.pb","encodeMAWDocumentFileMessage","encodeProtobuf","err","validateMAWMediaAndComposeEntryForProtoMsg"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j="image/jpeg",k="video/mp4",l="audio/wav",m="image/gif",n="image/webp",o="application/pdf",p=new ArrayBuffer(0);function a(a,b,e){switch(a.type){case d("MAWMsgType").MSG_TYPE.TEXT:return r(a);case d("MAWMsgType").MSG_TYPE.IMAGE:return s(a,b);case d("MAWMsgType").MSG_TYPE.VIDEO:return z(a,b);case d("MAWMsgType").MSG_TYPE.PTT:return C(a,b);case d("MAWMsgType").MSG_TYPE.REVOKED:return F(a);case d("MAWMsgType").MSG_TYPE.GIF:return z(a,b);case d("MAWMsgType").MSG_TYPE.STICKER:return w(a,b);case d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:return c("encodeMAWDocumentFileMessage")(a,b);case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SYNC_RESPONSE:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_CHANGE_FROM_CURRENT_DEVICE:case d("MAWMsgType").MSG_TYPE.SK_DISTRIBUTION:return null;case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:throw c("err")("Implemented ephemeral setting message in MAWAsConsumerApplication");case d("MAWMsgType").MSG_TYPE.XMA:throw c("err")("XMA content message is not consumer application. It should be addressed as ArmadilloApplication");case d("MAWMsgType").MSG_TYPE.FUTUREPROOF:case d("MAWMsgType").MSG_TYPE.CIPHERTEXT:case d("MAWMsgType").MSG_TYPE.UNAVAILABLE:case d("MAWMsgType").MSG_TYPE.EXPIRED_EPHEMERAL:case d("MAWMsgType").MSG_TYPE.ADMIN:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION:case d("MAWMsgType").MSG_TYPE.ICDC_ALERT:case d("MAWMsgType").MSG_TYPE.DELETE_FOR_ME:throw c("err")("We do not support converting to protoMsg with "+a.type+" type","mpf_web_foundations");case d("MAWMsgType").MSG_TYPE.RAVEN:case d("MAWMsgType").MSG_TYPE.RAVEN_ACTION:throw c("err")("Raven content message is not consumer application. It should be addressed as ArmadilloApplication");case d("MAWMsgType").MSG_TYPE.EDIT_ACTION:throw c("err")("We do not support editing messages right now since the sending flow is not implemented yet. ");case d("MAWMsgType").MSG_TYPE.GROUP_INVITE:return G(a,e);default:return c("WAAssertUnreachable")(a.type)}}function b(a,b){if(b==null)return q(a);else switch(b.mediaType){case d("MAWDbMedia").MEDIA_TYPE.IMAGE:return t(a.msgId,b);case d("MAWDbMedia").MEDIA_TYPE.VIDEO:return A(a.msgId,b);case d("MAWDbMedia").MEDIA_TYPE.PTT:return D(a.msgId,b);case d("MAWDbMedia").MEDIA_TYPE.GIF:return A(a.msgId,b);case d("MAWDbMedia").MEDIA_TYPE.STICKER:return x(a.msgId,b);default:return null}}function q(a){var b=null;if(a.type===d("MAWMsgType").MSG_TYPE.REVOKED&&a.msgContent!=null&&a.msgContent.content!=null)b=a.msgContent.content;else if(a.type===d("MAWMsgType").MSG_TYPE.DELETE_FOR_ME&&a.msgContent!=null)b=a.msgContent;else return null;return{payload:{content:{messageText:{mentionedJid:[],text:d("MAWVault").unvault(b)}}}}}function r(a){var b={payload:{content:{messageText:{mentionedJid:a.msgContent.mentionedJids,text:d("MAWVault").unvault(a.msgContent.content)}}}};if(a.specialTextSize!=null){a=a.specialTextSize===1?d("WAConsumerApplication.pb").CONSUMER_APPLICATION_METADATA_SPECIAL_TEXT_SIZE.SMALL:a.specialTextSize===2?d("WAConsumerApplication.pb").CONSUMER_APPLICATION_METADATA_SPECIAL_TEXT_SIZE.MEDIUM:d("WAConsumerApplication.pb").CONSUMER_APPLICATION_METADATA_SPECIAL_TEXT_SIZE.LARGE;b.metadata={specialTextSize:a}}return b}function s(a,b){return t(a.msgId,b)}function t(a,b){a=c("validateMAWMediaAndComposeEntryForProtoMsg")(a,b);b=a[0];a=a[1];return v(b,a)}function u(a,b){var c;a={ancillary:{height:(c=a.validatedImageInfo)==null?void 0:c.height,scanLengths:((c=b.progressiveJpegDetails)==null?void 0:c.scanLengths)||[],scansSidecar:(c=b.progressiveJpegDetails)==null?void 0:c.sidecar,width:(c=a.validatedImageInfo)==null?void 0:c.width},integral:{transport:{ancillary:{fileLength:a.size,mimetype:j,objectId:b.objectId,thumbnail:{downloadableThumbnail:b.downloadableThumbnail,jpegThumbnail:void 0,thumbnailHeight:(c=a.validatedImageInfo)==null?void 0:c.jpegThumbnailHeight,thumbnailWidth:(c=a.validatedImageInfo)==null?void 0:c.jpegThumbnailWidth}},integral:{directPath:b.directPath,fileEncSha256:b.fileEncSha256,fileSha256:b.fileSha256,mediaKey:b.mediaKey,mediaKeyTimestamp:b.mediaKeyTimestamp}}}};return d("encodeProtobuf").encodeProtobuf(d("WAMediaTransport.pb").ImageTransportSpec,a).readBuffer()}function v(a,b){a=u(a,b);return{payload:{content:{imageMessage:{caption:{mentionedJid:[]},image:{payload:a,version:1}}}}}}function e(a){return{payload:{content:{editMessage:{key:{fromMe:!0,id:a.originalMsgExternalId,remoteJid:a.threadJid},message:{mentionedJid:a.msgContent.mentionedJids,text:d("MAWVault").unvault(a.msgContent.content)},timestampMs:a.editTs}}}}}function w(a,b){return x(a.msgId,b)}function x(a,b){a=c("validateMAWMediaAndComposeEntryForProtoMsg")(a,b);b=a[0];a=a[1];return y(b,a)}function y(a,b){var c;a={ancillary:{height:(c=a.validatedImageInfo)==null?void 0:c.height,width:(c=a.validatedImageInfo)==null?void 0:c.width},integral:{transport:{ancillary:{fileLength:a.size,mimetype:n,objectId:b.objectId,thumbnail:{thumbnailHeight:(c=a.validatedImageInfo)==null?void 0:c.jpegThumbnailHeight,thumbnailWidth:(c=a.validatedImageInfo)==null?void 0:c.jpegThumbnailWidth}},integral:{directPath:b.directPath,fileEncSha256:b.fileEncSha256,fileSha256:b.fileSha256,mediaKey:b.mediaKey,mediaKeyTimestamp:b.mediaKeyTimestamp}}}};c=d("encodeProtobuf").encodeProtobuf(d("WAMediaTransport.pb").StickerTransportSpec,a);return{payload:{content:{stickerMessage:{sticker:{payload:c.readBuffer(),version:1}}}}}}function z(a,b){return A(a.msgId,b)}function A(a,b){a=c("validateMAWMediaAndComposeEntryForProtoMsg")(a,b);b=a[0];a=a[1];return B(b,a)}function B(a,b){var c,e=a.mediaType===d("MAWDbMedia").MEDIA_TYPE.GIF,f=e?a.validatedImageInfo:a.validatedVideoInfo;c={ancillary:{gifPlayback:e,height:f==null?void 0:f.height,seconds:e?void 0:(c=a.validatedVideoInfo)==null?void 0:c.duration,sidecar:b.sidecar,width:f==null?void 0:f.width},integral:{transport:{ancillary:{fileLength:a.size,mimetype:e?m:k,objectId:b.objectId,thumbnail:e?{thumbnailHeight:f==null?void 0:f.jpegThumbnailHeight,thumbnailWidth:f==null?void 0:f.jpegThumbnailWidth}:{downloadableThumbnail:b.downloadableThumbnail,jpegThumbnail:void 0,thumbnailHeight:f==null?void 0:f.jpegThumbnailHeight,thumbnailWidth:f==null?void 0:f.jpegThumbnailWidth}},integral:{directPath:b.directPath,fileEncSha256:b.fileEncSha256,fileSha256:b.fileSha256,mediaKey:b.mediaKey,mediaKeyTimestamp:b.mediaKeyTimestamp}}}};a=d("encodeProtobuf").encodeProtobuf(d("WAMediaTransport.pb").VideoTransportSpec,c);return{payload:{content:{videoMessage:{caption:{mentionedJid:[]},video:{payload:a.readBuffer(),version:1}}}}}}function C(a,b){return D(a.msgId,b)}function D(a,b){a=c("validateMAWMediaAndComposeEntryForProtoMsg")(a,b);b=a[0];a=a[1];return E(b,a)}function E(a,b){var c;c={ancillary:{seconds:(c=a.validatedAudioInfo)==null?void 0:c.duration},integral:{transport:{ancillary:{fileLength:a.size,mimetype:l,objectId:b.objectId,thumbnail:{jpegThumbnail:p}},integral:{directPath:b.directPath,fileEncSha256:b.fileEncSha256,fileSha256:b.fileSha256,mediaKey:b.mediaKey,mediaKeyTimestamp:b.mediaKeyTimestamp}}}};a=d("encodeProtobuf").encodeProtobuf(d("WAMediaTransport.pb").AudioTransportSpec,c);return{payload:{content:{audioMessage:{audio:{payload:a.readBuffer(),version:1},ptt:!0}}}}}function F(a){return{payload:{applicationData:{revoke:{key:{fromMe:!0,id:a.revokedExternalId}}}}}}function f(a){var b=d("WAJids").isAuthorMe(a.reactToAuthor)||d("MAWGlobals").getMyUserJid()===a.reactToAuthor,c=d("WAJids").interpretAsGroupJid(a.threadJid)!=null;c={groupingKey:a.groupingKey==null?void 0:a.groupingKey,key:{fromMe:b,id:a.reactToExternalId,participant:c&&!b?a.reactToAuthor:void 0,remoteJid:a.threadJid},senderTimestampMs:a.ts*1e3,text:a.reaction==null?void 0:a.reaction};return{payload:{content:{reactionMessage:c}}}}function G(a,b){if(a.threadJid==null)throw c("err")("msg threadJid is null in encodeGroupInviteMessage");if(b==null)throw c("err")("DbGroupInvite is null in encodeGroupInviteMessage");var e=d("WAJids").interpretAsGroupJid(a.threadJid);if(e==null)throw c("err")("groupJid is null in encodeGroupInviteMessage");return{payload:{content:{groupInviteMessage:{groupJid:e,groupName:a.groupName,inviteCode:b.inviteCode,inviteExpiration:b.inviteExpirationTs}}}}}function H(a){return(h||(h=d("I64"))).equal(a.displayedContentTypes,(i||(i=d("LSIntEnum"))).ofNumber(1))||(h||(h=d("I64"))).equal(a.displayedContentTypes,(i||(i=d("LSIntEnum"))).ofNumber(256))||a.textHasLinks||a.isUnsent?I(a):null}function I(a){var b;b=(b=a.mentionIds)==null?void 0:(b=b.split(","))==null?void 0:b.map(d("MAWJids").toUserJid);return{payload:{content:{messageText:{mentionedJid:(b=b)!=null?b:[],text:a.text}}}}}g.IMAGE_MIME_TYPE=j;g.VIDEO_MIME_TYPE=k;g.AUDIO_MIME_TYPE=l;g.GIF_MIME_TYPE=m;g.STICKER_MIME_TYPE=n;g.FILE_MIME_TYPE=o;g.emptyAudioFileArrayBuffer=p;g.asConsumerApplication=a;g.deletedMsgAsConsumerApplicationForSpamReporting=b;g.encodeValidatedMediaToImageTransport=u;g.encodeEditMessage=e;g.encodeReactionMessage=f;g.asConsumerApplicationLSDb=H}),98);
__d("WASortedLists",[],(function(a,b,c,d,e,f){"use strict";function a(){return[]}function b(){return[]}function c(a,b){return a.filter(b)}function d(a,b){return l(a.map(b))}function e(a,b){var c=a.length===b.length;for(var d=0;c&&d<a.length;d++)a[d]!==b[d]&&(c=!1);return c}function g(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return a;return a.concat([b]).sort()}function h(a,b){if(a.length<b.length)return!1;var c=!0;for(var d=0,e=0;c&&e<b.length;e++)do c=a[d]===b[e];while(!c&&++d<a.length);return c}function i(a,b){var c=[];for(var d=0,e=0;d<a.length;d++){var f=a[d];while(e<b.length&&f>b[e])e++;(e===b.length||f<b[e])&&c.push(f)}return c}function j(a,b){var c=[],d=0,e=0;while(d<a.length&&e<b.length){var f=a[d],g=b[e];f<g?d++:f===g?(c.push(f),d++,e++):e++}return c}function k(a,b){var c=[],d=0,e=0;while(d<a.length&&e<b.length)a[d]<b[e]?c.push(a[d++]):a[d]===b[e]?(c.push(a[d++]),e++):c.push(b[e++]);while(d<a.length)c.push(a[d++]);while(e<b.length)c.push(b[e++]);return c}function l(a){return m(a.slice().sort())}function m(a){var b=!1;for(var c=0;c<a.length-1;c++)a[c]===a[c+1]&&(b=!0);if(!b)return a;c=[];for(b=0;b<a.length-1;b++)a[b]!==a[b+1]&&c.push(a[b]);c.push(a[a.length-1]);return c}function n(a){return Array.from(a).sort()}function o(a){return a.slice().sort()}function p(a,b,c){var d=null;for(var e=0;!d&&e<a.length;e++)a[e]===b&&(d=a.slice(),d[e]=c,d=m(d.sort()));return d||a}function q(a){return[a]}function r(a){return a.length<1}function s(a,b,c){return a.slice(b,c)}f.emptySet=a;f.emptyList=b;f.filter=c;f.map=d;f.areEqual=e;f.addToSet=g;f.contains=h;f.subtract=i;f.intersect=j;f.joinUniq=k;f.sortAndDedupe=l;f.asSortedSet=n;f.sort=o;f.swapIn=p;f.singleElement=q;f.isEmpty=r;f.slice=s}),66);
__d("WAMsgApplication.pb",["WACommon.pb","WAProtoConst"],(function(a,b,c,d,e,f,g){var h;a={DEFAULT:0,VANISH_MODE:1,DISAPPEARING_MESSAGES:2};b={};c={};e={};f={};var i={},j={},k={},l={},m={},n={};b.internalSpec={payload:[1,(h=d("WAProtoConst")).TYPES.MESSAGE,i],metadata:[2,h.TYPES.MESSAGE,c]};c.internalSpec={chatEphemeralSetting:[1,h.TYPES.MESSAGE,n],ephemeralSettingList:[2,h.TYPES.MESSAGE,f],ephemeralSharedSecret:[3,h.TYPES.BYTES],forwardingScore:[5,h.TYPES.UINT32],isForwarded:[6,h.TYPES.BOOL],businessMetadata:[7,h.TYPES.MESSAGE,(d=d("WACommon.pb")).SubProtocolSpec],frankingKey:[8,h.TYPES.BYTES],frankingVersion:[9,h.TYPES.INT32],quotedMessage:[10,h.TYPES.MESSAGE,e],threadType:[11,h.TYPES.ENUM,a],readonlyMetadataDataclass:[12,h.TYPES.STRING],groupId:[13,h.TYPES.STRING],groupSize:[14,h.TYPES.UINT32],groupIndex:[15,h.TYPES.UINT32],botResponseId:[16,h.TYPES.STRING],collapsibleId:[17,h.TYPES.STRING],__oneofs__:{ephemeral:["chatEphemeralSetting","ephemeralSettingList","ephemeralSharedSecret"]}};e.internalSpec={stanzaId:[1,h.TYPES.STRING],remoteJid:[2,h.TYPES.STRING],participant:[3,h.TYPES.STRING],payload:[4,h.TYPES.MESSAGE,i]};f.internalSpec={chatJid:[1,h.TYPES.STRING],ephemeralSetting:[2,h.TYPES.MESSAGE,n]};i.internalSpec={coreContent:[1,h.TYPES.MESSAGE,m],signal:[2,h.TYPES.MESSAGE,l],applicationData:[3,h.TYPES.MESSAGE,k],subProtocol:[4,h.TYPES.MESSAGE,j],__oneofs__:{content:["coreContent","signal","applicationData","subProtocol"]}};j.internalSpec={futureProof:[1,h.TYPES.ENUM,d.FUTURE_PROOF_BEHAVIOR],consumerMessage:[2,h.TYPES.MESSAGE,d.SubProtocolSpec],businessMessage:[3,h.TYPES.MESSAGE,d.SubProtocolSpec],paymentMessage:[4,h.TYPES.MESSAGE,d.SubProtocolSpec],multiDevice:[5,h.TYPES.MESSAGE,d.SubProtocolSpec],voip:[6,h.TYPES.MESSAGE,d.SubProtocolSpec],armadillo:[7,h.TYPES.MESSAGE,d.SubProtocolSpec],__oneofs__:{subProtocol:["consumerMessage","businessMessage","paymentMessage","multiDevice","voip","armadillo"]}};k.internalSpec={};l.internalSpec={};m.internalSpec={};n.internalSpec={ephemeralExpiration:[2,h.TYPES.UINT32],ephemeralSettingTimestamp:[3,h.TYPES.INT64],isEphemeralSettingReset:[4,h.TYPES.BOOL]};g.MESSAGE_APPLICATION_METADATA_THREAD_TYPE=a;g.MessageApplicationSpec=b;g.MessageApplication$MetadataSpec=c;g.MessageApplication$Metadata$QuotedMessageSpec=e;g.MessageApplication$Metadata$EphemeralSettingMapSpec=f;g.MessageApplication$PayloadSpec=i;g.MessageApplication$SubProtocolPayloadSpec=j;g.MessageApplication$ApplicationDataSpec=k;g.MessageApplication$SignalSpec=l;g.MessageApplication$ContentSpec=m;g.MessageApplication$EphemeralSettingSpec=n}),98);
__d("WAParseMessageApplication",["decodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b,c,e=a.payload;if(e==null)return{version:"v3",type:"error",error:"The messageApplication has no payload"};if(d("decodeProtobuf").getUnknownFields(a.payload)!=null)return{version:"v3",type:"error",error:"There are unknown fields in the message application payload"};e=e.subProtocol;if(e==null)return{version:"v3",type:"error",error:"The messageApplication payload has no subProtocol"};if(d("decodeProtobuf").getUnknownFields(e)!=null)return{version:"v3",type:"error",error:"messageApplication subProtocol has unknown fields",futureProof:e.futureProof};e=[];b=(b=a.payload)==null?void 0:(b=b.subProtocol)==null?void 0:b.consumerMessage;c=(c=a.payload)==null?void 0:(c=c.subProtocol)==null?void 0:c.armadillo;a=(a=a.payload)==null?void 0:(a=a.subProtocol)==null?void 0:a.multiDevice;if(b!=null){if(b.payload==null)return{version:"v3",type:"error",error:"subprotocol of type consumerMessage has no payload"};e.push({payload:new Uint8Array(b.payload),type:"success",subprotocolType:"consumerMessage"})}if(c!=null){if(c.payload==null)return{version:"v3",type:"error",error:"subprotocol of type armadillo has no payload"};e.push({payload:new Uint8Array(c.payload),type:"success",subprotocolType:"armadillo"})}if(a!=null){if(a.payload==null)return{version:"v3",type:"error",error:"subprotocol of type multiDevice has no payload"};e.push({payload:new Uint8Array(a.payload),type:"success",subprotocolType:"multiDevice"})}return e.length!==1?{version:"v3",type:"error",error:"Wrong number of subprotocols: "+e.length}:e[0]}g.parseMessageApplication=a}),98);
__d("WAMapContentTypeToFbType",["WAAssertUnreachable"],(function(a,b,c,d,e,f,g){"use strict";function a(a){switch(a){case"text":return"text";case"media":return"media";case"reaction":return"reaction";case"live_location":case"pay":case"product_list":case"poll_creation":case"poll_vote":case"scheduled_call":return"text";default:a;throw c("WAAssertUnreachable")(a)}}g.mapContentTypeToFbType=a}),98);
__d("WAPersistedQueueCache",["WAResolvable","WAShiftTimer","WATagsLogger","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error during flush: ",""]);h=function(){return a};return a}function a(a,c,e){var f=d("WATagsLogger").TAGS(["PersistedQueue",a,"cache"]),g=[],i=new(d("WAResolvable").Resolvable)(),j=(a=e)!=null?a:{},k=new(d("WAShiftTimer").ShiftTimer)(function(){void n()});function l(){j.cacheSize!=null&&g.length>=j.cacheSize&&void n()}function m(){if(j.maxDelay!=null){var a=j.maxDelay;k.cancel();k.onOrAfter(a)}}function n(){var a,e;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:if(!(g.length===0)){j.next=2;break}return j.abrupt("return");case 2:k.cancel();a=g;g=[];e=i;i=new(d("WAResolvable").Resolvable)();j.prev=7;j.next=10;return b("regeneratorRuntime").awrap(c(a));case 10:e.resolve();j.next=17;break;case 13:j.prev=13,j.t0=j["catch"](7),f.ERROR(h(),j.t0),e.reject(j.t0);case 17:case"end":return j.stop()}},null,this,[[7,13]])}return{flush:function(){return n()},write:function(a){g.push(a);a=i;l();m();return a.promise},config:function(a){j=a}}}g.makePersistedQueueCache=a}),98);
__d("WAPubSub",[],(function(a,b,c,d,e,f){"use strict";var g=function(){function a(){this.$1=new Set()}var b=a.prototype;b.publish=function(a){this.$1.forEach(function(b){return b(a)})};b.subscribe=function(a){var b=this;this.$1.add(a);return function(){b.$1["delete"](a)}};return a}();function a(){return new g()}f.WAPubSub=g;f.simplePubSub=a}),66);
__d("WAPersistedQueue",["WALogger","WAPersistedQueueCache","WAPubSub"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[PersistedQueue] new entry"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[PersistedQueue] flush: ","}"]);i=function(){return a};return a}function a(a,b,c){var e=d("WAPubSub").simplePubSub(),f=d("WAPersistedQueueCache").makePersistedQueueCache(a,function(c){return b.write(a,c).then(function(){d("WALogger").DEV(i(),c.length),e.publish({type:"flush"})})},c);return{subscribe:function(a){return e.subscribe(a)},config:function(a){f.config(a)},DEPRECATED_count:function(c){return b.count(a,c)},where:function(c,d,e){return b.where(a,c,d,e)},write:function(a){d("WALogger").DEV(h());e.publish({type:"new_entity"});return f.write(a)},flush:function(){return f.flush()},ack:function(c,d){return b.ack(a,c,d)},"delete":function(c){return b["delete"](a,c)},failAck:function(c,d){return b.failAck(a,c,d)},clear:function(){return b.clear(a)}}}g.initPersistedQueue=a}),98);
__d("WAProtocolQueue",["WAErr","WAGlobals","WAJids","WALogger","WAMapContentTypeToFbType","WAPersistedQueue"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Protocol Queue is already initialized"]);h=function(){return a};return a}var i=5e3,j=null;function a(a){if(j!=null){d("WALogger").WARN(h());return j}a=d("WAPersistedQueue").initPersistedQueue("stanzaQueue",a,{cacheSize:null,maxDelay:i});j=a;return j}function b(){if(!j)throw c("WAErr")("Protocol queue not initialized");return j}function e(a){return{flush:function(){return a.flush()}}}function f(a){return a.map(function(a){return a.type==="message"?k(a):a})}function k(a){switch(a.subtype){case"unavailable":var b=a,c=d("WAJids").extractUserJid(b.from);c={type:"UnavailableMsg",id:{chat:b.jid,author:d("WAGlobals").getMyUserJid()===c?"@me":c,externalId:b.stanzaId},ts:b.serverTs};return{stanzaId:b.stanzaId,jid:b.jid,type:b.type,message:{decrypted:c,details:{count:null,externalId:b.stanzaId,folder:b.fbFolderId,from:d("WAJids").switchOnMsgrChatJidType(b.jid,{group:function(a){return{type:"group",groupJid:a,chat:a,author:b.from}},user:function(a){return{type:"device",deviceJid:b.from,chat:a,author:b.from}}}),hideDecryptionFailure:!1,messageAlreadyPresented:!1,offline:b.offline,recipient:b.recipient,reportingMeta:b.reportingMeta,retryCount:b.retryCount,ts:b.serverTs,isInstamadillo:!1,type:d("WAMapContentTypeToFbType").mapContentTypeToFbType(b.contentType)}},consumerRetries:a.consumerRetries,failAcks:a.failAcks,stanzaQueueId:a.stanzaQueueId,priority:b.priority};case"armadillo":var e=a;c=d("WAJids").extractUserJid(e.from);c={device:{id:d("WAJids").extractDeviceId(e.from),identity:e.remoteIdentity},folder:e.fbFolderId,id:{chat:e.jid,author:d("WAGlobals").getMyUserJid()===c?"@me":c,externalId:e.stanzaId},msg:e.message,recipientsCount:null,reportingMeta:e.reportingMeta,ts:e.serverTs,type:"IncomingMsg"};return{stanzaId:e.stanzaId,jid:e.jid,type:e.type,message:{decrypted:c,details:{count:null,externalId:e.stanzaId,folder:e.fbFolderId,from:d("WAJids").switchOnMsgrChatJidType(e.jid,{group:function(a){return{type:"group",groupJid:a,chat:a,author:e.from}},user:function(a){return{type:"device",deviceJid:e.from,chat:a,author:e.from}}}),hideDecryptionFailure:!1,messageAlreadyPresented:!1,offline:e.offline,recipient:e.recipient,reportingMeta:e.reportingMeta,retryCount:e.retryCount,ts:e.serverTs,isInstamadillo:!1,type:d("WAMapContentTypeToFbType").mapContentTypeToFbType(e.contentType)}},consumerRetries:a.consumerRetries,failAcks:a.failAcks,stanzaQueueId:a.stanzaQueueId,priority:e.priority};case"instamadillo":var f=a;c=d("WAJids").extractUserJid(f.from);c={device:{id:d("WAJids").extractDeviceId(f.from),identity:f.remoteIdentity},folder:f.fbFolderId,id:{chat:f.jid,author:d("WAGlobals").getMyUserJid()===c?"@me":c,externalId:f.stanzaId},msg:f.message,recipientsCount:null,reportingMeta:f.reportingMeta,ts:f.serverTs,type:"InstamadilloMsg"};return{stanzaId:f.stanzaId,jid:f.jid,type:f.type,priority:f.priority,message:{decrypted:c,details:{count:null,externalId:f.stanzaId,folder:f.fbFolderId,from:d("WAJids").switchOnMsgrChatJidType(f.jid,{group:function(a){return{type:"group",groupJid:a,chat:a,author:f.from}},user:function(a){return{type:"device",deviceJid:f.from,chat:a,author:f.from}}}),hideDecryptionFailure:!1,messageAlreadyPresented:!1,offline:f.offline,recipient:f.recipient,reportingMeta:f.reportingMeta,retryCount:f.retryCount,ts:f.serverTs,isInstamadillo:!0,type:d("WAMapContentTypeToFbType").mapContentTypeToFbType(f.contentType)}},consumerRetries:a.consumerRetries,failAcks:a.failAcks,stanzaQueueId:a.stanzaQueueId};case"ciphertext":var g=a;c=d("WAJids").extractUserJid(g.from);c={createPlaceholder:g.contentType!=="reaction",id:{chat:g.jid,author:d("WAGlobals").getMyUserJid()===c?"@me":c,externalId:g.stanzaId},ts:g.serverTs,type:"IncomingCiphertextMsg"};return{priority:g.priority,stanzaId:g.stanzaId,jid:g.jid,type:g.type,message:{decrypted:c,details:{count:null,externalId:g.stanzaId,folder:g.fbFolderId,from:d("WAJids").switchOnMsgrChatJidType(g.jid,{group:function(a){return{type:"group",groupJid:a,chat:a,author:g.from}},user:function(a){return{type:"device",deviceJid:g.from,chat:a,author:g.from}}}),hideDecryptionFailure:!1,messageAlreadyPresented:!1,offline:g.offline,recipient:g.recipient,reportingMeta:g.reportingMeta,retryCount:g.retryCount,ts:g.serverTs,isInstamadillo:!1,type:d("WAMapContentTypeToFbType").mapContentTypeToFbType(g.contentType)}},consumerRetries:a.consumerRetries,failAcks:a.failAcks,stanzaQueueId:a.stanzaQueueId};default:a;return a}}var l=9,m=5;function n(a){return a}function o(a){return a}g.initProtocolQueue=a;g.protocolQueue=b;g.protocolQueueFlushable=e;g.mapProtocolEntriesV2toV1=f;g.mapProcolQueueMessageV2toV1=k;g.WAProtocolQueuePriorityHigh=l;g.WAProtocolQueuePriorityLow=m;g.appdataApplicationProtocol=n;g.extractSubProtocolFromAppdataProtocol=o}),98);
__d("WAMessageKey",["WAErr","WAGlobals","WAJids","WAStanzaUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return a===d("WAJids").AUTHOR_ME||a==d("WAGlobals").getMyUserJid()}function a(a,b,e){if(e==null)throw c("WAErr")("messageKey is null");var f=e.id,g=e.remoteJid;if(f==null)throw c("WAErr")("messageKey.id is null");else if(g==null)throw c("WAErr")("messageKey.remoteJid is null");g=d("WAJids").interpretAndValidateJid(g);if(g.jidType==="unknown")throw c("WAErr")("messageKey.remoteJid is invalid");var i,j=d("WAJids").AUTHOR_ME;if(g.jidType==="group"){i=g.groupJid;if(h(b)&&e.fromMe===!0)j=d("WAJids").AUTHOR_ME;else if(e.fromMe==!0)j=b;else{var k=e.participant;if(k==null)throw c("WAErr")("key.participant is null");k=d("WAJids").interpretAndValidateJid(k);if(k.jidType==="msgrUser")j=k.userJid;else throw c("WAErr")("key.participant is invalid")}}else if(g.jidType==="msgrUser"||g.jidType==="msgrDevice"){k=d("WAJids").interpretAndValidateJid(a);if(k.jidType!=="msgrUser")throw c("WAErr")("expected user type jid.");i=k.userJid;h(b)?e.fromMe===!0?j=d("WAJids").AUTHOR_ME:j=k.userJid:e.fromMe===!0&&(j=k.userJid)}else throw c("WAErr")("Unsupported jidtype type");return{chat:i,author:h(j)?d("WAJids").AUTHOR_ME:j,externalId:d("WAStanzaUtils").toStanzaId(f)}}g.extractProtocolMessageId=a}),98);
__d("WAParseConsumerMessagePollCreation",["WAGlobals","WAHex","WAMsgType"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c,e){a={unstoredMsg:{type:d("WAMsgType").MSG_TYPE.FUTUREPROOF,msgContent:{protobuf:d("WAHex").bytesToBuffer(a),subtype:null},id:b.id,ts:b.ts,sentTs:b.sentTs,serverTs:b.serverTs,ack:b.ack,reportingMeta:c},unstoredMedia:null,unstoredQuotedMedia:null};return!e||!d("WAGlobals").getConfig().isPollsFallbackExperienceEnabled()?a:a}g["default"]=a}),98);
__d("WAParseProtocolUtils",["WAGlobals","WALogger","WALongInt","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unsupported franking version ",""]);h=function(){return a};return a}function a(a,b){b=i(b,a.serverTs);a=b==null?void 0:b.expirationTs;var c=b==null?void 0:b.deleteTs;b=b==null?void 0:b.ephemeralSetting;return{expirationTs:a,deleteTs:c,ephemeralSetting:b}}function b(a,b){b=j(b);b!=null&&(a.reportingMeta=b);return b}function i(a,b){var c;c=a==null?void 0:(c=a.chatEphemeralSetting)==null?void 0:c.ephemeralExpiration;a=a==null?void 0:(a=a.chatEphemeralSetting)==null?void 0:a.ephemeralSettingTimestamp;if(c==null||a==null||c===0||!d("WAGlobals").getConfig().isEphemeralMessagesEnabled())return null;b=d("WATimeUtils").castToUnixTime(b+d("WAGlobals").getConfig().ephemeralMaxDeletionWindowForUnseenMessage());var e=b,f=null;try{a=d("WALongInt").numberOrThrowIfTooLarge(a)/1e3;f=d("WATimeUtils").castToUnixTime(a)}catch(a){return null}return{expirationTs:b,deleteTs:e,ephemeralSetting:{expirationTs:c,updatedTs:f}}}function j(a){a=a==null?void 0:a.frankingVersion;a!=null&&a!==0&&d("WALogger").ERROR(h(),a);return{frankingKey:void 0,frankingTag:void 0,frankingVersion:a,reportingContent:void 0,reportingTag:void 0}}g.parseEphemerality=a;g.enhanceReportingMeta=b}),98);
__d("WAParseConsumerMessageProtocol",["WACommon.pb","WAConsumerApplication.pb","WAErr","WAGlobals","WAHex","WAJids","WALogger","WAMediaTransport.pb","WAMessageKey","WAMsgType","WAParseConsumerMessagePollCreation","WAParseMediaTransportProtocol","WAParseProtocolUtils","WAResultOrError","WAStanzaUtils","decodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["parseConsumerMessageProtocol error :",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["WAParseConsumerMessageProtocol - ephemeralSetting duration is invalid ",", jidType: ",""]);i=function(){return a};return a}b=1;e=0;f=1;f=d("WAGlobals").getConfig().armadilloWebProcessFutureproof()?f+1:f;function a(a,b,e,f,g){var j;b=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAConsumerApplication.pb").ConsumerApplicationSpec,b);j=(j=b.payload)==null?void 0:(j=j.applicationData)==null?void 0:(j=j.revoke)==null?void 0:(j=j.key)==null?void 0:j.id;if(j!=null)return{unstoredMsg:{type:d("WAMsgType").MSG_TYPE.REVOKED,id:e.id,ts:e.ts,sentTs:e.sentTs,serverTs:e.serverTs,ack:e.ack,reportingMeta:e.reportingMeta,revokedExternalId:d("WAStanzaUtils").toStanzaId(j),unsendMsgContentDeleteTs:null,msgContent:null},unstoredMedia:null,unstoredQuotedMedia:null};var k=(g==null?void 0:g.isForwarded)||!1;j=d("WAParseProtocolUtils").parseEphemerality(e,g);var l=j.expirationTs,u=j.deleteTs,v=j.ephemeralSetting;if(v!=null&&(v.expirationTs<0||v.expirationTs>86400)){j=d("WAJids").interpretAndValidateJid(a);j=j.jidType;var w=v.expirationTs;v.expirationTs===4294967295&&(v.expirationTs=0);d("WALogger").ERROR(i(),w,j)}var x=d("WAParseProtocolUtils").enhanceReportingMeta(e,g),y=(w=n(g))!=null?w:void 0,z=(j=b.payload)==null?void 0:j.content;if(!z)return{unstoredMsg:null,unstoredMedia:null,unstoredQuotedMedia:null};var A=(g=b.metadata)==null?void 0:g.specialTextSize,B=s(z),C={contentTypeForLogging:B,unstoredMsg:{type:d("WAMsgType").MSG_TYPE.FUTUREPROOF,msgContent:{protobuf:d("WAHex").bytesToBuffer(f),subtype:null},id:e.id,ts:e.ts,sentTs:e.sentTs,serverTs:e.serverTs,ack:e.ack,reportingMeta:x},unstoredMedia:null,unstoredQuotedMedia:null};w=function(){try{switch(B){case"messageText":var b,g=z[B];if(g==null)throw c("WAErr")("consumerMessage has no messageText");b=((b=g.commands)==null?void 0:b.some(function(a){return a.commandType===d("WACommon.pb").COMMAND_COMMAND_TYPE.AI}))===!0;if(b)return C;if(g.text==null)throw c("WAErr")("consumerMessage has no messageText");return{unstoredMsg:babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.TEXT,msgContent:{content:g.text,mentionedJids:g.mentionedJid.map(d("WAJids").validateUserJid).filter(Boolean)},quote:y,expirationTs:l,deleteTs:u,ephemeralSetting:v,isForwarded:k},e,{specialTextSize:A}),unstoredMedia:null,unstoredQuotedMedia:null};case"reactionMessage":return{unstoredMsg:m(a,e,z[B]),unstoredMedia:null,unstoredQuotedMedia:null};case"imageMessage":b=o(z,e.ts);return{unstoredMsg:babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.IMAGE,quote:y,expirationTs:l,deleteTs:u,ephemeralSetting:v,isForwarded:k,mediaId:b.plaintextHash},e),unstoredMedia:b,unstoredQuotedMedia:null};case"videoMessage":var i;g=z[B];if(g==null)throw c("WAErr")("consumerMessage has no videoMessage");g=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAMediaTransport.pb").VideoTransportSpec,g==null?void 0:(b=g.video)==null?void 0:b.payload);b=g==null?void 0:(b=g.integral)==null?void 0:(b=b.transport)==null?void 0:(b=b.ancillary)==null?void 0:b.mimetype;i=(g==null?void 0:(i=g.ancillary)==null?void 0:i.gifPlayback)===!0&&b==="image/gif";if(i&&!d("WAGlobals").getConfig().isGifEnabled())return C;b=d("WAParseMediaTransportProtocol").parseVideoMsg(g,e.ts,i);if(b==null)throw c("WAErr")("consumerMessage has no video media info");return{unstoredMsg:i?babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.GIF},e,{quote:y,expirationTs:l,deleteTs:u,ephemeralSetting:v,isForwarded:k,reportingMeta:x,mediaId:b.plaintextHash}):babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.VIDEO},e,{quote:y,expirationTs:l,deleteTs:u,ephemeralSetting:v,isForwarded:k,mediaId:b.plaintextHash}),unstoredMedia:b,unstoredQuotedMedia:null};case"audioMessage":g=p(z,e.ts);return{unstoredMsg:babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.PTT,quote:y,expirationTs:l,deleteTs:u,ephemeralSetting:v,isForwarded:k,mediaId:g.plaintextHash},e),unstoredMedia:g,unstoredQuotedMedia:null};case"stickerMessage":if(d("WAGlobals").getConfig().isStickerEnabled()){i=q(z,e.ts);return{unstoredMsg:babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.STICKER,quote:y,expirationTs:l,deleteTs:u,ephemeralSetting:v,isForwarded:k,reportingMeta:x,mediaId:i.plaintextHash},e),unstoredMedia:i,unstoredQuotedMedia:null}}return C;case"documentMessage":if(d("WAGlobals").getConfig().isDocumentReceiveEnabled()){b=r(z,e.ts);return{unstoredMsg:babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.DOCUMENT_FILE,quote:y,expirationTs:l,deleteTs:u,ephemeralSetting:v,isForwarded:k,reportingMeta:x,mediaId:b.plaintextHash},e),unstoredMedia:b,unstoredQuotedMedia:null}}return C;case"groupInviteMessage":return{unstoredMsg:null,unstoredMedia:null,unstoredQuotedMedia:null,unstoredIncomingGroupInvite:t(e,z)};case"editMessage":var j;g=z[B];i=g==null?void 0:g.message;b=i==null?void 0:i.text;j=g==null?void 0:(j=g.key)==null?void 0:j.id;if(g==null||i==null||b==null)throw c("WAErr")("consumerMessage with editMessage type has no editMessage");if(j==null)throw c("WAErr")("consumerMessage with editMessage type has no original Msg External Id.");g=d("WAStanzaUtils").toStanzaId(j);return{unstoredEditMsg:{type:d("WAMsgType").MSG_TYPE.EDIT_ACTION,editMsgContent:{content:b,mentionedJids:i.mentionedJid.map(d("WAJids").validateUserJid).filter(Boolean)},originalMsgExternalId:g,id:e.id,ts:e.ts,sentTs:e.sentTs,serverTs:e.serverTs,ack:e.ack,reportingMeta:x,specialTextSize:A},unstoredMsg:null,unstoredMedia:null,unstoredQuotedMedia:null};case"pollCreationMessage":return c("WAParseConsumerMessagePollCreation")(f,e,x,z[B]);case"contactMessage":case"locationMessage":case"extendedTextMessage":case"statusTextMessage":case"contactsArrayMessage":case"liveLocationMessage":case"viewOnceMessage":default:return C}}catch(a){d("WALogger").ERROR(h(),a);return{unstoredMsg:null,unstoredMedia:null,unstoredQuotedMedia:null}}}();return babelHelpers["extends"]({},w,{contentTypeForLogging:B})}function j(a){if(d("WAJids").isAuthorSystem(a))throw c("WAErr")("Got system author");return a}var k=30;function l(a){if(a==null)return d("WAResultOrError").makeResult(null);return a.length>k?d("WAResultOrError").makeError("invalid-reaction-text-length"):d("WAResultOrError").makeResult(a)}function m(a,b,e){if(e==null)throw c("WAErr")("consumerMessage has no reactionMessage");var f=j(b.id.author);a=d("WAMessageKey").extractProtocolMessageId(a,f,e.key);f=e.text;e=e.groupingKey;var g=l(f);if(!g.success){throw c("WAErr")('"'+((f=f)!=null?f:"")+'" is not a valid reaction ['+g.error+"]")}return{type:d("WAMsgType").MSG_TYPE.REACTION,ack:b.ack,id:b.id,reactToExternalId:a.externalId,reactToAuthor:a.author,reaction:g.value,groupingKey:e,ts:b.ts}}function n(a){var b,e;b=a==null?void 0:(b=a.quotedMessage)==null?void 0:b.stanzaId;e=a==null?void 0:(e=a.quotedMessage)==null?void 0:e.participant;a=a==null?void 0:(a=a.quotedMessage)==null?void 0:a.remoteJid;e=e!=null?d("WAJids").interpretAndValidateJid(e):null;var f;(e==null?void 0:e.jidType)==="msgrUser"&&e.userJid===d("WAGlobals").getMyUserJid()?f=d("WAJids").AUTHOR_ME:(e==null?void 0:e.jidType)==="msgrUser"?f=e.userJid:f=d("WAJids").AUTHOR_ME;if(b==null)return null;e={type:d("WAMsgType").MSG_TYPE.UNAVAILABLE,author:f,externalId:d("WAStanzaUtils").toStanzaId(b),ts:null};if(a!=null){f=d("WAJids").interpretAndValidateJid(a);if(f.jidType==="group")return{remoteJid:f.groupJid,content:e};else throw c("WAErr")("not supported")}else return{remoteJid:null,content:e}}function o(a,b){a=a.imageMessage;if(a==null)throw c("WAErr")("consumerMessage has no imageMessage");return d("WAParseMediaTransportProtocol").decodeImageTransport(a==null?void 0:(a=a.image)==null?void 0:a.payload,b)}function p(a,b){var e;a=a.audioMessage;if(a==null)throw c("WAErr")("consumerMessage has no audioMessage");e=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAMediaTransport.pb").AudioTransportSpec,a==null?void 0:(e=a.audio)==null?void 0:e.payload);e=d("WAParseMediaTransportProtocol").parseAudioMsg(e,(a==null?void 0:a.ptt)||!1,b);if(e==null)throw c("WAErr")("consumerMessage has no audio media info");return e}function q(a,b){a=a.stickerMessage;if(a==null)throw c("WAErr")("consumerMessage has no stickerMessage");a=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAMediaTransport.pb").StickerTransportSpec,a==null?void 0:(a=a.sticker)==null?void 0:a.payload);a=d("WAParseMediaTransportProtocol").parseStickerMsg(a,b);if(a==null)throw c("WAErr")("consumerMessage has no sticker media info");return a}function r(a,b){var e;a=a.documentMessage;if(a==null)throw c("WAErr")("consumerMessage has no documentMessage");e=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAMediaTransport.pb").DocumentTransportSpec,a==null?void 0:(e=a.document)==null?void 0:e.payload);a=a==null?void 0:a.fileName;e=d("WAParseMediaTransportProtocol").parseDocumentMsg(e,a,b);if(e==null)throw c("WAErr")("consumerMessage has no document media info");return e}function s(a){var b=Object.keys(a).filter(function(a){return a!=="$$unknownFieldCount"});if(b.length!==1)throw c("WAErr")(JSON.stringify(a)+" consumerMessage payload content should have exactly one field, instead found "+JSON.stringify(b));return b[0]}function t(a,b){b=b.groupInviteMessage;if(b==null)throw c("WAErr")("consumerMessage has no GroupInvite Data");return babelHelpers["extends"]({ack:a.ack,author:a.id.author,externalId:a.id.externalId,ts:a.ts},b)}g.MINIMAL_MEDIA_DURATION=b;g.DEFAULT_FILE_SIZE=e;g.SUPPORTED_TYPES_VERSION=f;g.parseConsumerMessageProtocol=a;g.interpretAsNonSystemAuthor=j;g.validReactionMessageText=l;g.parseReactionMessage=m;g.parseOneOfContentType=s}),98);
__d("WAMedia",[],(function(a,b,c,d,e,f){"use strict";a="Image";b="Video";c="Ptt";d="Gif";e="Sticker";var g="DocumentFile",h={IMAGE:a,VIDEO:b,PTT:c,GIF:d,STICKER:e,DOCUMENT_FILE:g};f.IMAGE=a;f.VIDEO=b;f.PTT=c;f.GIF=d;f.STICKER=e;f.DOCUMENT_FILE=g;f.MEDIA_TYPE=h}),66);
__d("WAParseMediaTransportProtocol",["WAErr","WALogger","WALongInt","WAMedia","WAMediaTransport.pb","WAMediaUtils","WAMsgMap","WAParseConsumerMessageProtocol","WAProgressiveJpegGetScanLengths","WATimeUtils","decodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["cannot compose mediaEntry with the media message"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["protobuf msg with too large size ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["protobuf msg with bad size ",", use default size instead"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["protobuf msg with no plaintext hash"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["There is unknown fileds in integral of VideoTransport"]);l=function(){return a};return a}function m(a,b,c){var e,f,g,m;if(!((e=a.integral)==null?void 0:e.transport))return null;e=(e=a.integral)==null?void 0:e.transport;if(d("decodeProtobuf").getUnknownFields(e.integral)!=null){d("WALogger").ERROR(l());return null}f=(f=e.integral)==null?void 0:f.fileSha256;if(!f){d("WALogger").ERROR(k());return null}g=(g=e.ancillary)==null?void 0:g.fileLength;g==null&&(d("WALogger").WARN(j(),g),g=d("WAParseConsumerMessageProtocol").DEFAULT_FILE_SIZE);try{g=d("WALongInt").numberOrThrowIfTooLarge(g)}catch(a){d("WALogger").ERROR(i(),g);return null}var n=null;if(((m=a.ancillary)==null?void 0:m.scansSidecar)!=null&&((m=a.ancillary)==null?void 0:m.scanLengths)!=null){n={sidecar:(m=a.ancillary)==null?void 0:m.scansSidecar,scanLengths:(m=a.ancillary)==null?void 0:(a=m.scanLengths)==null?void 0:a.map(d("WAProgressiveJpegGetScanLengths").asProgressiveJpegScanLength)}}if(((m=e.integral)==null?void 0:m.fileSha256)==null||((a=e.integral)==null?void 0:a.fileEncSha256)==null||((m=e.integral)==null?void 0:m.mediaKey)==null||((a=e.integral)==null?void 0:a.directPath)==null||((m=e.integral)==null?void 0:m.mediaKeyTimestamp)==null||((a=e.ancillary)==null?void 0:a.objectId)==null){d("WALogger").ERROR(h());return null}a=(m=e.ancillary.thumbnail)==null?void 0:m.downloadableThumbnail;b=d("WAMediaUtils").rawDataToMediaEntry(e.integral.fileSha256,e.integral.fileEncSha256,e.integral.mediaKey,e.integral.directPath,d("WATimeUtils").castLongIntToUnixTime(e.integral.mediaKeyTimestamp),b,(m=e.ancillary)==null?void 0:m.objectId,void 0,{directPath:a==null?void 0:a.directPath,fileEncSha256:a==null?void 0:a.fileEncSha256,fileSha256:a==null?void 0:a.fileSha256,mediaKey:a==null?void 0:a.mediaKey,mediaKeyTimestamp:(a==null?void 0:a.mediaKeyTimestamp)==null?null:d("WATimeUtils").castLongIntToUnixTime(a==null?void 0:a.mediaKeyTimestamp),objectId:a==null?void 0:a.objectId},c,n);return{size:g,plaintextHash:d("WAMediaUtils").toPlaintextHash(new Uint8Array(f)),mediaEntry:b}}function n(a,b){var c,e=m(a,"image");if(!e)return null;e=p(e,b);b=(b=a.ancillary)==null?void 0:b.width;c=(c=a.ancillary)==null?void 0:c.height;a.ancillary!=null&&(a.ancillary.width!=null&&a.ancillary.width===4294967295&&(b=void 0),a.ancillary.height!=null&&a.ancillary.height===4294967295&&(c=void 0));c=babelHelpers["extends"]({},e,{mediaType:d("WAMedia").MEDIA_TYPE.IMAGE,validatedVideoInfo:null,validatedImageInfo:{width:b,height:c,jpegThumbnail:(e=a.integral)==null?void 0:(b=e.transport)==null?void 0:(c=b.ancillary)==null?void 0:(e=c.thumbnail)==null?void 0:e.jpegThumbnail,jpegThumbnailHeight:(b=a.integral)==null?void 0:(c=b.transport)==null?void 0:(e=c.ancillary)==null?void 0:(b=e.thumbnail)==null?void 0:b.thumbnailHeight,jpegThumbnailWidth:(c=a.integral)==null?void 0:(e=c.transport)==null?void 0:(b=e.ancillary)==null?void 0:(a=b.thumbnail)==null?void 0:a.thumbnailWidth},validatedAudioInfo:null,validatedDocumentFileInfo:null});return c}function a(a,b){a=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAMediaTransport.pb").ImageTransportSpec,a);a=n(a,b);if(a==null)throw c("WAErr")("consumerMessage has no image media info");return a}function b(a,b,c){var e;if(!((e=a.integral)==null?void 0:e.transport))return null;e=m(a,c?"gif":"video");if(!e)return null;e=p(e,b);e=babelHelpers["extends"]({},e,{mediaType:c?d("WAMedia").MEDIA_TYPE.GIF:d("WAMedia").MEDIA_TYPE.VIDEO,validatedVideoInfo:c?null:{duration:(a==null?void 0:(b=a.ancillary)==null?void 0:b.seconds)!=null&&(a==null?void 0:(e=a.ancillary)==null?void 0:e.seconds)>d("WAParseConsumerMessageProtocol").MINIMAL_MEDIA_DURATION?a==null?void 0:(b=a.ancillary)==null?void 0:b.seconds:d("WAParseConsumerMessageProtocol").MINIMAL_MEDIA_DURATION,width:a==null?void 0:(e=a.ancillary)==null?void 0:e.width,height:a==null?void 0:(b=a.ancillary)==null?void 0:b.height,mimetype:a==null?void 0:(e=a.integral)==null?void 0:(b=e.transport)==null?void 0:(e=b.ancillary)==null?void 0:e.mimetype,jpegThumbnail:(b=a.integral)==null?void 0:(e=b.transport)==null?void 0:(b=e.ancillary)==null?void 0:(e=b.thumbnail)==null?void 0:e.jpegThumbnail,jpegThumbnailHeight:(b=a.integral)==null?void 0:(e=b.transport)==null?void 0:(b=e.ancillary)==null?void 0:(e=b.thumbnail)==null?void 0:e.thumbnailHeight,jpegThumbnailWidth:(b=a.integral)==null?void 0:(e=b.transport)==null?void 0:(b=e.ancillary)==null?void 0:(e=b.thumbnail)==null?void 0:e.thumbnailWidth},validatedImageInfo:c?{width:(b=a.ancillary)==null?void 0:b.width,height:(e=a.ancillary)==null?void 0:e.height,jpegThumbnail:(c=a.integral)==null?void 0:(b=c.transport)==null?void 0:(e=b.ancillary)==null?void 0:(c=e.thumbnail)==null?void 0:c.jpegThumbnail,jpegThumbnailHeight:(b=a.integral)==null?void 0:(e=b.transport)==null?void 0:(c=e.ancillary)==null?void 0:(b=c.thumbnail)==null?void 0:b.thumbnailHeight,jpegThumbnailWidth:(e=a.integral)==null?void 0:(c=e.transport)==null?void 0:(b=c.ancillary)==null?void 0:(a=b.thumbnail)==null?void 0:a.thumbnailWidth}:null,validatedAudioInfo:null,validatedDocumentFileInfo:null});return e}function e(a,b,c){if(!((b=a.integral)==null?void 0:b.transport))return null;b=m(a,"ptt");if(!b)return null;b=p(b,c);b=babelHelpers["extends"]({},b,{mediaType:d("WAMedia").MEDIA_TYPE.PTT,validatedVideoInfo:null,validatedImageInfo:null,validatedDocumentFileInfo:null,validatedAudioInfo:{duration:(a==null?void 0:(c=a.ancillary)==null?void 0:c.seconds)!=null&&(a==null?void 0:(b=a.ancillary)==null?void 0:b.seconds)>d("WAParseConsumerMessageProtocol").MINIMAL_MEDIA_DURATION?a==null?void 0:(c=a.ancillary)==null?void 0:c.seconds:d("WAParseConsumerMessageProtocol").MINIMAL_MEDIA_DURATION,mimetype:a==null?void 0:(b=a.integral)==null?void 0:(c=b.transport)==null?void 0:(a=c.ancillary)==null?void 0:a.mimetype,played:!1}});return b}function f(a,b){var c;if(!((c=a.integral)==null?void 0:c.transport))return null;c=m(a,"sticker");if(!c)return null;c=p(c,b);c=babelHelpers["extends"]({},c,{mediaType:d("WAMedia").MEDIA_TYPE.STICKER,validatedVideoInfo:null,validatedImageInfo:{width:(b=a.ancillary)==null?void 0:b.width,height:(c=a.ancillary)==null?void 0:c.height,jpegThumbnail:(b=a.integral)==null?void 0:(c=b.transport)==null?void 0:(b=c.ancillary)==null?void 0:(c=b.thumbnail)==null?void 0:c.jpegThumbnail,jpegThumbnailHeight:(b=a.integral)==null?void 0:(c=b.transport)==null?void 0:(b=c.ancillary)==null?void 0:(c=b.thumbnail)==null?void 0:c.thumbnailHeight,jpegThumbnailWidth:(b=a.integral)==null?void 0:(c=b.transport)==null?void 0:(a=c.ancillary)==null?void 0:(b=a.thumbnail)==null?void 0:b.thumbnailWidth},validatedAudioInfo:null,validatedDocumentFileInfo:null});return c}function o(a,b,c){var e;if(!((e=a.integral)==null?void 0:e.transport))return null;e=m(a,"document",b);if(!e)return null;e=p(e,c);return babelHelpers["extends"]({},e,{mediaType:d("WAMedia").MEDIA_TYPE.DOCUMENT_FILE,validatedVideoInfo:null,validatedImageInfo:null,validatedAudioInfo:null,validatedDocumentFileInfo:{mimetype:a==null?void 0:(c=a.integral)==null?void 0:(e=c.transport)==null?void 0:(a=e.ancillary)==null?void 0:a.mimetype,filename:(c=b)!=null?c:void 0}})}function p(a,b){return{mediaEntry:a.mediaEntry,plaintextHash:a.plaintextHash,size:a.size,msgIds:[],mediaEntries:new(d("WAMsgMap").MsgMap)(),ts:b}}g.getMediaMeta=m;g.parseImageMsg=n;g.decodeImageTransport=a;g.parseVideoMsg=b;g.parseAudioMsg=e;g.parseStickerMsg=f;g.parseDocumentMsg=o}),98);
__d("WAParseV3Protocol",["WAAckLevel","WAAssertUnreachable","WAErr","WAGlobals","WAHex","WAMsgType","WAParseConsumerMessageProtocol"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return function(b,e,f,g,h){h={id:{chat:e,author:g,externalId:f},ts:h,serverTs:h,ack:d("WAAckLevel").ACK.RECEIVED,forwardingScore:b.type!=="futureProof"?(f=b==null?void 0:(g=b.metadata)==null?void 0:g.forwardingScore)!=null?f:0:0};g=b.type!=="futureProof"&&((g=b.metadata)==null?void 0:(f=g.chatEphemeralSetting)==null?void 0:f.ephemeralExpiration)!=null&&((g=b.metadata)==null?void 0:(f=g.chatEphemeralSetting)==null?void 0:f.ephemeralExpiration)>0;if(b.type==="futureProof"||g&&!d("WAGlobals").getConfig().isEphemeralMessagesEnabled())return{unstoredMsg:{type:d("WAMsgType").FUTUREPROOF,msgContent:{subtype:null,protobuf:d("WAHex").bytesToBuffer(b.protobuf)},id:h.id,ts:h.ts,sentTs:h.sentTs,serverTs:h.serverTs,ack:h.ack,reportingMeta:h.reportingMeta},unstoredMedia:null,unstoredQuotedMedia:null};else if(b.type==="subprotocol"){f=a==null?void 0:a.get(b.subprotocolType);if(f!=null)return f(e,b.subprotocol,h,b.protobuf,b.metadata);switch(b.subprotocolType){case"consumerMessage":return d("WAParseConsumerMessageProtocol").parseConsumerMessageProtocol(e,b.subprotocol,h,b.protobuf,b.metadata);case"businessMessage":throw c("WAErr")("unsupported subprotocolType: "+b.subprotocolType);case"paymentMessage":throw c("WAErr")("unsupported subprotocolType: "+b.subprotocolType);case"multiDevice":throw c("WAErr")("unsupported subprotocolType: "+b.subprotocolType);case"voip":throw c("WAErr")("unsupported subprotocolType: "+b.subprotocolType);default:throw c("WAErr")("Subprotocol parser for: "+b.subprotocolType+" was not found")}}else return c("WAAssertUnreachable")(b.type)}}g.createV3ProtocolParser=a}),98);
__d("WAStanzaRootTag",[],(function(a,b,c,d,e,f){"use strict";a="notification";b="receipt";c="message";d="call";e="chatstate";var g="presence",h="appdata",i="failure",j="stream:error",k="ib",l="iq",m="error",n="success",o="xmlstreamend",p={NOTIFICATION:a,RECEIPT:b,MESSAGE:c,CHATSTATE:e,PRESENCE:g,APPDATA:h,CALL:d,IQ:l,IB:k,STREAM_ERROR:j,FAILURE:i,SUCCESS:n,ERROR:m,XML_STREAM_END:o};f.NOTIFICATION=a;f.RECEIPT=b;f.MESSAGE=c;f.CALL=d;f.CHATSTATE=e;f.PRESENCE=g;f.APPDATA=h;f.FAILURE=i;f.STREAM_ERROR=j;f.IB=k;f.IQ=l;f.ERROR=m;f.SUCCESS=n;f.XML_STREAM_END=o;f.STANZA_ROOT_TAG=p}),66);
__d("WASyncdConst",["$InternalEnum","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";a=1e3;c=1e3*60*60;e=2;f=d("WATimeUtils").DAY_MILLISECONDS*2;d=100;var h=2e3,i=10,j=100,k=0,l=3,m=7,n=(b=b("$InternalEnum"))({Star:"star",Contact:"contact",Mute:"mute",PinDEPRECATED:"pin",Pin:"pin_v1",SettingPushName:"setting_pushName",LabelEdit:"label_edit",LabelMessage:"label_message",LabelJid:"label_jid",QuickReply:"quick_reply",LocaleSetting:"setting_locale",Archive:"archive",MarkChatAsRead:"markChatAsRead",ClearChat:"clearChat",DeleteMessageForMe:"deleteMessageForMe",Sentinel:"sentinel",UnarchiveChatsSetting:"setting_unarchiveChats",DeleteChat:"deleteChat",AndroidUnsupportedActions:"android_unsupported_actions",PrimaryFeature:"primary_feature",Subscription:"subscription",Nux:"nux",Agent:"deviceAgent",TimeFormat:"time_format",UserStatusMute:"userStatusMute",PrimaryVersion:"primary_version",RemoveRecentSticker:"removeRecentSticker",ChatAssignment:"agentChatAssignment",ChatAssignmentOpenedStatus:"agentChatAssignmentOpenedStatus",FavoriteSticker:"favoriteSticker",PnForLidChat:"pnForLidChat",ShareOwnPn:"shareOwnPn",ExternalWebBeta:"external_web_beta",MarketingMessage:"marketingMessage",MarketingMessageBroadcast:"marketingMessageBroadcast",StatusPrivacy:"status_privacy",BotWelcomeRequest:"bot_welcome_request",LabelReordering:"label_reordering",PaymentInfo:"payment_info",CustomPaymentMethods:"custom_payment_methods",LockChat:"lock",ChatLockSettings:"setting_chatLock",DeviceCapabilities:"device_capabilities",DisableLinkPreviews:"setting_disableLinkPreviews"}),o=b({Regular:"regular",RegularLow:"regular_low",RegularHigh:"regular_high",CriticalBlock:"critical_block",CriticalUnblockLow:"critical_unblock_low"}),p=b.Mirrored(["Success","SuccessHasMore","Conflict","ConflictHasMore","ErrorRetry","ErrorFatal","Blocked"]),q=b.Mirrored(["UpToDate","Dirty","FailingFiniteRetry","Fatal","Blocked"]),r=b.Mirrored(["Success","Malformed","Orphan","Unsupported","Skipped","Failed"]),s=b.Mirrored(["Msg","Chat","Agent","ChatAssignment","UserStatusMute"]),t=b.Mirrored(["ApplyRemoteAndDropLocal","SkipRemote","SkipRemoteAndDropLocal"]);b=b.Mirrored(["Patch","Snapshot","Local"]);g.BACKOFF_MIN_TIMEOUT=a;g.BACKOFF_MAX_TIMEOUT=c;g.BACKOFF_BASE=e;g.FINITE_FAILURE_EXPIRY_DURATION=f;g.MIN_INLINE_MUTATIONS=d;g.MAX_INLINE_MUTATIONS=h;g.MIN_PATCH_SIZE=i;g.MAX_PATCH_SIZE=j;g.DEFAULT_COLLECTION_VERSION=k;g.LABEL_ASSOCIATION_SYNC_VERSION=l;g.CHAT_ASSIGNMENT_SYNC_VERSION=m;g.Actions=n;g.CollectionName=o;g.CollectionState=p;g.CollectionSyncState=q;g.SyncActionState=r;g.SyncModelType=s;g.ConflictResolutionState=t;g.SyncDataType=b}),98);
__d("WAPREList",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum")({DECRYPT_MESSAGE_FINAL:"decrypt_message_final",FRANKING_VALIDATION:"franking_validation",GET_DEVICES:"get_devices",MEDIA_DOWNLOAD:"media_download",MEDIA_UPLOAD:"media_upload",DELETE_THREAD:"delete_thread",DOWNLOAD_AND_DECRYPT:"download_and_decrypt",MESSAGE_DECRYPTION:"message_decryption",MESSAGE_ENCRYPTION:"message_encryption",OFFLINE_QUEUE:"offline_queue",OFFLINE_RETRY:"offline_retry",ICDC_ERROR:"icdc_error",QUERY_GROUP:"query_group",QUERY_GROUPS:"query_groups",RETRY_RECEIPTS_SENT:"retry_receipts_sent",SYNCD_FATAL_ERROR:"syncd_fatal_error",SYNCD_CRITICAL_EVENT:"syncd_critical_event",SYNCD_CRITICAL_BOOTSTRAP_STAGE:"syncd_critical_bootstrap_stage",SYNCD_BOOTSTRAP_APP_STATE_DOWNLOAD:"syncd_bootstrap_app_state_download",SYNCD_DECRYPT_MUTATIONS:"syncd_decrypt_mutations",SYNCD_BOOTSTRAP_DATA_APPLIED:"syncd_bootstrap_data_applied",APP_STATE_SYNC_DAILY:"app_state_sync_daily",SYNCD:"syncd",SEND_MESSAGE:"send_message",RECEIVE_MESSAGE:"receive_message",SYNCD_KEY_ROTATION:"syncd_key_rotation",REMOVE_PARTICIPANTS:"remove_participants",CREATE_GROUP:"create_group",WA_JOBS_ORCHESTRATOR:"wa_jobs_orchestrator",WA_DISCONNECT:"wa_disconnect",WA_JOB_MANAGER:"wa_job_manager",STANZA_QUEUE_MESSAGE_CONSUMER:"stanza_queue_message_consumer",WA_FAIL_STANZA_QUEUE_ITEM:"stanza_queue_item_failure",ONE_QUEUE:"one_queue",PROTOCOL_QUEUE_CONSUMER:"protocol_queue_consumer"});f.PRE_METRIC=a}),66);
__d("WAPREMetrics",["WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[PRE] "," ends with an error ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[PRE] "," ends successfully"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[PRE] add point "," to ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[PRE] resume ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[PRE] start ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[PRE] There are no subscribers to PRE events"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Removing all listeners from PRE_METRICS"]);n=function(){return a};return a}var o=0;function a(){var b=[];function c(a){b.push(a)}function e(){d("WALogger").WARN(n()),b.length=0}function a(a){b.length===0&&d("WALogger").WARN(m()),b.forEach(function(b){b(a)})}return{subscribe:c,notify:a,clear:e}}c=a();var p=c.notify;e=c.clear;f=c.subscribe;function b(a,b,c){var e;c==null&&o++;var f=(e=c)!=null?e:o,g="open";c==null?(p({name:a,stage:"START",instanceKey:f,annotations:b}),d("WALogger").DEV(l(),a)):(p({name:a,stage:"RESUME",instanceKey:f,annotations:b}),d("WALogger").DEV(k(),a));return{addPoint:function(c,b){p({name:a,stage:"POINT",reason:c,instanceKey:f,annotations:b}),d("WALogger").DEV(j(),c,a)},addAnnotations:function(b){p({name:a,stage:"ANNOTATE",instanceKey:f,annotations:b})},endSuccess:function(b){p({name:a,stage:"SUCCESS",instanceKey:f,annotations:b}),g="closed",d("WALogger").DEV(i(),a)},endFail:function(c,b){p({name:a,stage:"FAIL",reason:c,instanceKey:f,annotations:b}),g="closed",d("WALogger").DEV(h(),a,c)},getFlowDetails:function(){return{name:a,instanceKey:f}},isActive:function(){return g==="open"}}}g.clear=e;g.subscribe=f;g.startMetric=b}),98);
__d("WAProtocol.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.internalSpec={remoteJid:[1,(b=d("WAProtoConst")).TYPES.STRING],fromMe:[2,b.TYPES.BOOL],id:[3,b.TYPES.STRING],participant:[4,b.TYPES.STRING]};g.MessageKeySpec=a}),98);
__d("WATypedArraysConcat",[],(function(a,b,c,d,e,f){"use strict";function a(a,b,c){c===void 0&&(c=0);c=b.reduce(function(a,b){return a+b.length},c);var d=new a(c),e=0;b.forEach(function(a){d.set(a,e),e+=a.length});return d}f.concatTypedArrays=a}),66);
__d("WACryptoAesCbc",["Promise","WABinary","WACryptoDependencies","WAErr","WATypedArraysCast","WATypedArraysConcat","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=16,j=1024,k=16,l=1024*1024,m=i*l;l=function(){function a(a,b,c,e){this.$4=null;this.$6=!1;this.$1=a;this.$2=b;this.$3=c;var f={name:"AES-CBC",iv:e};this.$5=d("WACryptoDependencies").getCrypto().subtle.importKey("raw",c,"AES-CBC",!1,[b]).then(function(a){return{algo:f,key:a}})}var b=a.prototype;b.append=function(a){var b=this;this.$7("append");var c=this.$4;if(c){c.writeByteArray(a);if(c.size()>j){var e=c.size()%i;e=c.readByteArray(c.size()-e);c.size()||(this.$4=null)}else e=null}else if(a.length>j){c=a.length%i;!c?e=a:(this.$4=new(d("WABinary").Binary)(a),e=this.$4.readByteArray(a.length-c))}else this.$4=new(d("WABinary").Binary)(a),e=null;var f=e;f&&(this.$5=this.$5.then(function(a){var c=a.key;a=a.algo;if(b.$2==="encrypt")return d("WACryptoDependencies").getCrypto().subtle.encrypt(a,c,f).then(function(a){b.$1.writeByteArray(new Uint8Array(a,0,a.byteLength-i));return new Uint8Array(a,a.byteLength-2*i,i)});else{var e=f.slice(-i);return d("WACryptoDependencies").getCrypto().subtle.decrypt(a,c,f).then(function(a){b.$1.writeBuffer(a);return e})}}).then(function(a){var c={name:"AES-CBC",iv:a};return d("WACryptoDependencies").getCrypto().subtle.importKey("raw",b.$3,"AES-CBC",!1,[b.$2]).then(function(a){return{algo:c,key:a}})}));return this.$5.then(function(){})};b.finalize=function(a){var b=this;this.$7("finalize");var c;if(this.$4){var e=this.$4;a&&e.writeByteArray(a);c=e.readByteArray();this.$4=null}else a&&(c=a);if(c){var f=c;return this.$5.then(function(a){var c=a.algo;a=a.key;if(b.$2==="encrypt")return d("WACryptoDependencies").getCrypto().subtle.encrypt(c,a,f);else return d("WACryptoDependencies").getCrypto().subtle.decrypt(c,a,f)}).then(function(a){b.$1.writeBuffer(a)})}else return this.$5.then(function(){})};b.$7=function(a){if(this.$6)throw c("WAErr")("AesCbcStream."+a+" called after finalize")};return a}();function n(a){return{name:"AES-CBC",iv:d("WATypedArraysCast").castTypedArrays(Uint8Array,a)}}function o(a){return d("WACryptoDependencies").getCrypto().subtle.importKey("raw",d("WATypedArraysCast").castTypedArrays(Uint8Array,a),"AES-CBC",!1,["encrypt"])}function p(a){if(a)return d("WATypedArraysCast").castTypedArrays(Uint8Array,a);a=new Uint8Array(k);d("WACryptoDependencies").getCrypto().getRandomValues(a);return a}function q(a){a=a.byteLength;var b=i-a%i;return Number.isNaN(b)?a:a+b}function r(a,c,e){var f=n(c);return(h||(h=b("Promise"))).resolve(d("WACryptoDependencies").getCrypto().subtle.importKey("raw",d("WATypedArraysCast").castTypedArrays(Uint8Array,a),"AES-CBC",!1,["decrypt"])).then(function(a){return d("WACryptoDependencies").getCrypto().subtle.decrypt(f,a,e)})}function a(a,c){return(h||(h=b("Promise"))).resolve().then(function(){var b=c.slice(0,k),d=c.slice(k);return r(a,b,d)})}function e(a,c,e){return(h||(h=b("Promise"))).resolve().then(function(){var f=p(e),g=n(f);return(h||(h=b("Promise"))).resolve(o(a)).then(function(a){return d("WACryptoDependencies").getCrypto().subtle.encrypt(g,a,c)}).then(function(a){return d("WATypedArraysConcat").concatTypedArrays(Uint8Array,[f,new Uint8Array(a)]).buffer})})}function f(a,d,e,f){var g,h,j,k,l,n,r,t,u,v,w,x,y;return b("regeneratorRuntime").async(function(z){while(1)switch(z.prev=z.next){case 0:f===void 0&&(f=m);if(!(f%i!==0)){z.next=3;break}throw c("WAErr")("chunkSize must be a multiple of "+i+", "+f+" received");case 3:z.next=5;return b("regeneratorRuntime").awrap(o(a));case 5:g=z.sent,h=new Uint8Array(d),j=Math.ceil(h.byteLength/f),k=p(e),l=new Uint8Array(q(h)+k.byteLength),l.set(k),(n=0,r=k);case 12:if(!(n<j)){z.next=26;break}u=n===j-1;v=n*f;t=h.subarray(v,v+f);z.next=18;return b("regeneratorRuntime").awrap(s(u,t,r,g));case 18:w=z.sent,x=w.encryptedChunk,y=w.nextIv,l.set(x,k.byteLength+n*f),r=y;case 23:n++;z.next=12;break;case 26:return z.abrupt("return",l.buffer);case 27:case"end":return z.stop()}},null,this)}function s(a,c,e,f){var g,h;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:j.next=2;return b("regeneratorRuntime").awrap(d("WACryptoDependencies").getCrypto().subtle.encrypt(n(e),f,c).then(function(b){return a?new Uint8Array(b):new Uint8Array(b).subarray(0,-i)}));case 2:g=j.sent;h=g.slice(-i);return j.abrupt("return",{encryptedChunk:g,nextIv:h});case 5:case"end":return j.stop()}},null,this)}g.AES_CBC_BLOCK_SIZE=i;g.AesCbcStream=l;g.importRawKey=o;g.getIv=p;g.aesCbcDecrypt=r;g.aesCbcDecryptSplit=a;g.aesCbcEncrypt=e;g.aesCbcEncryptWithChunking=f;g.aesCbcEncryptChunk=s}),98);
__d("WAMemoizeCache",[],(function(a,b,c,d,e,f){"use strict";var g=[];function a(){g.forEach(function(a){return a.clear()})}function h(){var a=new Map();g.push(a);return a}function b(a,b){var c;return function(){c||(c=h());var d=b.apply(void 0,arguments),e=c.get(d);e==null&&(e=a.apply(void 0,arguments),c.set(d,e));return e}}f.clearAllMemoizeCache=a;f.MemoizeCache=h;f.memoizeWithArgs=b}),66);
__d("WACryptoSha256",["Promise","WABase64","WACryptoDependencies"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a){return(h||(h=b("Promise"))).resolve(d("WACryptoDependencies").getCrypto().subtle.digest({name:"SHA-256"},a))}function j(a){return(h||(h=b("Promise"))).resolve(i(a).then(d("WABase64").encodeB64))}function a(a){return j(k(a))}function k(a){var b=new ArrayBuffer(a.length),c=new Uint8Array(b);for(var d=0,e=a.length;d<e;d++)c[d]=a.charCodeAt(d);return b}g.sha256=i;g.sha256Base64=j;g.sha256Str=a}),98);
__d("MAWPersistedQueueApi",["MAWDexieTable","MAWTransactionMode","MAWTransactor","WAArrayZip","WATagsLogger","err"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["{"," not indexed in ",""]);h=function(){return a};return a}var i=d("WATagsLogger").TAGS(["MAWWorker"]);function a(){return{ack:o,clear:r,count:j,"delete":q,failAck:p,where:m,write:n}}function j(a,b){return d("MAWTransactor").persistedQueueTransactor(a,d("MAWTransactionMode").READONLY,function(a){return b==null?a.count():a.where(Object.keys(b)).anyOf(Object.values(b)).count()},"count")}function k(a,b){b=b.length===1?b[0]:"["+b.join("+")+"]";var c=a.schema.indexes.map(function(a){a=a.name;return a});if(c.includes(b))return!0;i.WARN(h(),b,a.name);return!1}function l(a,b){if(!k(a,b))throw c("err")(b.join(",")+" is not an index for "+a.name+".")}function m(a,b,c,e){return d("MAWTransactor").persistedQueueTransactor(a,d("MAWTransactionMode").READONLY,function(a){var d;if(b!=null&&Object.keys(b).length>0){var f=Object.keys(b),g=Object.values(b);k(a,f)||(f.reverse(),g.reverse());l(a,f);f.length>1?d=a.where(f).anyOf([g]):d=a.where(f[0]).equals(g[0])}else d=a.toCollection();e==="desc"&&(d=d.desc());c!=null&&(d=d.limit(c));return d.toArray()},"where")}function n(a,b){return d("MAWTransactor").persistedQueueTransactor(a,d("MAWTransactionMode").READWRITE,function(a){return a.bulkAdd(b).then(function(){})},"write")}function o(a,b,c){return d("MAWTransactor").persistedQueueTransactor(a,d("MAWTransactionMode").READWRITE,function(a){if(c==null)return a.bulkDelete(b);else return a.bulkGet(b).then(function(e){e=d("WAArrayZip").zip(b,e).map(function(a){var b=a[0];a=a[1];return{after:c(a),id:b}});var f=e.filter(function(a){return a.after==null}).map(function(a){return a.id});e=e.filter(function(a){return a.after!=null});return d("MAWDexieTable").dexieAll([a.bulkDelete(f),a.bulkUpdate(e.map(function(a){return{changes:a.after,key:a.id}}))]).then(function(){})})},"ack")}function p(a,b,c){return d("MAWTransactor").persistedQueueTransactor(a,d("MAWTransactionMode").READWRITE,function(a){return a.bulkGet(b).then(function(e){e=d("WAArrayZip").zip(b,e).map(function(a){var b=a[0];a=a[1];if(a==null)return;return{after:c(a),id:b}}).filter(Boolean);var f=e.filter(function(a){return a.after==null}).map(function(a){return a.id});e=e.filter(function(a){return a.after!=null});return d("MAWDexieTable").dexieAll([a.bulkDelete(f),a.bulkUpdate(e.map(function(a){return{changes:a.after,key:a.id}}))]).then(function(){})})},"failAck")}function q(a,b){return d("MAWTransactor").persistedQueueTransactor(a,d("MAWTransactionMode").READWRITE,function(a){return d("MAWDexieTable").dexieAll([a.bulkDelete(b)]).then(function(){})},"delete")}function r(a){return d("MAWTransactor").persistedQueueTransactor(a,d("MAWTransactionMode").READWRITE,function(a){return a.clear().then(function(){})},"clear")}g.dexieApiForPersistedQueue=a;g.persistedQueueWhere=m}),98);
__d("MAWSharedEbUploadQueue",["MAWPersistedQueueApi","MAWSharedEbUploadEntity","WAGlobals","WAPersistedQueue","WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to write to ebUploadQueue ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["EB Upload Queue is already initialized"]);i=function(){return a};return a}var j=d("WATagsLogger").TAGS(["EbUploadQueue"]),k=null;function l(){return k==null?m():k}function m(){k!=null&&j.ERROR(i());var a=d("WAPersistedQueue").initPersistedQueue("ebUploadQueue",d("MAWPersistedQueueApi").dexieApiForPersistedQueue());k=a;return a}function a(a){if(!d("WAGlobals").getConfig().useEbUploadQueue())return;a=a.map(function(a){var b=a.backupDirective,c=a.messageApplication,e=a.msgId,f=a.originalMsgProtocolId,g=a.reportingMeta,h=a.senderId;a=a.serverTs;return d("MAWSharedEbUploadEntity").asEBUploadEntity({backupDirective:b,msgId:e,originalMsgProtocolId:f,protobuf:d("MAWSharedEbUploadEntity").encodeBackupMessage({backupDirective:b,messageApplication:c,msgId:e,reportingMeta:g,serverTs:a}),senderId:h,serverTs:a})});var b=l();a.forEach(function(a){void b.write(a)});b.flush()["catch"](function(a){j.ERROR(h(),a)})}g.logger=j;g.ebUploadQueue=l;g.initEbUploadQueue=m;g.putMsgsToEbUpload=a}),98);
__d("MessageBackupSupplementalKeyGenerator",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";var g=b("$InternalEnum")({REACTION:"reaction",EDIT:"edit"}),h=":";function a(a,b){return""+g.getName(a)+h+b}function c(a){return a.split(h)[1]}function d(a){return a.startsWith("reaction")}f.SupplementalKeyPrefix=g;f.SUPPLEMENTAL_KEY_DELIMITER=h;f.createMessageSupplementalKey=a;f.getSupplementalSenderId=c;f.isSupplementalProtobufAReaction=d}),66);
__d("MAWDbEditMsgHistory",["I64"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){return a}function b(a){return(h||(h=d("I64"))).of_float(a)}function c(a){return(h||(h=d("I64"))).to_float(a)}g.unsafeCoerceToEditMsgHistoryId=a;g.convertToEditMsgHistoryId64=b;g.convertToEditMsgHistoryId=c}),98);
__d("MAWDbEditMsgHistoryTxns",["MAWAckLevel","MAWDbEditMsgHistory","MAWDexieTable","MAWIndexedDb","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[getEditHistoryMsgByEditedProtocolMsgId] Suspected multiple instances of same message!"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[getEditHistoryMsgByEditedProtocolMsgId] Can't have "," messages with the same editExternalId!"]);i=function(){return a};return a}function a(a,b){return a.editMsgHistory.where(["originalMsgExternalId","threadJid"]).anyOf(b).toArray()}function b(a,b){return b==null?d("MAWDexieTable").dexieResolve():a.editMsgHistory.get({editMsgHistoryId:b})}function c(a,b,c){return a.editMsgHistory.where("originalMsgExternalId").equals(c).filter(function(a){return a.editExternalId===b.externalId&&a.author===b.author&&a.threadJid===b.chat}).toArray().then(function(a){if(a.length>1){var b=a.map(function(a){return""+((a=a.editTs)!=null?a:0).toString()});b=new Set(b).size===1;!b?d("WALogger").ERROR(i(),a.length):d("WALogger").ERROR(h())}return a[0]})}function e(a,b){return b==null?d("MAWDexieTable").dexieResolve([]):a.editMsgHistory.where("originalMsgExternalId").equals(b.externalId).filter(function(a){return a.author===b.author&&a.threadJid===b.chat}).toArray().then(function(a){var b=[];a.forEach(function(a){if(a==null)return;b.push(a)});return b})}function f(a,b){return a.editMsgHistory.bulkGet(b)}function j(a,b,c){var e=b.map(function(a,b){return babelHelpers["extends"]({},a,{editMsgHistoryId:d("MAWDbEditMsgHistory").convertToEditMsgHistoryId64(c[b])})});return a.messages.where("externalId").anyOf(e.map(function(a){return a.originalMsgExternalId})).toArray().then(function(a){var b=new Map();a.forEach(function(a){a!=null&&b.set(a.externalId,a)});return e.map(function(a){var c=b.get(a.originalMsgExternalId);return c==null?null:babelHelpers["extends"]({},a,{originalMsgId:c.msgId})}).filter(Boolean)}).then(function(a){d("MAWIndexedDb").afterTransaction({tag:"EditMsgHistoryAdded",value:a});return c})}function k(a,b,c){c===void 0&&(c=!0);return a.editMsgHistory.bulkAdd(b,{allKeys:!0}).then(function(e){return c?j(a,b,e):d("MAWDexieTable").dexieResolve(e)})}function l(a,b,c,d){return d.then(function(d){return m(a,b,c,d)})}function m(a,b,c,e){var f=[];return a.editMsgHistory.where("originalMsgExternalId").equals(b).filter(function(a){return a.threadJid===e&&a.author===c&&(a.sendStatus==null||a.sendStatus>=d("MAWAckLevel").ACK.sent)}).toArray().then(function(a){a.forEach(function(a){f.push({messageId:a.editExternalId,originalMessageId:a.originalMsgExternalId,text:a.msgContent.content,timestamp:(a=a.editTs)!=null?a:0})});return f})}function n(a,b,c,d){return a.editMsgHistory.where("originalMsgExternalId").equals(b).filter(function(a){return a.threadJid===d&&a.author===c})["delete"]().then(function(){})}var o=function(a,b){return a.editMsgHistory.where(["originalMsgExternalId","threadJid"]).anyOf(b)["delete"]().then(function(){return d("MAWDexieTable").dexieResolve(b.length)})};g.getEditHistoryByOriginalMsgExternalIdAndThreadJid=a;g.maybeGetEditMsgHistoryFromEditMsgHistoryId=b;g.getEditHistoryMsgByEditedProtocolMsgId=c;g.maybeGetEditMsgHistoryFromProtocolMsgId=e;g.bulkGetEditMsgHistorys=f;g.bulkAddEditMsgHistory=k;g.getEditHistoryAsEchoWithJidPromise=l;g.getEditHistoryAsEcho=m;g.bulkRemoveEditHistory=n;g.deleteExpiredEditMsgHistory=o}),98);
__d("MAWDbIdentityTxns",["MAWAddQPLPointForHandleIncomingMsgApi","MAWDexieTable","MAWGlobals","MAWJids","WAArrayZip","WABaseGlobals","WACryptoUtils","WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Invalidate dhash for ",""]);h=function(){return a};return a}function i(a,b){if(b==null)return void 0;a=d("WAJids").isAuthorMe(a)?d("WABaseGlobals").getMyUserJid():a;return d("MAWJids").toDeviceJid(a,b)}function a(a,b){var c=Array.from(b.map(function(a){return a.msgData}).reduce(function(a,b){var c=b.device;b=b.id;b=i(b.author,c==null?void 0:c.id);return b==null?a:a.add(b)},new Set())),e=new Map();return a.identity.bulkGet(Array.from(c)).then(function(a){d("WAArrayZip").zip(c,a).forEach(function(a){var b=a[0];a=a[1];e.set(b,a==null);d("MAWAddQPLPointForHandleIncomingMsgApi").addQPLPointForHIMApi("hasDeviceJid",{bool:{knownDevice:a!=null}})});e.set(void 0,!0);return e})}function b(a,b){return j(a,b).then(function(a){return a.map(function(a){if(a==null)return;return{id:a.deviceJid,identity:a.identity}}).filter(Boolean)})}function c(a,b){return a.identity.bulkPut(b).then(function(){})}function e(a,b){return j(a,b).then(function(a){var c=new Map();for(var d=0;d<a.length;d++){var e=a[d],f=b[d];e!=null&&c.set(f,{pubKey:e.identity})}return c})}function j(a,b){return a.identity.bulkGet(b)}function k(a,b){return a.identity.where("userJid").equals(b).toArray()}function f(a,b){return a.identity.where("userJid").anyOf(b).toArray()}function l(a,b,c){var e=[],f=new Map();b.forEach(function(b){var d=k(a,b).then(function(a){var d=[];a.forEach(function(a){if(c!=null&&a.deviceJid===c)return;d.push(a)});d.length>0&&f.set(b,d)});e.push(d)});return d("MAWDexieTable").dexieAll(e).then(function(){return f})}function m(a,b){var c=b.find(function(a){return a.deviceJid===d("MAWGlobals").getMyDeviceJid()});if(c!=null)return a.identity.get(c.deviceJid).then(function(a){if(a!=null&&!d("WACryptoUtils").uint8ArraysEqual(c.identity,a.identity))return!0;else return!1});else return d("MAWDexieTable").dexieResolve(!1)}function n(a,b){d("WALogger").DEV(h(),b);return a.contacts.bulkGet(b).then(function(b){b=b.filter(Boolean);b.forEach(function(a){a.dhash=null});return a.contacts.bulkPut(b)}).then(function(){})}g.getDeviceJid=i;g.bulkGetUnknownDeviceStatus=a;g.bulkGetIdentities=b;g.bulkPutIdentities=c;g.getIdentitiesForDevices=e;g.bulkGetIdentityRows=j;g.getIdentitiesForUser=k;g.getIdentitiesForUsers=f;g.getIdentitiesForMultipleUsers=l;g.compareIdentityMismatch=m;g.invalidateDhash=n}),98);
__d("MAWCastToMsgrServerMediaType",["MAWDbMedia","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["invalid client mediaType: "," for castClientMediaTypeToServerMediaType method"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["invalid mediaType: "," for castToMsgrServerMediaType method"]);i=function(){return a};return a}function a(a,b){b===void 0&&(b=!1);if(b&&a==="image")return"xma";switch(a){case"image":case"video":case"gif":case"sticker":case"document":return a;case"ptt":return"audio";case"xma-image":return"xma";default:d("WALogger").ERROR(i(),a);return null}}function b(a,b){b===void 0&&(b=!1);if(b&&a===d("MAWDbMedia").MEDIA_TYPE.IMAGE)return"xma";switch(a){case"Image":return"image";case"Video":return"video";case"Gif":return"gif";case"Sticker":return"sticker";case"DocumentFile":return"document";case"Ptt":return"audio";default:d("WALogger").ERROR(h(),a);return null}}g.castToMsgrServerMediaType=a;g.castClientMediaTypeToServerMediaType=b}),98);
__d("MAWMediaAfterTxns",["MAWBridgeTypesCreators","MAWIndexedDb","MAWRavenUtils"],(function(a,b,c,d,e,f,g){"use strict";var h=function(a,b){return{ephemeralMediaState:b,ephemeralMediaViewMode:d("MAWRavenUtils").getEphemeralMediaViewMode(a)}};function a(a,b,c){b=a.ravenEphemeralType!=null&&a.ravenEphemeralMediaState!=null?d("MAWBridgeTypesCreators").createBridgeMedia(a.thread,a.threadJid,b,c,a.sortOrderMs,h(a.ravenEphemeralType,a.ravenEphemeralMediaState)):d("MAWBridgeTypesCreators").createBridgeMedia(a.thread,a.threadJid,b,c,a.sortOrderMs);d("MAWIndexedDb").afterTransaction({tag:"NewMedia",value:b})}g.handleNewMediaAfterTxn=a}),98);
__d("MAWMediaBackupTxns",["MAWDbMediaTxns","MAWDexieTable","Promise","WALogger","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] fbid already exists for objectId"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] mediaId or msgId cannot differ for an objectId in mediaBackup"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] ObjectId already shared by different msgId"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] fbid already exists for objectId"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] mediaId or msgId cannot differ for an objectId in mediaBackup"]);m=function(){return a};return a}function a(a,b,e,f,g){return f==null||!c("gkx")("23919")?d("MAWDexieTable").dexieResolve():d("MAWDbMediaTxns").maybeGetMediaBackupRowFromObjectId(a,f).then(function(c){if(c==null){var h={mediaId:b,msgId:e,objectId:f};g!=null&&(h=babelHelpers["extends"]({},h,{fbid:g}));return a.mediaBackup.add(h).then(function(a){return babelHelpers["extends"]({},h,{mediaBackupId:a})})}else if(c.mediaId!==b||c.msgId!==e){d("WALogger").ERROR(m());return c}else{if(c.fbid==null&&g!=null){var i=babelHelpers["extends"]({},c,{fbid:g});return a.mediaBackup.put(i).then(function(a){return i})}else d("WALogger").WARN(l());return c}})}function e(a,e){if(e==null||!c("gkx")("23919"))return d("MAWDexieTable").dexieResolve();var f=[];e.forEach(function(a){a=a.objectId;a!=null&&f.push(a)});return d("MAWDbMediaTxns").maybeGetMediaBackupRowsFromObjectIds(a,f).then(function(c){var f=new Map(),g=[];e.forEach(function(a){var b=a.objectId;if(b!=null){var e=c.get(b);if(e==null){var h={mediaId:a.mediaId,msgId:a.msgId,objectId:b},l=a.fbid;if(l!=null){h=babelHelpers["extends"]({},h,{fbid:l});f.get(b)!=null&&((l=f.get(b))==null?void 0:l.msgId)!==a.msgId&&d("WALogger").ERROR(k());f.set(b,h)}}else{e.mediaId!==a.mediaId&&d("WALogger").ERROR(j());l=a.fbid;if(e.fbid==null&&l!=null){b=babelHelpers["extends"]({},e,{fbid:l});g.push(b)}else d("WALogger").WARN(i())}}});return(h||(h=b("Promise"))).all([a.mediaBackup.bulkAdd([].concat(Array.from(f.values()))),a.mediaBackup.bulkPut(g)]).then(function(){})}).then(function(){})}g.linkMediaBackup=a;g.bulkLinkMediaBackup=e}),98);
__d("MAWMediaManagementTxns",["MAWBridgeTypesCreators","MAWBridgeUpload","MAWCastToMsgrServerMediaType","MAWDbChunkTxns","MAWDbMediaTxns","MAWDbMsgTxns","MAWDexieTable","MAWGlobals","MAWIndexedDb","MAWMediaAfterTxns","MAWMediaBackupTxns","MAWMediaUtils","MAWMsgType","MAWSupportedDocumentTypes","MAWWriteMsgTxns","WAErrorMessage","WAJids","WALogger","WAMediaUtils","WASortedLists","WATagsLogger","WATimeUtils","err","gkx","isInstamadilloEB"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] mediaBackup entry already exists for objectId ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Same FBId assigned for different mediaIds. fbId: "," - shared by hashedPlaintextHashes: "," ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Same objectId assigned for different mediaIds. objectId: "," shared by  hashedPlaintextHashes: "," ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web][updateMediaWithEncodedMediaEntryData] media entry is missing, can't upate media with encoded data"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] media entry is missing, can't update media info"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Media failed to link. Possible duplicate? Will attempt a retry. Error: ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Media failed to link. Possible duplicate? Will attempt a retry. For plaintextHash: ",", hashedPlaintextHash: ",". Error: ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["Media failed to link after retry. Error: ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["Media failed to link after retry. For plaintextHash: ",", hashedPlaintextHash: ",". Error: ",""]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["Media found after retry for plaintextHash: ",""]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["Missing mandatory args for incoming media msg"]);r=function(){return a};return a}var s=d("WATagsLogger").TAGS(["MAWMediaManagementTxns"]),t=c("gkx")("23924");function a(a,b,c,e){var f=c==null||b.type===d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE&&(t||!d("MAWSupportedDocumentTypes").isAllowedType((c=c.validatedDocumentFileInfo)==null?void 0:c.filename));return d("MAWWriteMsgTxns").prepareMsgWriteData(a,b,e).then(function(a){return babelHelpers["extends"]({},a,{shouldDropDocument:f})})}function b(a,b,e,f){f===void 0&&(f=!1);var g={validatedAudioInfo:b.validatedAudioInfo,validatedDocumentFileInfo:b.validatedDocumentFileInfo,validatedImageInfo:b.validatedImageInfo,validatedVideoInfo:b.validatedVideoInfo},h=d("MAWMediaUtils").genHMACPlaintextHash(b.plaintextHash),i=d("WAMediaUtils").decodeMediaEntryData(b.mediaEntry),j=i.objectId!=null?d("WAMediaUtils").stringToDeliveryObjectId(i.objectId):null;return d("MAWDexieTable").dexieAll([u(a,e,b.plaintextHash,b.mediaType,b.size,b.mediaEntry,g,j,void 0,f),d("MAWDbChunkTxns").hasMediaChunk(a,h)]).then(function(a){var b=a[0];a=a[1];e.type!==d("MAWMsgType").MSG_TYPE.REVOKED&&!f&&d("MAWMediaAfterTxns").handleNewMediaAfterTxn(e,b,a);return b}).then(function(a){var b=d("MAWCastToMsgrServerMediaType").castToMsgrServerMediaType(i.serverMediaType,f),g=i.mediaKeyTimestamp;if(d("MAWMsgType").isMAWSupportedMediaType(e.type)&&!c("isInstamadilloEB")()){var h=e.threadJid;j!=null&&b!=null&&h!=null&&g!=null&&b!=="document"?d("MAWIndexedDb").afterTransaction({tag:"UploadAttachment",value:d("MAWBridgeUpload").createBridgeUploadAttachment(e.thread,j,b,e.externalId,d("MAWGlobals").getConfig().productTypeForEBAttachments,d("WAJids").threadIdForChatJid(h),h,g)}):d("WALogger").WARN(r())}return a})}function u(a,b,c,e,f,g,h,i,j,k){k===void 0&&(k=!1);return v(a,b,c,e,f,g,h,i,j,k).then(function(c){var e=k?d("MAWDexieTable").dexieResolve():d("MAWDbMsgTxns").updateMediaId(a,b,c.mediaId);return e.then(function(){return d("MAWMediaBackupTxns").linkMediaBackup(a,c.mediaId,b.msgId,i,j).then(function(){return c})})})}function v(a,b,c,e,f,g,h,i,j,k,l){k===void 0&&(k=!1);l===void 0&&(l=0);return d("MAWDbMediaTxns").maybeGetMediaFromPlaintextHash(a,c).then(function(r){var t=new Map(r==null?void 0:r.mediaEntries),u=z(g,i,j);u!=null&&t.set(b.msgId,u);if(r){l>0&&s.LOG(q(),c);var w=babelHelpers["extends"]({},r,h,{mediaEntries:t,msgIds:d("WASortedLists").addToSet(r.msgIds,b.msgId)});return a.media.put(w).then(function(){return w})}else{var x=d("MAWMediaUtils").genHMACPlaintextHash(c),y=babelHelpers["extends"]({fbid:(u=j)!=null?u:void 0,hashedPlaintextHash:x,mediaEntries:t,mediaType:e,msgIds:d("WASortedLists").singleElement(b.msgId),objectId:(r=i)!=null?r:void 0,plaintextHash:c,size:f,ts:d("WATimeUtils").unixTime()},h);return a.media.add(y).then(function(a){return babelHelpers["extends"]({},y,{mediaId:a})})["catch"](function(q){var r=d("WAErrorMessage").maybeGetMessageFromError(q);if(l>0){s.WARN(p(),c,x,r);s.ERROR(o(),r);throw q}else{s.WARN(n(),c,x,r);s.ERROR(m(),r);return v(a,b,c,e,f,g,h,i,j,k,l+1)}})}})}var w=function(a,b,e,f,g,h,i,j,k){k===void 0&&(k=!1);return d("MAWDbMsgTxns").maybeGetMsgByProtocolMsgId(a,b).then(function(b){if(b==null)throw c("err")("Do not have the media message in db when attachHashToMediaMsg");else return u(a,b,e,h,i,void 0,j,f,g,k)})},x=function(a,b,c){return d("MAWDbMediaTxns").maybeGetMediaFromHashedPlaintextHash(a,b).then(function(b){if(b!=null){var d=babelHelpers["extends"]({},b);c.validatedAudioInfo!=null&&(d.validatedAudioInfo=babelHelpers["extends"]({},b.validatedAudioInfo,c.validatedAudioInfo));c.validatedVideoInfo!=null&&(d.validatedVideoInfo=babelHelpers["extends"]({},b.validatedVideoInfo,c.validatedVideoInfo));c.validatedImageInfo!=null&&(d.validatedImageInfo=babelHelpers["extends"]({},b.validatedImageInfo,c.validatedImageInfo));c.validatedDocumentFileInfo!=null&&(d.validatedDocumentFileInfo=babelHelpers["extends"]({},b.validatedDocumentFileInfo,c.validatedDocumentFileInfo));return a.media.update(d.mediaId,d).then(function(){})}else s.WARN(l())})},y=function(a,b,c,e){return d("MAWDbMediaTxns").maybeGetMediaFromHashedPlaintextHash(a,b).then(function(b){if(b!=null){var f=e?b.mediaEntries.set(c,e):b.mediaEntries;b=babelHelpers["extends"]({},b,{mediaEntries:f});return a.media.update(b.mediaId,b)}else{s.ERROR(k());return d("MAWDexieTable").dexieResolve()}})};function e(a,b,c,e,f,g,h,i,j,k){k===void 0&&(k=!1);return d("MAWDexieTable").dexieAll([w(a,b,e,f,g,h,j.size,i,k),d("MAWDbChunkTxns").getOrCreateMediaChunk(a,e,c,j.type)]).then(function(a){a=a[0];return a})}function z(a,b,c){var e;a=a;a!=null&&b!=null&&(e=d("WAMediaUtils").decodeMediaEntryData(a),a=d("WAMediaUtils").encodeMediaEntryWithUpdatedObjectId(e,b));a!=null&&c!=null&&(e=d("WAMediaUtils").decodeMediaEntryData(a),a=d("WAMediaUtils").encodeMediaEntryWithUpdatedFbid(e,c));return a}function f(a,b,c){var e=new Map();a.mediaEntries.forEach(function(a,f){var g=d("WAMediaUtils").decodeMediaEntryData(a);g=g.objectId===b?d("WAMediaUtils").encodeMediaEntryWithUpdatedFbid(g,c):a;e.set(f,g)});return e}function A(a,b,c,e){var f=new Map();b.forEach(function(a){var b;b=(b=f.get(a.hashedPlaintextHash))!=null?b:[];b.push(a);f.set(a.hashedPlaintextHash,b)});return d("MAWDbMediaTxns").maybeBulkGetMediaFromHashedPlaintextHash(a,[].concat(Array.from(f.keys()))).then(function(g){var h=new Map(g.map(function(a){return[a.hashedPlaintextHash,a]})),i=new Map();b.forEach(function(a){var b=h.get(a.hashedPlaintextHash);if(a==null)return;var c=z(a==null?void 0:a.entry,a==null?void 0:a.objectId,a==null?void 0:a.fbId);if(b){var e=c?b.mediaEntries.set(a.msgId,c):b.mediaEntries;e=babelHelpers["extends"]({},b,{mediaEntries:e,msgIds:d("WASortedLists").addToSet(b.msgIds,a.msgId)});h.set(a.hashedPlaintextHash,e)}else I(i,a,c)});var j=new Map(),k=new Map();g=Array.from(i.values()).filter(function(a){return B(a,j,k)});return d("MAWDexieTable").dexieAll([a.media.bulkAdd(g),a.media.bulkPut(Array.from(h.values()))]).then(function(){return C(a,[].concat(Array.from(f.keys())),f,c,e)})})}function B(a,b,c){if(a.objectId!=null){var d=b.get(a.objectId);if(d!=null&&d!==a.hashedPlaintextHash){s.ERROR(j(),a.objectId,d,a.hashedPlaintextHash);return!1}}if(a.fbid!=null){d=c.get(a.fbid);if(d!=null&&d!==a.hashedPlaintextHash){s.ERROR(i(),a.fbid,d,a.hashedPlaintextHash);return!1}}a.objectId!=null&&b.set(a.objectId,a.hashedPlaintextHash);a.fbid!=null&&c.set(a.fbid,a.hashedPlaintextHash);return!0}function C(a,b,c,e,f){return d("MAWDbMediaTxns").maybeBulkGetMediaFromHashedPlaintextHash(a,b).then(function(b){return d("MAWDexieTable").dexieAll([F(a,b,c),d("MAWMediaBackupTxns").bulkLinkMediaBackup(a,G(b,c))]).then(function(){D(b,c,e,f);return b})})}function D(a,b,c,e){a.forEach(function(a){var f=b.get(a.hashedPlaintextHash);f!=null&&!E(f)&&d("MAWIndexedDb").afterTransaction({tag:"NewMedia",value:d("MAWBridgeTypesCreators").createBridgeMedia(c,e,a,!1)})})}function E(a){return a.reduce(function(a,b){return a||b.isXMAShare},!1)}function F(a,b,c){b=b.reduce(function(a,b){var d;(d=c.get(b.hashedPlaintextHash))==null?void 0:d.filter(function(a){return a!=null&&!a.isXMAShare}).forEach(function(c){return a.set(c.msgId,b.mediaId)});return a},new Map());return d("MAWDbMsgTxns").bulkUpdateMediaId(a,b)}function G(a,b){var c=new Map();a.forEach(function(a){var d;d=(d=b.get(a.hashedPlaintextHash))!=null?d:[];d.forEach(function(b){c.has(b.objectId)?s.ERROR(h(),b.objectId):b.objectId!=null&&c.set(b.objectId,{fbid:b.fbId,mediaId:a.mediaId,msgId:b.msgId,objectId:b.objectId})})});return Array.from(c.values())}function H(a,b){var c;a=a?new Map([[b.msgId,a]]):new Map();return babelHelpers["extends"]({fbid:(c=b.fbId)!=null?c:void 0,hashedPlaintextHash:b.hashedPlaintextHash,mediaEntries:a,mediaType:b.mediaType,msgIds:d("WASortedLists").singleElement(b.msgId),objectId:(c=b.objectId)!=null?c:void 0,plaintextHash:b.plaintextHash,size:b.size,ts:d("WATimeUtils").unixTime()},b.mediaInfo)}function I(a,b,c){var d=a.get(b.hashedPlaintextHash);d==null?a.set(b.hashedPlaintextHash,H(c,b)):(c!=null&&d.mediaEntries.set(b.msgId,c),d.msgIds.push(b.msgId))}g.prepareMediaWriteData=a;g.handleUnstoredDbMedia=b;g.linkMedia=u;g.createOrUpdateMediaRow=v;g.attachHashToMediaMsg=w;g.updateMediaEntryWithValidatedMediaInfo=x;g.updateMediaWithEncodedMediaEntryData=y;g.attachHashAndSaveMedia=e;g.updateBackupFbidInMediaEntries=f;g.bulkLinkMedia=A;g.linkMessageAndMediaBackupForMediaList=C}),98);
__d("WAServerRPCLogger",["WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";a=d("WATagsLogger").TAGS(["ServerRPC"]);g.logger=a}),98);
__d("MAWIncomingMsg",["MAWExternalId","WAGlobals","WAHashStringToNumber","WAJids","WAServerRPCLogger","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";a=d("WAServerRPCLogger").logger.TAGS(["HandleIncomingMsg"]);b=function(a){var b=a.consumerRetries,c=a.encTypes,e=a.msg,f=a.queueType;a=a.retryCount;return{"int":{consumerRetries:(b=b)!=null?b:0,messageAge:d("WATimeUtils").unixTime()-e.ts,msgId:d("WAHashStringToNumber").hashStringToNumber(e.externalId.toString()),offlineDelivery:e.offline,retryCount:a},string:{e2eePlatform:d("MAWExternalId").getPlatform(e.externalId),jid:e.from.chat,msgType:e.type,queueType:f,threadType:e.from.type,userHash:d("WAGlobals").getConfig().isEmployee()&&d("WAGlobals").getConfig().isUseridAnnotationEnabled()?d("WAJids").extractUserId(d("WAGlobals").getMyUserJid()).slice(-5):null},string_array:{encTypes:c}}};g.logger=a;g.prepareAnnotationsForIncomingMessage=b}),98);
__d("MAWCastToServerMediaType",[],(function(a,b,c,d,e,f){"use strict";function a(a){switch(a){case"document":case"image":case"xma-image":case"video":case"ptt":case"gif":case"sticker":return a;default:return null}}f.castToServerMediaType=a}),66);
__d("MAWOptimisticUploadManager",[],(function(a,b,c,d,e,f){"use strict";var g=new Map();function a(){return g}function b(){g.clear()}f.getOptimisticUploadManager=a;f.clearOptimisticUploadManager=b}),66);
__d("MAWUpdateMediaEntryForMsgApi",["FBLogger","MAWBridgeUpload","MAWCastToMsgrServerMediaType","MAWCastToServerMediaType","MAWDbMediaTxns","MAWDbMsgTxns","MAWDexieTable","MAWGlobals","MAWIndexedDb","MAWMediaBackupTxns","MAWOptimisticUploadManager","MAWTransactionMode","WAJids","WALogger","WAMediaUtils","err","isInstamadilloEB"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Missing required arguments for media backup"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Nothing to update if updatedMediaEntry is null"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([""," msgId does not exist within media entries"]);j=function(){return a};return a}var k=d("MAWIndexedDb").makeMsgrTransactor({media:(a=d("MAWTransactionMode")).READWRITE,mediaBackup:a.READWRITE,messages:a.READONLY,threads:a.READONLY},"updateMediaEntryForMsg",function(a){return function(b,e,f,g,k){var l=d("MAWCastToServerMediaType").castToServerMediaType(k);if(!l){c("FBLogger")("labyrinth_web","unsupported_media").mustfix("unsupported media type");throw c("err")("Media type unsupported: "+((l=k)!=null?l:""))}return d("MAWDexieTable").dexieAll([d("MAWDbMediaTxns").maybeGetMediaFromPlaintextHash(a,b),d("MAWDbMsgTxns").maybeGetMsgByProtocolMsgId(a,e)]).then(function(b){var l=b[0],m=b[1];if(!m)throw c("err")("Message does not exist for the given protocolMsgId");if(!l)throw c("err")("Media does not exist for the given hashedPlaintextHash");if(!l.msgIds.includes(m.msgId)){d("WALogger").LOG(j(),m.msgId);return}b=l.mediaEntries;var n=b.get(m.msgId);n=f(n);if(n==null){d("WALogger").LOG(i());return}b=babelHelpers["extends"]({},l,{mediaEntries:b.set(m.msgId,n)});g!=null&&(b=babelHelpers["extends"]({},b,{objectId:d("WAMediaUtils").stringToDeliveryObjectId(g)}));var o=d("WAMediaUtils").decodeMediaEntryData(n);return a.media.put(b).then(function(b){return g!=null?d("MAWMediaBackupTxns").linkMediaBackup(a,l.mediaId,m.msgId,d("WAMediaUtils").stringToDeliveryObjectId(g)):d("MAWDexieTable").dexieResolve()}).then(function(){var a=d("MAWCastToMsgrServerMediaType").castToMsgrServerMediaType(k),b=o.mediaKeyTimestamp;g!=null&&a!=null&&b!=null&&a!=="document"&&!c("isInstamadilloEB")()?d("MAWIndexedDb").afterTransaction({tag:"UploadAttachment",value:d("MAWBridgeUpload").createBridgeUploadAttachment(m.thread,g,a,e.externalId,d("MAWGlobals").getConfig().productTypeForEBAttachments,d("WAJids").threadIdForChatJid(e.chat),m.threadJid,b)}):d("WALogger").WARN(h())})})}});b=function(a,b,c,d,e){l(a,c);return k(a,b,c,d,e)};function l(a,b){var c=d("MAWOptimisticUploadManager").getOptimisticUploadManager(),e=c.get(a);if(e==null)return;b=b();if(b==null)return;c.set(a,babelHelpers["extends"]({},e,{mediaEntry:b}))}g.updateMediaEntryForMsg=b}),98);
__d("WAMmsRetry.pb",["$InternalEnum","WAProtoConst"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({GENERAL_ERROR:0,SUCCESS:1,NOT_FOUND:2,DECRYPTION_ERROR:3});c={};e={};c.internalSpec={stanzaId:[1,(f=d("WAProtoConst")).TYPES.STRING],directPath:[2,f.TYPES.STRING],result:[3,f.TYPES.ENUM,a]};e.internalSpec={stanzaId:[1,f.TYPES.STRING]};g.MediaRetryNotification$ResultType=a;g.MediaRetryNotificationSpec=c;g.ServerErrorReceiptSpec=e}),98);
__d("WAArmadilloICDC.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};a.internalSpec={seq:[1,(c=d("WAProtoConst")).TYPES.INT32],timestamp:[2,c.TYPES.INT64],devices:[3,c.FLAGS.REPEATED|c.TYPES.BYTES],signingDeviceIndex:[4,c.TYPES.INT32]};b.internalSpec={details:[1,c.TYPES.BYTES],signature:[2,c.TYPES.BYTES]};g.ICDCIdentityListSpec=a;g.SignedICDCIdentityListSpec=b}),98);
__d("WAIdentityUtils",["WABinary","WACryptoDependencies","WASignalOther"],(function(a,b,c,d,e,f,g){"use strict";function h(a){var b=a.length===33&&a[0]===5;return b?a.slice(1):a}function i(a,b){for(var c=0;c<a.length&&c<b.length;++c)if(a[c]!==b[c])return a[c]-b[c];return a.length-b.length}function a(a){a=a.map(function(a){return h(a)});var b=new(d("WABinary").Binary)();a.sort(i).forEach(function(a){return b.writeByteArray(a)});a=d("WACryptoDependencies").getCrypto().subtle.digest("SHA-256",b.readByteArray());return a.then(function(a){a=new Uint8Array(a);return d("WASignalOther").sliceBytes(a,0,10)})}g.removeKeyTypeIfNeeded=h;g.computeIdentitiesHash=a}),98);
__d("WAProtocolQueueState",["Promise","WAProtocolQueue","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var c=d("WAProtocolQueue").protocolQueue();void (h||(h=b("Promise"))).all(a.map(function(a){return c.write(a)}));return h.resolve()}function c(a){void d("WAProtocolQueue").protocolQueue().write(a);return(h||(h=b("Promise"))).resolve()}function e(a){return d("WAProtocolQueue").protocolQueue().ack(a)}function f(a){return d("WAProtocolQueue").protocolQueue()["delete"](a)}var i=function(a){var c,e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:c=[{}];a.types!=null?c=a.types.map(function(b){b={type:b};a.jid!=null&&(b=babelHelpers["extends"]({jid:a.jid},b));return b}):a.jid!=null?c=[{jid:a.jid}]:a.priority!=null&&(c=[{priority:a.priority}]);e=c.map(function(b){return d("WAProtocolQueue").protocolQueue().where(b,a.limit)});g.next=5;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all(e).then(function(a){return a.flatMap(function(a){return a})}));case 5:f=g.sent;return g.abrupt("return",d("WAProtocolQueue").mapProtocolEntriesV2toV1(f));case 7:case"end":return g.stop()}},null,this)};g.persistStanzas=a;g.persistStanza=c;g.ackProtocols=e;g.deleteQueueIDs=f;g.read=i}),98);
__d("WAICDCUtils",["WAArmadilloICDC.pb","WABase64","WABinary","WABridge","WACryptoDependencies","WACryptoEd25519","WACryptoUtils","WADevicesState","WAErr","WAGlobals","WAIdentityUtils","WAJids","WALogger","WAOdsEnums","WAProtocolQueue","WAProtocolQueueState","WASignalKeys","WASignalOther","WASignalSignatures","WATimeUtils","decodeProtobuf","encodeProtobuf","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["The number of ICDC failures is higher "," than allowed amount ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to wait for user devices: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["flushing ICDC payload with "," entries from ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["flushing ICDC payload returned early"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["flushing ICDC payload"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["ICDC timestamp is negative. time: ",", closkSkew: ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["signingDeviceIndex not found. This should never happen. ",". caller: ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["Received ICDC has mismatched missed signingDeviceIndex"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["Received ICDC has mismatched timestamp between XML node and byte structure"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["Received ICDC has mismatched sequence between XML node and byte structure"]);q=function(){return a};return a}function a(a,b,c,e){if(a!==e.details.seq){d("WALogger").ERROR(q());return null}if(c!==e.details.timestamp){d("WALogger").ERROR(p());return null}if(e.details.signingDeviceIndex==null){d("WALogger").ERROR(o());return null}var f=e.details.signingDeviceIndex;return{dirty:b,sequence:a,timestamp:c,signingDeviceIndex:f,devices:e.details.devices.map(function(a){return new Uint8Array(a)})}}function r(a){return a.signingDeviceIndex<0||a.signingDeviceIndex>=a.devices.length}function s(a,b){if(r(b))return null;var c=new Set(),e=new Set();b.devices.forEach(function(a){c.add(a.id),e.add(a.identity.toString())});var f=new Set(),g=new Set();a.devicesInfo.forEach(function(a){var b=d("WAJids").extractDeviceId(a.jid);a=d("WAIdentityUtils").removeKeyTypeIfNeeded(a.identity);(!c.has(b)||!e.has(a.toString()))&&(f.add(b),g.add(a.buffer))});return{seq:b.sequence,signingDevice:d("WAIdentityUtils").removeKeyTypeIfNeeded(b.devices[b.signingDeviceIndex].identity).buffer,unknownDevices:Array.from(g),unknownDeviceIds:Array.from(f)}}function e(a,b,c){var d=new Map();c.forEach(function(a){d.set(a.user,a)});c=d.get(a.user);var e=void 0;c!=null&&(e=s(a,c));var f=[],g=[];b.forEach(function(a){var b=d.get(a.user);if(b!=null){b=s(a,b);b!=null&&f.push(b)}g.push(a.user)});return{senderIdentity:(a=e)!=null?a:void 0,recipientIdentities:f,recipientUserJids:g}}function t(a,b,c){if(a==null){d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.ICDC,key:"missing_icdc_payload"});return{action:"none"}}else if(b==null||a.seq==null||a.signingDevice==null){b==null&&d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.ICDC,key:"error.missing_stored_icdc"});(a.seq==null||a.signingDevice==null)&&d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.ICDC,key:"error.invalid_icdc_payload"});return{action:"error",failureTs:d("WATimeUtils").unixTime(),sync:!0}}var e=a.seq,f=a.signingDevice;if(e===b.sequence){var g=new Set();c.forEach(function(a){return g.add(d("WAIdentityUtils").removeKeyTypeIfNeeded(a).toString())});e=!g.has(new Uint8Array(f).toString());b=a.unknownDevices.some(function(a){return!g.has(new Uint8Array(a).toString())});if(e||b){d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.ICDC,key:"error.unknow_device"});return{action:"error",failureTs:d("WATimeUtils").unixTime(),sync:!0}}}else{d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.ICDC,key:"error.incorrect_seq"});return{action:"error",failureTs:d("WATimeUtils").unixTime(),sync:!0}}return{action:"none"}}function f(a){a=d("decodeProtobuf").decodeProtobuf(d("WAArmadilloICDC.pb").SignedICDCIdentityListSpec,a);var b=a.signature;a=d("decodeProtobuf").decodeProtobuf(d("WAArmadilloICDC.pb").ICDCIdentityListSpec,a.details);return{signature:b,details:a}}function u(a){return a.map(function(a){return d("WASignalKeys").serializeIdentity(new Uint8Array(d("WABase64").decodeB64UrlSafe(a)))})}function v(a,b,e,f,g){var h=d("WAIdentityUtils").removeKeyTypeIfNeeded(a.publicKey);e=e.map(function(a){return d("WAIdentityUtils").removeKeyTypeIfNeeded(a)});var i=e.findIndex(function(a){return d("WACryptoUtils").uint8ArraysEqual(a,h)});if(i===-1){d("WALogger").ERROR(n(),f,g);throw c("WAErr")("signingDeviceIndex not found")}f=b==null?1:b+1;g=d("WATimeUtils").unixTime();g<0&&d("WALogger").ERROR(m(),Date.now(),d("WATimeUtils").getClockSkew());b={seq:f,timestamp:g,devices:e,signingDeviceIndex:i};f=d("encodeProtobuf").encodeProtobuf(d("WAArmadilloICDC.pb").ICDCIdentityListSpec,b).readBuffer();g=w(a,d("WABinary").Binary.build(f).readByteArray());e={details:f,signature:g};i=d("encodeProtobuf").encodeProtobuf(d("WAArmadilloICDC.pb").SignedICDCIdentityListSpec,e).readBuffer();return{icdcInfo:b,encodedSignedICDC:i}}function w(a,b){var c=d("WASignalOther").makeBytes(64);d("WACryptoDependencies").getCrypto().getRandomValues(c);var e=new Uint8Array(64);d("WACryptoEd25519").hashSha512(e,b,b.length);e=d("WASignalSignatures").makeSignature(a,b,c);return d("WABinary").Binary.build(e).readBuffer()}var x=4*d("WATimeUtils").HOUR_SECONDS;function y(a){return a==null?!0:!d("WATimeUtils").happenedWithin(a,x)}var z=function(){function a(){this.$1=[]}var c=a.prototype;c.enqueue=function(a){this.$1.push(a)};c.flush=function(a,c,e){var f,g,m,n,o,p,q,r,s,u,v,w,x,y,z,A,B,C,D,E,F,G,H;return b("regeneratorRuntime").async(function(I){while(1)switch(I.prev=I.next){case 0:c.LOG(l()),f=new Map(),(g=this.$1,m=Array.isArray(g),n=0,g=m?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 3:if(!m){I.next=9;break}if(!(n>=g.length)){I.next=6;break}return I.abrupt("break",18);case 6:o=g[n++];I.next=13;break;case 9:n=g.next();if(!n.done){I.next=12;break}return I.abrupt("break",18);case 12:o=n.value;case 13:a=o,p=a.from,f.set(p,a);case 16:I.next=3;break;case 18:q=Array.from(f.values());if(!(q.length===0)){I.next=24;break}c.LOG(k());return I.abrupt("return");case 24:c.LOG(j(),q.length,Array.from(f.keys()).join(","));case 25:r=new Set(q.map(function(a){a=a.from;return d("WAJids").extractUserJid(a)}));I.next=28;return b("regeneratorRuntime").awrap(d("WAGlobals").runInTransaction({ContactsStore:!0},function(a){a=a.ContactsStore;return a.bulkGet(Array.from(r))}).then(function(a){return a.flatMap(function(a){return a.success?[a.value]:[]})}).then(function(a){return new Map(a.map(function(a){return[a.contactJid,a]}))}));case 28:s=I.sent,u=new Set(),v=new Set(),w=[],(x=q.slice(),y=Array.isArray(x),z=0,x=y?x:x[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 33:if(!y){I.next=39;break}if(!(z>=x.length)){I.next=36;break}return I.abrupt("break",56);case 36:B=x[z++];I.next=43;break;case 39:z=x.next();if(!z.done){I.next=42;break}return I.abrupt("break",56);case 42:B=z.value;case 43:e=B;C=e.icdc;p=e.from;D=e.serverTs;E=d("WAJids").extractUserJid(p);F=s.get(E);G=t(C.senderIdentity,F==null?void 0:F.icdcInfo,(F==null?void 0:(A=F.icdcInfo)==null?void 0:A.devices.map(function(a){return d("WASignalKeys").serializeIdentity(a)}))||[]);if(!(G.action==="error")){I.next=54;break}H=function(){var a;G.sync&&u.add(E);var b=G.failureTs;a=((a=F==null?void 0:F.icdcFails)!=null?a:[]).filter(function(a){return a.timeBucket>=d("WATimeUtils").pastUnixTime(d("WAGlobals").getConfig().icdcIntervalInMinutes()*60,b)});if(a.length>0&&d("WATimeUtils").futureUnixTime(d("WAGlobals").getConfig().icdcCooldownIntervalInMinutes()*60,a[a.length-1].timeBucket)>b)return"continue";F!=null&&(v.add(E),s.set(E,babelHelpers["extends"]({},F,{icdcFails:[].concat(a,[{timeBucket:b,alert:!0}])})));var c=d("WAGlobals").getConfig().icdcAlertTriggerFailureCounter(),e=a.filter(function(a){return a.alert===!0}).length>=c;e&&(d("WALogger").WARN(h(),a.length,c),w.push({type:"instruction",instruction:"icdcError",consumerRetries:0,jid:d("WAJids").extractUserJid(p),notificationTs:D,priority:d("WAProtocolQueue").WAProtocolQueuePriorityHigh}))}();if(!(H==="continue")){I.next=54;break}return I.abrupt("continue",54);case 54:I.next=33;break;case 56:u.size>0&&d("WADevicesState").getDevicesState().waitForUserDevices(Array.from(u))["catch"](function(a){d("WALogger").ERROR(i(),a)});if(!(v.size>0)){I.next=60;break}I.next=60;return b("regeneratorRuntime").awrap(d("WAGlobals").runInTransaction({ContactsStore:!0},function(a){a=a.ContactsStore;return a.bulkPut(Array.from(v).flatMap(function(a){a=s.get(a);return a?[a]:[]}))}));case 60:if(!(w.length>0)){I.next=63;break}I.next=63;return b("regeneratorRuntime").awrap(d("WAProtocolQueueState").persistStanzas(w));case 63:this.$1=[];case 64:case"end":return I.stop()}},null,this)};return a}(),A=new z();g.validateAndPrepareICDCFromNotification=a;g.isICDCIndexInvalid=r;g.computeICDCParticipantDevices=e;g.validateICDCInfo=t;g.decodeICDCInfo=f;g.base64DeviceIdentitiesToSerializedPubKeys=u;g.computeICDCInfoForUpload=v;g.isLastSyncTsExpired=y;g.ICDCFlushable=z;g.icdcFlushable=A}),98);
__d("WACryptoPkcs7",["WACryptoDependencies","WAErr"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=new Uint8Array(1);do d("WACryptoDependencies").getCrypto().getRandomValues(b);while(b[0]===0);h(a,b[0])}function b(a){var b=new Uint8Array(1);d("WACryptoDependencies").getCrypto().getRandomValues(b);h(a,(b[0]&15)+1)}function h(a,b){for(var c=0;c<b;c++)a.writeUint8(b)}function e(a){if(a.length===0)throw c("WAErr")("unpadPkcs7 given empty bytes");var b=a[a.length-1];if(b>a.length)throw c("WAErr")("unpadPkcs7 given "+a.length+" bytes, but pad is "+b);return new Uint8Array(a.buffer,a.byteOffset,a.length-b)}g.writeRandomPad=a;g.writeRandomPadMax16=b;g.writePad=h;g.unpadPkcs7=e}),98);
__d("WALock",["Promise","WAResolvable","WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Lock failed for ",""]);i=function(){return a};return a}function a(a){return{lock:function(c,e){var f=new(d("WAResolvable").Resolvable)(),g=c.map(function(a){return[a,new(d("WAResolvable").Resolvable)()]});(h||(h=b("Promise"))).all(g.map(function(b){var c=b[0],d=b[1];return a.enqueue(c,function(){d.resolve();return f.promise})}))["catch"](function(){d("WATagsLogger").TAGS(["WALock"]).ERROR(i(),c)});return h.all(g.map(function(a){a[0];a=a[1];return a.promise})).then(function(){return e()})["finally"](function(){f.resolve()})},wait:function(b){return a.wait(b)}}}g.makeLock=a}),98);
__d("WALockMap",["WALock","WAPromiseQueue"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a===void 0&&(a=-1);a=new(d("WAPromiseQueue").PromiseQueueMap)(a);return d("WALock").makeLock(a)}g.makeLockMap=a}),98);
__d("WASignalSessions",["WABinary","WAErr","WASignalKeys","WASignalOther"],(function(a,b,c,d,e,f,g){"use strict";var h=3;function a(a,b){return i(a,0,b,[])}function i(a,b,c,d){return{ratchetPubKey:a,nextMsgIndex:b,chainKey:c,unusedMsgKeys:d}}function b(a,b){return j(a,0,b)}function j(a,b,c){return{ratchetKey:a,nextMsgIndex:b,chainKey:c}}function k(a,b,c){return{remoteOneTimeId:a,remoteSignedId:b,localOneTimePubKey:c}}function e(a,b){return n(a.local,a.remote,a.rootKey,a.recvChains,a.sendChain,a.initialExchangeInfo,a.prevSendChainHighestIndex,b,a.aliceBaseKey)}function f(a,b,c){return n(a.local,a.remote,a.rootKey,b,c,a.initialExchangeInfo,a.prevSendChainHighestIndex,a.prevSessions,a.aliceBaseKey)}function l(a,b,c,d){c===void 0&&(c=a.sendChain);return n(a.local,a.remote,d,b,c,null,Math.max(a.sendChain.nextMsgIndex-1,0),a.prevSessions,a.aliceBaseKey)}function m(a,b,c,d,e,f,g){return n(a,b,c,d,e,f,0,[],g)}function n(a,b,c,d,e,f,g,h,i){return{local:a,remote:b,rootKey:c,sendChain:e,recvChains:d,initialExchangeInfo:f,prevSendChainHighestIndex:g,prevSessions:h,aliceBaseKey:i}}function o(a,b){b=new(d("WABinary").Binary)(b);var c=d("WASignalOther").readBytes(b,32),e=d("WASignalOther").readBytes(b,32);b=d("WASignalOther").readBytes(b,16);return p(a,c,e,b)}function p(a,b,c,d){return{index:a,cipherKey:b,macKey:c,iv:d}}function q(a){return{senderRatchetKey:a.ratchetPubKey,chainKey:{index:a.nextMsgIndex,key:a.chainKey},messageKeys:a.unusedMsgKeys}}function r(a){var b=a.ratchetKey;return{senderRatchetKey:b.serializedPubKey,senderRatchetKeyPrivate:b.privateKey,chainKey:{index:a.nextMsgIndex,key:a.chainKey}}}function s(a){var b=a.local,c=a.remote,d=a.initialExchangeInfo,e=void 0;if(d){var f=d.remoteOneTimeId;e={preKeyId:f!=null?f:void 0,signedPreKeyId:d.remoteSignedId,baseKey:d.localOneTimePubKey}}return{currentSession:{sessionVersion:h,localIdentityPublic:b.pubKey,remoteIdentityPublic:c.pubKey,rootKey:a.rootKey,previousCounter:a.prevSendChainHighestIndex,senderChain:r(a.sendChain),receiverChains:a.recvChains.map(q),pendingPreKey:e,remoteRegistrationId:c.regId,localRegistrationId:b.regId,aliceBaseKey:a.aliceBaseKey},previousSessions:a.prevSessions}}function t(a){var b=a.local,c=a.remote,e=a.sendChain,f=a.initialExchangeInfo,g=void 0;if(f){var i=f.remoteOneTimeId;g={preKeyId:i!=null?i:void 0,signedPreKeyId:f.remoteSignedId,baseKey:d("WASignalOther").toBuffer(f.localOneTimePubKey)}}return{sessionVersion:h,localIdentityPublic:d("WASignalOther").toBuffer(b.pubKey),remoteIdentityPublic:d("WASignalOther").toBuffer(c.pubKey),rootKey:d("WASignalOther").toBuffer(a.rootKey),previousCounter:a.prevSendChainHighestIndex,senderChain:{senderRatchetKey:d("WASignalOther").toBuffer(e.ratchetKey.serializedPubKey),senderRatchetKeyPrivate:d("WASignalOther").toBuffer(e.ratchetKey.privateKey),chainKey:{index:e.nextMsgIndex,key:d("WASignalOther").toBuffer(e.chainKey)},messageKeys:[]},receiverChains:a.recvChains.map(function(a){return{senderRatchetKey:d("WASignalOther").toBuffer(a.ratchetPubKey),chainKey:{index:a.nextMsgIndex,key:d("WASignalOther").toBuffer(a.chainKey)},messageKeys:a.unusedMsgKeys.map(function(a){return{index:a.index,cipherKey:d("WASignalOther").toBuffer(a.cipherKey),macKey:d("WASignalOther").toBuffer(a.macKey),iv:d("WASignalOther").toBuffer(a.iv)}})}}),pendingPreKey:g,remoteRegistrationId:c.regId,localRegistrationId:b.regId,aliceBaseKey:a.aliceBaseKey==null?void 0:d("WASignalOther").toBuffer(a.aliceBaseKey)}}function u(a){var b=A(a.currentSession,"currentSession");return w(b,a.previousSessions)}function v(a){return w(a,[])}function w(a,b){var e=A(a.sessionVersion,"sessionVersion");if(e!==h)throw c("WAErr")("Signal: bad session version "+e);e=A(a.senderChain,"senderChain");var f=A(e.chainKey,"senderChain.chainKey");e=j(d("WASignalKeys").makeSerializedKeyPairFrom(z(e.senderRatchetKeyPrivate,32,"senderRatchetKeyPrivate"),y(e.senderRatchetKey,"senderRatchetKey")),A(f.index,"senderChain.chainKey.index"),z(f.key,32,"senderChain.chainKey.key"));f=A(a.receiverChains,"receiverChains").map(function(a){var b=A(a.chainKey,"receiverChains[].chainKey");return i(y(a.senderRatchetKey,"receiverChains[].senderRatchetKey"),A(b.index,"receiverChains[].chainKey.index"),z(b.key,32,"receiverChains[].chainKey.key"),x(a.messageKeys))});var g={regId:d("WASignalOther").castRegistrationId(A(a.localRegistrationId,"localRegistrationId")),pubKey:y(a.localIdentityPublic,"localIdentityPublic")},l={regId:d("WASignalOther").castRegistrationId(A(a.remoteRegistrationId,"remoteRegistrationId")),pubKey:y(a.remoteIdentityPublic,"remoteIdentityPublic")},m=a.pendingPreKey,o=null;if(m){var p=m.preKeyId;o=k(p!=null?d("WASignalKeys").castToPreKeyId(p):null,d("WASignalKeys").castToSignedPreKeyId(A(m.signedPreKeyId,"pendingPreKey.signedPreKeyId")),y(m.baseKey,"pendingPreKey.baseKey"))}p=a.aliceBaseKey==null?null:y(a.aliceBaseKey,"aliceBaseKey");return n(g,l,z(a.rootKey,32,"rootKey"),f,e,o,a.previousCounter||0,b,p)}function x(a){return a.map(function(a){return{index:A(a.index,"messageKeys[].index"),cipherKey:z(a.cipherKey,32,"messageKeys[].cipherKey"),macKey:z(a.macKey,32,"messageKeys[].macKey"),iv:z(a.iv,16,"messageKeys[].iv")}})}function y(a,b){return d("WASignalKeys").castToSerializedPubKey(new Uint8Array(A(a,b)))}function z(a,b,c){return d("WASignalOther").toBytes(A(a,c),b)}function A(a,b){if(a==null)throw c("WAErr")("Signal: protobuf is missing "+b);return a}g.FORMAT_VERSION=h;g.makeFreshRecvChain=a;g.makeRecvChain=i;g.makeFreshSendChain=b;g.makeSendChain=j;g.makeInitialExchangeInfo=k;g.setPrevSessions=e;g.updateChains=f;g.ratchetSession=l;g.makeFreshSession=m;g.makeSession=n;g.splitMsgKey=o;g.serializeSession=s;g.detachSession=t;g.parseSessionFromRecord=u;g.parseSession=v;g._parseSession=w;g.bytesOrThrow=z;g.definedOrThrow=A}),98);
__d("WASignalWhisperTextProtocol.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};c={};e={};f={};var h={};a.internalSpec={ratchetKey:[1,(d=d("WAProtoConst")).TYPES.BYTES],counter:[2,d.TYPES.UINT32],previousCounter:[3,d.TYPES.UINT32],ciphertext:[4,d.TYPES.BYTES]};b.internalSpec={registrationId:[5,d.TYPES.UINT32],preKeyId:[1,d.TYPES.UINT32],signedPreKeyId:[6,d.TYPES.UINT32],baseKey:[2,d.TYPES.BYTES],identityKey:[3,d.TYPES.BYTES],message:[4,d.TYPES.BYTES]};c.internalSpec={id:[1,d.TYPES.UINT32],baseKey:[2,d.TYPES.BYTES],ratchetKey:[3,d.TYPES.BYTES],identityKey:[4,d.TYPES.BYTES],baseKeySignature:[5,d.TYPES.BYTES]};e.internalSpec={id:[1,d.TYPES.UINT32],iteration:[2,d.TYPES.UINT32],ciphertext:[3,d.TYPES.BYTES]};f.internalSpec={id:[1,d.TYPES.UINT32],iteration:[2,d.TYPES.UINT32],chainKey:[3,d.TYPES.BYTES],signingKey:[4,d.TYPES.BYTES]};h.internalSpec={generation:[1,d.TYPES.UINT32],signature:[2,d.TYPES.BYTES]};g.SignalMessageSpec=a;g.PreKeySignalMessageSpec=b;g.KeyExchangeMessageSpec=c;g.SenderKeyMessageSpec=e;g.SenderKeyDistributionMessageSpec=f;g.DeviceConsistencyCodeMessageSpec=h}),98);
__d("WASignalGroupSession",["WASignalKeys","WASignalSessions"],(function(a,b,c,d,e,f,g){"use strict";var h=5,i=3;function j(a){var b=d("WASignalSessions").definedOrThrow(a.senderSigningKey,"senderSigningKey"),c=d("WASignalSessions").definedOrThrow(a.senderMessageKeys,"senderMessageKeys"),e=d("WASignalSessions").definedOrThrow(a.senderChainKey,"senderChainKey");return{senderSigningKeyPublic:r(b["public"],"public"),senderSigningKeyPrivate:b["private"]?d("WASignalSessions").bytesOrThrow(b["private"],32,"private"):void 0,senderKeyId:d("WASignalSessions").definedOrThrow(a.senderKeyId,"senderKeyId"),unusedMsgKeys:c.map(function(a){return k(d("WASignalSessions").definedOrThrow(a.iteration,"iteration"),d("WASignalSessions").bytesOrThrow(a.seed,50,"seed"))}),senderKeyChainKey:l(d("WASignalSessions").definedOrThrow(e.iteration,"iteration"),d("WASignalSessions").bytesOrThrow(e.seed,32,"seed"))}}function a(a,b,c,d,e){return{senderSigningKeyPublic:a,senderSigningKeyPrivate:b,senderKeyChainKey:c,senderKeyId:d,unusedMsgKeys:e==null?[]:e}}function b(a,b){var c=a.senderKeyStates.findIndex(function(a){return a.senderKeyId===b.senderKeyId});return{senderKeyStates:a.senderKeyStates.map(function(a,d){return d===c?b:a})}}function c(a,b){a=a.senderKeyStates.slice(a.senderKeyStates.length>h-1?1:0);a.push(b);return{senderKeyStates:a}}function e(a){return{senderKeyStates:[a]}}function k(a,b){return{iteration:a,seed:b}}function l(a,b){return{nextMsgIndex:a,chainKey:b}}function f(a){a=d("WASignalSessions").definedOrThrow(a.senderKeyStates,"senderKeyStates");return m(a)}function m(a){return n(a)}function n(a){a=a.map(function(a){return j(a)});return{senderKeyStates:a}}function o(a,b){var c=a.senderKeyStates.findIndex(function(a){return a.senderKeyId===b});return c===-1?void 0:a.senderKeyStates[c]}function p(a){return{senderKeyStates:a.senderKeyStates.map(function(a){return q(a)})}}function q(a){return{senderKeyId:a.senderKeyId,senderChainKey:{iteration:a.senderKeyChainKey.nextMsgIndex,seed:a.senderKeyChainKey.chainKey},senderSigningKey:{"public":a.senderSigningKeyPublic,"private":a.senderSigningKeyPrivate},senderMessageKeys:a.unusedMsgKeys.map(function(a){var b=a.iteration;a=a.seed;return{iteration:b,seed:a}})}}function r(a,b){return d("WASignalKeys").castToSerializedPubKey(new Uint8Array(d("WASignalSessions").definedOrThrow(a,b)))}function s(a){return a}g.FORMAT_VERSION=i;g.makeSenderKeyState=a;g.updateSessionWithUpdatedSenderKeyState=b;g.updateSessionWithNewSenderKeyState=c;g.makeNewSenderKeySession=e;g.makeSenderKeyMsgKey=k;g.makeSenderKeyChainKey=l;g.parseSessionFromRecord=f;g._parseSession=m;g.makeSenderKeySessionFromRecord=n;g.findSenderKeyState=o;g.serializeSession=p;g.serializeSenderKeyState=q;g.convertFromRawToSenderKeyState=s}),98);
__d("WASignalWhitepaper",["Promise","WABinary","WACryptoDependencies","WASignalGroupSession","WASignalKeys","WASignalOther","WASignalSessions","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=new Uint8Array(32);i.fill(255);var j=new Uint8Array([1]),k=new Uint8Array([2]);function a(a,c,e){var f,g,h,j,k,l,m,q,r,s,t,u,v,w,x,y,z;return b("regeneratorRuntime").async(function(A){while(1)switch(A.prev=A.next){case 0:g=a.regId,h=a.staticKeyPair;j=c.identity;k=c.signedKey.publicKey;l=e.privateKey;m=h.privateKey;q=(f=c.oneTimeKey)==null?void 0:f.publicKey;r=d("WABinary").Binary.build(i,p(m,k),p(l,j),p(l,k),q&&p(l,q)).readByteArray();A.next=9;return b("regeneratorRuntime").awrap(o(r,"WhisperText"));case 9:s=A.sent;t=s[0];u=s[1];v=c.ratchetKey;w=d("WASignalSessions").makeFreshRecvChain(v,u);x=d("WASignalKeys").makeSerializedKeyPair();A.next=17;return b("regeneratorRuntime").awrap(n(t,x,v));case 17:y=A.sent;z=d("WASignalSessions").makeInitialExchangeInfo(c.oneTimeKey==null?null:c.oneTimeKey.id,c.signedKey.id,d("WASignalKeys").serializePubKey(e));return A.abrupt("return",d("WASignalSessions").makeFreshSession({regId:g,pubKey:d("WASignalKeys").serializePubKey(h)},{regId:c.regId,pubKey:j},y.rootKey,[w],d("WASignalSessions").makeFreshSendChain(x,y.chainKey),z,d("WASignalKeys").serializePubKey(e)));case 20:case"end":return A.stop()}},null,this)}function c(a,c,e,f){var g,h,j,k,l,m,n,p,r,s,t,u,v,w;return b("regeneratorRuntime").async(function(x){while(1)switch(x.prev=x.next){case 0:h=a.regId,j=a.staticKeyPair;k=j.privateKey;l=f.signed.privateKey;m=e;n=c.pubKey;p=(g=f.oneTime)==null?void 0:g.privateKey;r=d("WABinary").Binary.build(i,q(n,l),q(m,k),q(m,l),p&&q(m,p)).readByteArray();x.next=9;return b("regeneratorRuntime").awrap(o(r,"WhisperText"));case 9:s=x.sent;t=s[0];u=s[1];v=f.ratchet;w=d("WASignalSessions").makeFreshSendChain(v,u);return x.abrupt("return",d("WASignalSessions").makeSession({regId:h,pubKey:d("WASignalKeys").serializePubKey(j)},c,t,[],w,null,0,[],e));case 15:case"end":return x.stop()}},null,this)}function e(a){a=d("WASignalGroupSession").makeSenderKeyState(d("WASignalKeys").serializePubKey(a),a.privateKey,d("WASignalGroupSession").makeSenderKeyChainKey(0,d("WASignalKeys").makeRawSenderKey()),d("WASignalOther").makeSenderKeyId(),[]);return(h||(h=b("Promise"))).resolve(d("WASignalGroupSession").makeNewSenderKeySession(a))}function f(a,c,e,f,g){e=d("WASignalGroupSession").makeSenderKeyState(e,void 0,d("WASignalGroupSession").makeSenderKeyChainKey(c,f),a,[]);c=null;g?c=d("WASignalGroupSession").updateSessionWithNewSenderKeyState(g,e):c=d("WASignalGroupSession").makeNewSenderKeySession(e);return(h||(h=b("Promise"))).resolve(c)}function l(a,c){var e,f,g,i;return b("regeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:l.next=2;return b("regeneratorRuntime").awrap(d("WASignalOther").makeCryptoKey(c,"hmac-sha256"));case 2:e=l.sent;f=function(a){return d("WACryptoDependencies").getCrypto().subtle.sign({name:"HMAC",hash:"SHA-256"},e,a)};g=f(j).then(function(a){return d("WASignalOther").hkdf(new Uint8Array(a),null,"WhisperMessageKeys",80)}).then(function(b){return d("WASignalSessions").splitMsgKey(a,b)});i=f(k).then(function(a){return d("WASignalOther").toBytes(a,32)});return l.abrupt("return",(h||(h=b("Promise"))).all([i,g]));case 7:case"end":return l.stop()}},null,this)}function m(a,c){var e,f,g,i;return b("regeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:l.next=2;return b("regeneratorRuntime").awrap(d("WASignalOther").makeCryptoKey(c,"hmac-sha256"));case 2:e=l.sent;f=function(a){return d("WACryptoDependencies").getCrypto().subtle.sign({name:"HMAC",hash:"SHA-256"},e,a)};g=f(j).then(function(a){return d("WASignalOther").hkdf(new Uint8Array(a),null,"WhisperGroup",50)}).then(function(b){return d("WASignalGroupSession").makeSenderKeyMsgKey(a,b)});i=f(k).then(function(a){return d("WASignalOther").toBytes(a,32)});return l.abrupt("return",(h||(h=b("Promise"))).all([i,g]));case 7:case"end":return l.stop()}},null,this)}function n(a,c,e){var f,g,h,i,j,k;return b("regeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:f=c.privateKey;g=e;h=d("WASignalKeys").ecdh(f,g);l.next=5;return b("regeneratorRuntime").awrap(o(new Uint8Array(h),"WhisperRatchet",a));case 5:i=l.sent;j=i[0];k=i[1];return l.abrupt("return",{rootKey:j,chainKey:k});case 9:case"end":return l.stop()}},null,this)}function o(a,c,e){var f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:e===void 0&&(e=null);g.next=3;return b("regeneratorRuntime").awrap(d("WASignalOther").hkdf(a,e,c,64));case 3:f=g.sent;return g.abrupt("return",[d("WASignalOther").sliceBytes(f,0,32),d("WASignalOther").sliceBytes(f,32,32)]);case 5:case"end":return g.stop()}},null,this)}function p(a,b){return new Uint8Array(d("WASignalKeys").ecdh(a,b))}function q(a,b){return p(b,a)}g.initiateSessionOutgoing=a;g.initiateSessionIncoming=c;g.initiateSenderKeySessionOutgoing=e;g.initiateSenderKeySessionIncoming=f;g.deriveMsgKey=l;g.deriveSenderKeyMsgKey=m;g.calculateRatchet=n}),98);
__d("WASignalCipher",["Promise","WABaseGlobals","WABinary","WACryptoDependencies","WACryptoUtils","WALogger","WAResultOrError","WASignalKeys","WASignalOther","WASignalSessions","WASignalSignatures","WASignalWhisperTextProtocol.pb","WASignalWhitepaper","decodeProtobuf","encodeProtobuf","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["This would only fail if config is not initialised"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["decryptMsgFromSession error ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["deserializePkMsg error ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["deserializeMsg error ",""]);l=function(){return a};return a}var m=40,n=8,o=2e3;function a(a,c){var e,f,g,h,i,j,k,l,m,o,p,q,r,s,t,v,y,z,A,B,C;return b("regeneratorRuntime").async(function(D){while(1)switch(D.prev=D.next){case 0:e=a.sendChain;D.next=3;return b("regeneratorRuntime").awrap(d("WASignalWhitepaper").deriveMsgKey(e.nextMsgIndex,e.chainKey));case 3:f=D.sent;g=f[0];h=f[1];D.next=8;return b("regeneratorRuntime").awrap(x(h));case 8:i=D.sent;j=i.cipherKey;k=i.macKey;D.next=13;return b("regeneratorRuntime").awrap(d("WACryptoDependencies").getCrypto().subtle.encrypt({name:"AES-CBC",iv:h.iv},j,c));case 13:l=D.sent;m=new(d("WABinary").Binary)();m.writeByteArray(a.local.pubKey);m.writeByteArray(a.remote.pubKey);o=m.size();m.writeUint8(u(d("WASignalSessions").FORMAT_VERSION,d("WASignalSessions").FORMAT_VERSION));d("encodeProtobuf").encodeProtobuf(d("WASignalWhisperTextProtocol.pb").SignalMessageSpec,{ratchetKey:e.ratchetKey.serializedPubKey,counter:h.index,previousCounter:a.prevSendChainHighestIndex,ciphertext:l},m);p=m.readByteArray();D.next=23;return b("regeneratorRuntime").awrap(w(k,p));case 23:q=D.sent;r=p.subarray(o);s=d("WABinary").Binary.build(r,new Uint8Array(q,0,n)).readByteArray();y=a.initialExchangeInfo;y!=null?(A=new(d("WABinary").Binary)(),A.writeUint8(u(d("WASignalSessions").FORMAT_VERSION,d("WASignalSessions").FORMAT_VERSION)),d("encodeProtobuf").encodeProtobuf(d("WASignalWhisperTextProtocol.pb").PreKeySignalMessageSpec,{registrationId:a.local.regId,preKeyId:(z=y.remoteOneTimeId)!=null?z:void 0,signedPreKeyId:y.remoteSignedId,baseKey:y.localOneTimePubKey,identityKey:a.local.pubKey,message:s},A),t="pkmsg",v=A.readByteArray()):(t="msg",v=s);B=d("WASignalSessions").makeSendChain(e.ratchetKey,h.index+1,g);C=d("WASignalSessions").updateChains(a,a.recvChains,B);return D.abrupt("return",[C,{type:t,ciphertext:v}]);case 31:case"end":return D.stop()}},null,this)}function c(a,c){var e,f,g,h,i,j,k,l,m,n,o,p,q,s;return b("regeneratorRuntime").async(function(t){while(1)switch(t.prev=t.next){case 0:if(!(a==null)){t.next=2;break}return t.abrupt("return",d("WAResultOrError").makeError("errSignalNoSession"));case 2:t.next=4;return b("regeneratorRuntime").awrap(r(a,c));case 4:e=t.sent;if(!e.success){t.next=10;break}f=e.value,g=f[0],h=f[1];return t.abrupt("return",d("WAResultOrError").makeResult({newSessionInfo:null,updatedSession:g,plaintext:h}));case 10:i=a.prevSessions,j=e,k=0;case 13:if(!(!j.success&&k<i.length)){t.next=22;break}l=d("WASignalSessions").parseSession(i[k]);t.next=17;return b("regeneratorRuntime").awrap(r(l,c));case 17:m=t.sent,m.success&&((n=m.value,o=n[0],p=n[1]),q=d("WASignalSessions").setPrevSessions(o,[d("WASignalSessions").detachSession(a)].concat(i.slice(0,k),i.slice(k+1))),s=!a||!d("WACryptoUtils").serializedPubKeysEqual(q.remote.pubKey,a.remote.pubKey)?q.remote.pubKey:null,j=d("WAResultOrError").makeResult({newSessionInfo:{newIdentity:s,baseSession:l,usedPreKey:null},updatedSession:q,plaintext:p}));case 19:k++;t.next=13;break;case 22:return t.abrupt("return",j);case 23:case"end":return t.stop()}},null,this)}function e(a,b){if(y(a,b))return a;var c=a.prevSessions;for(var e=0;e<c.length;e++){var f=d("WASignalSessions").parseSession(c[e]);if(y(f,b))return d("WASignalSessions").setPrevSessions(f,[d("WASignalSessions").detachSession(a)].concat(c.slice(0,e),c.slice(e+1)))}return null}function f(a,c,e,f){var g,h,i,j,k,l,n,o,p,q,s,t;return b("regeneratorRuntime").async(function(u){while(1)switch(u.prev=u.next){case 0:h=f.localSignedPreKey;if(!(h==null)){u.next=3;break}return u.abrupt("return",d("WAResultOrError").makeError("errSignalInvalidSignedPreKey"));case 3:i=d("WASignalSignatures").deserializeSignedPreKey(h);if(!(i==null)){u.next=6;break}return u.abrupt("return",d("WAResultOrError").makeError("errSignalSignedPreKeyDeserialization"));case 6:if(!(i.id!==e.localSignedPreKeyId)){u.next=8;break}return u.abrupt("return",d("WAResultOrError").makeError("errSignalSignedPreKeyIdMismatch"));case 8:j=null;if(!(e.localOneTimeKeyId!=null)){u.next=18;break}k=f.localOneTimeKey;if(!(k==null)){u.next=13;break}return u.abrupt("return",d("WAResultOrError").makeError("errSignalInvalidOneTimeKey"));case 13:j=d("WASignalKeys").deserializePreKey(k);if(!(j==null)){u.next=16;break}return u.abrupt("return",d("WAResultOrError").makeError("errSignalOneTimeKeyDeserialization"));case 16:if(!(j.id!==e.localOneTimeKeyId)){u.next=18;break}return u.abrupt("return",d("WAResultOrError").makeError("errSignalOneTimeKeyMismatch"));case 18:u.next=20;return b("regeneratorRuntime").awrap(d("WASignalWhitepaper").initiateSessionIncoming(a,e.remote,e.sessionBaseKey,{signed:i.keyPair,oneTime:(g=j)==null?void 0:g.keyPair,ratchet:d("WASignalKeys").toSerializedKeyPair(i.keyPair)}));case 20:l=u.sent;n=l.remote.pubKey;o=!c||!d("WACryptoUtils").serializedPubKeysEqual(n,c.remote.pubKey)?n:null;c&&!o&&(l=d("WASignalSessions").setPrevSessions(l,[d("WASignalSessions").detachSession(c)].concat(c.prevSessions.slice(0,m-1))));u.next=26;return b("regeneratorRuntime").awrap(r(l,e));case 26:p=u.sent;if(p.success){u.next=29;break}return u.abrupt("return",p);case 29:q=p.value,s=q[0],t=q[1];return u.abrupt("return",d("WAResultOrError").makeResult({newIdentity:o,baseSession:l,updatedSession:s,plaintext:t}));case 31:case"end":return u.stop()}},null,this)}function p(a){var b,c,e=null;try{var f=t(a,d("WASignalSessions").FORMAT_VERSION,n);if(!f.success)return f;f=d("decodeProtobuf").decodeProtobuf(d("WASignalWhisperTextProtocol.pb").SignalMessageSpec,f.value);var g=f.ratchetKey;e=f.counter;c=f.ciphertext;if(g==null||e==null||c==null)return d("WAResultOrError").makeError("errSignalDeserializeInvalidProtoFormat");b=d("WASignalKeys").castToSerializedPubKey(new Uint8Array(g))}catch(a){d("WALogger").DEV(l(),a);return d("WAResultOrError").makeError("errSignalDeserializeRatchetKeyBadFormat")}f={ratchetPubKey:b,counter:e,ciphertext:new Uint8Array(c),versionContentMac:a};return d("WAResultOrError").makeResult(f)}function q(a){a=t(a,d("WASignalSessions").FORMAT_VERSION,0);if(!a.success)return a;var b,c,e,f,g;try{a=d("decodeProtobuf").decodeProtobuf(d("WASignalWhisperTextProtocol.pb").PreKeySignalMessageSpec,a.value);var h=a.registrationId,i=a.preKeyId,j=a.signedPreKeyId,l=a.baseKey,m=a.identityKey;a=a.message;if(h==null||j==null||l==null||m==null||a==null)return d("WAResultOrError").makeError("errSignalDeserializePkInvalidProtoFormat");f=d("WASignalKeys").castToSerializedPubKey(new Uint8Array(l));b={regId:d("WASignalOther").castRegistrationId(h),pubKey:d("WASignalKeys").castToSerializedPubKey(new Uint8Array(m))};e=i!=null?d("WASignalKeys").castToPreKeyId(i):null;c=d("WASignalKeys").castToSignedPreKeyId(j);g=new Uint8Array(a)}catch(a){d("WALogger").DEV(k(),a);return d("WAResultOrError").makeError("errSignalDeserializePkKeyBadFormat")}l=p(g);return!l.success?l:d("WAResultOrError").makeResult(babelHelpers["extends"]({},l.value,{remote:b,sessionBaseKey:f,localSignedPreKeyId:c,localOneTimeKeyId:e}))}function r(a,c){var e,f,g,h,i,k,l,m,o,p,q,r,t,u,v,y,z,A,B,C,D,E,F,G,H,I;return b("regeneratorRuntime").async(function(J){while(1)switch(J.prev=J.next){case 0:e=c.ratchetPubKey,f=c.counter,g=c.ciphertext,h=c.versionContentMac;i=a.recvChains;k=a.recvChains.findIndex(function(a){return d("WACryptoUtils").serializedPubKeysEqual(a.ratchetPubKey,e)});if(!(k===-1)){J.next=24;break}J.next=6;return b("regeneratorRuntime").awrap(d("WASignalWhitepaper").calculateRatchet(a.rootKey,a.sendChain.ratchetKey,e));case 6:o=J.sent;p=d("WASignalSessions").makeFreshRecvChain(e,o.chainKey);J.next=10;return b("regeneratorRuntime").awrap(s(p,f));case 10:q=J.sent;if(q.success){J.next=13;break}return J.abrupt("return",q);case 13:r=q.value;t=d("WASignalKeys").makeSerializedKeyPair();J.next=17;return b("regeneratorRuntime").awrap(d("WASignalWhitepaper").calculateRatchet(o.rootKey,t,e));case 17:u=J.sent;v=i.slice(-4);v.push(r.updatedChain);m=r.msgKey;l=d("WASignalSessions").ratchetSession(a,v,d("WASignalSessions").makeFreshSendChain(t,u.chainKey),u.rootKey);J.next=34;break;case 24:J.next=26;return b("regeneratorRuntime").awrap(s(i[k],f));case 26:y=J.sent;if(y.success){J.next=29;break}return J.abrupt("return",y);case 29:z=y.value,A=i.slice(),A[k]=z.updatedChain,m=z.msgKey,l=d("WASignalSessions").updateChains(a,A,a.sendChain);case 34:J.next=36;return b("regeneratorRuntime").awrap(x(m));case 36:B=J.sent;C=B.cipherKey;D=B.macKey;E=d("WABinary").Binary.build(a.remote.pubKey,a.local.pubKey,h.subarray(0,-n)).readByteArray();J.next=42;return b("regeneratorRuntime").awrap(w(D,E));case 42:F=J.sent;G=h.subarray(-n);H=!d("WACryptoUtils").uint8ArraysEqual(new Uint8Array(F,0,n),G);I=null;J.prev=46;J.next=49;return b("regeneratorRuntime").awrap(d("WACryptoDependencies").getCrypto().subtle.decrypt({name:"AES-CBC",iv:m.iv},C,g));case 49:I=J.sent;J.next=55;break;case 52:J.prev=52,J.t0=J["catch"](46),d("WALogger").DEV(j(),J.t0);case 55:if(!(H&&I==null)){J.next=59;break}if(!(k===-1)){J.next=58;break}return J.abrupt("return",d("WAResultOrError").makeError("errInvalidMacInvalidCipherKeyNewChain"));case 58:return J.abrupt("return",d("WAResultOrError").makeError("errInvalidMacInvalidCipherKey"));case 59:if(!H){J.next=61;break}return J.abrupt("return",d("WAResultOrError").makeError("errInvalidMacWithDecryptedPlaintext"));case 61:if(!(I==null)){J.next=63;break}return J.abrupt("return",d("WAResultOrError").makeError("errUnknownInvalidCipherKey"));case 63:return J.abrupt("return",d("WAResultOrError").makeResult([l,I]));case 64:case"end":return J.stop()}},null,this,[[46,52]])}function s(a,c){var e,f,g,h,j,k,l,m,n,p,q,r;return b("regeneratorRuntime").async(function(s){while(1)switch(s.prev=s.next){case 0:e=c-a.nextMsgIndex;f=2e3;try{f=d("WABaseGlobals").getConfig().getSignalFutureMessagesMax()}catch(a){d("WALogger").ERROR(i())}if(!(e>f)){s.next=5;break}return s.abrupt("return",d("WAResultOrError").makeError("errSignalTooManyMessagesInFuture"));case 5:g=a.unusedMsgKeys;if(!(e<0)){s.next=11;break}h=g.findIndex(function(a){return a.index===c});if(!(h===-1)){s.next=10;break}return s.abrupt("return",d("WAResultOrError").makeError("errDuplicateMsg"));case 10:return s.abrupt("return",d("WAResultOrError").makeResult({msgKey:g[h],updatedChain:d("WASignalSessions").makeRecvChain(a.ratchetPubKey,a.nextMsgIndex,a.chainKey,v(g,h))}));case 11:j=a.nextMsgIndex;s.next=14;return b("regeneratorRuntime").awrap(d("WASignalWhitepaper").deriveMsgKey(j,a.chainKey));case 14:k=s.sent;l=k[0];m=k[1];n=null;if(!(e>0)){s.next=32;break}p=e+g.length-o;p>0?(n=g.slice(p),p-=g.length):n=g.slice();q=j+1;case 22:if(!(q<=c)){s.next=32;break}p>0?p--:n.push(m);s.next=26;return b("regeneratorRuntime").awrap(d("WASignalWhitepaper").deriveMsgKey(q,l));case 26:r=s.sent,l=r[0],m=r[1];case 29:q++;s.next=22;break;case 32:return s.abrupt("return",d("WAResultOrError").makeResult({msgKey:m,updatedChain:d("WASignalSessions").makeRecvChain(a.ratchetPubKey,c+1,l,n||g)}));case 33:case"end":return s.stop()}},null,this)}function t(a,b,c){if(a.length<1)return d("WAResultOrError").makeError("errSignalEmptyVersionContentSuffix");var e=a[0]>>>4;if(e!==b)return e<b?d("WAResultOrError").makeError("errSignalLegacyMsg"):d("WAResultOrError").makeError("errSignalInvalidVersion");e=a.length-c;return e<1?d("WAResultOrError").makeError("errSignalContentExceededExpectedLength"):d("WAResultOrError").makeResult(a.subarray(1,e))}function u(a,b){return(a<<4|b)&255}function v(a,b){var c=[];for(var d=0;d<a.length;d++)d!==b&&c.push(a[d]);return c}function w(a,b){return d("WACryptoDependencies").getCrypto().subtle.sign(d("WASignalOther").HMAC_SHA256,a,b)}function x(a){return(h||(h=b("Promise"))).all([d("WASignalOther").makeCryptoKey(a.cipherKey,"aes-cbc"),d("WASignalOther").makeCryptoKey(a.macKey,"hmac-sha256")]).then(function(a){var b=a[0];a=a[1];return{cipherKey:b,macKey:a}})}function y(a,b){a=a.aliceBaseKey;return!a?!1:d("WACryptoUtils").serializedPubKeysEqual(a,b)}g.MAX_UNUSED_KEYS=o;g.encryptMsg=a;g.decryptMsg=c;g.findMatchingSession=e;g.decryptPkMsgWithNewSession=f;g.deserializeMsg=p;g.deserializePkMsg=q;g.decryptMsgFromSession=r;g.readContent=t;g.versionByte=u}),98);
__d("WASignalGroupCipher",["WABaseGlobals","WABinary","WACryptoDependencies","WALogger","WAResultOrError","WASignalCipher","WASignalGroupSession","WASignalKeys","WASignalOther","WASignalSessions","WASignalSignatures","WASignalWhisperTextProtocol.pb","WASignalWhitepaper","decodeProtobuf","encodeProtobuf","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["This would only fail if config is not initialised"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Exception caught during SenderKeyMessageSpec Proto: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["deserializeSenderKeyDistributionMsg error ",""]);j=function(){return a};return a}var k=64;function a(a,c){var e,f,g,h,i,j,k;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:e=l(a);if(e.success){m.next=3;break}return m.abrupt("return",e);case 3:f=e.value,g=f.senderKeyId,h=f.iteration,i=f.signingKeyPublic,j=f.chainKey;m.next=6;return b("regeneratorRuntime").awrap(d("WASignalWhitepaper").initiateSenderKeySessionIncoming(g,h,i,j,c));case 6:k=m.sent;return m.abrupt("return",d("WAResultOrError").makeResult(k));case 8:case"end":return m.stop()}},null,this)}function c(a){a=d("WASignalGroupSession").serializeSenderKeyState(a);var b=new(d("WABinary").Binary)();b.writeUint8(d("WASignalCipher").versionByte(d("WASignalGroupSession").FORMAT_VERSION,d("WASignalGroupSession").FORMAT_VERSION));d("encodeProtobuf").encodeProtobuf(d("WASignalWhisperTextProtocol.pb").SenderKeyDistributionMessageSpec,{id:a.senderKeyId,iteration:d("WASignalSessions").definedOrThrow(a.senderChainKey,"senderChainKey").iteration,chainKey:d("WASignalSessions").definedOrThrow(a.senderChainKey,"senderChainKey").seed,signingKey:d("WASignalSessions").definedOrThrow(a.senderSigningKey,"senderSigningKey")["public"]},b);return b.readByteArray()}function e(a,c){var e,f,g,h,i,j,k,l,m,o,p,q,r,s,t;return b("regeneratorRuntime").async(function(u){while(1)switch(u.prev=u.next){case 0:if(!(!a.senderKeyStates||a.senderKeyStates.length===0)){u.next=2;break}return u.abrupt("return",d("WAResultOrError").makeError("errSignalNoSession"));case 2:e=a.senderKeyStates[a.senderKeyStates.length-1];u.next=5;return b("regeneratorRuntime").awrap(d("WASignalWhitepaper").deriveSenderKeyMsgKey(e.senderKeyChainKey.nextMsgIndex,e.senderKeyChainKey.chainKey));case 5:f=u.sent;g=f[0];h=f[1];u.next=10;return b("regeneratorRuntime").awrap(n(h.seed));case 10:i=u.sent;j=i[0];k=i[1];u.next=15;return b("regeneratorRuntime").awrap(d("WACryptoDependencies").getCrypto().subtle.encrypt({name:"AES-CBC",iv:k},j,c));case 15:l=u.sent;m=new(d("WABinary").Binary)();d("encodeProtobuf").encodeProtobuf(d("WASignalWhisperTextProtocol.pb").SenderKeyMessageSpec,{id:e.senderKeyId,iteration:h.iteration,ciphertext:l},m);o=new(d("WABinary").Binary)();o.writeUint8(d("WASignalCipher").versionByte(d("WASignalGroupSession").FORMAT_VERSION,d("WASignalGroupSession").FORMAT_VERSION));o.writeBinary(m);p=d("WASignalKeys").makeKeyPairFromSerialized(d("WASignalSessions").definedOrThrow(e.senderSigningKeyPrivate,"senderSigningKeyPrivate"),e.senderSigningKeyPublic);q=d("WASignalSignatures").signSenderKeyMessage(p,o.readByteArray());r=new(d("WABinary").Binary)();r.writeUint8(d("WASignalCipher").versionByte(d("WASignalGroupSession").FORMAT_VERSION,d("WASignalGroupSession").FORMAT_VERSION));r.writeBinary(m);r.writeByteArray(q);s=d("WASignalGroupSession").makeSenderKeyChainKey(h.iteration+1,g);t=d("WASignalGroupSession").updateSessionWithUpdatedSenderKeyState(a,d("WASignalGroupSession").makeSenderKeyState(e.senderSigningKeyPublic,e.senderSigningKeyPrivate,s,e.senderKeyId,e.unusedMsgKeys));return u.abrupt("return",d("WAResultOrError").makeResult([t,r.readByteArray()]));case 30:case"end":return u.stop()}},null,this)}function f(a,c){var e,f,g,h,i,j,k,l,m,q,r,s,t,u,v;return b("regeneratorRuntime").async(function(w){while(1)switch(w.prev=w.next){case 0:e=c.senderKeyMessageId,f=c.iteration,g=c.ciphertext,h=c.versionContentMac;i=d("WASignalGroupSession").findSenderKeyState(a,e);if(!(i==null)){w.next=4;break}return w.abrupt("return",d("WAResultOrError").makeError("errSignalNoSession"));case 4:j=i.senderSigningKeyPublic;k=o(h,j);if(k){w.next=8;break}return w.abrupt("return",d("WAResultOrError").makeError("errSignalInvalidKey"));case 8:w.next=10;return b("regeneratorRuntime").awrap(p(i,f));case 10:l=w.sent;if(l.success){w.next=13;break}return w.abrupt("return",l);case 13:m=l.value;q=m.msgKey;r=d("WASignalGroupSession").updateSessionWithUpdatedSenderKeyState(a,m.updatedSenderKeyState);w.next=18;return b("regeneratorRuntime").awrap(n(q.seed));case 18:s=w.sent;t=s[0];u=s[1];w.next=23;return b("regeneratorRuntime").awrap(d("WACryptoDependencies").getCrypto().subtle.decrypt({name:"AES-CBC",iv:u},t,g));case 23:v=w.sent;return w.abrupt("return",d("WAResultOrError").makeResult([r,v]));case 25:case"end":return w.stop()}},null,this)}function l(a){var b,c,e,f;try{a=d("WASignalCipher").readContent(a,d("WASignalGroupSession").FORMAT_VERSION,0);if(!a.success)return a;a=d("decodeProtobuf").decodeProtobuf(d("WASignalWhisperTextProtocol.pb").SenderKeyDistributionMessageSpec,a.value);b=a.id;c=a.iteration;var g=d("WASignalSessions").bytesOrThrow(a.signingKey,33,"signingKey");e=d("WASignalKeys").castToSerializedPubKey(g);f=d("WASignalSessions").bytesOrThrow(a.chainKey,32,"chainKey");if(b==null||c==null)return d("WAResultOrError").makeError("errSignalGrpInvalidProtoFormat")}catch(a){d("WALogger").DEV(j(),a);return d("WAResultOrError").makeError("errSignalGrpInvalidKeyFormat")}return d("WAResultOrError").makeResult({senderKeyId:b,iteration:c,signingKeyPublic:e,chainKey:f})}function m(a){if(a.length<1)return d("WAResultOrError").makeError("errSignalGrpVersionContentEmpty");var b=a[0]>>>4;if(b!==d("WASignalGroupSession").FORMAT_VERSION)return b<d("WASignalGroupSession").FORMAT_VERSION?d("WAResultOrError").makeError("errSignalLegacyMsg"):d("WAResultOrError").makeError("errSignalInvalidVersion");if(a.length<1+k)return d("WAResultOrError").makeError("errSignalGrpInvalidVersionContentLength");var c,e,f;try{b=a.subarray(1,-k);b=d("decodeProtobuf").decodeProtobuf(d("WASignalWhisperTextProtocol.pb").SenderKeyMessageSpec,b);c=b.id;e=b.iteration;f=b.ciphertext;if(c==null||e==null||f==null)return d("WAResultOrError").makeError("errSignalGrpSenderKeyInvalidProtoFormat")}catch(a){d("WALogger").ERROR(i(),a);return d("WAResultOrError").makeError("errSignalGrpSenderKeyProtoError")}return d("WAResultOrError").makeResult({senderKeyMessageId:c,iteration:e,ciphertext:new Uint8Array(f),versionContentMac:a})}function n(a){var c,e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:c=new(d("WABinary").Binary)(a);e=d("WASignalOther").readBytes(c,16);f=d("WASignalOther").readBytes(c,32);g.next=5;return b("regeneratorRuntime").awrap(d("WASignalOther").makeCryptoKey(f,"aes-cbc"));case 5:g.t0=g.sent;g.t1=e;return g.abrupt("return",[g.t0,g.t1]);case 8:case"end":return g.stop()}},null,this)}function o(a,b){var c=a.subarray(a.length-k);a=a.subarray(0,a.length-k);return d("WASignalSignatures").verifyMsgSignalVariant(b,a,d("WASignalOther").toBytes(d("WASignalOther").toBuffer(c),64))}function p(a,c){var e,f,g,i,j,k,l,m,n,o,p,r,s;return b("regeneratorRuntime").async(function(t){while(1)switch(t.prev=t.next){case 0:e=a;f=c-e.senderKeyChainKey.nextMsgIndex;g=2e3;try{g=d("WABaseGlobals").getConfig().getSignalFutureMessagesMax()}catch(a){d("WALogger").ERROR(h())}if(!(f>g)){t.next=6;break}return t.abrupt("return",d("WAResultOrError").makeError("errSignalGrpTooManyMessagesInFuture"));case 6:i=a.unusedMsgKeys||[];if(!(f<0)){t.next=12;break}j=i.findIndex(function(a){return a.iteration===c});if(!(j===-1)){t.next=11;break}return t.abrupt("return",d("WAResultOrError").makeError("errDuplicateMsg"));case 11:return t.abrupt("return",d("WAResultOrError").makeResult({msgKey:i[j],updatedSenderKeyState:d("WASignalGroupSession").makeSenderKeyState(e.senderSigningKeyPublic,e.senderSigningKeyPrivate,e.senderKeyChainKey,e.senderKeyId,q(i,j))}));case 12:k=e.senderKeyChainKey.nextMsgIndex;t.next=15;return b("regeneratorRuntime").awrap(d("WASignalWhitepaper").deriveSenderKeyMsgKey(k,e.senderKeyChainKey.chainKey));case 15:l=t.sent;m=l[0];n=l[1];o=null;if(!(f>0)){t.next=33;break}p=f+i.length-d("WASignalCipher").MAX_UNUSED_KEYS;p>0?(o=i.slice(p),p-=i.length):o=i.slice();r=k+1;case 23:if(!(r<=c)){t.next=33;break}p>0?p--:o.push(n);t.next=27;return b("regeneratorRuntime").awrap(d("WASignalWhitepaper").deriveSenderKeyMsgKey(r,m));case 27:s=t.sent,m=s[0],n=s[1];case 30:r++;t.next=23;break;case 33:return t.abrupt("return",d("WAResultOrError").makeResult({msgKey:n,updatedSenderKeyState:d("WASignalGroupSession").makeSenderKeyState(e.senderSigningKeyPublic,e.senderSigningKeyPrivate,d("WASignalGroupSession").makeSenderKeyChainKey(c+1,m),a.senderKeyId,o||i)}));case 34:case"end":return t.stop()}},null,this)}function q(a,b){var c=[];for(var d=0;d<a.length;d++)d!==b&&c.push(a[d]);return c}g.processSenderKeyDistributionMsg=a;g.createSenderKeyDistributionProto=c;g.encryptSenderKeyMsgWithSession=e;g.decryptSenderKeyMsgFromSession=f;g.deserializeSenderKeyMsg=m}),98);
__d("WACryptoLibrary",["WACryptoUtils","WAJids","WALockMap","WALogger","WAResultOrError","WASignalCipher","WASignalGroupCipher","WASignalGroupSession","WASignalKeys","WASignalOther","WASignalSignatures","WASignalWhitepaper","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["getSessionForRecipient pkmsg signature verification result: ",""]);h=function(){return a};return a}var i=d("WALockMap").makeLockMap(60*1e3),j=[],k=300;function l(a){j.push(a),j.length>=k&&j.shift()}function a(a){a(j),j=[]}function m(a,c){var e,f,g,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:l("createOutgoingSession");e=t(c);f=e.signedKey;j.next=5;return b("regeneratorRuntime").awrap(d("WASignalSignatures").verifyMsgSignalVariant(e.identity,f.publicKey,f.signature));case 5:g=j.sent;d("WALogger").DEV(h(),g);if(g){j.next=10;break}l("createOutgoingSession: errSignalInvalidKey");return j.abrupt("return",d("WAResultOrError").makeError("errSignalInvalidKey"));case 10:j.next=12;return b("regeneratorRuntime").awrap(d("WASignalWhitepaper").initiateSessionOutgoing(a,e,d("WASignalKeys").makeKeyPair()));case 12:i=j.sent;return j.abrupt("return",d("WAResultOrError").makeResult(i));case 14:case"end":return j.stop()}},null,this)}function c(a,c,d,e,f){var g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:g=a.handleNewSession;l("establishOutgoingSession");j.next=4;return b("regeneratorRuntime").awrap(m(c,e));case 4:h=j.sent;if(h.success){j.next=7;break}return j.abrupt("return",h);case 7:i=h.value;return j.abrupt("return",g(d,i,i.remote.pubKey,null,f));case 9:case"end":return j.stop()}},null,this)}function e(a,c,e,f){var g=a.loadSession,h=a.handleNewSession;l("encryptContent");return i.lock([d("WAJids").extractUserJid(c)],function(){var a,i,j,k,m,n;return b("regeneratorRuntime").async(function(o){while(1)switch(o.prev=o.next){case 0:a=null;case 1:o.next=3;return b("regeneratorRuntime").awrap(g(c,"cryptoLibraryEncryptContent"));case 3:i=o.sent;if(!(i==null)){o.next=7;break}l("encryptContent: errSignalInvalidKey");return o.abrupt("return",d("WAResultOrError").makeError("errSignalInvalidKey"));case 7:if(!(f!=null&&!d("WACryptoUtils").uint8ArraysEqual(f,i.remote.pubKey))){o.next=10;break}l("encryptContent: identity-mismatch");return o.abrupt("return",d("WAResultOrError").makeError("identity-mismatch"));case 10:o.next=12;return b("regeneratorRuntime").awrap(d("WASignalCipher").encryptMsg(i,e));case 12:j=o.sent;k=j[0];m=j[1];o.next=17;return b("regeneratorRuntime").awrap(h(c,k,k.remote.pubKey));case 17:n=o.sent,n.success?a=d("WAResultOrError").makeResult(babelHelpers["extends"]({},m,{baseKey:k.aliceBaseKey})):n.error;case 19:if(a==null){o.next=1;break}case 20:return o.abrupt("return",a);case 21:case"end":return o.stop()}},null,this)})}function f(a,c,e,f,g){var h=a.loadSession,j=a.handleNewSession,k=a.loadSignedPreKey,m=a.loadOneTimePreKey;l("decryptContent");return i.lock([d("WAJids").extractUserJid(e)],function(){var a,i,o,p,q,r,s,t,u,v,w,x;return b("regeneratorRuntime").async(function(y){while(1)switch(y.prev=y.next){case 0:a=!1;y.next=3;return b("regeneratorRuntime").awrap(h(e,"decryptContent"));case 3:i=y.sent;if(!(f.type==="pkmsg")){y.next=18;break}p=d("WASignalCipher").deserializePkMsg(f.ciphertext);if(p.success){y.next=9;break}l("decryptContent: errCryptoDeserialization");return y.abrupt("return",d("WAResultOrError").makeError("errCryptoDeserialization"));case 9:q=p.value;y.next=12;return b("regeneratorRuntime").awrap(n({loadSignedPreKey:k,loadOneTimePreKey:m},c,q,i));case 12:r=y.sent;if(r.success){y.next=15;break}return y.abrupt("return",r);case 15:o=r.value;y.next=30;break;case 18:f.type;s=d("WASignalCipher").deserializeMsg(f.ciphertext);if(s.success){y.next=23;break}l("decryptContent: errCryptoDeserialization");return y.abrupt("return",d("WAResultOrError").makeError("errCryptoDeserialization"));case 23:t=s.value;y.next=26;return b("regeneratorRuntime").awrap(d("WASignalCipher").decryptMsg(i,t));case 26:u=y.sent;if(u.success){y.next=29;break}return y.abrupt("return",u);case 29:o=u.value;case 30:v=o,w=v.newSessionInfo;if(!(w&&(w.newIdentity!=null||w.usedPreKey!=null))){y.next=34;break}y.next=34;return b("regeneratorRuntime").awrap(j(e,w.baseSession,w.newIdentity,w.usedPreKey));case 34:if(a){y.next=39;break}x=w==null?void 0:w.baseSession.remote.pubKey;y.next=38;return b("regeneratorRuntime").awrap(g(new Uint8Array(o.plaintext),x));case 38:a=!0;case 39:y.next=41;return b("regeneratorRuntime").awrap(j(e,o.updatedSession,o.updatedSession.remote.pubKey));case 41:return y.abrupt("return",d("WAResultOrError").makeResult());case 42:case"end":return y.stop()}},null,this)})}function n(a,c,e,f){var g,h,i,j,k,m,n,o,p,q,r,s,t,u,v,w;return b("regeneratorRuntime").async(function(x){while(1)switch(x.prev=x.next){case 0:g=a.loadSignedPreKey,h=a.loadOneTimePreKey;l("decryptPkMsg");i=f&&d("WASignalCipher").findMatchingSession(f,e.sessionBaseKey);if(!i){x.next=13;break}x.next=6;return b("regeneratorRuntime").awrap(d("WASignalCipher").decryptMsgFromSession(i,e));case 6:j=x.sent;if(j.success){x.next=9;break}return x.abrupt("return",j);case 9:k=j.value,m=k[0],n=k[1];return x.abrupt("return",d("WAResultOrError").makeResult({newSessionInfo:null,updatedSession:m,plaintext:n}));case 13:o=e.localOneTimeKeyId;x.next=16;return b("regeneratorRuntime").awrap(g(e.localSignedPreKeyId));case 16:p=x.sent;if(!(o==null)){x.next=21;break}x.t0=null;x.next=24;break;case 21:x.next=23;return b("regeneratorRuntime").awrap(h(o));case 23:x.t0=x.sent;case 24:q=x.t0;x.next=27;return b("regeneratorRuntime").awrap(d("WASignalCipher").decryptPkMsgWithNewSession(c,f,e,{localSignedPreKey:p,localOneTimeKey:q}));case 27:r=x.sent;if(r.success){x.next=30;break}return x.abrupt("return",r);case 30:s=r.value,t=s.newIdentity,u=s.baseSession,v=s.updatedSession,w=s.plaintext;return x.abrupt("return",d("WAResultOrError").makeResult({newSessionInfo:{newIdentity:t,baseSession:u,usedPreKey:o},updatedSession:v,plaintext:w}));case 32:case"end":return x.stop()}},null,this)}function o(c,e,f,g){var h=c.loadSenderKeySession,a=c.saveSenderKeySession;l("encryptGroupContent");return i.lock([e,d("WAJids").extractUserJid(f)],function(){var c,i,j,k,m,n,o,p;return b("regeneratorRuntime").async(function(q){while(1)switch(q.prev=q.next){case 0:c=null;case 1:q.next=3;return b("regeneratorRuntime").awrap(h(e,f));case 3:i=q.sent;if(i.success){q.next=6;break}return q.abrupt("return",d("WAResultOrError").makeError(i.error));case 6:j=i.value;q.next=9;return b("regeneratorRuntime").awrap(d("WASignalGroupCipher").encryptSenderKeyMsgWithSession(j,g));case 9:k=q.sent;if(!k.success){q.next=18;break}m=k.value,n=m[0],o=m[1];q.next=14;return b("regeneratorRuntime").awrap(a(e,f,n));case 14:p=j.senderKeyStates[j.senderKeyStates.length-1];c=d("WAResultOrError").makeResult({ciphertext:{ciphertext:o,type:"skmsg"},senderKeyId:p.senderKeyId,senderKeyDistributionProto:d("WASignalGroupCipher").createSenderKeyDistributionProto(d("WASignalGroupSession").convertFromRawToSenderKeyState(p))});q.next=20;break;case 18:l("encryptGroupContent: sender-key-no-session");return q.abrupt("return",d("WAResultOrError").makeError("sender-key-no-session"));case 20:if(c==null){q.next=1;break}case 21:return q.abrupt("return",c);case 22:case"end":return q.stop()}},null,this)})}function p(c,e,f,g,h){var j=c.loadSenderKeySession,a=c.saveSenderKeySession;l("decryptGroupContent");return i.lock([e,d("WAJids").extractUserJid(f)],function(){var c,i,k,m,n,o,p,q;return b("regeneratorRuntime").async(function(r){while(1)switch(r.prev=r.next){case 0:c=!1;r.next=3;return b("regeneratorRuntime").awrap(j(e,f));case 3:i=r.sent;if(i.success){r.next=6;break}return r.abrupt("return",d("WAResultOrError").makeError(i.error));case 6:k=d("WASignalGroupCipher").deserializeSenderKeyMsg(g);if(k.success){r.next=10;break}l("decryptGroupContent: errCryptoDeserialization");return r.abrupt("return",d("WAResultOrError").makeError("errCryptoDeserialization"));case 10:m=i.value;r.next=13;return b("regeneratorRuntime").awrap(d("WASignalGroupCipher").decryptSenderKeyMsgFromSession(m,k.value));case 13:n=r.sent;if(n.success){r.next=16;break}return r.abrupt("return",n);case 16:o=n.value,p=o[0],q=o[1];if(c){r.next=21;break}r.next=20;return b("regeneratorRuntime").awrap(h(new Uint8Array(q)));case 20:c=!0;case 21:r.next=23;return b("regeneratorRuntime").awrap(a(e,f,p));case 23:return r.abrupt("return",d("WAResultOrError").makeResult());case 24:case"end":return r.stop()}},null,this)})}function q(c,e,f,g){var h=c.loadSenderKeySession,a=c.saveSenderKeySession;l("saveSenderKeySession");return i.lock([e,d("WAJids").extractUserJid(f)],function(){var c,i,j,k;return b("regeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:c=null;if(!h){l.next=6;break}l.next=4;return b("regeneratorRuntime").awrap(h(e,f));case 4:i=l.sent,c=i.success?i.value:null;case 6:l.next=8;return b("regeneratorRuntime").awrap(d("WASignalGroupCipher").processSenderKeyDistributionMsg(g,c));case 8:j=l.sent;if(j.success){l.next=11;break}return l.abrupt("return",j);case 11:k=j.value;l.next=14;return b("regeneratorRuntime").awrap(a(e,f,k));case 14:return l.abrupt("return",d("WAResultOrError").makeResult());case 15:case"end":return l.stop()}},null,this)})}function r(c,e,f,g){var a=c.saveSenderKeySession;l("rotateGroupSenderKey");return i.lock([e,d("WAJids").extractUserJid(f)],function(){var c,h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:i.next=2;return b("regeneratorRuntime").awrap(d("WASignalWhitepaper").initiateSenderKeySessionOutgoing(g));case 2:c=i.sent;h=c.senderKeyStates[0].senderKeyId;i.next=6;return b("regeneratorRuntime").awrap(a(e,f,c));case 6:return i.abrupt("return",{senderKeyId:h});case 7:case"end":return i.stop()}},null,this)})}function s(c,e,f){var g,a,h,i,j,k;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:g=c.loadSenderKeySession,a=c.saveSenderKeySession;l("createSenderKeyDistributionMsg");m.next=4;return b("regeneratorRuntime").awrap(g(e,f));case 4:h=m.sent;i=h.error;if(!(!h.success&&i==="errLoadSenderKeySession")){m.next=15;break}m.next=9;return b("regeneratorRuntime").awrap(d("WASignalKeys").makeKeyPair());case 9:j=m.sent;m.next=12;return b("regeneratorRuntime").awrap(r({saveSenderKeySession:a},e,f,j));case 12:m.next=14;return b("regeneratorRuntime").awrap(g(e,f));case 14:h=m.sent;case 15:if(!h.success){m.next=19;break}k=h.value.senderKeyStates.slice(-1);if(!(k.length>0)){m.next=19;break}return m.abrupt("return",d("WAResultOrError").makeResult(d("WASignalGroupCipher").createSenderKeyDistributionProto(d("WASignalGroupSession").convertFromRawToSenderKeyState(k[0]))));case 19:l("createSenderKeyDistributionMsg: errGetSenderKeyProto");return m.abrupt("return",d("WAResultOrError").makeError("errGetSenderKeyProto"));case 21:case"end":return m.stop()}},null,this)}function t(a){var b=a.regId,c=a.identity,e=a.signedKey;a=a.oneTimeKey;l("sanitizeInitialSessionInfo");var f=d("WASignalKeys").castToSerializedPubKey(e.publicKey);return{regId:d("WASignalOther").castRegistrationId(b),identity:d("WASignalKeys").castToSerializedPubKey(c),signedKey:{id:d("WASignalKeys").castToSignedPreKeyId(e.id),publicKey:f,signature:d("WASignalOther").ensureSize(e.signature,64)},oneTimeKey:a&&{id:d("WASignalKeys").castToPreKeyId(a.id),publicKey:d("WASignalKeys").castToSerializedPubKey(a.publicKey)},ratchetKey:f}}g.publishLogs=a;g.createOutgoingSession=m;g.establishOutgoingSession=c;g.encryptContent=e;g.decryptContent=f;g.encryptGroupContent=o;g.decryptGroupContent=p;g.saveSenderKeySession=q;g.rotateGroupSenderKey=r;g.createSenderKeyDistributionMsg=s}),98);
__d("WACryptoManager",["MAWLoggerUtils","Promise","WABaseGlobals","WACryptoLibrary","WACryptoUtils","WAErr","WAJids","WALogger","WANullthrows","WAPromiseQueue","WAResultOrError","WASignalCipher","WASignalGroupSession","WASignalKeys","WASignalLocalStorageProtocol.pb","WASignalOther","WASignalSessions","WASignalSignatures","WATagsLogger","WATimeUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to generate signed prekey with id: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to deserialize signed prekey: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to generate signed prekey ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[SendMessage] end encryption"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[SendMessage] start encryption"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[SendMessage] sendWrittenMsg bulkEncryptContent"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[sessions] Failed to create a session"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["[sessions] Received keys ",""]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["[sessions] fail during key requesting"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["[sessions] Missing sessions: ",". Requesting keys"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["[sessions] No need to establish outgoing sessions"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["[sessions] Establish outgoing sessions"]);t=function(){return a};return a}var u=d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.CryptoManager]),v={type:"default"};function a(a){return{flush:function(){return a.storage.savePendingToDatabase().then(function(){})}}}function e(a){return{regInfo:a.regInfo,network:a.network,storage:a.storage}}function w(a,c,e,f,g){var h,i,j,k,l;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:m.next=2;return b("regeneratorRuntime").awrap(f(c,g));case 2:h=m.sent;if(!(h!=null&&e.type!=="requestNewSession")){m.next=13;break}i=h;if(!(e.type==="default")){m.next=9;break}return m.abrupt("return",d("WAResultOrError").makeResult(i));case 9:if(!(i.aliceBaseKey!=null&&e.session.baseKey!=null)){m.next=13;break}e.type;if(d("WACryptoUtils").uint8ArraysEqual(e.session.baseKey,i.aliceBaseKey)){m.next=13;break}return m.abrupt("return",d("WAResultOrError").makeResult(i));case 13:if(!(e.type==="useSession")){m.next=17;break}j=e.session.keys;m.next=25;break;case 17:e.type;m.next=20;return b("regeneratorRuntime").awrap(a.network.requestKeys(c));case 20:k=m.sent;if(k.success){m.next=23;break}return m.abrupt("return",k);case 23:j=k.value.keys,e.type==="compareTSAndUseSession"&&e.session.timestamp>=k.value.timestamp&&(j=e.session.keys);case 25:m.next=27;return b("regeneratorRuntime").awrap(d("WACryptoLibrary").createOutgoingSession(a.regInfo,j));case 27:l=m.sent;if(l.success){m.next=30;break}return m.abrupt("return",l);case 30:return m.abrupt("return",d("WAResultOrError").makeResult(l.value));case 31:case"end":return m.stop()}},null,this)}function f(a,b,c,e){return a.storage.runInTransaction(function(f){f=f.handleNewSession;return d("WACryptoLibrary").establishOutgoingSession({handleNewSession:f},a.regInfo,b,c,e)})}function x(a,c){var e,f,g,h,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:d("WALogger").DEV(t());k.next=3;return b("regeneratorRuntime").awrap(a.storage.runInTransaction(function(a){a=a.loadSessions;return a(c).then(function(a){return d("WAResultOrError").makeResult(a)})}));case 3:e=k.sent;f=e.success===!0?e.value:new Map();g=c.filter(function(a){return!f.has(a)});if(!(g.length===0)){k.next=9;break}d("WALogger").DEV(s());return k.abrupt("return",f);case 9:d("WALogger").DEV(r(),g.length);k.next=12;return b("regeneratorRuntime").awrap(a.network.bulkRequestKeys(g));case 12:h=k.sent;if(h.success){k.next=16;break}d("WALogger").ERROR(q());return k.abrupt("return",f);case 16:i=h.value;d("WALogger").DEV(p(),i.size);j=new(d("WAPromiseQueue").PromiseQueue)();i.forEach(function(b,c){j.enqueue(function(){return d("WACryptoLibrary").createOutgoingSession(a.regInfo,b.keys).then(function(a){a.success===!1?d("WALogger").ERROR(o()):f.set(c,a.value)})})});k.next=22;return b("regeneratorRuntime").awrap(j.wait());case 22:return k.abrupt("return",f);case 23:case"end":return k.stop()}},null,this)}function y(a,e){var f,g,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:f=Array.from(e.keys());d("WALogger").LOG(n());k.next=4;return b("regeneratorRuntime").awrap(x(a,f));case 4:g=k.sent;i=new Map();d("WALogger").DEV(m());k.next=9;return b("regeneratorRuntime").awrap(a.storage.runInTransaction(function(a){var f=a.handleNewSession;return(h||(h=b("Promise"))).all(Array.from(g.entries()).map(function(a){var g,h,j,k,l,m;return b("regeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:h=a[0],j=a[1];n.next=3;return b("regeneratorRuntime").awrap(d("WASignalCipher").encryptMsg(j,c("WANullthrows")((g=e.get(h))==null?void 0:g.plaintext)));case 3:k=n.sent;l=k[0];m=k[1];i.set(h,babelHelpers["extends"]({},m,{baseKey:null}));return n.abrupt("return",f(h,l,l.remote.pubKey));case 8:case"end":return n.stop()}},null,this)})).then(function(){return d("WAResultOrError").makeResult()})}));case 9:j=k.sent;if(!(j.success===!0)){k.next=15;break}d("WALogger").DEV(l());return k.abrupt("return",d("WAResultOrError").makeResult(i));case 15:return k.abrupt("return",j);case 16:case"end":return k.stop()}},null,this)}function z(a,b,c,e,f){return a.storage.runInTransaction(function(g){var h=g.handleNewSession,i=g.loadSession;return d("WACryptoLibrary").encryptContent({loadSession:function(b){return w(a,b,e,i,"cryptoManagerEncryptContent").then(function(a){if(a.success===!0)return a.value;else return null})},handleNewSession:h},b,c,f)})}function A(a,b,c,e){return a.storage.runInTransaction(function(f){var g=f.loadSession,h=f.handleNewSession,i=f.loadSignedPreKey;f=f.loadOneTimePreKey;return d("WACryptoLibrary").decryptContent({loadSession:g,handleNewSession:h,loadSignedPreKey:i,loadOneTimePreKey:f},a.regInfo,b,c,e)})}function B(a,c){var e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:g.next=2;return b("regeneratorRuntime").awrap(a.storage.runInTransaction(function(a){a=a.loadSession;return a(c,"getParticipantInfo").then(function(a){return d("WAResultOrError").makeResult(a)})}));case 2:e=g.sent;if(!(e.success===!0)){g.next=5;break}return g.abrupt("return",(f=e.value)==null?void 0:f.remote);case 5:case"end":return g.stop()}},null,this)}function C(a){var e,f,g,h,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:k.next=2;return b("regeneratorRuntime").awrap(a.storage.getLastPreKeyGenerationId());case 2:g=k.sent;h=((e=g==null?void 0:g.lastPreKeyId)!=null?e:0)+1;i=d("WASignalKeys").makePreKeys(h,1)[0];k.next=7;return b("regeneratorRuntime").awrap(a.storage.saveOneTimePreKey({keyId:i.plainObject.id,encoded:i.record}));case 7:j=k.sent;if(!j.success){k.next=10;break}return k.abrupt("return",i.plainObject);case 10:throw c("WAErr")("Cannot save one time prekey: "+j.error+", LastPreKeyId: "+((f=g==null?void 0:g.lastPreKeyId)!=null?f:0));case 11:case"end":return k.stop()}},null,this)}function D(a,c){var e,f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:c===void 0&&(c=d("WABaseGlobals").getConfig().maxPrekeysToUpload());h.next=3;return b("regeneratorRuntime").awrap(a.storage.getLastPreKeyGenerationId());case 3:f=h.sent;g=d("WASignalKeys").makePreKeys(((e=f==null?void 0:f.lastPreKeyId)!=null?e:0)+1,c);return h.abrupt("return",a.storage.savePreKeysGeneration(g.map(function(a){var b=a.plainObject;a=a.record;return{keyId:b.id,encoded:a}})));case 6:case"end":return h.stop()}},null,this)}function E(a){return a.storage.runInTransaction(function(a){a=a.loadLatestSignedPreKey;return a().then(function(a){return d("WAResultOrError").makeResult(a)})}).then(function(b){if(b.success===!1){var e;u.TAGS([d("MAWLoggerUtils").Tag.SignedPrekey]).ERROR(k(),b==null?void 0:b.payload);throw c("WAErr")("Failed to generate signed prekey: "+((e=b==null?void 0:(e=b.payload)==null?void 0:e.message)!=null?e:""))}e=b.value;e=d("WASignalSignatures").deserializeSignedPreKey(e);if(e==null){u.TAGS([d("MAWLoggerUtils").Tag.SignedPrekey]).ERROR(j(),b);throw c("WAErr")("failed to deserialize signed prekey")}return F(a,e.id+1)})}function F(a,b){var e=d("WASignalSignatures").makeSignedPreKey(b,d("WATimeUtils").unixTimeMs(),a.regInfo.staticKeyPair);b=d("WASignalSignatures").serializeSignedPreKeyForPrivateStorage(e);return a.storage.saveSignedPreKeyIfNew(e.id,b).then(function(a){if(a.type==="success")return d("WAResultOrError").makeResult(e);else{a.type;return d("WAResultOrError").makeResult(a.key)}}).then(function(a){if(!a.success){var b;u.TAGS([d("MAWLoggerUtils").Tag.SignedPrekey]).ERROR(i(),a);throw c("WAErr")("Unexpected error when generateSignedPreKeyWithId: "+((b=a==null?void 0:(b=a.payload)==null?void 0:b.message)!=null?b:a.error))}return a.value})}function G(a,b,c,e){return a.storage.runInTransaction(function(a){var f=a.loadSenderKeySession;a=a.saveSenderKeySession;return d("WACryptoLibrary").encryptGroupContent({loadSenderKeySession:f,saveSenderKeySession:a},b,c,e)})}function H(a,b,c,e,f){return a.storage.runInTransaction(function(a){var g=a.loadSenderKeySession;a=a.saveSenderKeySession;return d("WACryptoLibrary").decryptGroupContent({loadSenderKeySession:g,saveSenderKeySession:a},b,c,e,f)})}function I(a,b,c,e){return a.storage.runInTransaction(function(f){var a=f.saveSenderKeySession;f=f.loadSenderKeySession;return d("WACryptoLibrary").saveSenderKeySession({loadSenderKeySession:d("WABaseGlobals").getConfig().useUpdatedSenderKeySession()?f:void 0,saveSenderKeySession:a},b,c,e)})}function J(a,c,e){var f,g;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:i.next=2;return b("regeneratorRuntime").awrap(C(a));case 2:f=i.sent;i.next=5;return b("regeneratorRuntime").awrap(a.storage.runInTransaction(function(a){a=a.saveSenderKeySession;return d("WACryptoLibrary").rotateGroupSenderKey({saveSenderKeySession:a},c,e,f.keyPair).then(d("WAResultOrError").makeResult)}));case 5:g=i.sent;if(!g.success){i.next=10;break}return i.abrupt("return",(h||(h=b("Promise"))).resolve(g.value));case 10:return i.abrupt("return",(h||(h=b("Promise"))).reject(g.error));case 11:case"end":return i.stop()}},null,this)}function K(a){return(h||(h=b("Promise"))).resolve().then(function(){return{regId:d("WASignalOther").makeRegistrationId(a),staticKeyPair:d("WASignalKeys").makeKeyPair(),authKeyPair:d("WASignalKeys").makeKeyPair()}})}function L(a){return d("WASignalOther").encodeSignalProto(d("WASignalLocalStorageProtocol.pb").RecordStructureSpec,d("WASignalSessions").serializeSession(a))}function M(a){return d("WASignalOther").decodeSignalProto(d("WASignalLocalStorageProtocol.pb").RecordStructureSpec,a,d("WASignalSessions").parseSessionFromRecord)}function N(a){return d("WASignalOther").encodeSignalProto(d("WASignalLocalStorageProtocol.pb").SenderKeyRecordStructureSpec,d("WASignalGroupSession").serializeSession(a))}function O(a){return d("WASignalOther").decodeSignalProto(d("WASignalLocalStorageProtocol.pb").SenderKeyRecordStructureSpec,a,d("WASignalGroupSession").parseSessionFromRecord)}function P(a){return a}function Q(a,b){return a+"|"+b}function R(a){a=a.split("|");if(a.length!==2)throw c("WAErr")("Incorrect ComplexSenderKey");return{groupId:d("WAJids").unsafeCoerceToGroupJid(a[0]),deviceId:d("WAJids").unsafeCoerceToDeviceJid(a[1])}}g.DEFAULT_SESSION_REQUEST=v;g.cryptoManagerFlushable=a;g.initCryptoManager=e;g.getSessionForRecipient=w;g.establishOutgoingSession=f;g.ensureSessionsExists=x;g.bulkEncryptContent=y;g.encryptContent=z;g.decryptContent=A;g.getParticipantInfo=B;g.generateOneTimePreKey=C;g.generatePreKeys=D;g.generateSignedPreKey=E;g.generateSignedPreKeyWithId=F;g.encryptGroupContent=G;g.decryptGroupContent=H;g.saveSenderKeySession=I;g.rotateGroupSenderKey=J;g.generateRegistrationInfo=K;g.encodeSession=L;g.decodeSession=M;g.encodeSenderKeySession=N;g.decodeSenderKeySession=O;g.castToPreKeyGenerationId=P;g.encodeSenderKey=Q;g.decodeSenderKey=R}),98);
__d("WAConvertRegistrationIdMixin",["WAParsableXmlNode"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return d("WAParsableXmlNode").convertBytesToUint(a.registrationElementValue,4)}g.registrationIdMixin=a}),98);
__d("WAConvertSignedPreKeyMixin",["WAParsableXmlNode"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return{id:d("WAParsableXmlNode").convertBytesToUint(a.skeyIdKeyIDMixin.elementValue,3),pubkey:a.skeyValueKeyDataMixin.elementValue,signature:a.skeySignatureElementValue}}g.convertSignedPreKeyMixin=a}),98);
__d("WASmaxInPreKeysIQErrorResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","error");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQErrorResponseMixin=a}),98);
__d("WASmaxInPreKeysIQErrorBadRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","bad-request");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",400);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorBadRequestMixin=a}),98);
__d("WASmaxInPreKeysIQErrorFallbackClientMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"text");if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(a,"code",400,499);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorFallbackClientMixin=a}),98);
__d("WASmaxInPreKeysIQErrorNoValidJIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","not-acceptable");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",406);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorNoValidJIDMixin=a}),98);
__d("WASmaxInPreKeysRequestErrorsFetch",["WAResultOrError","WASmaxInPreKeysIQErrorBadRequestMixin","WASmaxInPreKeysIQErrorFallbackClientMixin","WASmaxInPreKeysIQErrorNoValidJIDMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInPreKeysIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:b.value});var c=d("WASmaxInPreKeysIQErrorNoValidJIDMixin").parseIQErrorNoValidJIDMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IQErrorNoValidJID",value:c.value});var e=d("WASmaxInPreKeysIQErrorFallbackClientMixin").parseIQErrorFallbackClientMixin(a);return e.success?d("WAResultOrError").makeResult({name:"IQErrorFallbackClient",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorBadRequest","IQErrorNoValidJID","IQErrorFallbackClient"],[b,c,e])}g.parseRequestErrorsFetch=a}),98);
__d("WASmaxInPreKeysFetchKeyBundlesResponseRequestError",["WAResultOrError","WASmaxInPreKeysIQErrorResponseMixin","WASmaxInPreKeysRequestErrorsFetch","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInPreKeysIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInPreKeysRequestErrorsFetch").parseRequestErrorsFetch(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorRequestErrorsFetch:b.value}))}g.parseFetchKeyBundlesResponseRequestError=a}),98);
__d("WASmaxInPreKeysIQErrorFallbackServerMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"text");if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(a,"code",500,599);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorFallbackServerMixin=a}),98);
__d("WASmaxInPreKeysIQErrorServiceUnavailableMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","service-unavailable");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",503);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorServiceUnavailableMixin=a}),98);
__d("WASmaxInPreKeysServerErrors",["WAResultOrError","WASmaxInPreKeysIQErrorFallbackServerMixin","WASmaxInPreKeysIQErrorServiceUnavailableMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInPreKeysIQErrorServiceUnavailableMixin").parseIQErrorServiceUnavailableMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorServiceUnavailable",value:b.value});var c=d("WASmaxInPreKeysIQErrorFallbackServerMixin").parseIQErrorFallbackServerMixin(a);return c.success?d("WAResultOrError").makeResult({name:"IQErrorFallbackServer",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorServiceUnavailable","IQErrorFallbackServer"],[b,c])}g.parseServerErrors=a}),98);
__d("WASmaxInPreKeysFetchKeyBundlesResponseServerError",["WAResultOrError","WASmaxInPreKeysIQErrorResponseMixin","WASmaxInPreKeysServerErrors","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInPreKeysIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInPreKeysServerErrors").parseServerErrors(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorServerErrors:b.value}))}g.parseFetchKeyBundlesResponseServerError=a}),98);
__d("WASmaxInPreKeysEnums",["WAJids"],(function(a,b,c,d,e,f,g){b={validators:[(a=d("WAJids")).validateDeviceJid,a.validateDeviceJid],typeName:"DeviceJid|DeviceJid"};c={validators:[a.validateDeviceJid,a.validateDeviceJid,a.validateInteropDeviceJid,a.validateInteropDeviceJid],typeName:"DeviceJid|DeviceJid|InteropDeviceJid|InteropDeviceJid"};e={validators:[a.validateDeviceJid,a.validateDomainJid],typeName:"DeviceJid|DomainJid"};f={validators:[a.validateUserJid,a.validateUserJid],typeName:"UserJid|UserJid"};g.DEVICEJID_DEVICEJID=b;g.DEVICEJID_DEVICEJID_INTEROPDEVICEJID_INTEROPDEVICEJID=c;g.DEVICEJID_DOMAINJID=e;g.USERJID_USERJID=f}),98);
__d("WASmaxInPreKeysIQResultResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQResultResponseMixin=a}),98);
__d("WASmaxInPreKeysFetchKeyBundlesUserErrorFallbackMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"user");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!b.success)return b;a=d("WASmaxParseUtils").attrString(b.value,"text");if(!a.success)return a;b=d("WASmaxParseUtils").attrIntRange(b.value,"code",500,599);return!b.success?b:d("WAResultOrError").makeResult({errorText:a.value,errorCode:b.value})}g.parseFetchKeyBundlesUserErrorFallbackMixin=a}),98);
__d("WASmaxInPreKeysFetchKeyBundlesUserErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"user");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!b.success)return b;a=d("WASmaxParseUtils").attrString(b.value,"text");if(!a.success)return a;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,b.value,"code",500);return!b.success?b:d("WAResultOrError").makeResult({errorText:a.value,errorCode:b.value})}g.parseFetchKeyBundlesUserErrorMixin=a}),98);
__d("WASmaxInPreKeysDeviceIdentityMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"device-identity");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytes(a.value);return!a.success?a:d("WAResultOrError").makeResult({deviceIdentityElementValue:a.value})}g.parseDeviceIdentityMixin=a}),98);
__d("WASmaxInPreKeysKeyDataMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").contentBytesRange(a,32,32);return!a.success?a:d("WAResultOrError").makeResult({elementValue:a.value})}g.parseKeyDataMixin=a}),98);
__d("WASmaxInPreKeysIdentityKeyMixin",["WASmaxInPreKeysKeyDataMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"identity");if(!a.success)return a;a=d("WASmaxInPreKeysKeyDataMixin").parseKeyDataMixin(a.value);return!a.success?a:a}g.parseIdentityKeyMixin=a}),98);
__d("WASmaxInPreKeysKeyTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"type");if(!a.success)return a;a=d("WASmaxParseUtils").contentLiteralBytes(a.value,new Uint8Array([5]));return!a.success?a:d("WAResultOrError").makeResult({typeElementValue:a.value})}g.parseKeyTypeMixin=a}),98);
__d("WASmaxInPreKeysKeyIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"id");if(!b.success)return b;b=d("WASmaxParseUtils").contentBytesRange(a,3,3);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}g.parseKeyIDMixin=a}),98);
__d("WASmaxInPreKeysPreKeyMixin",["WAResultOrError","WASmaxInPreKeysKeyDataMixin","WASmaxInPreKeysKeyIDMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"key");if(!a.success)return a;var b=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"id");if(!b.success)return b;a=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"value");if(!a.success)return a;b=d("WASmaxInPreKeysKeyIDMixin").parseKeyIDMixin(b.value);if(!b.success)return b;a=d("WASmaxInPreKeysKeyDataMixin").parseKeyDataMixin(a.value);return!a.success?a:d("WAResultOrError").makeResult({keyIdKeyIDMixin:b.value,keyValueKeyDataMixin:a.value})}g.parsePreKeyMixin=a}),98);
__d("WASmaxInPreKeysRegistrationIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"registration");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytesRange(a.value,4,4);return!a.success?a:d("WAResultOrError").makeResult({registrationElementValue:a.value})}g.parseRegistrationIDMixin=a}),98);
__d("WASmaxInPreKeysSignedPreKeyMixin",["WAResultOrError","WASmaxInPreKeysKeyDataMixin","WASmaxInPreKeysKeyIDMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"skey");if(!a.success)return a;var b=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"id");if(!b.success)return b;var c=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"value");if(!c.success)return c;a=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"signature");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytesRange(a.value,64,64);if(!a.success)return a;b=d("WASmaxInPreKeysKeyIDMixin").parseKeyIDMixin(b.value);if(!b.success)return b;c=d("WASmaxInPreKeysKeyDataMixin").parseKeyDataMixin(c.value);return!c.success?c:d("WAResultOrError").makeResult({skeySignatureElementValue:a.value,skeyIdKeyIDMixin:b.value,skeyValueKeyDataMixin:c.value})}g.parseSignedPreKeyMixin=a}),98);
__d("WASmaxInPreKeysFetchKeyBundlesUserSuccessMixin",["WAResultOrError","WASmaxInPreKeysDeviceIdentityMixin","WASmaxInPreKeysIdentityKeyMixin","WASmaxInPreKeysKeyTypeMixin","WASmaxInPreKeysPreKeyMixin","WASmaxInPreKeysRegistrationIDMixin","WASmaxInPreKeysSignedPreKeyMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"user");if(!b.success)return b;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"t",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,a,"is_cloud_api","true");if(!c.success)return c;var e=d("WASmaxInPreKeysRegistrationIDMixin").parseRegistrationIDMixin(a);if(!e.success)return e;var f=d("WASmaxInPreKeysKeyTypeMixin").parseKeyTypeMixin(a),g=d("WASmaxInPreKeysIdentityKeyMixin").parseIdentityKeyMixin(a);if(!g.success)return g;var h=d("WASmaxInPreKeysPreKeyMixin").parsePreKeyMixin(a),i=d("WASmaxInPreKeysSignedPreKeyMixin").parseSignedPreKeyMixin(a);if(!i.success)return i;a=d("WASmaxInPreKeysDeviceIdentityMixin").parseDeviceIdentityMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({t:b.value,isCloudApi:c.value},e.value,{keyTypeMixin:f.success?f.value:null},g.value,{preKeyMixin:h.success?h.value:null},i.value,{deviceIdentityMixin:a.success?a.value:null}))}g.parseFetchKeyBundlesUserSuccessMixin=a}),98);
__d("WASmaxInPreKeysUserFetchKeyBundlesSuccessOrFetchKeyBundlesErrorOrFetchKeyBundlesErrorFallbackMixinGroup",["WAResultOrError","WASmaxInPreKeysFetchKeyBundlesUserErrorFallbackMixin","WASmaxInPreKeysFetchKeyBundlesUserErrorMixin","WASmaxInPreKeysFetchKeyBundlesUserSuccessMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInPreKeysFetchKeyBundlesUserSuccessMixin").parseFetchKeyBundlesUserSuccessMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"FetchKeyBundlesUserSuccess",value:b.value});var c=d("WASmaxInPreKeysFetchKeyBundlesUserErrorMixin").parseFetchKeyBundlesUserErrorMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"FetchKeyBundlesUserError",value:c.value});var e=d("WASmaxInPreKeysFetchKeyBundlesUserErrorFallbackMixin").parseFetchKeyBundlesUserErrorFallbackMixin(a);return e.success?d("WAResultOrError").makeResult({name:"FetchKeyBundlesUserErrorFallback",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["UserSuccess","UserError","UserErrorFallback"],[b,c,e])}g.parseUserFetchKeyBundlesSuccessOrFetchKeyBundlesErrorOrFetchKeyBundlesErrorFallbackMixinGroup=a}),98);
__d("WASmaxInPreKeysFetchKeyBundlesResponseSuccess",["WAResultOrError","WASmaxInPreKeysEnums","WASmaxInPreKeysIQResultResponseMixin","WASmaxInPreKeysUserFetchKeyBundlesSuccessOrFetchKeyBundlesErrorOrFetchKeyBundlesErrorFallbackMixinGroup","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"user");if(!b.success)return b;b=d("WASmaxParseJid").attrJidEnum(a,"jid",d("WASmaxInPreKeysEnums").DEVICEJID_DEVICEJID);if(!b.success)return b;a=d("WASmaxInPreKeysUserFetchKeyBundlesSuccessOrFetchKeyBundlesErrorOrFetchKeyBundlesErrorFallbackMixinGroup").parseUserFetchKeyBundlesSuccessOrFetchKeyBundlesErrorOrFetchKeyBundlesErrorFallbackMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({jid:b.value,userFetchKeyBundlesSuccessOrFetchKeyBundlesErrorOrFetchKeyBundlesErrorFallbackMixinGroup:a.value})}function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"list");if(!c.success)return c;a=d("WASmaxInPreKeysIQResultResponseMixin").parseIQResultResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxParseUtils").mapChildrenWithTag(c.value,"user",0,1e5,h);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{listUser:b.value}))}g.parseFetchKeyBundlesResponseSuccessListUser=h;g.parseFetchKeyBundlesResponseSuccess=a}),98);
__d("WASmaxAttrs",["WAWap"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){if(b==null)return d("WAWap").DROP_ATTR;else return a(b)}function b(a,b){if(b)return a;else return d("WAWap").DROP_ATTR}g.OPTIONAL=a;g.OPTIONAL_LITERAL=b}),98);
__d("WASmaxOutPreKeysClientRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("iq",{id:d("WAWap").generateId(),xmlns:"encrypt",to:d("WAWap").S_WHATSAPP_NET});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeClientRequestMixin=a}),98);
__d("WASmaxOutPreKeysFetchKeyBundlesRequest",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxOutPreKeysClientRequestMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.userJid;a=a.hasUserReasonIdentity;b=d("WASmaxJsx").smax("user",{jid:d("WAWap").JID(b),reason:d("WASmaxAttrs").OPTIONAL_LITERAL("identity",a)});return b}function a(a){a=a.userArgs;a=d("WASmaxOutPreKeysClientRequestMixin").mergeClientRequestMixin(d("WASmaxJsx").smax("iq",{type:"get"},d("WASmaxJsx").smax("key",null,d("WASmaxChildren").REPEATED_CHILD(h,a,1,1e5))));return a}g.makeFetchKeyBundlesRequestKeyUser=h;g.makeFetchKeyBundlesRequest=a}),98);
__d("WASmaxPreKeysFetchKeyBundlesRPC",["WAComms","WASmaxInPreKeysFetchKeyBundlesResponseRequestError","WASmaxInPreKeysFetchKeyBundlesResponseServerError","WASmaxInPreKeysFetchKeyBundlesResponseSuccess","WASmaxOutPreKeysFetchKeyBundlesRequest","WASmaxParsingFailure","WASmaxRpcUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:e=d("WASmaxOutPreKeysFetchKeyBundlesRequest").makeFetchKeyBundlesRequest(a);j.next=3;return b("regeneratorRuntime").awrap(d("WAComms").sendSmaxStanza(e,c));case 3:f=j.sent;g=d("WASmaxInPreKeysFetchKeyBundlesResponseSuccess").parseFetchKeyBundlesResponseSuccess(f,e);if(!g.success){j.next=7;break}return j.abrupt("return",{name:"FetchKeyBundlesResponseSuccess",value:g.value});case 7:h=d("WASmaxInPreKeysFetchKeyBundlesResponseRequestError").parseFetchKeyBundlesResponseRequestError(f,e);if(!h.success){j.next=10;break}return j.abrupt("return",{name:"FetchKeyBundlesResponseRequestError",value:h.value});case 10:i=d("WASmaxInPreKeysFetchKeyBundlesResponseServerError").parseFetchKeyBundlesResponseServerError(f,e);if(!i.success){j.next=13;break}return j.abrupt("return",{name:"FetchKeyBundlesResponseServerError",value:i.value});case 13:throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("FetchKeyBundles",{Success:g,RequestError:h,ServerError:i}));case 14:case"end":return j.stop()}},null,this)}g.sendFetchKeyBundlesRPC=a}),98);
__d("WAFetchPreKeyBundlesProtocol",["WAConvertRegistrationIdMixin","WAConvertSignedPreKeyMixin","WAParsableXmlNode","WAResultOrError","WASignalKeys","WASmaxPreKeysFetchKeyBundlesRPC","WATagsLogger","WATimeUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["RequestError: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["ServerError: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["fetched prekey successfully"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["start fetching prekey of ","..."]);k=function(){return a};return a}var l=d("WATagsLogger").TAGS(["fetchPreKeyBundlesProtocol"]);function a(a){var c,e,f,g;return b("regeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:l.LOG(k(),a.join(", "));n.next=3;return b("regeneratorRuntime").awrap(d("WASmaxPreKeysFetchKeyBundlesRPC").sendFetchKeyBundlesRPC({userArgs:a.map(function(a){return{userJid:a,hasUserReasonIdentity:!1}})}));case 3:c=n.sent;n.t0=c.name;n.next=n.t0==="FetchKeyBundlesResponseSuccess"?7:n.t0==="FetchKeyBundlesResponseServerError"?11:n.t0==="FetchKeyBundlesResponseRequestError"?14:17;break;case 7:l.LOG(j());e=new Map();c.value.listUser.map(function(a){var b=a.userFetchKeyBundlesSuccessOrFetchKeyBundlesErrorOrFetchKeyBundlesErrorFallbackMixinGroup;b.name==="FetchKeyBundlesUserSuccess"&&e.set(a.jid,m(b.value))});return n.abrupt("return",d("WAResultOrError").makeResult(e));case 11:f=c.value.errorServerErrors.name;l.WARN(i(),f);return n.abrupt("return",d("WAResultOrError").makeError({type:"server-error",payload:f}));case 14:g=c.value.errorRequestErrorsFetch.name;l.ERROR(h(),g);return n.abrupt("return",d("WAResultOrError").makeError({type:"request-error",payload:g}));case 17:case"end":return n.stop()}},null,this)}function m(a){var b=d("WAConvertRegistrationIdMixin").registrationIdMixin(a),c=d("WASignalKeys").serializeIdentity(a.elementValue),e=d("WAConvertSignedPreKeyMixin").convertSignedPreKeyMixin(a),f=a.preKeyMixin?n(a.preKeyMixin):null;a=d("WATimeUtils").castToUnixTime(a.t||0);return{keys:{regId:b,identity:c,oneTimeKey:f,signedKey:{id:e.id,signature:e.signature,publicKey:d("WASignalKeys").serializeIdentity(e.pubkey)}},timestamp:a}}function n(a){return{id:d("WAParsableXmlNode").convertBytesToUint(a.keyIdKeyIDMixin.elementValue,3),publicKey:d("WASignalKeys").serializeIdentity(a.keyValueKeyDataMixin.elementValue)}}g.fetchPreKeyBundlesProtocol=a}),98);
__d("WABulkRequestKeys",["WAFetchPreKeyBundlesProtocol","WAResultOrError","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var c;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(d("WAFetchPreKeyBundlesProtocol").fetchPreKeyBundlesProtocol(a));case 2:c=e.sent;if(c.success){e.next=5;break}return e.abrupt("return",d("WAResultOrError").makeError("errRequestKeysParsingFailed"));case 5:return e.abrupt("return",d("WAResultOrError").makeResult(c.value));case 6:case"end":return e.stop()}},null,this)}g.bulkRequestKeys=a}),98);
__d("WAHandleFailureUtils",["WABridge","WAGlobals"],(function(a,b,c,d,e,f,g){"use strict";c={GENERIC_FAILURE:"400",NOT_AUTHORIZED:"401",TEMP_BANNED:"402",BANNED:"403",CAT_EXPIRED:"413",CAT_INVALID:"414",NOT_FOUND:"415",INTERNAL_ERROR:"500",SERVER_UNAVAILABLE:"503"};function h(){return d("WAGlobals").getDbImpls().clearSignalAndTempStores()}function a(){return h().then(function(){d("WABridge").getBridge().fireAndForget("event","logout",{})})}function b(){return h().then(function(){d("WABridge").getBridge().fireAndForget("event","reregisterDevice",{})})}g.FAILURE_CODES=c;g.clearRegistrationAndTempData=h;g.deregisterPhone=a;g.reregisterPhone=b}),98);
__d("WASignalEntityStoreV2",["$InternalEnum","regeneratorRuntime"],(function(a,b,c,d,e,f){"use strict";var g=b("$InternalEnum").Mirrored(["NOT_PERSISTED","PERSIST_IN_PROGRESS","PERSISTED"]);a=function(){function a(){this.$1=new Map()}var c=a.prototype;c.TEST_ONLY_LOAD_FROM_MEMORY=function(a){return this.$2(a)};c.$2=function(a){a=this.$1.get(a);return a!=null?{entity:a.entity,deleted:a.deleted}:null};c.load=function(a,c){var d,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:d=this.$2(a);if(!(d==null?void 0:d.deleted)){f.next=3;break}return f.abrupt("return",null);case 3:if(!(d!=null&&d.entity!=null)){f.next=5;break}return f.abrupt("return",d.entity);case 5:f.next=7;return b("regeneratorRuntime").awrap(c(a));case 7:e=f.sent;this.$3(a,e);return f.abrupt("return",e);case 10:case"end":return f.stop()}},null,this)};c.bulkLoad=function(a,c){var d,e,f,g,h,i,j,k,l,m,n,o,p;return b("regeneratorRuntime").async(function(q){while(1)switch(q.prev=q.next){case 0:d=[],e=new Map(),f=0;case 3:if(!(f<a.length)){q.next=15;break}g=a[f];h=this.$2(g);if(!(h==null)){q.next=9;break}d.push(g);return q.abrupt("continue",12);case 9:if(!h.deleted){q.next=11;break}return q.abrupt("continue",12);case 11:h.entity!=null?e.set(g,h.entity):d.push(g);case 12:f++;q.next=3;break;case 15:q.next=17;return b("regeneratorRuntime").awrap(c(d));case 17:i=q.sent,(j=i.entries(),k=Array.isArray(j),l=0,j=k?j:j[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 19:if(!k){q.next=25;break}if(!(l>=j.length)){q.next=22;break}return q.abrupt("break",36);case 22:m=j[l++];q.next=29;break;case 25:l=j.next();if(!l.done){q.next=28;break}return q.abrupt("break",36);case 28:m=l.value;case 29:n=m,o=n[0],p=n[1],e.set(o,p),this.$3(o,p);case 34:q.next=19;break;case 36:return q.abrupt("return",e);case 37:case"end":return q.stop()}},null,this)};c.$3=function(a,b){this.$1.set(a,{entity:b,status:g.PERSISTED,deleted:!1})};c.store=function(a,b){this.$1.set(a,{entity:b,status:g.NOT_PERSISTED,deleted:!1})};c.remove=function(a){this.$1.set(a,{entity:null,status:g.NOT_PERSISTED,deleted:!0})};c.pureSnapshot=function(){var a=[],b=Array.from(this.$1.entries()).filter(function(a){a[0];a=a[1];return a.status===g.NOT_PERSISTED}).filter(function(b){var c=b[0];b=b[1];b.deleted&&a.push({id:c});return!b.deleted}).filter(function(a){a[0];a=a[1];return a.entity!=null}).map(function(a){var b=a[0];a=a[1];return{id:b,cachedEntity:a.entity}});return{update:b,remove:a}};c.snapshot=function(){var a=this,b=this.pureSnapshot();b.remove.forEach(function(b){b=b.id;b=a.$1.get(b);b&&(b.status=g.PERSIST_IN_PROGRESS)});b.update.forEach(function(b){b=b.id;b=a.$1.get(b);b&&(b.status=g.PERSIST_IN_PROGRESS)});return b};c.markSnapshotAsCommitted=function(){this.$1.forEach(function(a){a.status===g.PERSIST_IN_PROGRESS&&(a.status=g.PERSISTED)})};c.markSnapshotAsFailed=function(){this.$1.forEach(function(a){a.status===g.PERSIST_IN_PROGRESS&&(a.status=g.NOT_PERSISTED)})};c.clear=function(){this.$1=new Map()};return a}();f.PersistStatus=g;f.SignalEntityStore=a}),66);
__d("WASignalIdentityStore",["Promise","WAJids","WALogger","WASignalEntityStoreV2","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[WASignalIdentityStore] This should never happen."]);i=function(){return a};return a}a=function(){function a(){this.$1=new Map(),this.$2=new(d("WASignalEntityStoreV2").SignalEntityStore)()}var c=a.prototype;c.bulkLoadIdentities=function(a){var c=this,d,e,f,g,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:d=function(){var a,d,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:if(!f){k.next=6;break}if(!(g>=e.length)){k.next=3;break}return k.abrupt("return","break");case 3:i=e[g++];k.next=10;break;case 6:g=e.next();if(!g.done){k.next=9;break}return k.abrupt("return","break");case 9:i=g.value;case 10:a=i;d=a[0];j=a[1];k.next=15;return b("regeneratorRuntime").awrap(c.loadIdentitiesByUser(d,function(){return(h||(h=b("Promise"))).resolve(j)}));case 15:case"end":return k.stop()}},null,this)},(e=a,f=Array.isArray(e),g=0,e=f?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 2:k.next=4;return b("regeneratorRuntime").awrap(d());case 4:j=k.sent;if(!(j==="break")){k.next=7;break}return k.abrupt("break",9);case 7:k.next=2;break;case 9:return k.abrupt("return",a);case 10:case"end":return k.stop()}},null,this)};c.loadIdentitiesByUser=function(a,c){var e,f,g;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:e=this.$1.get(a);if(!(e==null)){j.next=13;break}j.t0=this;j.t1=a;j.next=6;return b("regeneratorRuntime").awrap(c(a));case 6:j.t2=j.sent;f=j.t0.$3.call(j.t0,j.t1,j.t2);g=Array.from(f.keys());this.$1.set(a,new Set(g));return j.abrupt("return",this.$2.bulkLoad(g,function(){return(h||(h=b("Promise"))).resolve(f)}));case 13:return j.abrupt("return",this.$2.bulkLoad(Array.from(e),function(a){a.length>0&&d("WALogger").ERROR(i());return(h||(h=b("Promise"))).resolve(new Map())}));case 14:case"end":return j.stop()}},null,this)};c.$3=function(a,b){b=new Map(b);var c=this.$2.pureSnapshot(),e=c.remove;c=c.update;for(var e=e,f=Array.isArray(e),g=0,e=f?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=e.length)break;h=e[g++]}else{g=e.next();if(g.done)break;h=g.value}h=h;h=h.id;b["delete"](h)}for(h=c,g=Array.isArray(h),f=0,h=g?h:h[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(g){if(f>=h.length)break;e=h[f++]}else{f=h.next();if(f.done)break;e=f.value}c=e;e=c.id;c=c.cachedEntity;c!=null&&d("WAJids").extractUserJid(e)===a&&b.set(e,c)}return b};c.store=function(a,b){this.$2.store(a,b);b=d("WAJids").extractUserJid(a);b=this.$1.get(b);b!=null&&b.add(a)};c.remove=function(a){this.$2.remove(a);var b=d("WAJids").extractUserJid(a);b=this.$1.get(b);b!=null&&b["delete"](a)};c.clear=function(){this.$2.clear(),this.$1=new Map()};c.load=function(a,b){return this.$2.load(a,b)};c.bulkLoad=function(a,b){return this.$2.bulkLoad(a,b)};c.snapshot=function(){return this.$2.snapshot()};c.pureSnapshot=function(){return this.pureSnapshot()};c.markSnapshotAsCommitted=function(){this.$2.markSnapshotAsCommitted()};c.markSnapshotAsFailed=function(){this.$2.markSnapshotAsFailed()};return a}();g.SignalIdentityStore=a}),98);
__d("WAInMemorySignalStore",["Promise","WACryptoManager","WACryptoUtils","WAGlobals","WAICDCUtils","WAIdentityUtils","WAJids","WAJobDefinitions","WAJobOrchestratorTypes","WAJobs","WAPromiseQueue","WAProtocolQueue","WAProtocolQueueState","WAResultOrError","WASignalEntityStoreV2","WASignalIdentityStore","WATagsLogger","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Cannot perform signal LLA ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Users with unknown devices: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Snapshot save: end"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Snapshot save: start"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Snapshot: ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Removing old identity: ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["Removing my device identity. This should not happen"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["Device notification of one user cannot remove identity the other one "]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["Removing session dur to identity mismatch: ",""]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["Device notification of one user cannot remove session the other one"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["Receiving an identity for my device but it is different from original one"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["Update user devices: userJid: ","; new identities: ","; previous identities: ","}"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);u=function(){return a};return a}var v=d("WATagsLogger").TAGS(["CryptoManager","InMemorySignalStore"]);a=function(){function a(a,c){var e=this;this.$10=new(d("WAPromiseQueue").PromiseQueue)();this.loadSession=function(a,b){return e.$1.load(a,function(a){return e.$9.loadSession(a,b)})};this.loadSessions=function(a){return e.$1.bulkLoad(a,function(a){return e.$9.loadSessions(a).then(function(a){return new Map(Array.from(a.entries()).map(function(a){return[a[0],a[1]]}))})}).then(function(a){return new Map(Array.from(a.entries()).map(function(a){return[a[0],a[1]]}))})};this.loadSignedPreKey=function(a){return e.$7.load(a,function(){return e.$9.loadSignedPreKey(a)})};this.loadOneTimePreKey=function(a){return e.$6.load(a,function(){return e.$9.loadOneTimePreKey(a)})};this.saveSenderKeySession=function(a,c,d){e.storeSenderKeySession(a,c,d);return(h||(h=b("Promise"))).resolve()};this.loadSenderKeySession=function(a,c){var f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:g.next=2;return b("regeneratorRuntime").awrap(e.$8.load(d("WACryptoManager").encodeSenderKey(a,c),function(){var d;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b("regeneratorRuntime").awrap(e.$9.loadSenderKeySession(a,c));case 2:d=f.sent;return f.abrupt("return",d.success?d.value:null);case 4:case"end":return f.stop()}},null,this)}));case 2:f=g.sent;if(!(f==null)){g.next=5;break}return g.abrupt("return",d("WAResultOrError").makeError("errLoadSenderKeySession"));case 5:return g.abrupt("return",d("WAResultOrError").makeResult(f));case 6:case"end":return g.stop()}},null,this)};this.handleNewSession=function(a,c,f,g,i){e.storeSession(a,c);f!=null&&e.storeIdentity(a,f);g!=null&&e.removeOneTimePreKey(g);return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult())};this.calculateICDC=function(a){if(a.length===0)return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeError("missing_participants"));var c=new Set();return(h||(h=b("Promise"))).all(a.map(function(a){var f,g,h,i,j,k,l,m,n,o,p;return b("regeneratorRuntime").async(function(q){while(1)switch(q.prev=q.next){case 0:q.next=2;return b("regeneratorRuntime").awrap(e.loadIdentities(a));case 2:f=q.sent;q.next=5;return b("regeneratorRuntime").awrap(e.loadICDC(a));case 5:g=q.sent;q.next=8;return b("regeneratorRuntime").awrap(e.$9.loadLastSyncTs(a));case 8:h=q.sent;d("WAICDCUtils").isLastSyncTsExpired(h)&&c.add(a);i=new Map(Array.from(f.entries()).map(function(a){var b=a[0];a=a[1];return[d("WAIdentityUtils").removeKeyTypeIfNeeded(a).toString(),b]}));if(!(g==null||d("WAICDCUtils").isICDCIndexInvalid(g))){q.next=14;break}c.add(a);return q.abrupt("return",null);case 14:j=[],(k=g.devices,l=Array.isArray(k),m=0,k=l?k:k[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 16:if(!l){q.next=22;break}if(!(m>=k.length)){q.next=19;break}return q.abrupt("break",34);case 19:n=k[m++];q.next=26;break;case 22:m=k.next();if(!m.done){q.next=25;break}return q.abrupt("break",34);case 25:n=m.value;case 26:o=n;p=i.get(d("WAIdentityUtils").removeKeyTypeIfNeeded(o).toString());if(!(p==null)){q.next=31;break}c.add(a);return q.abrupt("continue",32);case 31:j.push({id:d("WAJids").extractDeviceId(p),identity:d("WAIdentityUtils").removeKeyTypeIfNeeded(o)});case 32:q.next=16;break;case 34:return q.abrupt("return",{devices:j,sequence:g.sequence,signingDeviceIndex:g.signingDeviceIndex,timestamp:g.timestamp,user:a});case 35:case"end":return q.stop()}},null,this)})).then(function(a){var b=a.filter(Boolean);return b.length===0?d("WAResultOrError").makeError("invalid_icdc_info"):d("WAResultOrError").makeResult({icdcInfo:a.filter(Boolean),usersWithMissingICDC:c})})["catch"](function(a){v.ERROR(u(),a);return d("WAResultOrError").makeError("invalid_icdc_info")})};this.$9=a;this.$11=c;this.$5=new(d("WASignalIdentityStore").SignalIdentityStore)();this.$1=new((a=d("WASignalEntityStoreV2")).SignalEntityStore)();this.$2=new a.SignalEntityStore();this.$3=new a.SignalEntityStore();this.$4=new a.SignalEntityStore();this.$6=new a.SignalEntityStore();this.$7=new a.SignalEntityStore();this.$8=new a.SignalEntityStore()}var c=a.prototype;c.storeSession=function(a,b){this.$1.store(a,b)};c.storeIdentity=function(a,b){if(!b)return;this.$5.store(a,b)};c.bulkLoadIdentities=function(a){var b=this;return this.$9.bulkLoadIdentities(a).then(function(a){return b.$5.bulkLoadIdentities(a)})};c.loadIdentities=function(a){var b=this;return this.$5.loadIdentitiesByUser(a,function(){return b.$9.loadIdentities(a)})};c.saveIdentity=function(a,c){return(h||(h=b("Promise"))).resolve(this.storeIdentity(a,c))};c.saveSignedPreKeyIfNew=function(a,b){return this.$9.saveSignedPreKeyIfNew(a,b)};c.removeOneTimePreKey=function(a){this.$6.remove(a)};c.storeSenderKeySession=function(a,b,c){this.$8.store(d("WACryptoManager").encodeSenderKey(a,b),c)};c.updateUserDevicesInfo=function(a){var c=this;return(h||(h=b("Promise"))).all(a.map(function(a){var e,f,g,i,j,k,l,m,u,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N;return b("regeneratorRuntime").async(function(O){while(1)switch(O.prev=O.next){case 0:O.next=2;return b("regeneratorRuntime").awrap(c.loadIdentities(a.jid));case 2:e=O.sent,(f=a.devices,g=a.jid,i=a.notificationTs,j=a.dhash,k=a.icdcInfo),v.DEV(t(),g,f.map(function(b){b=b.id;return d("WAJids").toDeviceJid(a.jid,b)}).join(","),Array.from(e.keys()).join(",")),l=new Set(e.keys()),m=[],u=[],(w=f,x=Array.isArray(w),y=0,w=x?w:w[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 9:if(!x){O.next=15;break}if(!(y>=w.length)){O.next=12;break}return O.abrupt("break",41);case 12:z=w[y++];O.next=19;break;case 15:y=w.next();if(!y.done){O.next=18;break}return O.abrupt("break",41);case 18:z=y.value;case 19:A=z;B=A.id;C=A.identity;D=A.model;E=A.platform;F=d("WAJids").toDeviceJid(a.jid,B);G=e.get(F);d("WAGlobals").getMyDeviceJid()===F&&(H=d("WACryptoUtils").uint8ArraysEqual(d("WAIdentityUtils").removeKeyTypeIfNeeded(c.$11.staticKeyPair.publicKey),d("WAIdentityUtils").removeKeyTypeIfNeeded(C)),H||v.ERROR(s()));l["delete"](F);if(!(G==null)){O.next=32;break}u.push({instruction:"identityAdded",consumerRetries:0,jid:d("WAJids").extractUserJid(F),type:"instruction",device:F,identity:C,model:D,platform:E,notificationTs:i,priority:d("WAProtocolQueue").WAProtocolQueuePriorityHigh});O.next=39;break;case 32:if(d("WACryptoUtils").uint8ArraysEqual(G,C)){O.next=39;break}if(!(d("WAJids").extractUserJid(F)!==g)){O.next=36;break}v.ERROR(r());return O.abrupt("continue",39);case 36:m.push(F),v.DEV(q(),F),u.push({instruction:"identityChanged",consumerRetries:0,jid:d("WAJids").extractUserJid(F),type:"instruction",device:F,identity:C,model:D,platform:E,notificationTs:i,priority:d("WAProtocolQueue").WAProtocolQueuePriorityHigh});case 39:O.next=9;break;case 41:I=[],(J=l,K=Array.isArray(J),L=0,J=K?J:J[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 43:if(!K){O.next=49;break}if(!(L>=J.length)){O.next=46;break}return O.abrupt("break",63);case 46:M=J[L++];O.next=53;break;case 49:L=J.next();if(!L.done){O.next=52;break}return O.abrupt("break",63);case 52:M=L.value;case 53:N=M;if(!(d("WAJids").extractUserJid(N)!==g)){O.next=57;break}v.ERROR(p());return O.abrupt("continue",61);case 57:I.push(N),d("WAGlobals").getMyDeviceJid()===N&&v.ERROR(o()),v.DEV(n(),N),u.push({instruction:"identityRemoved",consumerRetries:0,jid:d("WAJids").extractUserJid(N),type:"instruction",device:N,notificationTs:i,priority:d("WAProtocolQueue").WAProtocolQueuePriorityHigh});case 61:O.next=43;break;case 63:return O.abrupt("return",(h||(h=b("Promise"))).all([j!=null?c.saveDhash(g,j):(h||(h=b("Promise"))).resolve(),k!=null?c.saveICDC(g,k):(h||(h=b("Promise"))).resolve()].concat(Array.from(I).map(function(a){return c.deleteIdentity(a)}),[I.concat(m).map(function(a){return c.$12(a)})],f.map(function(b){var a=b.id;b=b.identity;return c.saveIdentity(d("WAJids").toDeviceJid(g,a),b)}))).then(function(){return d("WAResultOrError").makeResult(u)}));case 64:case"end":return O.stop()}},null,this)})).then(function(a){a=a.flatMap(function(a){return a.success?a.value:[]});if(a.length>0)return d("WAProtocolQueueState").persistStanzas(a)}).then(function(){})};c.savePendingToDatabase=function(){var a=this,c=this.$13();if(c==null)return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult([]));v.DEV(m(),c);v.LOG(l());return this.$9.bulkSaveSignalData(c).then(function(b){v.LOG(k());a.$14();return b},function(c){a.$15();return(h||(h=b("Promise"))).reject(c)})};c.clear=function(){this.$1.clear(),this.$5.clear(),this.$6.clear(),this.$7.clear(),this.$8.clear(),this.$2.clear(),this.$3.clear()};c.$16=function(a){if(a.length===0)return;v.DEV(j(),a);d("WAJobs").getJobManager().fireAndForget(d("WAJobDefinitions").createStartJobInfo("getDevices",{ignoreDhash:!0,reason:"UnknownDevice",scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.LOW},users:new Set(a)}))};c.saveICDC=function(a,c){this.$3.store(a,c);return(h||(h=b("Promise"))).resolve()};c.loadICDC=function(a){var b=this;return this.$3.load(a,function(){return b.$9.loadICDC(a)})};c.saveDhash=function(a,c){this.$2.store(a,c);return(h||(h=b("Promise"))).resolve()};c.deleteIdentity=function(a){this.$5.remove(a);return(h||(h=b("Promise"))).resolve()};c.$12=function(a){this.$1.remove(a);return(h||(h=b("Promise"))).resolve()};c.getLastPreKeyGenerationId=function(){return this.$9.getLastPreKeyGenerationId()};c.savePreKeysGeneration=function(a){return this.$9.savePreKeysGeneration(a)};c.getPreKeyGenerationsTimestamps=function(){return this.$9.getPreKeyGenerationsTimestamps()};c.deletePreKeyGenerations=function(a){return this.$9.deletePreKeyGenerations(a)};c.saveOneTimePreKey=function(a){return this.$9.saveOneTimePreKey(a)};c.runInTransaction=function(a){var c=this,e=function(){return(h||(h=b("Promise"))).resolve(a({handleNewSession:c.handleNewSession,loadLatestSignedPreKey:c.$9.loadLatestSignedPreKey,loadOneTimePreKey:c.loadOneTimePreKey,loadPreKeys:c.$9.loadPreKeys,loadSenderKeySession:c.loadSenderKeySession,loadSession:c.loadSession,loadSessions:c.loadSessions,loadSignedPreKey:c.loadSignedPreKey,saveSenderKeySession:c.saveSenderKeySession}))};return e()["catch"](function(a){v.ERROR(i(),a);return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeError("runtime-exception",a))})};c.$14=function(){this.$1.markSnapshotAsCommitted(),this.$2.markSnapshotAsCommitted(),this.$3.markSnapshotAsCommitted(),this.$5.markSnapshotAsCommitted(),this.$6.markSnapshotAsCommitted(),this.$7.markSnapshotAsCommitted(),this.$8.markSnapshotAsCommitted()};c.$15=function(){this.$1.markSnapshotAsFailed(),this.$2.markSnapshotAsFailed(),this.$3.markSnapshotAsFailed(),this.$5.markSnapshotAsFailed(),this.$6.markSnapshotAsFailed(),this.$7.markSnapshotAsFailed(),this.$8.markSnapshotAsFailed()};c.$13=function(){var a=this.$1.snapshot(),b=[],c=a.remove.map(function(a){return a.id});a.update.forEach(function(a){var c=a.id;a=a.cachedEntity;if(a==null)return;b.push({id:c,updated:a})});var e=[];this.$8.snapshot().update.forEach(function(a){var b=d("WACryptoManager").decodeSenderKey(a.id),c=b.groupId;b=b.deviceId;a.cachedEntity!=null&&c&&b&&e.push({groupId:c,author:b,updated:a.cachedEntity})});a=this.$5.snapshot();var f=a.remove.map(function(a){return a.id}),g=[];a.update.forEach(function(a){var b=a.id;a=a.cachedEntity;if(a==null)return;g.push({id:b,identity:a})});a=this.$6.snapshot().remove;var h=this.$2.snapshot(),i=[];for(var h=h.update,j=Array.isArray(h),k=0,h=j?h:h[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var l;if(j){if(k>=h.length)break;l=h[k++]}else{k=h.next();if(k.done)break;l=k.value}l=l;var m=l.cachedEntity;l=l.id;m!=null&&i.push({id:l,dhash:m})}l=this.$3.snapshot();m=[];for(k=l.update,j=Array.isArray(k),h=0,k=j?k:k[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(j){if(h>=k.length)break;l=k[h++]}else{h=k.next();if(h.done)break;l=h.value}l=l;var n=l.cachedEntity;l=l.id;n!=null&&m.push({id:l,icdc:n})}return b.length===0&&c.length===0&&g.length===0&&e.length===0&&a.length===0&&m.length===0&&i.length===0&&f.length===0?null:{dhashUpdate:i,icdcUpdate:m,identityRemove:f,identityUpdate:g,preKeyRemove:a,senderKeySessionUpdate:e,sessionRemove:c,sessionUpdate:b}};c.warmCache=function(a){var c=this;return this.runInTransaction(function(e){var f,g,h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:f=e.loadSessions;i.next=3;return b("regeneratorRuntime").awrap(c.bulkLoadIdentities(a.map(d("WAJids").interpretAsUserJid).filter(Boolean)));case 3:g=i.sent;h=Array.from(g.values()).reduce(function(a,b){return a.concat(Array.from(b.keys()))},[]);i.next=7;return b("regeneratorRuntime").awrap(f(h));case 7:return i.abrupt("return",d("WAResultOrError").makeResult());case 8:case"end":return i.stop()}},null,this)}).then(function(){})};return a}();g.InMemorySignalStoreImpl=a}),98);
__d("WARequestKeysBatcher",["WAResolvable"],(function(a,b,c,d,e,f,g){"use strict";var h={delayMs:50,maxSize:100};function a(a,b){b=b===void 0?h:b;var c=b.delayMs,e=b.maxSize,f=null;function g(b){f&&f.args===b&&(f=null);return a(b)}return function(a){if(f!=null)f.args.push(a);else{var b=[a],h=new(d("WAResolvable").Resolvable)();a=h.promise.then(g);var i=function(){return void h.resolve(b)},j=setTimeout(i,c);f={args:b,batchPromise:a,run:i,timer:j}}a=f;i=a.args;j=a.batchPromise;var k=i.length-1;if(i.length>=e){clearTimeout((a=f)==null?void 0:a.timer);f.run();f=null}return j.then(function(a){return a[k]})}}g.makeSimpleBatcher=a}),98);
__d("WARequestKeys",["WABulkRequestKeys","WAPromiseManagement","WARequestKeysBatcher","WAResultOrError","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";a=d("WARequestKeysBatcher").makeSimpleBatcher(function(a){var c;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(d("WABulkRequestKeys").bulkRequestKeys(a));case 2:c=e.sent;if(!(c.success===!1)){e.next=5;break}return e.abrupt("return",a.map(function(){return c}));case 5:return e.abrupt("return",a.map(function(a){a=c.value.get(a);return a?d("WAResultOrError").makeResult(a):d("WAResultOrError").makeError("errRequestKeysNoKeys")}));case 6:case"end":return e.stop()}},null,this)});c=d("WAPromiseManagement").cacheWhilePending(function(a){return a},a);g.requestKeys=c}),98);
__d("WACryptoManagerUtils",["MAWLoggerUtils","Promise","WABulkRequestKeys","WACryptoManager","WAErr","WAGlobals","WAHandleFailureUtils","WAInMemorySignalStore","WALogger","WAPREList","WAPREMetrics","WARequestKeys","WAResultOrError","WASignalKeys","WASignalSignatures","WATagsLogger","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[SendMessage] Fail encrypt messages"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Cannot generate one time prekey"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Cannot deserialize signed prekey"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["No signed prekey"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["DecryptMsg error: ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["DecryptMsg error: ",""]);n=function(){return a};return a}var o=d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.SignedPrekey]);function a(a){var b=new(d("WAInMemorySignalStore").InMemorySignalStoreImpl)(a.db,a.regInfo),c=p();return{manager:d("WACryptoManager").initCryptoManager({regInfo:a.regInfo,storage:b,network:c}),storage:b}}function p(){return{requestKeys:d("WARequestKeys").requestKeys,bulkRequestKeys:d("WABulkRequestKeys").bulkRequestKeys}}function q(a,b){if(b.success)a==null?void 0:a.endSuccess();else{var c,e=b.error;d("WALogger").WARN(n(),e);switch(e){case"errDuplicateMsg":a==null?void 0:a.addPoint(e);a==null?void 0:a.endSuccess();return;case"errCryptoDeserialization":case"errSignalNoSession":case"errSignalInvalidMsg":case"errInvalidMac":case"errSignalInvalidSignedPreKey":case"errSignalSignedPreKeyIdMismatch":case"errSignalSignedPreKeyDeserialization":case"errSignalInvalidOneTimeKey":case"errSignalOneTimeKeyMismatch":case"errSignalOneTimeKeyDeserialization":case"errSignalInvalidKey":case"errSignalDecryptionFailed":case"errSignalDeserializeInvalidProtoFormat":case"errSignalDeserializeRatchetKeyBadFormat":case"errSignalDeserializePkInvalidProtoFormat":case"errSignalDeserializePkKeyBadFormat":case"errSignalTooManyMessagesInFuture":case"errSignalEmptyVersionContentSuffix":case"errSignalContentExceededExpectedLength":case"errSignalGrpInvalidProtoFormat":case"errSignalGrpInvalidKeyFormat":case"errSignalGrpVersionContentEmpty":case"errSignalGrpInvalidVersionContentLength":case"errSignalGrpSenderKeyInvalidProtoFormat":case"errSignalGrpSenderKeyProtoError":case"errSignalGrpTooManyMessagesInFuture":c=e;break;default:typeof e==="string"?c=e:(d("WALogger").ERROR(m(),b),c="fail");break}a==null?void 0:a.endFail(c)}}function e(a,c,e,f,g){var i=null;return d("WACryptoManager").decryptContent(f.cryptoManager,c,{ciphertext:e,type:a},function(a,c){i={plaintext:a,remoteIdentity:c};return(h||(h=b("Promise"))).resolve()}).then(function(a){q(g,a);if(a.success)return d("WAResultOrError").makeResult(i);else return a})}function f(a,c,e,f,g){var i=null;return d("WACryptoManager").decryptGroupContent(f.cryptoManager,a,c,e,function(a){i={plaintext:a};return(h||(h=b("Promise"))).resolve()}).then(function(a){q(g,a);if(a.success)return d("WAResultOrError").makeResult(i);else return a})}function r(a,b){return d("WACryptoManager").getParticipantInfo(b,a)}function s(a){return a.storage.getPreKeyGenerationsTimestamps()}function t(a,b){return b.storage.deletePreKeyGenerations(a)}function u(a,b,c,e){return d("WACryptoManager").saveSenderKeySession(e.cryptoManager,a,b,c)}function v(a){var e,f,g,i,m,n,p,q;return b("regeneratorRuntime").async(function(r){while(1)switch(r.prev=r.next){case 0:r.next=2;return b("regeneratorRuntime").awrap(a.storage.runInTransaction(function(a){a=a.loadLatestSignedPreKey;return a().then(d("WAResultOrError").makeResult)}));case 2:e=r.sent;if(!(e.success===!1)){r.next=9;break}o.ERROR(l());if(!(e==null?void 0:(f=e.payload)==null?void 0:(g=f.message)==null?void 0:g.includes("lastSignedPrekeyId"))){r.next=8;break}r.next=8;return b("regeneratorRuntime").awrap(d("WAHandleFailureUtils").reregisterPhone());case 8:throw c("WAErr")("No signed prekey");case 9:i=d("WASignalSignatures").deserializeSignedPreKey(e.value);if(!(i==null)){r.next=13;break}o.ERROR(k());throw c("WAErr")("Cannot deserialize signed prekey");case 13:r.next=15;return b("regeneratorRuntime").awrap(d("WACryptoManager").generateOneTimePreKey(a));case 15:m=r.sent;if(!(m==null)){r.next=19;break}d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.OneTimePrekey]).ERROR(j());throw c("WAErr")("Cannot generate one time prekey");case 19:n=a.regInfo,p=n.regId,q=n.staticKeyPair;return r.abrupt("return",(h||(h=b("Promise"))).resolve({regId:p,keyType:d("WASignalKeys").KEY_TYPE,publicKey:q.publicKey,signedPreKey:i,preKey:m}));case 21:case"end":return r.stop()}},null,this)}function w(a,b,c){var e=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.MESSAGE_ENCRYPTION,{string:{chat:"group",jid:a}},void 0);return d("WACryptoManager").encryptGroupContent(c.cryptoManager,a,d("WAGlobals").getMyDeviceJid(),b).then(function(a){if(a.success)e.endSuccess();else{var b=a.error;switch(b){case"identity-mismatch":break;default:break}e.endFail(b)}return a})}function x(a,b,c){var e=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.MESSAGE_ENCRYPTION,{string:{chat:"1:1",jid:c}},void 0);return d("WACryptoManager").bulkEncryptContent(b.cryptoManager,a).then(function(a){if(a.success)e.endSuccess();else{var b=a.error;switch(b){case"missing":case"mismatch":case"runtime-exception":break;default:break}e.endFail(b)}return a})}function y(a,b,c,e,f,g){var h=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.MESSAGE_ENCRYPTION,{string:{chat:"1:1",jid:g}},void 0);return d("WACryptoManager").encryptContent(c.cryptoManager,a,b,e||d("WACryptoManager").DEFAULT_SESSION_REQUEST,f).then(function(a){if(a.success)h.endSuccess();else{var b=a.error;switch(b){case"identity-mismatch":case"errSignalInvalidKey":break;default:break}h.endFail(b)}return a})}function z(a,b){return d("WACryptoManager").bulkEncryptContent(b.cryptoManager,a).then(function(a){if(a.success===!1){d("WALogger").ERROR(i());return new Map()}return a.value})}function A(a,c){var e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b("regeneratorRuntime").awrap(d("WACryptoManager").ensureSessionsExists(c.cryptoManager,a));case 2:e=f.sent;return f.abrupt("return",c.cryptoManager.storage.runInTransaction(function(a){var c=a.handleNewSession;return(h||(h=b("Promise"))).all(Array.from(e.entries()).map(function(a){var b=a[0];a=a[1];return c(b,a,a.remote.pubKey)})).then(function(){return d("WAResultOrError").makeResult()})}).then(function(){}));case 4:case"end":return f.stop()}},null,this)}g.createCryptoManager=a;g.decryptMsg=e;g.decryptGroupMsg=f;g.getParticipantInfo=r;g.getPreKeyGenerationsTimestamps=s;g.deletePreKeyGenerations=t;g.saveSenderKeySession=u;g.getSignalInfoForRetry=v;g.encryptGroupContentWithMetrics=w;g.bulkEncryptMsgWithMetrics=x;g.encryptMsgWithMetrics=y;g.bulkEncrypt=z;g.bulkPreEstablishOutgoingSession=A}),98);
__d("WAMsgTransport.pb",["WACommon.pb","WAProtoConst"],(function(a,b,c,d,e,f,g){var h;a={NOOP:0,UPSERT:1,DELETE:2,UPSERT_AND_DELETE:3};b={};c={};e={};f={};var i={},j={},k={},l={},m={},n={},o={};b.internalSpec={payload:[1,(h=d("WAProtoConst")).TYPES.MESSAGE,c],protocol:[2,h.TYPES.MESSAGE,e]};c.internalSpec={applicationPayload:[1,h.TYPES.MESSAGE,d("WACommon.pb").SubProtocolSpec],futureProof:[3,h.TYPES.ENUM,d("WACommon.pb").FUTURE_PROOF_BEHAVIOR]};e.internalSpec={integral:[1,h.TYPES.MESSAGE,m],ancillary:[2,h.TYPES.MESSAGE,f]};f.internalSpec={skdm:[2,h.TYPES.MESSAGE,l],deviceListMetadata:[3,h.TYPES.MESSAGE,o],icdc:[4,h.TYPES.MESSAGE,j],backupDirective:[5,h.TYPES.MESSAGE,i]};i.internalSpec={messageId:[1,h.TYPES.STRING],actionType:[2,h.TYPES.ENUM,a],supplementalKey:[3,h.TYPES.STRING]};j.internalSpec={senderIdentity:[1,h.TYPES.MESSAGE,k],recipientIdentities:[2,h.FLAGS.REPEATED|h.TYPES.MESSAGE,k],recipientUserJids:[3,h.FLAGS.REPEATED|h.TYPES.STRING]};k.internalSpec={seq:[1,h.TYPES.INT32],signingDevice:[2,h.TYPES.BYTES],unknownDevices:[3,h.FLAGS.REPEATED|h.TYPES.BYTES],unknownDeviceIds:[4,h.FLAGS.REPEATED|h.TYPES.INT32]};l.internalSpec={groupId:[1,h.TYPES.STRING],axolotlSenderKeyDistributionMessage:[2,h.TYPES.BYTES]};m.internalSpec={padding:[1,h.TYPES.BYTES],dsm:[2,h.TYPES.MESSAGE,n]};n.internalSpec={destinationJid:[1,h.TYPES.STRING],phash:[2,h.TYPES.STRING]};o.internalSpec={senderKeyHash:[1,h.TYPES.BYTES],senderTimestamp:[2,h.TYPES.UINT64],recipientKeyHash:[8,h.TYPES.BYTES],recipientTimestamp:[9,h.TYPES.UINT64]};g.MESSAGE_TRANSPORT_PROTOCOL_ANCILLARY_BACKUP_DIRECTIVE_ACTION_TYPE=a;g.MessageTransportSpec=b;g.MessageTransport$PayloadSpec=c;g.MessageTransport$ProtocolSpec=e;g.MessageTransport$Protocol$AncillarySpec=f;g.MessageTransport$Protocol$Ancillary$BackupDirectiveSpec=i;g.MessageTransport$Protocol$Ancillary$ICDCParticipantDevicesSpec=j;g.MessageTransport$Protocol$Ancillary$ICDCParticipantDevices$ICDCIdentityListDescriptionSpec=k;g.MessageTransport$Protocol$Ancillary$SenderKeyDistributionMessageSpec=l;g.MessageTransport$Protocol$IntegralSpec=m;g.MessageTransport$Protocol$Integral$DeviceSentMessageSpec=n;g.DeviceListMetadataSpec=o}),98);
__d("WASmaxMixinGroupExhaustiveError",[],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.name="SmaxMixinGroupExhaustiveError",b)||babelHelpers.assertThisInitialized(c)}return b}(babelHelpers.wrapNativeSuper(Error));f.SmaxMixinGroupExhaustiveError=a}),66);
__d("WAProtocolQueueLogger",["WAServerRPCLogger"],(function(a,b,c,d,e,f,g){"use strict";a=d("WAServerRPCLogger").logger.TAGS(["ProtocolQueue"]);g.logger=a}),98);
__d("MAWProtocolQueueUtils",["MAWGetStorageQplAnnotations","MAWIncomingMsg","WAHashStringToNumber","WAPREList","WAPREMetrics","WAProtocolQueue","WAProtocolQueueLogger","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Cannot remove acked stanzas ",""]);h=function(){return a};return a}var i=50;function a(a){return function(b){b.success&&c("promiseDone")(a(b.value.toAck));return b}}function j(a){var b=a.stanza,e=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.RECEIVE_MESSAGE,d("MAWIncomingMsg").prepareAnnotationsForIncomingMessage({consumerRetries:b.consumerRetries,msg:b.message.details,queueType:b.message.details.offline!=null?"offline":"online",retryCount:b.message.details.retryCount}),d("WAHashStringToNumber").hashStringToNumber(b.stanzaId.toString()));c("promiseDone")(d("MAWGetStorageQplAnnotations").getStorageQplAnnotations().then(function(a){e.addAnnotations(a)}));e.addPoint("consumer_handle_message_stanza_start");return babelHelpers["extends"]({},a,{receiveFlow:e})}function k(a){return j({decodedMsg:void 0,stanza:a})}function b(a){var b=!1;return d("WAProtocolQueue").protocolQueue().failAck(a,function(a){var c=a.consumerRetries+1;if(c>=i){if(a.type==="message"){var e=k(d("WAProtocolQueue").mapProcolQueueMessageV2toV1(a));e.receiveFlow.endFail("consumer_retries_exceed_limit",{"int":{consumerRetries:a.consumerRetries}})}b=!0;return}return babelHelpers["extends"]({},a,{consumerRetries:c})}).then(function(){return b})["catch"](function(a){d("WAProtocolQueueLogger").logger.ERROR(h(),a);return!1})}g.makeAckResult=a;g.addMetricToMessage=j;g.addMetricToProtocolMessage=k;g.failAck=b}),98);
__d("WAWa5.pb",["$InternalEnum","WAProtoConst"],(function(a,b,c,d,e,f,g){c=(a=b("$InternalEnum"))({WHATSAPP:0,MESSENGER:1});e=a({SYSTEM:0,GOOGLE:1,HARDCODED:2,OVERRIDE:3,FALLBACK:4});f=a({CELLULAR_UNKNOWN:0,WIFI_UNKNOWN:1,CELLULAR_EDGE:100,CELLULAR_IDEN:101,CELLULAR_UMTS:102,CELLULAR_EVDO:103,CELLULAR_GPRS:104,CELLULAR_HSDPA:105,CELLULAR_HSUPA:106,CELLULAR_HSPA:107,CELLULAR_CDMA:108,CELLULAR_1XRTT:109,CELLULAR_EHRPD:110,CELLULAR_LTE:111,CELLULAR_HSPAP:112});b=a({PUSH:0,USER_ACTIVATED:1,SCHEDULED:2,ERROR_RECONNECT:3,NETWORK_SWITCH:4,PING_RECONNECT:5,UNKNOWN:6});var h=a({SHARE_EXTENSION:0,SERVICE_EXTENSION:1,INTENTS_EXTENSION:2}),i=a({WEB_BROWSER:0,APP_STORE:1,WIN_STORE:2,DARWIN:3,WIN32:4}),j=a({PHONE:0,TABLET:1,DESKTOP:2,WEARABLE:3,VR:4}),k=a({RELEASE:0,BETA:1,ALPHA:2,DEBUG:3});a=a({ANDROID:0,IOS:1,WINDOWS_PHONE:2,BLACKBERRY:3,BLACKBERRYX:4,S40:5,S60:6,PYTHON_CLIENT:7,TIZEN:8,ENTERPRISE:9,SMB_ANDROID:10,KAIOS:11,SMB_IOS:12,WINDOWS:13,WEB:14,PORTAL:15,GREEN_ANDROID:16,GREEN_IPHONE:17,BLUE_ANDROID:18,BLUE_IPHONE:19,FBLITE_ANDROID:20,MLITE_ANDROID:21,IGLITE_ANDROID:22,PAGE:23,MACOS:24,OCULUS_MSG:25,OCULUS_CALL:26,MILAN:27,CAPI:28,WEAROS:29,ARDEVICE:30,VRDEVICE:31,BLUE_WEB:32,IPAD:33,TEST:34,SMART_GLASSES:35});var l={},m={},n={},o={},p={},q={},r={},s={},t={},u={},v={};l.internalSpec={clientHello:[2,(d=d("WAProtoConst")).TYPES.MESSAGE,o],serverHello:[3,d.TYPES.MESSAGE,n],clientFinish:[4,d.TYPES.MESSAGE,m]};m.internalSpec={"static":[1,d.TYPES.BYTES],payload:[2,d.TYPES.BYTES]};n.internalSpec={ephemeral:[1,d.TYPES.BYTES],"static":[2,d.TYPES.BYTES],payload:[3,d.TYPES.BYTES]};o.internalSpec={ephemeral:[1,d.TYPES.BYTES],"static":[2,d.TYPES.BYTES],payload:[3,d.TYPES.BYTES]};p.internalSpec={username:[1,d.TYPES.UINT64],passive:[3,d.TYPES.BOOL],userAgent:[5,d.TYPES.MESSAGE,u],webInfo:[6,d.TYPES.MESSAGE,s],pushName:[7,d.TYPES.STRING],sessionId:[9,d.TYPES.SFIXED32],shortConnect:[10,d.TYPES.BOOL],connectType:[12,d.TYPES.ENUM,f],connectReason:[13,d.TYPES.ENUM,b],shards:[14,d.FLAGS.REPEATED|d.TYPES.INT32],dnsSource:[15,d.TYPES.MESSAGE,r],connectAttemptCount:[16,d.TYPES.UINT32],device:[18,d.TYPES.UINT32],devicePairingData:[19,d.TYPES.MESSAGE,q],product:[20,d.TYPES.ENUM,c],fbCat:[21,d.TYPES.BYTES],fbUserAgent:[22,d.TYPES.BYTES],oc:[23,d.TYPES.BOOL],lc:[24,d.TYPES.INT32],iosAppExtension:[30,d.TYPES.ENUM,h],fbAppId:[31,d.TYPES.UINT64],fbDeviceId:[32,d.TYPES.BYTES],pull:[33,d.TYPES.BOOL],paddingBytes:[34,d.TYPES.BYTES],yearClass:[36,d.TYPES.INT32],memClass:[37,d.TYPES.INT32]};q.internalSpec={eRegid:[1,d.TYPES.BYTES],eKeytype:[2,d.TYPES.BYTES],eIdent:[3,d.TYPES.BYTES],eSkeyId:[4,d.TYPES.BYTES],eSkeyVal:[5,d.TYPES.BYTES],eSkeySig:[6,d.TYPES.BYTES],buildHash:[7,d.TYPES.BYTES],deviceProps:[8,d.TYPES.BYTES]};r.internalSpec={dnsMethod:[15,d.TYPES.ENUM,e],appCached:[16,d.TYPES.BOOL]};s.internalSpec={refToken:[1,d.TYPES.STRING],version:[2,d.TYPES.STRING],webdPayload:[3,d.TYPES.MESSAGE,t],webSubPlatform:[4,d.TYPES.ENUM,i]};t.internalSpec={usesParticipantInKey:[1,d.TYPES.BOOL],supportsStarredMessages:[2,d.TYPES.BOOL],supportsDocumentMessages:[3,d.TYPES.BOOL],supportsUrlMessages:[4,d.TYPES.BOOL],supportsMediaRetry:[5,d.TYPES.BOOL],supportsE2EImage:[6,d.TYPES.BOOL],supportsE2EVideo:[7,d.TYPES.BOOL],supportsE2EAudio:[8,d.TYPES.BOOL],supportsE2EDocument:[9,d.TYPES.BOOL],documentTypes:[10,d.TYPES.STRING],features:[11,d.TYPES.BYTES]};u.internalSpec={platform:[1,d.TYPES.ENUM,a],appVersion:[2,d.TYPES.MESSAGE,v],mcc:[3,d.TYPES.STRING],mnc:[4,d.TYPES.STRING],osVersion:[5,d.TYPES.STRING],manufacturer:[6,d.TYPES.STRING],device:[7,d.TYPES.STRING],osBuildNumber:[8,d.TYPES.STRING],phoneId:[9,d.TYPES.STRING],releaseChannel:[10,d.TYPES.ENUM,k],localeLanguageIso6391:[11,d.TYPES.STRING],localeCountryIso31661Alpha2:[12,d.TYPES.STRING],deviceBoard:[13,d.TYPES.STRING],deviceExpId:[14,d.TYPES.STRING],deviceType:[15,d.TYPES.ENUM,j]};v.internalSpec={primary:[1,d.TYPES.UINT32],secondary:[2,d.TYPES.UINT32],tertiary:[3,d.TYPES.UINT32],quaternary:[4,d.TYPES.UINT32],quinary:[5,d.TYPES.UINT32]};g.ClientPayload$Product=c;g.ClientPayload$DNSSource$DNSResolutionMethod=e;g.ClientPayload$ConnectType=f;g.ClientPayload$ConnectReason=b;g.ClientPayload$IOSAppExtension=h;g.ClientPayload$WebInfo$WebSubPlatform=i;g.ClientPayload$UserAgent$DeviceType=j;g.ClientPayload$UserAgent$ReleaseChannel=k;g.ClientPayload$UserAgent$Platform=a;g.HandshakeMessageSpec=l;g.HandshakeMessage$ClientFinishSpec=m;g.HandshakeMessage$ServerHelloSpec=n;g.HandshakeMessage$ClientHelloSpec=o;g.ClientPayloadSpec=p;g.ClientPayload$DevicePairingRegistrationDataSpec=q;g.ClientPayload$DNSSourceSpec=r;g.ClientPayload$WebInfoSpec=s;g.ClientPayload$WebInfo$WebdPayloadSpec=t;g.ClientPayload$UserAgentSpec=u;g.ClientPayload$UserAgent$AppVersionSpec=v}),98);
__d("WACryptoCurve25519",["Promise","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Curve25519.generateSharedSecret pubkey:",""]);i=function(){return a};return a}a=function(){function a(a,c){this.signalDependencies=a,this.keyPair=c?(h||(h=b("Promise"))).resolve(c):this.signalDependencies.generateIdentityKeyPair()}var c=a.prototype;c.generatePublicKey=function(){return this.keyPair.then(function(a){return a.publicKey})};c.generateSharedSecret=function(a){var b=this;return this.keyPair.then(function(c){c=c.privateKey;d("WALogger").LOG(i(),a).devConsole(c);return b.signalDependencies.calculateAgreement(new Uint8Array(a),c)})};return a}();g.Curve25519=a}),98);
__d("WAConnectivityReports",["WALogger","WAPREList","WAPREMetrics"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Connectivity]: ",". Reason: ",", clean: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Connectivity]: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Connectivity]: ",""]);j=function(){return a};return a}function a(a,b){d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.WA_DISCONNECT).endSuccess({string:{key:"code"+b.code}});a=a!=null?"WebSocket "+a+" closed. code: "+b.code:"WebSocket closed connection during initialization. Code: "+b.code;switch(b.code){case 1e3:case 1001:case 1006:d("WALogger").LOG(j(),a);break;case 1002:case 1003:case 1007:case 1008:case 1009:case 1010:case 1011:case 1015:d("WALogger").ERROR(i(),a);break;default:d("WALogger").ERROR(h(),a,b.reason,b.wasClean);break}}g.onWebSocketCloseEvent=a}),98);
__d("WASocketTransport",["Promise","WABinary","WAConnectivityReports","WAErr","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["WebSocket #"," not opened"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["WebSocket #"," errored: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["WebSocket #"," dropped "," bytes"]);k=function(){return a};return a}var l=1,m=function(){function a(a){var b=this;this.$2=!1;this.onData=null;this.onClose=null;this.onError=null;this.dataToSend=new(d("WABinary").Binary)();this.$3=function(a){if(b.$2)return;a=new Uint8Array(a.data);b.onData?b.onData(a):d("WALogger").ERROR(k(),b.id,a.length)};this.$4=function(a){d("WAConnectivityReports").onWebSocketCloseEvent(b.id,a);if(b.$2)return;b.$6()};this.$5=function(a){d("WALogger").DEV(j(),b.id,a);if(b.$2)return;var c=b.onError;c&&c(String(a))};var c=l++;this.id=c;this.$1=a;a.onmessage=this.$3;a.onclose=this.$4;a.onerror=this.$5}var b=a.prototype;b.close=function(){if(this.$2)return;this.$1.close();this.$6()};b.requestSend=function(){if(this.$2){d("WALogger").ERROR(i(),this.id);return}if(!this.dataToSend.size())return;this.$1.send(this.dataToSend.readBuffer())};b.$6=function(){this.$2=!0,this.onClose&&this.onClose()};return a}();function a(a){var e=new WebSocket(a);e.binaryType="arraybuffer";return new(h||(h=b("Promise")))(function(a,b){e.onopen=a,e.onclose=function(a){d("WAConnectivityReports").onWebSocketCloseEvent(null,a),b(c("WAErr")("WebSocket closed immediately: "+a.reason+" "+a.code))}}).then(function(){return new m(e)})}g.openWebSocket=a}),98);
__d("WATreasureHunt",["Promise","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";var h,i=new(h||(h=b("Promise")))(function(){});function a(a,c,e,f){var g=0,j=0,k=!1,l=null,m=null;function n(a){if(!k){k=!0;l!=null&&(clearTimeout(l),l=null);return d("WAResultOrError").makeResult(a)}else{f==null?void 0:f(a);return i}}function o(){if(k)return i;j++;if(j===c)return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeError("max-hunters"));var a=m;a!=null&&j===g&&(l!=null&&(clearTimeout(l),l=null),a());return i}function p(){var d=g++;d=a(d).then(n,o);if(g<c){var f=new(h||(h=b("Promise")))(function(a){l=setTimeout(a,e),m=a}).then(p);return h.race([d,f])}else return d}return p()}g.treasureHunt=a}),98);
__d("WACert.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};c={};e={};f={};a.internalSpec={details:[1,(d=d("WAProtoConst")).TYPES.BYTES],signature:[2,d.TYPES.BYTES]};b.internalSpec={serial:[1,d.TYPES.UINT32],issuer:[2,d.TYPES.STRING],expires:[3,d.TYPES.UINT64],subject:[4,d.TYPES.STRING],key:[5,d.TYPES.BYTES]};c.internalSpec={leaf:[1,d.TYPES.MESSAGE,e],intermediate:[2,d.TYPES.MESSAGE,e]};e.internalSpec={details:[1,d.TYPES.BYTES],signature:[2,d.TYPES.BYTES]};f.internalSpec={serial:[1,d.TYPES.UINT32],issuerSerial:[2,d.TYPES.UINT32],key:[3,d.TYPES.BYTES],notBefore:[4,d.TYPES.UINT64],notAfter:[5,d.TYPES.UINT64]};g.NoiseCertificateSpec=a;g.NoiseCertificate$DetailsSpec=b;g.CertChainSpec=c;g.CertChain$NoiseCertificateSpec=e;g.CertChain$NoiseCertificate$DetailsSpec=f}),98);
__d("WAVerifyChainCertificateWA6",["WACert.pb","WACryptoUtils","WAHex","WALogger","WAResultOrError","WASignalKeys","WASignalOther","WASignalSignatures","decodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(['parseCertificateWA6 certificate is missing "key"']);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(['parseCertificateWA6 certificate is missing "serial"']);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(['parseCertificateWA6 certificate is missing "issuer_serial"']);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(['parseCertificateWA6 certificate is missing "signature"']);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(['parseCertificateWA6 certificate is missing "details"']);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["verifyChainCertificateWA6 leafCert.key does not match handshake server.hello.static"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["verifyChainCertificateWA6: leaf certificate is poorly signed"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["verifyChainCertificateWA6 leaf certificate was not issued by RootCA"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["verifyChainCertificateWA6: invalid leaf certificate"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["verifying leaf certificate"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["verifyChainCertificateWA6: intermediate certificate is poorly signed"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["verifyChainCertificateWA6 intermediate certificate was not issued by RootCA"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["verifyChainCertificateWA6: invalid intermediate certificate"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["verifying intermediate certificate"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["verifyChainCertificateWA6: missing leaf and/or intermediate certificate"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose(["verifyChainCertificateWA6: extract leaf and intermediate certificate"]);w=function(){return a};return a}b="142375574d0a587166aae71ebe516437c4a28b73e3695c6ce1f7f9545da8ee6b";var x={SERIAL:0,ISSUER:"WhatsAppLongTerm1",PUBLIC_KEY:d("WASignalKeys").serializeIdentity(new Uint8Array(d("WAHex").parseHex(b)))};function a(a,b){d("WALogger").LOG(w());a=d("decodeProtobuf").decodeProtobuf(d("WACert.pb").CertChainSpec,a);var c=a.intermediate;a=a.leaf;if(c==null||a==null){d("WALogger").ERROR(v());return d("WAResultOrError").makeError("missing-certificate")}d("WALogger").LOG(u());c=y(c);if(!c.success){d("WALogger").ERROR(t());return d("WAResultOrError").makeError("invalid-certificate")}if(c.value.issuerSerial!==x.SERIAL){d("WALogger").ERROR(s());return d("WAResultOrError").makeError("invalid-certificate")}if(!z(c.value,x.PUBLIC_KEY)){d("WALogger").ERROR(r());return d("WAResultOrError").makeError("invalid-certificate")}d("WALogger").LOG(q());a=y(a);if(!a.success){d("WALogger").ERROR(p());return d("WAResultOrError").makeError("invalid-certificate")}if(a.value.issuerSerial!==c.value.serial){d("WALogger").ERROR(o());return d("WAResultOrError").makeError("invalid-certificate")}var e=d("WASignalKeys").serializeIdentity(new Uint8Array(c.value.key));if(!z(a.value,e)){d("WALogger").ERROR(n());return d("WAResultOrError").makeError("invalid-certificate")}if(!d("WACryptoUtils").arrayBuffersEqual(a.value.key,b)){d("WALogger").ERROR(m());return d("WAResultOrError").makeError("invalid-certificate")}return d("WAResultOrError").makeResult({leaf:a.value,intermediate:c.value})}function y(a){var b=a.details;a=a.signature;if(!b){d("WALogger").ERROR(l());return d("WAResultOrError").makeError("invalid-certificate")}if(!a){d("WALogger").ERROR(k());return d("WAResultOrError").makeError("invalid-certificate")}var c=d("decodeProtobuf").decodeProtobuf(d("WACert.pb").CertChain$NoiseCertificate$DetailsSpec,b),e=c.issuerSerial,f=c.serial,g=c.key,m=c.notAfter;c=c.notBefore;if(e==null){d("WALogger").ERROR(j());return d("WAResultOrError").makeError("invalid-certificate")}if(f==null){d("WALogger").ERROR(i());return d("WAResultOrError").makeError("invalid-certificate")}if(g==null){d("WALogger").ERROR(h());return d("WAResultOrError").makeError("invalid-certificate")}a=d("WASignalOther").ensureSize(new Uint8Array(a),64);return d("WAResultOrError").makeResult({serial:f,issuerSerial:e,key:g,notBefore:c,notAfter:m,details:b,signature:a})}function z(a,b){return d("WASignalSignatures").verifyMsgSignalVariant(b,new Uint8Array(a.details),a.signature)}g.ROOT_CA=x;g.verifyChainCertificateWA6=a;g.parseCertificateWA6=y}),98);
__d("WAFrameSocket",["WABinary","WAErrors","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["FrameSocket: queueing partial frame of "," bytes"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Buffer to send: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["FrameSocket closed"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["FrameSocket error"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["FrameSocket closed, waiting for pending processing"]);l=function(){return a};return a}var m=function(b){babelHelpers.inheritsLoose(a,b);function a(a){var c="SocketClosed";a=b.call(this,(a=a)!=null?a:c)||this;a.name=c;return a}return a}(babelHelpers.wrapNativeSuper(Error));a=function(){function a(a,b){var c=this;this.$3=new(d("WABinary").Binary)();this.closed=!1;this.$4=!1;this.onFrame=null;this.onClose=null;this.$5=function(a){c.$3.writeByteArray(a),c.convertBufferedToFrames()};this.$6=function(){if(c.$3.peek(n)){d("WALogger").LOG(l());c.$4=!0;return}c.$9()};this.$7=function(a){d("WALogger").DEV(k()).devConsole(a)};this.$2=b;this.$1=a;a.onData=this.$5;a.onClose=this.$6;a.onError=this.$7}var b=a.prototype;b.sendFrame=function(a){if(this.$4)return;this.throwIfClosed();var b=this.$2,c=a.byteLength,d=this.$1.dataToSend;b?(this.$2=null,d.ensureAdditionalCapacity(b.length+3+c),d.writeByteArray(b)):d.ensureAdditionalCapacity(3+c);this.$8(c);d.writeUint8(c>>16);d.writeUint16(c&65535);d.write(a);this.$1.requestSend()};b.$9=function(){if(this.closed)return;d("WALogger").LOG(j());this.$4=!1;this.closed=!0;var a=this.onClose;a&&a()};b.$8=function(a){if(a>=1<<24){d("WALogger").WARN(i(),a);throw new(d("WAErrors").BufferTooLargeError)("Buffer too large: "+a)}};b.convertBufferedToFrames=function(){var a=this.$3,b=this.onFrame;while(b&&a.peek(n)){var c=o(a);c=a.readByteArray(c);b(c);b=this.onFrame}this.$4&&!a.peek(n)&&this.$9();b&&a.size()&&d("WALogger").LOG(h(),a.size())};b.throwIfClosed=function(){if(this.closed)throw new m()};b.close=function(){this.$1.close()};return a}();function n(a){if(a.size()<3)return!1;var b=o(a);return b<=a.size()}function o(a){return a.readUint8()<<16|a.readUint16()}g.SocketClosed=m;g.FrameSocket=a}),98);
__d("WANoiseSocket",["Promise","WACryptoDependencies","WALogger","WAPromiseQueue","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendFrame adding to queue with frame size: "," bytes"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["NoiseSocket socket closed while encrypting frame"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Sending encrypted frame to web socket"]);k=function(){return a};return a}a=(h||(h=b("Promise"))).reject("UNINITIALIZED HANDSHAKE");var l=new Uint8Array(0);a["catch"](function(){});c=function(){function a(a,b,c){var e=this;this.$4=[];this.$5=new(d("WAPromiseQueue").PromiseQueue)();this.$6=new(d("WAPromiseQueue").PromiseQueue)();this.$7=0;this.$8=0;this.$9=!1;this.$14=function(a){!e.$1.closed?(d("WALogger").DEV(k()).tags("WANoiseSocket"),e.$1.sendFrame(a)):d("WALogger").LOG(j())};this.$12=function(a){var b=e.$7++;e.$5.enqueueHandlers(o(e.$2,b,void 0,a),e.$15)};this.$13=function(){e.$9=!0,e.$5.wait().then(function(){e.$9=!1;var a=e.$11;a&&a()})};this.$15=function(a){e.$10?e.$10(a):e.$4.push(a)};this.$1=a;this.$3=b;this.$2=c;a.onFrame=this.$12;this.$1.onClose=this.$13;a.convertBufferedToFrames()}var c=a.prototype;c.sendFrameAsync=function(a){var c;return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:d.next=2;return b("regeneratorRuntime").awrap(this.sendFrame(a));case 2:c=d.sent;return d.abrupt("return",c);case 4:case"end":return d.stop()}},null,this)};c.sendFrame=function(a){if(this.$9)return(h||(h=b("Promise"))).resolve();this.$1.throwIfClosed();var c=this.$8++;d("WALogger").DEV(i(),a.length).tags("WANoiseSocket");return this.$6.enqueueHandlers(n(this.$3,c,void 0,a),this.$14)};c.setOnFrame=function(a){this.$10=a};c.setOnClose=function(a){this.$11=a};c.close=function(){this.$1.close()};return a}();function m(a){var b=new ArrayBuffer(12),c=new DataView(b);c.setUint32(8,a);return new Uint8Array(b)}function n(a,b,c,e){return d("WACryptoDependencies").getCrypto().subtle.encrypt({name:"AES-GCM",iv:m(b),additionalData:c?new Uint8Array(c):l},a,e)}function o(a,b,c,e){return d("WACryptoDependencies").getCrypto().subtle.decrypt({name:"AES-GCM",iv:m(b),additionalData:c?new Uint8Array(c):l},a,e)}g.NoiseSocket=c}),98);
__d("WANoiseHandshake",["Promise","WABinary","WACryptoDependencies","WACryptoHkdf","WACryptoSha256","WAErrors","WANoiseSocket","WAResolvable"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=b("Promise"))).reject("UNINITIALIZED HANDSHAKE"),j=new Uint8Array(0);i["catch"](function(){});a=function(){function a(a){var b=this;this.$2=i;this.$3=i;this.$4=i;this.$5=0;this.$1=a;this.$6=new(d("WAResolvable").Resolvable)();a.onClose=function(){b.$6.reject(new(d("WAErrors").Disconnected)("NoiseHandshake: SocketClosed"))};p(this.$6.promise)}var c=a.prototype;c.start=function(a,c){a=d("WABinary").Binary.build(a).readBuffer();a=a.byteLength===32?(h||(h=b("Promise"))).resolve(a):d("WACryptoSha256").sha256(a);this.$2=a;this.$3=a;this.$4=a.then(l);this.authenticate(c)};c.sendAndReceive=function(a){var c=this.$1,d=new(h||(h=b("Promise")))(function(b){c.onFrame=function(a){c.onFrame=null,b(a)},c.sendFrame(a)});return this.$7(d)};c.send=function(a){this.$1.sendFrame(a)};c.authenticate=function(a){this.$2=(h||(h=b("Promise"))).all([this.$2,a]).then(function(a){var b=a[0];a=a[1];b=d("WABinary").Binary.build(b,a).readByteArray();return d("WACryptoSha256").sha256(b)})};c.encrypt=function(a){var c=this.$5++;a=(h||(h=b("Promise"))).all([this.$4,this.$2,a]).then(function(a){var b=a[0],d=a[1];a=a[2];return m(b,c,d,a)});this.authenticate(a);return this.$7(a)};c.decrypt=function(a){var c=this.$5++,d=(h||(h=b("Promise"))).all([this.$4,this.$2]).then(function(b){var d=b[0];b=b[1];return n(d,c,b,a)});this.authenticate(a);return this.$7(d)};c.finish=function(){var a=this,c=this.$3.then(function(a){return o(a,new Uint8Array(0))}).then(function(a){var c=a[0];a=a[1];return(h||(h=b("Promise"))).all([l(c,["encrypt"]),l(a,["decrypt"])])}).then(function(b){var c=b[0];b=b[1];return new(d("WANoiseSocket").NoiseSocket)(a.$1,c,b)});return this.$7(c)};c.mixIntoKey=function(a){this.$5=0;a=(h||(h=b("Promise"))).all([this.$3,a]).then(function(a){var b=a[0];a=a[1];return o(b,new Uint8Array(a))});this.$3=a.then(function(a){return a[0]});this.$4=a.then(function(a){return l(a[1])});p(this.$3);p(this.$4)};c.$7=function(a){var c=this;return(h||(h=b("Promise"))).race([a,this.$6.promise]).then(function(a){return c.$6.resolveWasCalled()?c.$6.promise:a})};return a}();function k(a){var b=new ArrayBuffer(12),c=new DataView(b);c.setUint32(8,a);return new Uint8Array(b)}function l(a,b){b===void 0&&(b=["encrypt","decrypt"]);return d("WACryptoDependencies").getCrypto().subtle.importKey("raw",new Uint8Array(a),"AES-GCM",!1,b)}function m(a,b,c,e){return d("WACryptoDependencies").getCrypto().subtle.encrypt({name:"AES-GCM",iv:k(b),additionalData:c?new Uint8Array(c):j},a,e)}function n(a,b,c,e){return d("WACryptoDependencies").getCrypto().subtle.decrypt({name:"AES-GCM",iv:k(b),additionalData:c?new Uint8Array(c):j},a,e)}function o(a,b){return d("WACryptoHkdf").extractWithSaltAndExpand(b,new Uint8Array(a),"",64).then(function(a){return[a.slice(0,32),a.slice(32)]})}function p(a){a["catch"](function(){})}g.NoiseHandshake=a}),98);
__d("WAOpenChatSocket",["Promise","WABinary","WACryptoCurve25519","WAErr","WAFrameSocket","WALogger","WANoiseHandshake","WAResultOrError","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["openChatSocket performing full handshake"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["openChatSocket performing resume handshake"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["openChatSocket preIntro ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["doFallbackHandshake continuing handshake with given server hello"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["resumeNoiseHandshake performing fallback handshake"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["resumeNoiseHandshake deriving secrets"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["resumeNoiseHandshake continuing resume handshake"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["resumeNoiseHandshake rcv hello"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["resumeNoiseHandshake send hello"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["fullNoiseHandshake rcv hello"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["fullNoiseHandshake send hello"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["doFullHandshakeCore client finish and deriving secrets"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["doFullHandshakeCore parsing and verifying server certificate"]);u=function(){return a};return a}var v="Noise_XX_25519_AESGCM_SHA256\0\0\0\0",w="Noise_IK_25519_AESGCM_SHA256\0\0\0\0",x="Noise_XXfallback_25519_AESGCM_SHA256";function y(a,e,f,g,i){e=e||{};var j=e.ephemeral,k=e["static"];e=e.payload;if(j==null||k==null||e==null)return(h||(h=b("Promise"))).reject(c("WAErr")("doFullHandshakeCore server hello invalid proto"));a.authenticate(j);a.mixIntoKey(g.generateSharedSecret(j));k=a.decrypt(k);a.mixIntoKey(k.then(function(a){return g.generateSharedSecret(a)}));e=a.decrypt(e);return(h||(h=b("Promise"))).all([k,e]).then(function(a){var b=a[0];a=a[1];d("WALogger").LOG(u());return i.processCertificate({certificate:a,serverStatic:b})}).then(function(){var c=a.encrypt(i.staticKeyPair.generatePublicKey());a.mixIntoKey(i.staticKeyPair.generateSharedSecret(j));var d=a.encrypt((h||(h=b("Promise"))).resolve(f));return h.all([c,d])}).then(function(b){var c=b[0];b=b[1];d("WALogger").LOG(t());a.send(i.encodeHandshakeFinish({"static":c,payload:b}));return a.finish()})}function z(a,b,c,e){var f=new(d("WANoiseHandshake").NoiseHandshake)(a);f.start(v,e.protoHeader);a=c.generatePublicKey();f.authenticate(a);return a.then(function(a){d("WALogger").LOG(s());return f.sendAndReceive(e.encodeHandshakeHello({ephemeral:a}))}).then(function(a){d("WALogger").LOG(r());a=e.decodeServerHello(a);return y(f,a,b,c,e)})}function A(a,e,f,g,i){var j=new(d("WANoiseHandshake").NoiseHandshake)(a);j.start(w,i.protoHeader);var k=g.generatePublicKey();j.authenticate(f);j.authenticate(k);j.mixIntoKey(g.generateSharedSecret(f));var l=j.encrypt(i.staticKeyPair.generatePublicKey());j.mixIntoKey(i.staticKeyPair.generateSharedSecret(f));f=j.encrypt((h||(h=b("Promise"))).resolve(e));return h.all([k,f,l]).then(function(b){var a=b[0],c=b[1];b=b[2];d("WALogger").LOG(q());return j.sendAndReceive(i.encodeHandshakeHello({ephemeral:a,payload:c,"static":b}))}).then(function(b){d("WALogger").LOG(p());b=i.decodeServerHello(b);var f=b||{},h=f.ephemeral,k=f["static"];f=f.payload;if(k==null){d("WALogger").LOG(o());if(!h)throw c("WAErr")("serverHello missing serverEphemeral");if(!f)throw c("WAErr")("serverHello missing certificateCiphertext");j.authenticate(h);j.mixIntoKey(g.generateSharedSecret(h));j.mixIntoKey(i.staticKeyPair.generateSharedSecret(h));return j.decrypt(f).then(function(){d("WALogger").LOG(n());return j.finish()})}else{d("WALogger").LOG(m());return B(a,b,e,g,i)}})}function B(a,b,c,e,f){a=new(d("WANoiseHandshake").NoiseHandshake)(a);a.start(x,f.protoHeader);var g=e.generatePublicKey();a.authenticate(g);d("WALogger").LOG(l());return y(a,b,c,e,f)}function a(a,c,e){return a.openSocket(e).then(d("WAResultOrError").onResult(function(e){var f,g,l,m,n,o,p,q,r,s;return b("regeneratorRuntime").async(function(t){while(1)switch(t.prev=t.next){case 0:(h||(h=b("Promise"))).resolve().then(c);f=void 0;g=a.edgeInfo;g&&(l=new(d("WABinary").Binary)(),l.write("ED",0,1),l.writeUint8(g.byteLength>>16),l.writeUint16(g.byteLength&65535),l.writeBuffer(g),f=l.readByteArray(),d("WALogger").LOG(k(),f));m=f?d("WABinary").Binary.build(f,a.protoHeader).readByteArray():a.protoHeader;n=new(d("WAFrameSocket").FrameSocket)(e,m);t.next=8;return b("regeneratorRuntime").awrap(a.getClientPayload());case 8:o=t.sent;p=new(d("WACryptoCurve25519").Curve25519)(a.curveSignalDependencies);q=a.serverStaticKeyIfKnown();if(!q){t.next=17;break}d("WALogger").LOG(j());(r=a.preLogging)==null?void 0:r.onBeforeResumeHandshakeStarted==null?void 0:r.onBeforeResumeHandshakeStarted();return t.abrupt("return",A(n,o,q,p,a).then(function(b){var c;(c=a.preLogging)==null?void 0:c.onAfterResumeHandshakeCompleted==null?void 0:c.onAfterResumeHandshakeCompleted();return b})["catch"](function(c){var d;(d=a.preLogging)==null?void 0:d.onHandshakeError==null?void 0:d.onHandshakeError();return(h||(h=b("Promise"))).reject(c)}));case 17:d("WALogger").LOG(i());(s=a.preLogging)==null?void 0:s.onBeforeFullHandshakeStarted==null?void 0:s.onBeforeFullHandshakeStarted();return t.abrupt("return",z(n,o,p,a).then(function(b){var c;(c=a.preLogging)==null?void 0:c.onAfterFullHandshakeCompleted==null?void 0:c.onAfterFullHandshakeCompleted();return b})["catch"](function(c){var d;(d=a.preLogging)==null?void 0:d.onHandshakeError==null?void 0:d.onHandshakeError();return(h||(h=b("Promise"))).reject(c)}));case 20:case"end":return t.stop()}},null,this)}))}g.doFullHandshake=z;g.openChatSocket=a}),98);
__d("WASmaxInMultiwaydServerNotificationMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"offline",0,1024);return!a.success?a:d("WAResultOrError").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);
__d("WASmaxInMultiwaydMultiwayNotificationRequest",["WAResultOrError","WASmaxInMultiwaydServerNotificationMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"multiway");if(!b.success)return b;var c=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrDomainJid,a,"from","s.whatsapp.net");if(!c.success)return c;var e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","fb:multiway");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,b.value,"transaction_id");if(!f.success)return f;var g=d("WASmaxParseUtils").attrInt(b.value,"binary_version");if(!g.success)return g;b=d("WASmaxParseUtils").contentBytesRange(b.value,1,void 0);if(!b.success)return b;a=d("WASmaxInMultiwaydServerNotificationMixin").parseServerNotificationMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({from:c.value,type:e.value,multiwayTransactionId:f.value,multiwayBinaryVersion:g.value,multiwayElementValue:b.value},a.value))}g.parseMultiwayNotificationRequest=a}),98);
__d("WASmaxOutMultiwaydNotificationClientAckMixin",["WASmaxJsx","WASmaxMixins","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrDomainJid,a,["from"]);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);a=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{id:d("WAWap").STANZA_ID(b.value),to:d("WAWap").DOMAIN_JID(c.value),"class":"notification",type:d("WAWap").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNotificationClientAckMixin=a}),98);
__d("WASmaxOutMultiwaydMultiwayNotificationResponseAck",["WASmaxJsx","WASmaxOutMultiwaydNotificationClientAckMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutMultiwaydNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",null),a);return a}g.makeMultiwayNotificationResponseAck=a}),98);
__d("WASmaxMultiwaydMultiwayNotificationRPC",["WASmaxInMultiwaydMultiwayNotificationRequest","WASmaxOutMultiwaydMultiwayNotificationResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMultiwaydMultiwayNotificationRequest").parseMultiwayNotificationRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("MultiwayNotification",{Request:b}));return{parsedRequest:b.value,makeMultiwayNotificationResponseAck:function(){return d("WASmaxOutMultiwaydMultiwayNotificationResponseAck").makeMultiwayNotificationResponseAck(a)}}}g.receiveMultiwayNotificationRPC=a}),98);
__d("MAWMockServerShell",["cr:8600"],(function(a,b,c,d,e,f,g){"use strict";a=b("cr:8600")!=null;g.isMockServerMode=a;g.getMockServer=b("cr:8600")}),98);
__d("WAParseMessageTransport",["decodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return{version:"v3",type:"error",error:a}}function i(a,b){return a!=null&&(b.dsm==null||b.dsm.destinationJid==null||b.dsm.destinationJid!==a)}function a(a,b){var c=a.payload;a=a.protocol;if(c==null&&a==null)return h("There is no payload and protocol in the message transport");else if(a==null)return h("There is no protocol part in the message transport");var e=a.integral;if(e==null)return h("There is no integral part in the message transport");else if(e.padding==null)return h("There is no padding in the message transport");else if(i(b,e))return h("The recipient does not match the device sent message recipient");else if(d("decodeProtobuf").getUnknownFields(e)!=null)return babelHelpers["extends"]({},h("There are unknown fields in the integral"),{futureProof:c==null?void 0:c.futureProof});if(c!=null){b=c.applicationPayload;return b==null?h("There is no applicationPayload payload in the message transport"):{type:"applicationPayload",applicationPayload:b,skdm:j(a.ancillary),icdc:k(a.ancillary)}}e=j(a.ancillary);return e!=null?{type:"skdm",skdm:e,icdc:k(a.ancillary)}:{type:"unknown"}}function j(a){return a==null?null:a.skdm}function k(a){return a==null?null:a.icdc}g.parseMessageTransport=a}),98);
__d("MAWDbMetaTxns",["MAWTransactionMode","MAWTransactor","SignalDbTypes"],(function(a,b,c,d,e,f,g){"use strict";var h=d("MAWTransactor").makeSignalTransactor({meta:d("MAWTransactionMode").READWRITE},"saveCAT",function(a){return function(b){return a.meta.put({key:d("SignalDbTypes").MetaKeysEnum.cat,value:{cat:b}}).then(function(){return b})}});function a(a){return a.meta.get(d("SignalDbTypes").MetaKeysEnum.deviceUUID).then(function(a){return{deviceUUID:a==null?void 0:a.value.deviceUUID}})}function b(a){return a.meta.bulkGet([d("SignalDbTypes").MetaKeysEnum.lastSignedPrekeyId,d("SignalDbTypes").MetaKeysEnum.identityKeyPair]).then(function(a){var b=a[0];a=a[1];b=b==null?void 0:b.value.lastSignedPrekeyId;a=a==null?void 0:a.value.identityKeyPair;return{identityPair:a,keyId:b}})}function c(a){return a.meta.get(d("SignalDbTypes").MetaKeysEnum.lastPrekeyId).then(function(a){return a==null?void 0:a.value.lastPrekeyId})}function e(a){return a.meta.get(d("SignalDbTypes").MetaKeysEnum.lastPrekeyGenerationId).then(function(a){return a==null?void 0:a.value.lastPrekeyGenerationId})}function f(a){return a.meta.toArray()}g.saveCAT=h;g.getPushMetaData=a;g.maybeGetLastSignedPrekeyIdAndIdentity=b;g.maybeGetLastPrekeyId=c;g.maybeGetLastPrekeyGenerationId=e;g.getAllMeta=f}),98);
__d("MAWDeviceRegistrationTypes",[],(function(a,b,c,d,e,f){"use strict";a=25;b=7;c=100;d="https://reg-e2ee.facebook.com";e=d;var g="https://v.whatsapp.net",h="https://reg-e2ee.instagram.com",i="/v2/fb_icdc_fetch",j="/v2/fb_register_v2",k="Device has already been registered to WA servers",l="Device registration finished successfully",m="Device registration retries failed "+b+" times. No longer attempting registration.",n="Device registration response was null",o="Current user id is zero",p="CryptoAuthToken is empty",q="CryptoAuthToken is expired",r={failed:"failed",finished:"finished"};f.MAX_USERS_FOR_NOTIFY_DEVICE_CHANGE=a;f.MAX_DEVICE_REGISTRATION_RETRIES=b;f.MAX_ROTATE_CRYPTO_AUTH_TOKEN_RETRIES=c;f.REG_FB_DOMAIN=d;f.REG_MSGR_DOMAIN=e;f.REG_WA_DOMAIN=g;f.REG_IGD_DOMAIN=h;f.ICDC_ENDPOINT=i;f.REGISTRATION_ENDPOINT=j;f.DEVICE_ALREADY_REGISTERED=k;f.DEVICE_SUCCESSFULLY_REGISTERED=l;f.FAILED_REGISTRATION_RETRIES=m;f.NULL_RESPONSE_FROM_SERVER=n;f.DEVICE_REGISTER_ERROR_ZERO_AS_USER_ID=o;f.DEVICE_REGISTER_ERROR_EMPTY_CAT_TOKEN=p;f.DEVICE_REGISTER_ERROR_EXPIRED_CAT_TOKEN=q;f.RegistrationStatesEnum=r}),66);
__d("WARetryUtils",[],(function(a,b,c,d,e,f){"use strict";a={algo:{type:"adjust",backoff:{type:"fibonacci",first:1,second:1},toMs:function(a){return 1e3*(a+9)}},max:62e4};f.FIBONACCI_BACKOFF=a}),66);
__d("WADecodeIncomingMsg",["WALogger","WALongInt","WAMsgApplication.pb","WAMsgTransport.pb","WAParseMessageApplication","WAParseMessageTransport","WATimeUtils","decodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["decodeIncomingMsg called with unexpected encoding version: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["instamadillo decodeIncomingMsg called with null applicationPayload"]);i=function(){return a};return a}function j(a,b){return a.futureProof?{version:"v3",type:"futureProof",futureProof:a.futureProof,protobuf:b,subtype:null}:{version:"v3",type:"error",error:a.error}}function a(a,b,c,e){if(b==="v2")return{version:"v2",encoded:a};else if(b==="v3"){var f=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAMsgTransport.pb").MessageTransportSpec,a);f=d("WAParseMessageTransport").parseMessageTransport(f,c);if(f.type==="error")return j(f,a);if(f.type==="skdm")return k(f.skdm,f.icdc);else if(f.type==="applicationPayload"){if(e===!0){if(f.applicationPayload.payload==null){d("WALogger").DEV(i());return{version:"v3",type:"error",error:"instamadillo unhandled proto"}}return{version:"v3",type:"instamadillo",applicationPayload:new Uint8Array(f.applicationPayload.payload)}}c=l(f.applicationPayload,a,f.icdc);if(f.skdm!=null){e=k(f.skdm,f.icdc);return{version:"v3",type:"msgWithSKDM",msg:c,skdm:e}}return c}else{f.type;return{version:"v3",type:"error",error:"unhandled proto"}}}else{d("WALogger").DEV(h(),b);return{type:"error",version:"v3",error:"decodeIncomingMsg called with unexpected encoding version: "+b}}}function k(a,b){var c=a.axolotlSenderKeyDistributionMessage;a=a.groupId;if(c==null)return{type:"error",version:"v3",error:"parseSKDM called with null axolotlSenderKeyDistributionMessage"};else if(a==null)return{type:"error",version:"v3",error:"parseSKDM called with null groupId"};return{version:"v3",type:"skdm",msg:{senderKey:c,groupId:a},icdc:b}}function l(a,b,c){var e=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAMsgApplication.pb").MessageApplicationSpec,a.payload);if(e.payload==null)return m(e.metadata);var f=d("WAParseMessageApplication").parseMessageApplication(e);return f.type==="error"?j(f,b):{version:"v3",type:"subprotocol",metadata:(e=e.metadata)!=null?e:null,subprotocolType:f.subprotocolType,subprotocol:f.payload,protobuf:b,frankingContent:a.payload,icdc:c}}function m(a){a=a==null?void 0:a.chatEphemeralSetting;if(a!=null){var b=a.ephemeralExpiration,c=a.ephemeralSettingTimestamp;if(b==null)return{version:"v3",type:"error",error:"Ephemeral setting without expiration"};try{c=c!=null?d("WATimeUtils").castToUnixTime(d("WALongInt").numberOrThrowIfTooLarge(c)/1e3):d("WATimeUtils").DEFAULT_UNIXTIME;return{version:"v3",type:"ephemeral",ephemeralExpirationInSec:b,ephemeralLastUpdatedOrSetTimestamp:c,isEphemeralSettingReset:(c=a.isEphemeralSettingReset)!=null?c:!1}}catch(e){return{version:"v3",type:"ephemeral",ephemeralExpirationInSec:b,ephemeralLastUpdatedOrSetTimestamp:d("WATimeUtils").DEFAULT_UNIXTIME,isEphemeralSettingReset:(c=a.isEphemeralSettingReset)!=null?c:!1}}}else return{version:"v3",type:"error",error:"MessageApplication has no payload and is not ephemeral"}}g.decodeIncomingMsg=a}),98);
__d("WAAdv.pb",["$InternalEnum","WAProtoConst"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({E2EE:0,HOSTED:1});c={};e={};f={};b={};var h={};c.internalDefaults={accountType:a.E2EE};c.internalSpec={rawId:[1,(d=d("WAProtoConst")).TYPES.UINT32],timestamp:[2,d.TYPES.UINT64],currentIndex:[3,d.TYPES.UINT32],validIndexes:[4,d.FLAGS.REPEATED|d.FLAGS.PACKED|d.TYPES.UINT32],accountType:[5,d.TYPES.ENUM,a]};e.internalSpec={details:[1,d.TYPES.BYTES],accountSignature:[2,d.TYPES.BYTES],accountSignatureKey:[3,d.TYPES.BYTES]};f.internalDefaults={accountType:a.E2EE,deviceType:a.E2EE};f.internalSpec={rawId:[1,d.TYPES.UINT32],timestamp:[2,d.TYPES.UINT64],keyIndex:[3,d.TYPES.UINT32],accountType:[4,d.TYPES.ENUM,a],deviceType:[5,d.TYPES.ENUM,a]};b.internalSpec={details:[1,d.TYPES.BYTES],accountSignatureKey:[2,d.TYPES.BYTES],accountSignature:[3,d.TYPES.BYTES],deviceSignature:[4,d.TYPES.BYTES]};h.internalDefaults={accountType:a.E2EE};h.internalSpec={details:[1,d.TYPES.BYTES],hmac:[2,d.TYPES.BYTES],accountType:[3,d.TYPES.ENUM,a]};g.ADVEncryptionType=a;g.ADVKeyIndexListSpec=c;g.ADVSignedKeyIndexListSpec=e;g.ADVDeviceIdentitySpec=f;g.ADVSignedDeviceIdentitySpec=b;g.ADVSignedDeviceIdentityHMACSpec=h}),98);
__d("WAE2E.pb",["$InternalEnum","WAAdv.pb","WAMmsRetry.pb","WAProtoConst","WAProtocol.pb"],(function(a,b,c,d,e,f,g){var h,i;c=(a=b("$InternalEnum"))({MASK_LINKED_DEVICES:0});e=a({UNKNOWN:0,AUDIO:1,VIDEO:2});f=a({CONNECTED:0,MISSED:1,FAILED:2,REJECTED:3,ACCEPTED_ELSEWHERE:4,ONGOING:5,SILENCED_BY_DND:6,SILENCED_UNKNOWN_CALLER:7});b=a({REGULAR:0,SCHEDULED_CALL:1,VOICE_CHAT:2});var aa=a({UNKNOWN:0,CANCEL:1}),ba=a({UNKNOWN:0,VOICE:1,VIDEO:2}),ca=a({UNKNOWN:0,GOING:1,NOT_GOING:2}),da=a({UNKNOWN_TYPE:0,PIN_FOR_ALL:1,UNPIN_FOR_ALL:2}),ea=a({UNKNOWN:0,DISPLAY_TEXT:1}),fa=a({UNKNOWN:0,RESPONSE:1,NATIVE_FLOW:2}),ga=a({UNKNOWN:0,EMPTY:1,TEXT:2,DOCUMENT:3,IMAGE:4,VIDEO:5,LOCATION:6}),ha=a({UNKNOWN:0,EVENT_EDIT:1}),ia=a({DEFAULT:0,PARENT:1}),j=a({DEFAULT:0,EXTENSIONS_1:1}),ja=a({UNKNOWN_SURFACE:0,FB:1,IG:2,WA:3}),ka=a({UNKNOWN:0,SINGLE_SELECT:1}),la=a({UNKNOWN:0,SINGLE_SELECT:1,PRODUCT_LIST:2}),ma=a({CATALOG:1}),na=a({INQUIRY:1,ACCEPTED:2,DECLINED:3}),oa=a({UNKNOWN:0,FBPAY:1,NOVI:2,UPI:3}),pa=a({GREGORIAN:1,SOLAR_HIJRI:2}),qa=a({MONDAY:1,TUESDAY:2,WEDNESDAY:3,THURSDAY:4,FRIDAY:5,SATURDAY:6,SUNDAY:7}),k=a({UPLOAD_STICKER:0,SEND_RECENT_STICKER_BOOTSTRAP:1,GENERATE_LINK_PREVIEW:2,HISTORY_SYNC_ON_DEMAND:3,PLACEHOLDER_MESSAGE_RESEND:4}),ra=a({INITIAL_BOOTSTRAP:0,INITIAL_STATUS_V3:1,FULL:2,RECENT:3,PUSH_NAME:4,NON_BLOCKING_DATA:5,ON_DEMAND:6}),sa=a({EMPTY:0,NON_EMPTY:1}),ta=a({REVOKE:0,EPHEMERAL_SETTING:3,EPHEMERAL_SYNC_RESPONSE:4,HISTORY_SYNC_NOTIFICATION:5,APP_STATE_SYNC_KEY_SHARE:6,APP_STATE_SYNC_KEY_REQUEST:7,MSG_FANOUT_BACKFILL_REQUEST:8,INITIAL_SECURITY_NOTIFICATION_SETTING_SYNC:9,APP_STATE_FATAL_EXCEPTION_NOTIFICATION:10,SHARE_PHONE_NUMBER:11,MESSAGE_EDIT:14,PEER_DATA_OPERATION_REQUEST_MESSAGE:16,PEER_DATA_OPERATION_REQUEST_RESPONSE_MESSAGE:17,REQUEST_WELCOME_MESSAGE:18,BOT_FEEDBACK_MESSAGE:19,MEDIA_NOTIFY_MESSAGE:20}),ua=a({BOT_FEEDBACK_MULTIPLE_POSITIVE_GENERIC:1}),va=a({BOT_FEEDBACK_MULTIPLE_NEGATIVE_GENERIC:1,BOT_FEEDBACK_MULTIPLE_NEGATIVE_HELPFUL:2,BOT_FEEDBACK_MULTIPLE_NEGATIVE_INTERESTING:4,BOT_FEEDBACK_MULTIPLE_NEGATIVE_ACCURATE:8,BOT_FEEDBACK_MULTIPLE_NEGATIVE_SAFE:16,BOT_FEEDBACK_MULTIPLE_NEGATIVE_OTHER:32,BOT_FEEDBACK_MULTIPLE_NEGATIVE_REFUSED:64,BOT_FEEDBACK_MULTIPLE_NEGATIVE_NOT_VISUALLY_APPEALING:128,BOT_FEEDBACK_MULTIPLE_NEGATIVE_NOT_RELEVANT_TO_TEXT:256}),wa=a({BOT_FEEDBACK_POSITIVE:0,BOT_FEEDBACK_NEGATIVE_GENERIC:1,BOT_FEEDBACK_NEGATIVE_HELPFUL:2,BOT_FEEDBACK_NEGATIVE_INTERESTING:3,BOT_FEEDBACK_NEGATIVE_ACCURATE:4,BOT_FEEDBACK_NEGATIVE_SAFE:5,BOT_FEEDBACK_NEGATIVE_OTHER:6,BOT_FEEDBACK_NEGATIVE_REFUSED:7,BOT_FEEDBACK_NEGATIVE_NOT_VISUALLY_APPEALING:8,BOT_FEEDBACK_NEGATIVE_NOT_RELEVANT_TO_TEXT:9}),xa=a({NONE:0,GIPHY:1,TENOR:2}),l=a({DEFAULT:0,PARENT:1,SUB:2,DEFAULT_SUB:3}),ya=a({NONE:0,VIDEO:1,PLACEHOLDER:4,IMAGE:5}),za=a({SYSTEM:0,SYSTEM_TEXT:1,FB_SCRIPT:2,SYSTEM_BOLD:6,MORNINGBREEZE_REGULAR:7,CALISTOGA_REGULAR:8,EXO2_EXTRABOLD:9,COURIERPRIME_BOLD:10}),Aa=a({IMAGE:0,PDF:1}),Ba=a({USER_IMAGE:0,AI_GENERATED:1,AI_MODIFIED:2}),Ca=a({UPDATE:1,UPDATE_CARD:2,LINK_CARD:3}),Da=a({NONE:0,IMAGE:1,VIDEO:2}),Ea=a({NONE:0,IMAGE:1,VIDEO:2}),Fa=a({REELS:1,SEARCH:2}),Ga=a({BING:1,GOOGLE:2}),Ha=a({FULL:1,TALL:2,COMPACT:3}),Ia=a({UNKNOWN:0,DEFAULT:1}),Ja=a({UNKNOWN:0,CHAT_SETTING:1,ACCOUNT_SETTING:2,BULK_CHANGE:3,BIZ_SUPPORTS_FB_HOSTING:4}),Ka=a({CHANGED_IN_CHAT:0,INITIATED_BY_ME:1,INITIATED_BY_OTHER:2,BIZ_UPGRADE_FB_HOSTING:3});a=a({UNKNOWN:0,KEEP_FOR_ALL:1,UNDO_KEEP_FOR_ALL:2});var m={},n={},o={},p={},q={},r={},s={},t={},La={},u={},v={},w={},x={},y={},Ma={},Na={},Oa={},Pa={},Qa={},Ra={},z={},Sa={},Ta={},Ua={},Va={},Wa={},Xa={},Ya={},Za={},$a={},A={},ab={},bb={},cb={},db={},eb={},B={},C={},D={},E={},F={},fb={},G={},H={},gb={},hb={},ib={},jb={},kb={},lb={},mb={},nb={},ob={},pb={},qb={},rb={},I={},J={},sb={},tb={},ub={},K={},L={},vb={},M={},wb={},xb={},yb={},zb={},Ab={},Bb={},N={},Cb={},Db={},Eb={},Fb={},Gb={},Hb={},Ib={},Jb={},Kb={},Lb={},Mb={},Nb={},Ob={},Pb={},Qb={},Rb={},Sb={},Tb={},Ub={},Vb={},Wb={},Xb={},O={},Yb={},Zb={},$b={},ac={},bc={},cc={},dc={},P={},ec={},Q={},fc={},R={},S={},gc={},T={},U={},V={},hc={},W={},ic={},jc={},kc={},lc={},mc={},nc={},oc={},pc={},qc={},rc={},X={},Y={},sc={},tc={},uc={},vc={},wc={},xc={},yc={},zc={},Ac={},Bc={},Cc={},Z={},Dc={},$={},Ec={},Fc={},Gc={},Hc={};m.internalSpec={conversation:[1,(h=d("WAProtoConst")).TYPES.STRING],senderKeyDistributionMessage:[2,h.TYPES.MESSAGE,U],imageMessage:[3,h.TYPES.MESSAGE,T],contactMessage:[4,h.TYPES.MESSAGE,S],locationMessage:[5,h.TYPES.MESSAGE,R],extendedTextMessage:[6,h.TYPES.MESSAGE,fc],documentMessage:[7,h.TYPES.MESSAGE,Q],audioMessage:[8,h.TYPES.MESSAGE,ec],videoMessage:[9,h.TYPES.MESSAGE,P],call:[10,h.TYPES.MESSAGE,dc],chat:[11,h.TYPES.MESSAGE,cc],protocolMessage:[12,h.TYPES.MESSAGE,ac],contactsArrayMessage:[13,h.TYPES.MESSAGE,Hb],highlyStructuredMessage:[14,h.TYPES.MESSAGE,N],fastRatchetKeySenderKeyDistributionMessage:[15,h.TYPES.MESSAGE,U],sendPaymentMessage:[16,h.TYPES.MESSAGE,Bb],liveLocationMessage:[18,h.TYPES.MESSAGE,wb],requestPaymentMessage:[22,h.TYPES.MESSAGE,Ab],declinePaymentRequestMessage:[23,h.TYPES.MESSAGE,zb],cancelPaymentRequestMessage:[24,h.TYPES.MESSAGE,yb],templateMessage:[25,h.TYPES.MESSAGE,K],stickerMessage:[26,h.TYPES.MESSAGE,M],groupInviteMessage:[28,h.TYPES.MESSAGE,db],templateButtonReplyMessage:[29,h.TYPES.MESSAGE,ub],productMessage:[30,h.TYPES.MESSAGE,J],deviceSentMessage:[31,h.TYPES.MESSAGE,ab],messageContextInfo:[35,h.TYPES.MESSAGE,rc],listMessage:[36,h.TYPES.MESSAGE,lb],viewOnceMessage:[37,h.TYPES.MESSAGE,A],orderMessage:[38,h.TYPES.MESSAGE,I],listResponseMessage:[39,h.TYPES.MESSAGE,jb],ephemeralMessage:[40,h.TYPES.MESSAGE,A],invoiceMessage:[41,h.TYPES.MESSAGE,gc],buttonsMessage:[42,h.TYPES.MESSAGE,Wa],buttonsResponseMessage:[43,h.TYPES.MESSAGE,Va],paymentInviteMessage:[44,h.TYPES.MESSAGE,xb],interactiveMessage:[45,h.TYPES.MESSAGE,D],reactionMessage:[46,h.TYPES.MESSAGE,Ua],stickerSyncRmrMessage:[47,h.TYPES.MESSAGE,Ta],interactiveResponseMessage:[48,h.TYPES.MESSAGE,eb],pollCreationMessage:[49,h.TYPES.MESSAGE,z],pollUpdateMessage:[50,h.TYPES.MESSAGE,Ra],keepInChatMessage:[51,h.TYPES.MESSAGE,Na],documentWithCaptionMessage:[53,h.TYPES.MESSAGE,A],requestPhoneNumberMessage:[54,h.TYPES.MESSAGE,bb],viewOnceMessageV2:[55,h.TYPES.MESSAGE,A],encReactionMessage:[56,h.TYPES.MESSAGE,y],editedMessage:[58,h.TYPES.MESSAGE,A],viewOnceMessageV2Extension:[59,h.TYPES.MESSAGE,A],pollCreationMessageV2:[60,h.TYPES.MESSAGE,z],scheduledCallCreationMessage:[61,h.TYPES.MESSAGE,t],groupMentionedMessage:[62,h.TYPES.MESSAGE,A],pinInChatMessage:[63,h.TYPES.MESSAGE,Ma],pollCreationMessageV3:[64,h.TYPES.MESSAGE,z],scheduledCallEditMessage:[65,h.TYPES.MESSAGE,s],ptvMessage:[66,h.TYPES.MESSAGE,P],botInvokeMessage:[67,h.TYPES.MESSAGE,A],callLogMesssage:[69,h.TYPES.MESSAGE,q],messageHistoryBundle:[70,h.TYPES.MESSAGE,p],encCommentMessage:[71,h.TYPES.MESSAGE,x],bcallMessage:[72,h.TYPES.MESSAGE,o],lottieStickerMessage:[74,h.TYPES.MESSAGE,A],eventMessage:[75,h.TYPES.MESSAGE,v],encEventResponseMessage:[76,h.TYPES.MESSAGE,u],commentMessage:[77,h.TYPES.MESSAGE,w],newsletterAdminInviteMessage:[78,h.TYPES.MESSAGE,cb],placeholderMessage:[80,h.TYPES.MESSAGE,n],secretEncryptedMessage:[82,h.TYPES.MESSAGE,$a]};n.internalSpec={type:[1,h.TYPES.ENUM,c]};o.internalSpec={sessionId:[1,h.TYPES.STRING],mediaType:[2,h.TYPES.ENUM,e],masterKey:[3,h.TYPES.BYTES],caption:[4,h.TYPES.STRING]};p.internalSpec={mimetype:[2,h.TYPES.STRING],fileSha256:[3,h.TYPES.BYTES],mediaKey:[5,h.TYPES.BYTES],fileEncSha256:[6,h.TYPES.BYTES],directPath:[7,h.TYPES.STRING],mediaKeyTimestamp:[8,h.TYPES.INT64],contextInfo:[9,h.TYPES.MESSAGE,V],participants:[10,h.FLAGS.REPEATED|h.TYPES.STRING]};q.internalSpec={isVideo:[1,h.TYPES.BOOL],callOutcome:[2,h.TYPES.ENUM,f],durationSecs:[3,h.TYPES.INT64],callType:[4,h.TYPES.ENUM,b],participants:[5,h.FLAGS.REPEATED|h.TYPES.MESSAGE,r]};r.internalSpec={jid:[1,h.TYPES.STRING],callOutcome:[2,h.TYPES.ENUM,f]};s.internalSpec={key:[1,h.TYPES.MESSAGE,(i=d("WAProtocol.pb")).MessageKeySpec],editType:[2,h.TYPES.ENUM,aa]};t.internalSpec={scheduledTimestampMs:[1,h.TYPES.INT64],callType:[2,h.TYPES.ENUM,ba],title:[3,h.TYPES.STRING]};La.internalSpec={response:[1,h.TYPES.ENUM,ca],timestampMs:[2,h.TYPES.INT64]};u.internalSpec={eventCreationMessageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec],encPayload:[2,h.TYPES.BYTES],encIv:[3,h.TYPES.BYTES]};v.internalSpec={contextInfo:[1,h.TYPES.MESSAGE,V],isCanceled:[2,h.TYPES.BOOL],name:[3,h.TYPES.STRING],description:[4,h.TYPES.STRING],location:[5,h.TYPES.MESSAGE,R],joinLink:[6,h.TYPES.STRING],startTime:[7,h.TYPES.INT64]};w.internalSpec={message:[1,h.TYPES.MESSAGE,m],targetMessageKey:[2,h.TYPES.MESSAGE,i.MessageKeySpec]};x.internalSpec={targetMessageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec],encPayload:[2,h.TYPES.BYTES],encIv:[3,h.TYPES.BYTES]};y.internalSpec={targetMessageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec],encPayload:[2,h.TYPES.BYTES],encIv:[3,h.TYPES.BYTES]};Ma.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec],type:[2,h.TYPES.ENUM,da],senderTimestampMs:[3,h.TYPES.INT64]};Na.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec],keepType:[2,h.TYPES.ENUM,a],timestampMs:[3,h.TYPES.INT64]};Oa.internalSpec={selectedOptions:[1,h.FLAGS.REPEATED|h.TYPES.BYTES]};Pa.internalSpec={encPayload:[1,h.TYPES.BYTES],encIv:[2,h.TYPES.BYTES]};Qa.internalSpec={};Ra.internalSpec={pollCreationMessageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec],vote:[2,h.TYPES.MESSAGE,Pa],metadata:[3,h.TYPES.MESSAGE,Qa],senderTimestampMs:[4,h.TYPES.INT64]};z.internalSpec={encKey:[1,h.TYPES.BYTES],name:[2,h.TYPES.STRING],options:[3,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Sa],selectableOptionsCount:[4,h.TYPES.UINT32],contextInfo:[5,h.TYPES.MESSAGE,V]};Sa.internalSpec={optionName:[1,h.TYPES.STRING]};Ta.internalSpec={filehash:[1,h.FLAGS.REPEATED|h.TYPES.STRING],rmrSource:[2,h.TYPES.STRING],requestTimestamp:[3,h.TYPES.INT64]};Ua.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec],text:[2,h.TYPES.STRING],groupingKey:[3,h.TYPES.STRING],senderTimestampMs:[4,h.TYPES.INT64]};Va.internalSpec={selectedButtonId:[1,h.TYPES.STRING],selectedDisplayText:[2,h.TYPES.STRING],contextInfo:[3,h.TYPES.MESSAGE,V],type:[4,h.TYPES.ENUM,ea],__oneofs__:{response:["selectedDisplayText"]}};Wa.internalSpec={text:[1,h.TYPES.STRING],documentMessage:[2,h.TYPES.MESSAGE,Q],imageMessage:[3,h.TYPES.MESSAGE,T],videoMessage:[4,h.TYPES.MESSAGE,P],locationMessage:[5,h.TYPES.MESSAGE,R],contentText:[6,h.TYPES.STRING],footerText:[7,h.TYPES.STRING],contextInfo:[8,h.TYPES.MESSAGE,V],buttons:[9,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Xa],headerType:[10,h.TYPES.ENUM,ga],__oneofs__:{header:["text","documentMessage","imageMessage","videoMessage","locationMessage"]}};Xa.internalSpec={buttonId:[1,h.TYPES.STRING],buttonText:[2,h.TYPES.MESSAGE,Za],type:[3,h.TYPES.ENUM,fa],nativeFlowInfo:[4,h.TYPES.MESSAGE,Ya]};Ya.internalSpec={name:[1,h.TYPES.STRING],paramsJson:[2,h.TYPES.STRING]};Za.internalSpec={displayText:[1,h.TYPES.STRING]};$a.internalSpec={targetMessageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec],encPayload:[2,h.TYPES.BYTES],encIv:[3,h.TYPES.BYTES],secretEncType:[4,h.TYPES.ENUM,ha]};A.internalSpec={message:[1,h.TYPES.MESSAGE,m]};ab.internalSpec={destinationJid:[1,h.TYPES.STRING],message:[2,h.TYPES.MESSAGE,m],phash:[3,h.TYPES.STRING]};bb.internalSpec={contextInfo:[1,h.TYPES.MESSAGE,V]};cb.internalSpec={newsletterJid:[1,h.TYPES.STRING],newsletterName:[2,h.TYPES.STRING],jpegThumbnail:[3,h.TYPES.BYTES],caption:[4,h.TYPES.STRING],inviteExpiration:[5,h.TYPES.INT64],contextInfo:[6,h.TYPES.MESSAGE,V]};db.internalSpec={groupJid:[1,h.TYPES.STRING],inviteCode:[2,h.TYPES.STRING],inviteExpiration:[3,h.TYPES.INT64],groupName:[4,h.TYPES.STRING],jpegThumbnail:[5,h.TYPES.BYTES],caption:[6,h.TYPES.STRING],contextInfo:[7,h.TYPES.MESSAGE,V],groupType:[8,h.TYPES.ENUM,ia]};eb.internalSpec={body:[1,h.TYPES.MESSAGE,C],nativeFlowResponseMessage:[2,h.TYPES.MESSAGE,B],contextInfo:[15,h.TYPES.MESSAGE,V],__oneofs__:{interactiveResponseMessage:["nativeFlowResponseMessage"]}};B.internalDefaults={version:1};B.internalSpec={name:[1,h.TYPES.STRING],paramsJson:[2,h.TYPES.STRING],version:[3,h.TYPES.INT32]};C.internalDefaults={format:j.DEFAULT};C.internalSpec={text:[1,h.TYPES.STRING],format:[2,h.TYPES.ENUM,j]};D.internalSpec={header:[1,h.TYPES.MESSAGE,ib],body:[2,h.TYPES.MESSAGE,hb],footer:[3,h.TYPES.MESSAGE,gb],shopStorefrontMessage:[4,h.TYPES.MESSAGE,H],collectionMessage:[5,h.TYPES.MESSAGE,G],nativeFlowMessage:[6,h.TYPES.MESSAGE,F],carouselMessage:[7,h.TYPES.MESSAGE,E],contextInfo:[15,h.TYPES.MESSAGE,V],__oneofs__:{interactiveMessage:["shopStorefrontMessage","collectionMessage","nativeFlowMessage","carouselMessage"]}};E.internalDefaults={messageVersion:1};E.internalSpec={cards:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,D],messageVersion:[2,h.TYPES.INT32]};F.internalDefaults={messageVersion:1};F.internalSpec={buttons:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,fb],messageParamsJson:[2,h.TYPES.STRING],messageVersion:[3,h.TYPES.INT32]};fb.internalSpec={name:[1,h.TYPES.STRING],buttonParamsJson:[2,h.TYPES.STRING]};G.internalDefaults={messageVersion:1};G.internalSpec={bizJid:[1,h.TYPES.STRING],id:[2,h.TYPES.STRING],messageVersion:[3,h.TYPES.INT32]};H.internalDefaults={messageVersion:1};H.internalSpec={id:[1,h.TYPES.STRING],surface:[2,h.TYPES.ENUM,ja],messageVersion:[3,h.TYPES.INT32]};gb.internalSpec={text:[1,h.TYPES.STRING]};hb.internalSpec={text:[1,h.TYPES.STRING]};ib.internalSpec={title:[1,h.TYPES.STRING],subtitle:[2,h.TYPES.STRING],documentMessage:[3,h.TYPES.MESSAGE,Q],imageMessage:[4,h.TYPES.MESSAGE,T],jpegThumbnail:[6,h.TYPES.BYTES],videoMessage:[7,h.TYPES.MESSAGE,P],locationMessage:[8,h.TYPES.MESSAGE,R],productMessage:[9,h.TYPES.MESSAGE,J],hasMediaAttachment:[5,h.TYPES.BOOL],__oneofs__:{media:["documentMessage","imageMessage","jpegThumbnail","videoMessage","locationMessage","productMessage"]}};jb.internalSpec={title:[1,h.TYPES.STRING],listType:[2,h.TYPES.ENUM,ka],singleSelectReply:[3,h.TYPES.MESSAGE,kb],contextInfo:[4,h.TYPES.MESSAGE,V],description:[5,h.TYPES.STRING]};kb.internalSpec={selectedRowId:[1,h.TYPES.STRING]};lb.internalSpec={title:[1,h.TYPES.STRING],description:[2,h.TYPES.STRING],buttonText:[3,h.TYPES.STRING],listType:[4,h.TYPES.ENUM,la],sections:[5,h.FLAGS.REPEATED|h.TYPES.MESSAGE,qb],productListInfo:[6,h.TYPES.MESSAGE,mb],footerText:[7,h.TYPES.STRING],contextInfo:[8,h.TYPES.MESSAGE,V]};mb.internalSpec={productSections:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,ob],headerImage:[2,h.TYPES.MESSAGE,nb],businessOwnerJid:[3,h.TYPES.STRING]};nb.internalSpec={productId:[1,h.TYPES.STRING],jpegThumbnail:[2,h.TYPES.BYTES]};ob.internalSpec={title:[1,h.TYPES.STRING],products:[2,h.FLAGS.REPEATED|h.TYPES.MESSAGE,pb]};pb.internalSpec={productId:[1,h.TYPES.STRING]};qb.internalSpec={title:[1,h.TYPES.STRING],rows:[2,h.FLAGS.REPEATED|h.TYPES.MESSAGE,rb]};rb.internalSpec={title:[1,h.TYPES.STRING],description:[2,h.TYPES.STRING],rowId:[3,h.TYPES.STRING]};I.internalDefaults={messageVersion:1};I.internalSpec={orderId:[1,h.TYPES.STRING],thumbnail:[2,h.TYPES.BYTES],itemCount:[3,h.TYPES.INT32],status:[4,h.TYPES.ENUM,na],surface:[5,h.TYPES.ENUM,ma],message:[6,h.TYPES.STRING],orderTitle:[7,h.TYPES.STRING],sellerJid:[8,h.TYPES.STRING],token:[9,h.TYPES.STRING],totalAmount1000:[10,h.TYPES.INT64],totalCurrencyCode:[11,h.TYPES.STRING],contextInfo:[17,h.TYPES.MESSAGE,V],messageVersion:[12,h.TYPES.INT32],orderRequestMessageId:[13,h.TYPES.MESSAGE,i.MessageKeySpec]};J.internalSpec={product:[1,h.TYPES.MESSAGE,sb],businessOwnerJid:[2,h.TYPES.STRING],catalog:[4,h.TYPES.MESSAGE,tb],body:[5,h.TYPES.STRING],footer:[6,h.TYPES.STRING],contextInfo:[17,h.TYPES.MESSAGE,V]};sb.internalSpec={productImage:[1,h.TYPES.MESSAGE,T],productId:[2,h.TYPES.STRING],title:[3,h.TYPES.STRING],description:[4,h.TYPES.STRING],currencyCode:[5,h.TYPES.STRING],priceAmount1000:[6,h.TYPES.INT64],retailerId:[7,h.TYPES.STRING],url:[8,h.TYPES.STRING],productImageCount:[9,h.TYPES.UINT32],firstImageId:[11,h.TYPES.STRING],salePriceAmount1000:[12,h.TYPES.INT64]};tb.internalSpec={catalogImage:[1,h.TYPES.MESSAGE,T],title:[2,h.TYPES.STRING],description:[3,h.TYPES.STRING]};ub.internalSpec={selectedId:[1,h.TYPES.STRING],selectedDisplayText:[2,h.TYPES.STRING],contextInfo:[3,h.TYPES.MESSAGE,V],selectedIndex:[4,h.TYPES.UINT32],selectedCarouselCardIndex:[5,h.TYPES.UINT32]};K.internalSpec={fourRowTemplate:[1,h.TYPES.MESSAGE,vb],hydratedFourRowTemplate:[2,h.TYPES.MESSAGE,L],interactiveMessageTemplate:[5,h.TYPES.MESSAGE,D],contextInfo:[3,h.TYPES.MESSAGE,V],hydratedTemplate:[4,h.TYPES.MESSAGE,L],templateId:[9,h.TYPES.STRING],__oneofs__:{format:["fourRowTemplate","hydratedFourRowTemplate","interactiveMessageTemplate"]}};L.internalSpec={documentMessage:[1,h.TYPES.MESSAGE,Q],hydratedTitleText:[2,h.TYPES.STRING],imageMessage:[3,h.TYPES.MESSAGE,T],videoMessage:[4,h.TYPES.MESSAGE,P],locationMessage:[5,h.TYPES.MESSAGE,R],hydratedContentText:[6,h.TYPES.STRING],hydratedFooterText:[7,h.TYPES.STRING],hydratedButtons:[8,h.FLAGS.REPEATED|h.TYPES.MESSAGE,yc],templateId:[9,h.TYPES.STRING],maskLinkedDevices:[10,h.TYPES.BOOL],__oneofs__:{title:["documentMessage","hydratedTitleText","imageMessage","videoMessage","locationMessage"]}};vb.internalSpec={documentMessage:[1,h.TYPES.MESSAGE,Q],highlyStructuredMessage:[2,h.TYPES.MESSAGE,N],imageMessage:[3,h.TYPES.MESSAGE,T],videoMessage:[4,h.TYPES.MESSAGE,P],locationMessage:[5,h.TYPES.MESSAGE,R],content:[6,h.TYPES.MESSAGE,N],footer:[7,h.TYPES.MESSAGE,N],buttons:[8,h.FLAGS.REPEATED|h.TYPES.MESSAGE,uc],__oneofs__:{title:["documentMessage","highlyStructuredMessage","imageMessage","videoMessage","locationMessage"]}};M.internalSpec={url:[1,h.TYPES.STRING],fileSha256:[2,h.TYPES.BYTES],fileEncSha256:[3,h.TYPES.BYTES],mediaKey:[4,h.TYPES.BYTES],mimetype:[5,h.TYPES.STRING],height:[6,h.TYPES.UINT32],width:[7,h.TYPES.UINT32],directPath:[8,h.TYPES.STRING],fileLength:[9,h.TYPES.UINT64],mediaKeyTimestamp:[10,h.TYPES.INT64],firstFrameLength:[11,h.TYPES.UINT32],firstFrameSidecar:[12,h.TYPES.BYTES],isAnimated:[13,h.TYPES.BOOL],pngThumbnail:[16,h.TYPES.BYTES],contextInfo:[17,h.TYPES.MESSAGE,V],stickerSentTs:[18,h.TYPES.INT64],isAvatar:[19,h.TYPES.BOOL],isAiSticker:[20,h.TYPES.BOOL],isLottie:[21,h.TYPES.BOOL]};wb.internalSpec={degreesLatitude:[1,h.TYPES.DOUBLE],degreesLongitude:[2,h.TYPES.DOUBLE],accuracyInMeters:[3,h.TYPES.UINT32],speedInMps:[4,h.TYPES.FLOAT],degreesClockwiseFromMagneticNorth:[5,h.TYPES.UINT32],caption:[6,h.TYPES.STRING],sequenceNumber:[7,h.TYPES.INT64],timeOffset:[8,h.TYPES.UINT32],jpegThumbnail:[16,h.TYPES.BYTES],contextInfo:[17,h.TYPES.MESSAGE,V]};xb.internalSpec={serviceType:[1,h.TYPES.ENUM,oa],expiryTimestamp:[2,h.TYPES.INT64]};yb.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec]};zb.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec]};Ab.internalSpec={noteMessage:[4,h.TYPES.MESSAGE,m],currencyCodeIso4217:[1,h.TYPES.STRING],amount1000:[2,h.TYPES.UINT64],requestFrom:[3,h.TYPES.STRING],expiryTimestamp:[5,h.TYPES.INT64],amount:[6,h.TYPES.MESSAGE,Cc],background:[7,h.TYPES.MESSAGE,Z]};Bb.internalSpec={noteMessage:[2,h.TYPES.MESSAGE,m],requestMessageKey:[3,h.TYPES.MESSAGE,i.MessageKeySpec],background:[4,h.TYPES.MESSAGE,Z]};N.internalSpec={namespace:[1,h.TYPES.STRING],elementName:[2,h.TYPES.STRING],params:[3,h.FLAGS.REPEATED|h.TYPES.STRING],fallbackLg:[4,h.TYPES.STRING],fallbackLc:[5,h.TYPES.STRING],localizableParams:[6,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Cb],deterministicLg:[7,h.TYPES.STRING],deterministicLc:[8,h.TYPES.STRING],hydratedHsm:[9,h.TYPES.MESSAGE,K]};Cb.internalSpec={"default":[1,h.TYPES.STRING],currency:[2,h.TYPES.MESSAGE,Gb],dateTime:[3,h.TYPES.MESSAGE,Db],__oneofs__:{paramOneof:["currency","dateTime"]}};Db.internalSpec={component:[1,h.TYPES.MESSAGE,Fb],unixEpoch:[2,h.TYPES.MESSAGE,Eb],__oneofs__:{datetimeOneof:["component","unixEpoch"]}};Eb.internalSpec={timestamp:[1,h.TYPES.INT64]};Fb.internalSpec={dayOfWeek:[1,h.TYPES.ENUM,qa],year:[2,h.TYPES.UINT32],month:[3,h.TYPES.UINT32],dayOfMonth:[4,h.TYPES.UINT32],hour:[5,h.TYPES.UINT32],minute:[6,h.TYPES.UINT32],calendar:[7,h.TYPES.ENUM,pa]};Gb.internalSpec={currencyCode:[1,h.TYPES.STRING],amount1000:[2,h.TYPES.INT64]};Hb.internalSpec={displayName:[1,h.TYPES.STRING],contacts:[2,h.FLAGS.REPEATED|h.TYPES.MESSAGE,S],contextInfo:[17,h.TYPES.MESSAGE,V]};Ib.internalSpec={securityNotificationEnabled:[1,h.TYPES.BOOL]};Jb.internalSpec={peerDataOperationRequestType:[1,h.TYPES.ENUM,k],stanzaId:[2,h.TYPES.STRING],peerDataOperationResult:[3,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Kb]};Kb.internalSpec={mediaUploadResult:[1,h.TYPES.ENUM,d("WAMmsRetry.pb").MediaRetryNotification$ResultType],stickerMessage:[2,h.TYPES.MESSAGE,M],linkPreviewResponse:[3,h.TYPES.MESSAGE,Mb],placeholderMessageResendResponse:[4,h.TYPES.MESSAGE,Lb]};Lb.internalSpec={webMessageInfoBytes:[1,h.TYPES.BYTES]};Mb.internalSpec={url:[1,h.TYPES.STRING],title:[2,h.TYPES.STRING],description:[3,h.TYPES.STRING],thumbData:[4,h.TYPES.BYTES],canonicalUrl:[5,h.TYPES.STRING],matchText:[6,h.TYPES.STRING],previewType:[7,h.TYPES.STRING],hqThumbnail:[8,h.TYPES.MESSAGE,Nb]};Nb.internalSpec={directPath:[1,h.TYPES.STRING],thumbHash:[2,h.TYPES.STRING],encThumbHash:[3,h.TYPES.STRING],mediaKey:[4,h.TYPES.BYTES],mediaKeyTimestampMs:[5,h.TYPES.INT64],thumbWidth:[6,h.TYPES.INT32],thumbHeight:[7,h.TYPES.INT32]};Ob.internalSpec={peerDataOperationRequestType:[1,h.TYPES.ENUM,k],requestStickerReupload:[2,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Sb],requestUrlPreview:[3,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Rb],historySyncOnDemandRequest:[4,h.TYPES.MESSAGE,Qb],placeholderMessageResendRequest:[5,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Pb]};Pb.internalSpec={messageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec]};Qb.internalSpec={chatJid:[1,h.TYPES.STRING],oldestMsgId:[2,h.TYPES.STRING],oldestMsgFromMe:[3,h.TYPES.BOOL],onDemandMsgCount:[4,h.TYPES.INT32],oldestMsgTimestampMs:[5,h.TYPES.INT64]};Rb.internalSpec={url:[1,h.TYPES.STRING],includeHqThumbnail:[2,h.TYPES.BOOL]};Sb.internalSpec={fileSha256:[1,h.TYPES.STRING]};Tb.internalSpec={collectionNames:[1,h.FLAGS.REPEATED|h.TYPES.STRING],timestamp:[2,h.TYPES.INT64]};Ub.internalSpec={keyIds:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,O]};Vb.internalSpec={keys:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Yb]};Wb.internalSpec={keyData:[1,h.TYPES.BYTES],fingerprint:[2,h.TYPES.MESSAGE,Xb],timestamp:[3,h.TYPES.INT64]};Xb.internalSpec={rawId:[1,h.TYPES.UINT32],currentIndex:[2,h.TYPES.UINT32],deviceIndexes:[3,h.FLAGS.REPEATED|h.FLAGS.PACKED|h.TYPES.UINT32]};O.internalSpec={keyId:[1,h.TYPES.BYTES]};Yb.internalSpec={keyId:[1,h.TYPES.MESSAGE,O],keyData:[2,h.TYPES.MESSAGE,Wb]};Zb.internalSpec={fileSha256:[1,h.TYPES.BYTES],fileLength:[2,h.TYPES.UINT64],mediaKey:[3,h.TYPES.BYTES],fileEncSha256:[4,h.TYPES.BYTES],directPath:[5,h.TYPES.STRING],syncType:[6,h.TYPES.ENUM,ra],chunkOrder:[7,h.TYPES.UINT32],originalMessageId:[8,h.TYPES.STRING],progress:[9,h.TYPES.UINT32],oldestMsgInChunkTimestampSec:[10,h.TYPES.INT64],initialHistBootstrapInlinePayload:[11,h.TYPES.BYTES],peerDataRequestSessionId:[12,h.TYPES.STRING]};$b.internalSpec={localChatState:[1,h.TYPES.ENUM,sa]};ac.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec],type:[2,h.TYPES.ENUM,ta],ephemeralExpiration:[4,h.TYPES.UINT32],ephemeralSettingTimestamp:[5,h.TYPES.INT64],historySyncNotification:[6,h.TYPES.MESSAGE,Zb],appStateSyncKeyShare:[7,h.TYPES.MESSAGE,Vb],appStateSyncKeyRequest:[8,h.TYPES.MESSAGE,Ub],initialSecurityNotificationSettingSync:[9,h.TYPES.MESSAGE,Ib],appStateFatalExceptionNotification:[10,h.TYPES.MESSAGE,Tb],disappearingMode:[11,h.TYPES.MESSAGE,$],editedMessage:[14,h.TYPES.MESSAGE,m],timestampMs:[15,h.TYPES.INT64],peerDataOperationRequestMessage:[16,h.TYPES.MESSAGE,Ob],peerDataOperationRequestResponseMessage:[17,h.TYPES.MESSAGE,Jb],botFeedbackMessage:[18,h.TYPES.MESSAGE,bc],invokerJid:[19,h.TYPES.STRING],requestWelcomeMessageMetadata:[20,h.TYPES.MESSAGE,$b],mediaNotifyMessage:[21,h.TYPES.MESSAGE,Hc]};bc.internalSpec={messageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec],kind:[2,h.TYPES.ENUM,wa],text:[3,h.TYPES.STRING],kindNegative:[4,h.TYPES.UINT64],kindPositive:[5,h.TYPES.UINT64]};cc.internalSpec={displayName:[1,h.TYPES.STRING],id:[2,h.TYPES.STRING]};dc.internalSpec={callKey:[1,h.TYPES.BYTES],conversionSource:[2,h.TYPES.STRING],conversionData:[3,h.TYPES.BYTES],conversionDelaySeconds:[4,h.TYPES.UINT32]};P.internalSpec={url:[1,h.TYPES.STRING],mimetype:[2,h.TYPES.STRING],fileSha256:[3,h.TYPES.BYTES],fileLength:[4,h.TYPES.UINT64],seconds:[5,h.TYPES.UINT32],mediaKey:[6,h.TYPES.BYTES],caption:[7,h.TYPES.STRING],gifPlayback:[8,h.TYPES.BOOL],height:[9,h.TYPES.UINT32],width:[10,h.TYPES.UINT32],fileEncSha256:[11,h.TYPES.BYTES],interactiveAnnotations:[12,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Y],directPath:[13,h.TYPES.STRING],mediaKeyTimestamp:[14,h.TYPES.INT64],jpegThumbnail:[16,h.TYPES.BYTES],contextInfo:[17,h.TYPES.MESSAGE,V],streamingSidecar:[18,h.TYPES.BYTES],gifAttribution:[19,h.TYPES.ENUM,xa],viewOnce:[20,h.TYPES.BOOL],thumbnailDirectPath:[21,h.TYPES.STRING],thumbnailSha256:[22,h.TYPES.BYTES],thumbnailEncSha256:[23,h.TYPES.BYTES],staticUrl:[24,h.TYPES.STRING],annotations:[25,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Y]};ec.internalSpec={url:[1,h.TYPES.STRING],mimetype:[2,h.TYPES.STRING],fileSha256:[3,h.TYPES.BYTES],fileLength:[4,h.TYPES.UINT64],seconds:[5,h.TYPES.UINT32],ptt:[6,h.TYPES.BOOL],mediaKey:[7,h.TYPES.BYTES],fileEncSha256:[8,h.TYPES.BYTES],directPath:[9,h.TYPES.STRING],mediaKeyTimestamp:[10,h.TYPES.INT64],contextInfo:[17,h.TYPES.MESSAGE,V],streamingSidecar:[18,h.TYPES.BYTES],waveform:[19,h.TYPES.BYTES],backgroundArgb:[20,h.TYPES.FIXED32],viewOnce:[21,h.TYPES.BOOL]};Q.internalSpec={url:[1,h.TYPES.STRING],mimetype:[2,h.TYPES.STRING],title:[3,h.TYPES.STRING],fileSha256:[4,h.TYPES.BYTES],fileLength:[5,h.TYPES.UINT64],pageCount:[6,h.TYPES.UINT32],mediaKey:[7,h.TYPES.BYTES],fileName:[8,h.TYPES.STRING],fileEncSha256:[9,h.TYPES.BYTES],directPath:[10,h.TYPES.STRING],mediaKeyTimestamp:[11,h.TYPES.INT64],contactVcard:[12,h.TYPES.BOOL],thumbnailDirectPath:[13,h.TYPES.STRING],thumbnailSha256:[14,h.TYPES.BYTES],thumbnailEncSha256:[15,h.TYPES.BYTES],jpegThumbnail:[16,h.TYPES.BYTES],contextInfo:[17,h.TYPES.MESSAGE,V],thumbnailHeight:[18,h.TYPES.UINT32],thumbnailWidth:[19,h.TYPES.UINT32],caption:[20,h.TYPES.STRING]};fc.internalSpec={text:[1,h.TYPES.STRING],matchedText:[2,h.TYPES.STRING],canonicalUrl:[4,h.TYPES.STRING],description:[5,h.TYPES.STRING],title:[6,h.TYPES.STRING],textArgb:[7,h.TYPES.FIXED32],backgroundArgb:[8,h.TYPES.FIXED32],font:[9,h.TYPES.ENUM,za],previewType:[10,h.TYPES.ENUM,ya],jpegThumbnail:[16,h.TYPES.BYTES],contextInfo:[17,h.TYPES.MESSAGE,V],doNotPlayInline:[18,h.TYPES.BOOL],thumbnailDirectPath:[19,h.TYPES.STRING],thumbnailSha256:[20,h.TYPES.BYTES],thumbnailEncSha256:[21,h.TYPES.BYTES],mediaKey:[22,h.TYPES.BYTES],mediaKeyTimestamp:[23,h.TYPES.INT64],thumbnailHeight:[24,h.TYPES.UINT32],thumbnailWidth:[25,h.TYPES.UINT32],inviteLinkGroupType:[26,h.TYPES.ENUM,l],inviteLinkParentGroupSubjectV2:[27,h.TYPES.STRING],inviteLinkParentGroupThumbnailV2:[28,h.TYPES.BYTES],inviteLinkGroupTypeV2:[29,h.TYPES.ENUM,l],viewOnce:[30,h.TYPES.BOOL]};R.internalSpec={degreesLatitude:[1,h.TYPES.DOUBLE],degreesLongitude:[2,h.TYPES.DOUBLE],name:[3,h.TYPES.STRING],address:[4,h.TYPES.STRING],url:[5,h.TYPES.STRING],isLive:[6,h.TYPES.BOOL],accuracyInMeters:[7,h.TYPES.UINT32],speedInMps:[8,h.TYPES.FLOAT],degreesClockwiseFromMagneticNorth:[9,h.TYPES.UINT32],comment:[11,h.TYPES.STRING],jpegThumbnail:[16,h.TYPES.BYTES],contextInfo:[17,h.TYPES.MESSAGE,V]};S.internalSpec={displayName:[1,h.TYPES.STRING],vcard:[16,h.TYPES.STRING],contextInfo:[17,h.TYPES.MESSAGE,V]};gc.internalSpec={note:[1,h.TYPES.STRING],token:[2,h.TYPES.STRING],attachmentType:[3,h.TYPES.ENUM,Aa],attachmentMimetype:[4,h.TYPES.STRING],attachmentMediaKey:[5,h.TYPES.BYTES],attachmentMediaKeyTimestamp:[6,h.TYPES.INT64],attachmentFileSha256:[7,h.TYPES.BYTES],attachmentFileEncSha256:[8,h.TYPES.BYTES],attachmentDirectPath:[9,h.TYPES.STRING],attachmentJpegThumbnail:[10,h.TYPES.BYTES]};T.internalSpec={url:[1,h.TYPES.STRING],mimetype:[2,h.TYPES.STRING],caption:[3,h.TYPES.STRING],fileSha256:[4,h.TYPES.BYTES],fileLength:[5,h.TYPES.UINT64],height:[6,h.TYPES.UINT32],width:[7,h.TYPES.UINT32],mediaKey:[8,h.TYPES.BYTES],fileEncSha256:[9,h.TYPES.BYTES],interactiveAnnotations:[10,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Y],directPath:[11,h.TYPES.STRING],mediaKeyTimestamp:[12,h.TYPES.INT64],jpegThumbnail:[16,h.TYPES.BYTES],contextInfo:[17,h.TYPES.MESSAGE,V],firstScanSidecar:[18,h.TYPES.BYTES],firstScanLength:[19,h.TYPES.UINT32],experimentGroupId:[20,h.TYPES.UINT32],scansSidecar:[21,h.TYPES.BYTES],scanLengths:[22,h.FLAGS.REPEATED|h.TYPES.UINT32],midQualityFileSha256:[23,h.TYPES.BYTES],midQualityFileEncSha256:[24,h.TYPES.BYTES],viewOnce:[25,h.TYPES.BOOL],thumbnailDirectPath:[26,h.TYPES.STRING],thumbnailSha256:[27,h.TYPES.BYTES],thumbnailEncSha256:[28,h.TYPES.BYTES],staticUrl:[29,h.TYPES.STRING],annotations:[30,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Y],imageSourceType:[31,h.TYPES.ENUM,Ba]};U.internalSpec={groupId:[1,h.TYPES.STRING],axolotlSenderKeyDistributionMessage:[2,h.TYPES.BYTES]};V.internalSpec={stanzaId:[1,h.TYPES.STRING],participant:[2,h.TYPES.STRING],quotedMessage:[3,h.TYPES.MESSAGE,m],remoteJid:[4,h.TYPES.STRING],mentionedJid:[15,h.FLAGS.REPEATED|h.TYPES.STRING],conversionSource:[18,h.TYPES.STRING],conversionData:[19,h.TYPES.BYTES],conversionDelaySeconds:[20,h.TYPES.UINT32],forwardingScore:[21,h.TYPES.UINT32],isForwarded:[22,h.TYPES.BOOL],quotedAd:[23,h.TYPES.MESSAGE,kc],placeholderKey:[24,h.TYPES.MESSAGE,i.MessageKeySpec],expiration:[25,h.TYPES.UINT32],ephemeralSettingTimestamp:[26,h.TYPES.INT64],ephemeralSharedSecret:[27,h.TYPES.BYTES],externalAdReply:[28,h.TYPES.MESSAGE,jc],entryPointConversionSource:[29,h.TYPES.STRING],entryPointConversionApp:[30,h.TYPES.STRING],entryPointConversionDelaySeconds:[31,h.TYPES.UINT32],disappearingMode:[32,h.TYPES.MESSAGE,$],actionLink:[33,h.TYPES.MESSAGE,Ec],groupSubject:[34,h.TYPES.STRING],parentGroupJid:[35,h.TYPES.STRING],trustBannerType:[37,h.TYPES.STRING],trustBannerAction:[38,h.TYPES.UINT32],isSampled:[39,h.TYPES.BOOL],groupMentions:[40,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Fc],utm:[41,h.TYPES.MESSAGE,ic],forwardedNewsletterMessageInfo:[43,h.TYPES.MESSAGE,W],businessMessageForwardInfo:[44,h.TYPES.MESSAGE,lc],smbClientCampaignId:[45,h.TYPES.STRING],smbServerCampaignId:[46,h.TYPES.STRING],dataSharingContext:[47,h.TYPES.MESSAGE,hc],alwaysShowAdAttribution:[48,h.TYPES.BOOL]};hc.internalSpec={showMmDisclosure:[1,h.TYPES.BOOL]};W.internalSpec={newsletterJid:[1,h.TYPES.STRING],serverMessageId:[2,h.TYPES.INT32],newsletterName:[3,h.TYPES.STRING],contentType:[4,h.TYPES.ENUM,Ca],accessibilityText:[5,h.TYPES.STRING]};ic.internalSpec={utmSource:[1,h.TYPES.STRING],utmCampaign:[2,h.TYPES.STRING]};jc.internalSpec={title:[1,h.TYPES.STRING],body:[2,h.TYPES.STRING],mediaType:[3,h.TYPES.ENUM,Da],thumbnailUrl:[4,h.TYPES.STRING],mediaUrl:[5,h.TYPES.STRING],thumbnail:[6,h.TYPES.BYTES],sourceType:[7,h.TYPES.STRING],sourceId:[8,h.TYPES.STRING],sourceUrl:[9,h.TYPES.STRING],containsAutoReply:[10,h.TYPES.BOOL],renderLargerThumbnail:[11,h.TYPES.BOOL],showAdAttribution:[12,h.TYPES.BOOL],ctwaClid:[13,h.TYPES.STRING],ref:[14,h.TYPES.STRING]};kc.internalSpec={advertiserName:[1,h.TYPES.STRING],mediaType:[2,h.TYPES.ENUM,Ea],jpegThumbnail:[16,h.TYPES.BYTES],caption:[17,h.TYPES.STRING]};lc.internalSpec={businessOwnerJid:[1,h.TYPES.STRING]};mc.internalSpec={sentiment:[1,h.TYPES.UINT32],behaviorGraph:[2,h.TYPES.STRING],action:[3,h.TYPES.UINT32],intensity:[4,h.TYPES.UINT32],wordCount:[5,h.TYPES.UINT32]};nc.internalSpec={provider:[1,h.TYPES.ENUM,Ga],pluginType:[2,h.TYPES.ENUM,Fa],thumbnailCdnUrl:[3,h.TYPES.STRING],profilePhotoCdnUrl:[4,h.TYPES.STRING],searchProviderUrl:[5,h.TYPES.STRING],referenceIndex:[6,h.TYPES.UINT32],expectedLinksCount:[7,h.TYPES.UINT32],searchQuery:[9,h.TYPES.STRING],parentPluginMessageKey:[10,h.TYPES.MESSAGE,i.MessageKeySpec]};oc.internalSpec={suggestedPrompts:[1,h.FLAGS.REPEATED|h.TYPES.STRING],selectedPromptIndex:[2,h.TYPES.UINT32]};pc.internalSpec={sessionId:[1,h.TYPES.STRING]};qc.internalSpec={avatarMetadata:[1,h.TYPES.MESSAGE,mc],personaId:[2,h.TYPES.STRING],pluginMetadata:[3,h.TYPES.MESSAGE,nc],suggestedPromptMetadata:[4,h.TYPES.MESSAGE,oc],invokerJid:[5,h.TYPES.STRING],searchMetadata:[6,h.TYPES.MESSAGE,pc]};rc.internalSpec={deviceListMetadata:[1,h.TYPES.MESSAGE,X],deviceListMetadataVersion:[2,h.TYPES.INT32],messageSecret:[3,h.TYPES.BYTES],paddingBytes:[4,h.TYPES.BYTES],messageAddOnDurationInSecs:[5,h.TYPES.UINT32],botMessageSecret:[6,h.TYPES.BYTES],botMetadata:[7,h.TYPES.MESSAGE,qc],reportingTokenVersion:[8,h.TYPES.INT32]};X.internalDefaults={senderAccountType:(i=d("WAAdv.pb")).ADVEncryptionType.E2EE,receiverAccountType:i.ADVEncryptionType.E2EE};X.internalSpec={senderKeyHash:[1,h.TYPES.BYTES],senderTimestamp:[2,h.TYPES.UINT64],senderKeyIndexes:[3,h.FLAGS.REPEATED|h.FLAGS.PACKED|h.TYPES.UINT32],senderAccountType:[4,h.TYPES.ENUM,i.ADVEncryptionType],receiverAccountType:[5,h.TYPES.ENUM,i.ADVEncryptionType],recipientKeyHash:[8,h.TYPES.BYTES],recipientTimestamp:[9,h.TYPES.UINT64],recipientKeyIndexes:[10,h.FLAGS.REPEATED|h.FLAGS.PACKED|h.TYPES.UINT32]};Y.internalSpec={polygonVertices:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,sc],location:[2,h.TYPES.MESSAGE,tc],newsletter:[3,h.TYPES.MESSAGE,W],shouldSkipConfirmation:[4,h.TYPES.BOOL],__oneofs__:{action:["location","newsletter"]}};sc.internalSpec={xDeprecated:[1,h.TYPES.INT32],yDeprecated:[2,h.TYPES.INT32],x:[3,h.TYPES.DOUBLE],y:[4,h.TYPES.DOUBLE]};tc.internalSpec={degreesLatitude:[1,h.TYPES.DOUBLE],degreesLongitude:[2,h.TYPES.DOUBLE],name:[3,h.TYPES.STRING]};uc.internalSpec={quickReplyButton:[1,h.TYPES.MESSAGE,xc],urlButton:[2,h.TYPES.MESSAGE,wc],callButton:[3,h.TYPES.MESSAGE,vc],index:[4,h.TYPES.UINT32],__oneofs__:{button:["quickReplyButton","urlButton","callButton"]}};vc.internalSpec={displayText:[1,h.TYPES.MESSAGE,N],phoneNumber:[2,h.TYPES.MESSAGE,N]};wc.internalSpec={displayText:[1,h.TYPES.MESSAGE,N],url:[2,h.TYPES.MESSAGE,N]};xc.internalSpec={displayText:[1,h.TYPES.MESSAGE,N],id:[2,h.TYPES.STRING]};yc.internalSpec={quickReplyButton:[1,h.TYPES.MESSAGE,Bc],urlButton:[2,h.TYPES.MESSAGE,Ac],callButton:[3,h.TYPES.MESSAGE,zc],index:[4,h.TYPES.UINT32],__oneofs__:{hydratedButton:["quickReplyButton","urlButton","callButton"]}};zc.internalSpec={displayText:[1,h.TYPES.STRING],phoneNumber:[2,h.TYPES.STRING]};Ac.internalSpec={displayText:[1,h.TYPES.STRING],url:[2,h.TYPES.STRING],consentedUsersUrl:[3,h.TYPES.STRING],webviewPresentation:[4,h.TYPES.ENUM,Ha]};Bc.internalSpec={displayText:[1,h.TYPES.STRING],id:[2,h.TYPES.STRING]};Cc.internalSpec={value:[1,h.TYPES.INT64],offset:[2,h.TYPES.UINT32],currencyCode:[3,h.TYPES.STRING]};Z.internalSpec={id:[1,h.TYPES.STRING],fileLength:[2,h.TYPES.UINT64],width:[3,h.TYPES.UINT32],height:[4,h.TYPES.UINT32],mimetype:[5,h.TYPES.STRING],placeholderArgb:[6,h.TYPES.FIXED32],textArgb:[7,h.TYPES.FIXED32],subtextArgb:[8,h.TYPES.FIXED32],mediaData:[9,h.TYPES.MESSAGE,Dc],type:[10,h.TYPES.ENUM,Ia]};Dc.internalSpec={mediaKey:[1,h.TYPES.BYTES],mediaKeyTimestamp:[2,h.TYPES.INT64],fileSha256:[3,h.TYPES.BYTES],fileEncSha256:[4,h.TYPES.BYTES],directPath:[5,h.TYPES.STRING]};$.internalSpec={initiator:[1,h.TYPES.ENUM,Ka],trigger:[2,h.TYPES.ENUM,Ja],initiatorDeviceJid:[3,h.TYPES.STRING],initiatedByMe:[4,h.TYPES.BOOL]};Ec.internalSpec={url:[1,h.TYPES.STRING],buttonTitle:[2,h.TYPES.STRING]};Fc.internalSpec={groupJid:[1,h.TYPES.STRING],groupSubject:[2,h.TYPES.STRING]};Gc.internalSpec={version:[1,h.TYPES.SFIXED32],encIv:[2,h.TYPES.BYTES],encPayload:[3,h.TYPES.BYTES]};Hc.internalSpec={expressPathUrl:[1,h.TYPES.STRING],fileEncSha256:[2,h.TYPES.BYTES],fileLength:[3,h.TYPES.UINT64]};g.Message$PlaceholderMessage$PlaceholderType=c;g.Message$BCallMessage$MediaType=e;g.Message$CallLogMessage$CallOutcome=f;g.Message$CallLogMessage$CallType=b;g.Message$ScheduledCallEditMessage$EditType=aa;g.Message$ScheduledCallCreationMessage$CallType=ba;g.Message$EventResponseMessage$EventResponseType=ca;g.Message$PinInChatMessage$Type=da;g.Message$ButtonsResponseMessage$Type=ea;g.Message$ButtonsMessage$Button$Type=fa;g.Message$ButtonsMessage$HeaderType=ga;g.Message$SecretEncryptedMessage$SecretEncType=ha;g.Message$GroupInviteMessage$GroupType=ia;g.Message$InteractiveResponseMessage$Body$Format=j;g.Message$InteractiveMessage$ShopMessage$Surface=ja;g.Message$ListResponseMessage$ListType=ka;g.Message$ListMessage$ListType=la;g.Message$OrderMessage$OrderSurface=ma;g.Message$OrderMessage$OrderStatus=na;g.Message$PaymentInviteMessage$ServiceType=oa;g.Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMDateTime$HSMDateTimeComponent$CalendarType=pa;g.Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMDateTime$HSMDateTimeComponent$DayOfWeekType=qa;g.Message$PeerDataOperationRequestType=k;g.Message$HistorySyncNotification$HistorySyncType=ra;g.Message$RequestWelcomeMessageMetadata$LocalChatState=sa;g.Message$ProtocolMessage$Type=ta;g.Message$BotFeedbackMessage$BotFeedbackKindMultiplePositive=ua;g.Message$BotFeedbackMessage$BotFeedbackKindMultipleNegative=va;g.Message$BotFeedbackMessage$BotFeedbackKind=wa;g.Message$VideoMessage$Attribution=xa;g.Message$ExtendedTextMessage$InviteLinkGroupType=l;g.Message$ExtendedTextMessage$PreviewType=ya;g.Message$ExtendedTextMessage$FontType=za;g.Message$InvoiceMessage$AttachmentType=Aa;g.Message$ImageMessage$ImageSourceType=Ba;g.ContextInfo$ForwardedNewsletterMessageInfo$ContentType=Ca;g.ContextInfo$ExternalAdReplyInfo$MediaType=Da;g.ContextInfo$AdReplyInfo$MediaType=Ea;g.BotPluginMetadata$PluginType=Fa;g.BotPluginMetadata$SearchProvider=Ga;g.HydratedTemplateButton$HydratedURLButton$WebviewPresentationType=Ha;g.PaymentBackground$Type=Ia;g.DisappearingMode$Trigger=Ja;g.DisappearingMode$Initiator=Ka;g.KeepType=a;g.MessageSpec=m;g.Message$PlaceholderMessageSpec=n;g.Message$BCallMessageSpec=o;g.Message$MessageHistoryBundleSpec=p;g.Message$CallLogMessageSpec=q;g.Message$CallLogMessage$CallParticipantSpec=r;g.Message$ScheduledCallEditMessageSpec=s;g.Message$ScheduledCallCreationMessageSpec=t;g.Message$EventResponseMessageSpec=La;g.Message$EncEventResponseMessageSpec=u;g.Message$EventMessageSpec=v;g.Message$CommentMessageSpec=w;g.Message$EncCommentMessageSpec=x;g.Message$EncReactionMessageSpec=y;g.Message$PinInChatMessageSpec=Ma;g.Message$KeepInChatMessageSpec=Na;g.Message$PollVoteMessageSpec=Oa;g.Message$PollEncValueSpec=Pa;g.Message$PollUpdateMessageMetadataSpec=Qa;g.Message$PollUpdateMessageSpec=Ra;g.Message$PollCreationMessageSpec=z;g.Message$PollCreationMessage$OptionSpec=Sa;g.Message$StickerSyncRMRMessageSpec=Ta;g.Message$ReactionMessageSpec=Ua;g.Message$ButtonsResponseMessageSpec=Va;g.Message$ButtonsMessageSpec=Wa;g.Message$ButtonsMessage$ButtonSpec=Xa;g.Message$ButtonsMessage$Button$NativeFlowInfoSpec=Ya;g.Message$ButtonsMessage$Button$ButtonTextSpec=Za;g.Message$SecretEncryptedMessageSpec=$a;g.Message$FutureProofMessageSpec=A;g.Message$DeviceSentMessageSpec=ab;g.Message$RequestPhoneNumberMessageSpec=bb;g.Message$NewsletterAdminInviteMessageSpec=cb;g.Message$GroupInviteMessageSpec=db;g.Message$InteractiveResponseMessageSpec=eb;g.Message$InteractiveResponseMessage$NativeFlowResponseMessageSpec=B;g.Message$InteractiveResponseMessage$BodySpec=C;g.Message$InteractiveMessageSpec=D;g.Message$InteractiveMessage$CarouselMessageSpec=E;g.Message$InteractiveMessage$NativeFlowMessageSpec=F;g.Message$InteractiveMessage$NativeFlowMessage$NativeFlowButtonSpec=fb;g.Message$InteractiveMessage$CollectionMessageSpec=G;g.Message$InteractiveMessage$ShopMessageSpec=H;g.Message$InteractiveMessage$FooterSpec=gb;g.Message$InteractiveMessage$BodySpec=hb;g.Message$InteractiveMessage$HeaderSpec=ib;g.Message$ListResponseMessageSpec=jb;g.Message$ListResponseMessage$SingleSelectReplySpec=kb;g.Message$ListMessageSpec=lb;g.Message$ListMessage$ProductListInfoSpec=mb;g.Message$ListMessage$ProductListHeaderImageSpec=nb;g.Message$ListMessage$ProductSectionSpec=ob;g.Message$ListMessage$ProductSpec=pb;g.Message$ListMessage$SectionSpec=qb;g.Message$ListMessage$RowSpec=rb;g.Message$OrderMessageSpec=I;g.Message$ProductMessageSpec=J;g.Message$ProductMessage$ProductSnapshotSpec=sb;g.Message$ProductMessage$CatalogSnapshotSpec=tb;g.Message$TemplateButtonReplyMessageSpec=ub;g.Message$TemplateMessageSpec=K;g.Message$TemplateMessage$HydratedFourRowTemplateSpec=L;g.Message$TemplateMessage$FourRowTemplateSpec=vb;g.Message$StickerMessageSpec=M;g.Message$LiveLocationMessageSpec=wb;g.Message$PaymentInviteMessageSpec=xb;g.Message$CancelPaymentRequestMessageSpec=yb;g.Message$DeclinePaymentRequestMessageSpec=zb;g.Message$RequestPaymentMessageSpec=Ab;g.Message$SendPaymentMessageSpec=Bb;g.Message$HighlyStructuredMessageSpec=N;g.Message$HighlyStructuredMessage$HSMLocalizableParameterSpec=Cb;g.Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMDateTimeSpec=Db;g.Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMDateTime$HSMDateTimeUnixEpochSpec=Eb;g.Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMDateTime$HSMDateTimeComponentSpec=Fb;g.Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMCurrencySpec=Gb;g.Message$ContactsArrayMessageSpec=Hb;g.Message$InitialSecurityNotificationSettingSyncSpec=Ib;g.Message$PeerDataOperationRequestResponseMessageSpec=Jb;g.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResultSpec=Kb;g.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$PlaceholderMessageResendResponseSpec=Lb;g.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$LinkPreviewResponseSpec=Mb;g.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$LinkPreviewResponse$LinkPreviewHighQualityThumbnailSpec=Nb;g.Message$PeerDataOperationRequestMessageSpec=Ob;g.Message$PeerDataOperationRequestMessage$PlaceholderMessageResendRequestSpec=Pb;g.Message$PeerDataOperationRequestMessage$HistorySyncOnDemandRequestSpec=Qb;g.Message$PeerDataOperationRequestMessage$RequestUrlPreviewSpec=Rb;g.Message$PeerDataOperationRequestMessage$RequestStickerReuploadSpec=Sb;g.Message$AppStateFatalExceptionNotificationSpec=Tb;g.Message$AppStateSyncKeyRequestSpec=Ub;g.Message$AppStateSyncKeyShareSpec=Vb;g.Message$AppStateSyncKeyDataSpec=Wb;g.Message$AppStateSyncKeyFingerprintSpec=Xb;g.Message$AppStateSyncKeyIdSpec=O;g.Message$AppStateSyncKeySpec=Yb;g.Message$HistorySyncNotificationSpec=Zb;g.Message$RequestWelcomeMessageMetadataSpec=$b;g.Message$ProtocolMessageSpec=ac;g.Message$BotFeedbackMessageSpec=bc;g.Message$ChatSpec=cc;g.Message$CallSpec=dc;g.Message$VideoMessageSpec=P;g.Message$AudioMessageSpec=ec;g.Message$DocumentMessageSpec=Q;g.Message$ExtendedTextMessageSpec=fc;g.Message$LocationMessageSpec=R;g.Message$ContactMessageSpec=S;g.Message$InvoiceMessageSpec=gc;g.Message$ImageMessageSpec=T;g.Message$SenderKeyDistributionMessageSpec=U;g.ContextInfoSpec=V;g.ContextInfo$DataSharingContextSpec=hc;g.ContextInfo$ForwardedNewsletterMessageInfoSpec=W;g.ContextInfo$UTMInfoSpec=ic;g.ContextInfo$ExternalAdReplyInfoSpec=jc;g.ContextInfo$AdReplyInfoSpec=kc;g.ContextInfo$BusinessMessageForwardInfoSpec=lc;g.BotAvatarMetadataSpec=mc;g.BotPluginMetadataSpec=nc;g.BotSuggestedPromptMetadataSpec=oc;g.BotSearchMetadataSpec=pc;g.BotMetadataSpec=qc;g.MessageContextInfoSpec=rc;g.DeviceListMetadataSpec=X;g.InteractiveAnnotationSpec=Y;g.PointSpec=sc;g.LocationSpec=tc;g.TemplateButtonSpec=uc;g.TemplateButton$CallButtonSpec=vc;g.TemplateButton$URLButtonSpec=wc;g.TemplateButton$QuickReplyButtonSpec=xc;g.HydratedTemplateButtonSpec=yc;g.HydratedTemplateButton$HydratedCallButtonSpec=zc;g.HydratedTemplateButton$HydratedURLButtonSpec=Ac;g.HydratedTemplateButton$HydratedQuickReplyButtonSpec=Bc;g.MoneySpec=Cc;g.PaymentBackgroundSpec=Z;g.PaymentBackground$MediaDataSpec=Dc;g.DisappearingModeSpec=$;g.ActionLinkSpec=Ec;g.GroupMentionSpec=Fc;g.MessageSecretMessageSpec=Gc;g.MediaNotifyMessageSpec=Hc}),98);
__d("WAForceSecondRetryErrorTypes",[],(function(a,b,c,d,e,f){"use strict";a=new Set(["errSignalTooManyMessagesInFuture","errSignalGrpTooManyMessagesInFuture"]);f.FORCE_SECOND_RETRY_ON=a}),66);
__d("WAParseProtocol",["WAAckLevel","WAAssertUnreachable","WAE2E.pb","WAErr","WAGlobals","WAHex","WAJids","WALogger","WALongInt","WAMedia","WAMediaUtils","WAMsgMap","WAMsgType","WASortedLists","WAStanzaUtils","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["cannot compose mediaEntry with the media message"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["protobuf msg with too large size ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["protobuf msg with bad size ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["protobuf msg with no plaintext hash"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["received protocol message with unknown type ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["received unsupported protocol message with type ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["received invalid revoke key"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["received a non supported revoke"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["Received extendedTextMsg with no text content"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["There are no admin made reactions"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["We dont support this message type yet"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["interpretProto msg came with tags "," and ",""]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["Received a quote of a type that is not yet supported: ",""]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["Received quote invalid author ",""]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["Received quote with missing data in the protobuf"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose(["Received quote from a type that us not supported ",""]);w=function(){return a};return a}var x={};function y(){return{unstoredMsg:null,unstoredMedia:null,unstoredQuotedMedia:null}}function z(a){var b=a.unstoredMsg,c=a.unstoredMedia;c=c===void 0?null:c;a=a.unstoredQuotedMedia;a=a===void 0?null:a;if(b==null&&c==null)return y();else return{unstoredMsg:b,unstoredMedia:c,unstoredQuotedMedia:a}}function a(a){var b=F(a.proto);if(!b)return y();var e=C(a,b),f=A(a,b),g=f.quote;f=f.quotedMedia;switch(b.type){case"conversation":var h;h=babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.TEXT,msgContent:{content:b.value},quote:(h=g)!=null?h:void 0},e);return z({unstoredMsg:h,unstoredQuotedMedia:f});case"imageMessage":h=b.value;f=G(h,e.ts);h=babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.IMAGE,mediaId:f==null?void 0:f.plaintextHash,quote:(h=g)!=null?h:void 0},e);return z({unstoredMsg:h,unstoredMedia:f});case"videoMessage":h=b.value;f=H(h,e.ts);h=babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.VIDEO,mediaId:f==null?void 0:f.plaintextHash,quote:(h=g)!=null?h:void 0},e);return z({unstoredMsg:h,unstoredMedia:f});case"audioMessage":h=b.value;f=I(h,e.ts);h=babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.PTT,mediaId:f==null?void 0:f.plaintextHash},e);return z({unstoredMsg:h,unstoredMedia:f});case"documentMessage":h=b.value;f=N(h,e.ts);h=babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.DOCUMENT_FILE,mediaId:f==null?void 0:f.plaintextHash,quote:(h=g)!=null?h:void 0},e);return z({unstoredMsg:h,unstoredMedia:f});case"futureproof":h={type:d("WAMsgType").MSG_TYPE.FUTUREPROOF,msgContent:{protobuf:d("WAHex").bytesToBuffer(a.bytes),subtype:x[b.type]||null},id:e.id,ts:e.ts,sentTs:e.sentTs,serverTs:e.serverTs,ack:e.ack,reportingMeta:e.reportingMeta};return z({unstoredMsg:h});case"reactionMessage":f=b.value;a=J(f,e);return z({unstoredMsg:a});case"protocolMessage":h=M(b.value,e);return z({unstoredMsg:h});case"extendedTextMessage":return K(b.value,e,g);default:return c("WAAssertUnreachable")(b.type)}}function A(a,b){b=D(b);var c=b==null?void 0:b.quotedMessage;if(b==null||c==null)return{quote:null,quotedMedia:null};var e=F(c);if(e==null){d("WALogger").ERROR(w(),c);return{quote:null,quotedMedia:null}}c=b.stanzaId;b=b.participant;if(c==null||b==null){d("WALogger").ERROR(v());return{quote:null,quotedMedia:null}}b=b?d("WAJids").validateUserJid(b):d("WAJids").interpretAsUserJid(a.jid);if(b==null){d("WALogger").ERROR(u(),b);return{quote:null,quotedMedia:null}}c={externalId:d("WAStanzaUtils").toStanzaId(c),ts:null,author:b,serverTs:a.ts};switch(e.type){case"conversation":b=babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.TEXT,msgContent:{content:e.value}},c);return{quote:{content:b,remoteJid:null},quotedMedia:null};case"imageMessage":b=e.value;b=G(b,a.ts);a=babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.IMAGE,mediaId:b==null?void 0:b.plaintextHash},c);return{quote:{content:a,remoteJid:null},quotedMedia:b};default:d("WALogger").ERROR(t(),e.type);return{quote:null,quotedMedia:null}}}var B=["conversation","imageMessage","videoMessage","audioMessage","reactionMessage","protocolMessage","extendedTextMessage","documentMessage"];function C(a,b){var c=D(b);return{id:{externalId:a.externalId,author:a.author,chat:a.jid},ts:a.ts,ack:d("WAAckLevel").ACK.RECEIVED,serverTs:a.ts,forwardingScore:E(b,c)}}function D(a){switch(a.type){case"imageMessage":case"videoMessage":case"extendedTextMessage":case"audioMessage":case"documentMessage":return a.value.contextInfo;default:a.type;return null}}function E(a,b){if(a.type==="futureproof")return 0;return(b==null?void 0:b.forwardingScore)!=null?b==null?void 0:b.forwardingScore:(b==null?void 0:b.isForwarded)===!0?1:0}function F(a){var b=null;for(var e=0;e<B.length;e++)if(a[B[e]]!=null){if(b){d("WALogger").ERROR(s(),b,B[e]);return null}b=B[e]}if(b==null){d("WALogger").ERROR(r()).devConsole(a);return{type:"futureproof"}}switch(b){case"audioMessage":return a.audioMessage!=null?{type:"audioMessage",value:a.audioMessage}:null;case"videoMessage":return a.videoMessage!=null?{type:"videoMessage",value:a.videoMessage}:null;case"imageMessage":return a.imageMessage!=null?{type:"imageMessage",value:a.imageMessage}:null;case"documentMessage":return a.documentMessage!=null?{type:"documentMessage",value:a.documentMessage}:null;case"conversation":return a.conversation!=null?{type:"conversation",value:a.conversation}:null;case"protocolMessage":return a.protocolMessage!=null?{type:"protocolMessage",value:a.protocolMessage}:null;case"extendedTextMessage":return a.extendedTextMessage!=null?{type:"extendedTextMessage",value:a.extendedTextMessage}:null;case"reactionMessage":return a.reactionMessage!=null?{type:"reactionMessage",value:a.reactionMessage}:null;default:c("WAAssertUnreachable")(b)}}function G(a,b){var c=P(a,"image");if(!c)return null;c=O(c,b);return babelHelpers["extends"]({},c,{mediaType:d("WAMedia").IMAGE,validatedVideoInfo:null,validatedImageInfo:{width:a.width,height:a.height,jpegThumbnail:a.jpegThumbnail},validatedAudioInfo:null,validatedDocumentFileInfo:null})}function H(a,b){var c=P(a,"video");if(!c)return null;c=O(c,b);return babelHelpers["extends"]({},c,{mediaType:d("WAMedia").VIDEO,validatedVideoInfo:{duration:a.seconds!=null&&a.seconds>1?a.seconds:1,width:a.width,height:a.height,mimetype:a.mimetype,jpegThumbnail:a.jpegThumbnail},validatedImageInfo:null,validatedAudioInfo:null,validatedDocumentFileInfo:null})}function I(a,b){var c=P(a,"ptt");if(!c)return null;c=O(c,b);return babelHelpers["extends"]({},c,{mediaType:d("WAMedia").PTT,validatedVideoInfo:null,validatedImageInfo:null,validatedAudioInfo:{duration:a.seconds!=null&&a.seconds>1?a.seconds:1,mimetype:a.mimetype,played:!1},validatedDocumentFileInfo:null})}function J(a,b){var c;c=(c=a.key)==null?void 0:c.id;var e=b.id.author;if(d("WAJids").isAuthorSystem(e)){d("WALogger").ERROR(q());return null}return c==null?null:{type:d("WAMsgType").MSG_TYPE.REACTION,reactToAuthor:e,reaction:a.text,reactToExternalId:d("WAStanzaUtils").toStanzaId(c),groupingKey:a.groupingKey,id:b.id,ts:b.ts,ack:d("WAAckLevel").ACK.RECEIVED,serverTs:b.ts}}function K(a,b,c){var e=a.text;if(e==null){d("WALogger").ERROR(p());return y()}a=L((a=a.contextInfo)==null?void 0:a.mentionedJid,e);e=babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.TEXT,msgContent:{content:e,mentionedJids:(e=a)!=null?e:void 0},quote:(a=c)!=null?a:void 0},b);return z({unstoredMsg:e})}function L(a,b){b=b;if(a==null||b==null)return null;var c=[];for(var e=0;e<a.length;e++){var f=d("WAJids").interpretAndValidateJid(a[e]);f.jidType==="phoneUser"&&b.includes("@"+d("WAJids").phoneNumberFromJid(f.userJid))&&c.push(f.userJid)}return c.length?d("WASortedLists").sortAndDedupe(c):void 0}function M(a,b){var e=b.id.author,f=a.type;if(d("WAJids").isAuthorSystem(e))throw c("WAErr")("There are no admin made reactions");else if(f==null)throw c("WAErr")("Received invalid protocol message with no type");switch(f){case d("WAE2E.pb").Message$ProtocolMessage$Type.REVOKE:a=a.key;var g=b.id.chat;if(a&&(a.remoteJid===d("WAGlobals").getMyUserJid()?e===g:a.remoteJid===g)&&a.id!=null){e=a.fromMe;g=a.id;e=(e=e)!=null?e:!1;if(e)return{id:b.id,ts:b.ts,sentTs:b.sentTs,serverTs:b.serverTs,ack:b.ack,reportingMeta:b.reportingMeta,type:d("WAMsgType").MSG_TYPE.REVOKED,revokedExternalId:d("WAStanzaUtils").toStanzaId(g),unsendMsgContentDeleteTs:null,msgContent:null};else{d("WALogger").ERROR(o());return null}}else{d("WALogger").ERROR(n()).devConsole(a,b);return null}case d("WAE2E.pb").Message$ProtocolMessage$Type.EPHEMERAL_SETTING:case d("WAE2E.pb").Message$ProtocolMessage$Type.EPHEMERAL_SYNC_RESPONSE:case d("WAE2E.pb").Message$ProtocolMessage$Type.APP_STATE_SYNC_KEY_REQUEST:d("WALogger").ERROR(m(),f);return null;default:d("WALogger").ERROR(l(),f);return null}}function N(a,b){var c=P(a,"document");if(!c)return null;c=O(c,b);return babelHelpers["extends"]({},c,{mediaType:d("WAMedia").DOCUMENT_FILE,validatedVideoInfo:null,validatedImageInfo:null,validatedAudioInfo:null,validatedDocumentFileInfo:{filename:a.fileName,mimetype:a.mimetype}})}function O(a,b){return{mediaEntry:a.mediaEntry,plaintextHash:a.plaintextHash,size:a.size,msgIds:[],mediaEntries:new(d("WAMsgMap").MsgMap)(),ts:b}}function P(a,b){var c=a.fileSha256;if(!c){d("WALogger").ERROR(k());return null}var e=a.fileLength;if(e==null||e===0){d("WALogger").ERROR(j(),e);return null}try{e=d("WALongInt").numberOrThrowIfTooLarge(e)}catch(a){d("WALogger").ERROR(i(),e);return null}if(a.fileSha256==null||a.fileEncSha256==null||a.mediaKey==null||a.directPath==null||a.mediaKeyTimestamp==null){d("WALogger").ERROR(h());return null}a=d("WAMediaUtils").rawDataToMediaEntry(a.fileSha256,a.fileEncSha256,a.mediaKey,a.directPath,d("WATimeUtils").castLongIntToUnixTime(a.mediaKeyTimestamp),b);return{size:e,plaintextHash:d("WAMediaUtils").toPlaintextHash(new Uint8Array(c)),mediaEntry:a}}g.FUTUREPROOF_TYPES=x;g.parseProtocol=a;g.interpretMsg=F}),98);
__d("WAPreKeysStanzaUtils",["WAWap"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b;return(b=d("WAWap")).wap("key",null,b.wap("id",null,b.BIG_ENDIAN_CONTENT(a.id,3)),b.wap("value",null,a.keyPair.publicKey))}function b(a){var b;return(b=d("WAWap")).wap("skey",null,b.wap("id",null,b.BIG_ENDIAN_CONTENT(a.id,3)),b.wap("value",null,a.keyPair.publicKey),b.wap("signature",null,a.signature))}function c(a){var b=a.child("skey"),c=null;if(a.hasChild("key")){var d=a.child("key");c={id:d.child("id").contentUint(3),publicKey:d.child("value").contentSerializedPubKey()}}return{identity:a.child("identity").contentSerializedPubKey(),signedKey:{id:b.child("id").contentUint(3),publicKey:b.child("value").contentSerializedPubKey(),signature:b.child("signature").contentBytes(64)},oneTimeKey:c}}g.xmppPreKey=a;g.xmppSignedPreKey=b;g.readSessionInfo=c}),98);
__d("WAGetKeysForUpload",["MAWLoggerUtils","WAResultOrError","WASignalKeys","WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to deserialize prekey received from the db"]);h=function(){return a};return a}var i=d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.PrekeyGenerateAndUpload,d("MAWLoggerUtils").Tag.SignedPrekey]);function a(a,b){return a.storage.runInTransaction(function(c){c=c.loadPreKeys;return c(b).then(function(b){var c=b.preKeys;b=b.signedPreKey;var e=[];c.forEach(function(a){a=d("WASignalKeys").deserializePreKey(a);a==null?i.ERROR(h()):e.push(a)});return d("WAResultOrError").makeResult({regInfo:a.regInfo,keyType:d("WASignalKeys").KEY_TYPE,preKeys:e,signedPreKey:b})})})}g.getKeysForUpload=a}),98);
__d("WASmaxInPreKeysIQErrorItemNotFoundMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","item-not-found");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",404);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorItemNotFoundMixin=a}),98);
__d("WASmaxInPreKeysIQErrorNotAcceptableMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"field");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"name");if(!b.success)return b;a=d("WASmaxParseUtils").attrString(a,"reason");return!a.success?a:d("WAResultOrError").makeResult({name:b.value,reason:a.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"field",h);if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","not-acceptable");if(!c.success)return c;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",406);return!a.success?a:d("WAResultOrError").makeResult({text:c.value,code:a.value,field:b.value})}g.parseIQErrorNotAcceptableField=h;g.parseIQErrorNotAcceptableMixin=a}),98);
__d("WASmaxInPreKeysRequestErrorsFetchDigest",["WAResultOrError","WASmaxInPreKeysIQErrorFallbackClientMixin","WASmaxInPreKeysIQErrorItemNotFoundMixin","WASmaxInPreKeysIQErrorNotAcceptableMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInPreKeysIQErrorNotAcceptableMixin").parseIQErrorNotAcceptableMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorNotAcceptable",value:b.value});var c=d("WASmaxInPreKeysIQErrorItemNotFoundMixin").parseIQErrorItemNotFoundMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IQErrorItemNotFound",value:c.value});var e=d("WASmaxInPreKeysIQErrorFallbackClientMixin").parseIQErrorFallbackClientMixin(a);return e.success?d("WAResultOrError").makeResult({name:"IQErrorFallbackClient",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorNotAcceptable","IQErrorItemNotFound","IQErrorFallbackClient"],[b,c,e])}g.parseRequestErrorsFetchDigest=a}),98);
__d("WASmaxInPreKeysFetchDigestResponseRequestError",["WAResultOrError","WASmaxInPreKeysIQErrorResponseMixin","WASmaxInPreKeysRequestErrorsFetchDigest","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInPreKeysIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInPreKeysRequestErrorsFetchDigest").parseRequestErrorsFetchDigest(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorRequestErrorsFetchDigest:b.value}))}g.parseFetchDigestResponseRequestError=a}),98);
__d("WASmaxInPreKeysFetchDigestResponseServerError",["WAResultOrError","WASmaxInPreKeysIQErrorResponseMixin","WASmaxInPreKeysServerErrors","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInPreKeysIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInPreKeysServerErrors").parseServerErrors(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorServerErrors:b.value}))}g.parseFetchDigestResponseServerError=a}),98);
__d("WASmaxInPreKeysKeysHashMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"hash");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytesRange(a.value,20,20);return!a.success?a:d("WAResultOrError").makeResult({hashElementValue:a.value})}g.parseKeysHashMixin=a}),98);
__d("WASmaxInPreKeysPreKeyIDListMixin",["WAResultOrError","WASmaxInPreKeysKeyIDMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"id");if(!b.success)return b;b=d("WASmaxInPreKeysKeyIDMixin").parseKeyIDMixin(a);return!b.success?b:b}function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"list");if(!a.success)return a;a=d("WASmaxParseUtils").mapChildrenWithTag(a.value,"id",0,2e4,h);return!a.success?a:d("WAResultOrError").makeResult({listId:a.value})}g.parsePreKeyIDListListId=h;g.parsePreKeyIDListMixin=a}),98);
__d("WASmaxInPreKeysIdentityDigestBundleMixin",["WAResultOrError","WASmaxInPreKeysIdentityKeyMixin","WASmaxInPreKeysKeyTypeMixin","WASmaxInPreKeysKeysHashMixin","WASmaxInPreKeysPreKeyIDListMixin","WASmaxInPreKeysRegistrationIDMixin","WASmaxInPreKeysSignedPreKeyMixin"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInPreKeysRegistrationIDMixin").parseRegistrationIDMixin(a);if(!b.success)return b;var c=d("WASmaxInPreKeysIdentityKeyMixin").parseIdentityKeyMixin(a);if(!c.success)return c;var e=d("WASmaxInPreKeysPreKeyIDListMixin").parsePreKeyIDListMixin(a);if(!e.success)return e;var f=d("WASmaxInPreKeysSignedPreKeyMixin").parseSignedPreKeyMixin(a);if(!f.success)return f;var g=d("WASmaxInPreKeysKeyTypeMixin").parseKeyTypeMixin(a);a=d("WASmaxInPreKeysKeysHashMixin").parseKeysHashMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,c.value,e.value,f.value,{keyTypeMixin:g.success?g.value:null},a.value))}g.parseIdentityDigestBundleMixin=a}),98);
__d("WASmaxInPreKeysFetchDigestResponseSuccess",["WAResultOrError","WASmaxInPreKeysIQResultResponseMixin","WASmaxInPreKeysIdentityDigestBundleMixin","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"digest");if(!c.success)return c;var e=d("WASmaxParseReference").optionalAttrStringFromReference(b,["digest","identity_type"]);if(!e.success)return e;e=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,c.value,"identity_type",e.value);if(!e.success)return e;c=d("WASmaxInPreKeysIdentityDigestBundleMixin").parseIdentityDigestBundleMixin(c.value);if(!c.success)return c;a=d("WASmaxInPreKeysIQResultResponseMixin").parseIQResultResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({hasDigestIdentityType:e.value!=null,digestIdentityDigestBundleMixin:c.value},a.value))}g.parseFetchDigestResponseSuccess=a}),98);
__d("WASmaxOutPreKeysFetchDigestRequest",["WASmaxJsx","WASmaxOutPreKeysClientRequestMixin"],(function(a,b,c,d,e,f,g){function a(){var a=d("WASmaxOutPreKeysClientRequestMixin").mergeClientRequestMixin(d("WASmaxJsx").smax("iq",{type:"get"},d("WASmaxJsx").smax("digest",null)));return a}g.makeFetchDigestRequest=a}),98);
__d("WASmaxPreKeysFetchDigestRPC",["WAComms","WASmaxInPreKeysFetchDigestResponseRequestError","WASmaxInPreKeysFetchDigestResponseServerError","WASmaxInPreKeysFetchDigestResponseSuccess","WASmaxOutPreKeysFetchDigestRequest","WASmaxParsingFailure","WASmaxRpcUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){var c,e,f,g,h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:c=d("WASmaxOutPreKeysFetchDigestRequest").makeFetchDigestRequest();i.next=3;return b("regeneratorRuntime").awrap(d("WAComms").sendSmaxStanza(c,a));case 3:e=i.sent;f=d("WASmaxInPreKeysFetchDigestResponseSuccess").parseFetchDigestResponseSuccess(e,c);if(!f.success){i.next=7;break}return i.abrupt("return",{name:"FetchDigestResponseSuccess",value:f.value});case 7:g=d("WASmaxInPreKeysFetchDigestResponseRequestError").parseFetchDigestResponseRequestError(e,c);if(!g.success){i.next=10;break}return i.abrupt("return",{name:"FetchDigestResponseRequestError",value:g.value});case 10:h=d("WASmaxInPreKeysFetchDigestResponseServerError").parseFetchDigestResponseServerError(e,c);if(!h.success){i.next=13;break}return i.abrupt("return",{name:"FetchDigestResponseServerError",value:h.value});case 13:throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("FetchDigest",{Success:f,RequestError:g,ServerError:h}));case 14:case"end":return i.stop()}},null,this)}g.sendFetchDigestRPC=a}),98);
__d("WARequestPreKeyDigestProtocol",["WABinary","WAConvertRegistrationIdMixin","WAConvertSignedPreKeyMixin","WACryptoDependencies","WACryptoUtils","WAParsableXmlNode","WAResultOrError","WASignalKeys","WASmaxPreKeysFetchDigestRPC","WATagsLogger","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": ",""]);i=function(){return a};return a}var j=d("WATagsLogger").TAGS(["requestPreKeyDigestProtocol"]);function a(a){return d("WASmaxPreKeysFetchDigestRPC").sendFetchDigestRPC({withoutRetry:!1}).then(function(b){switch(b.name){case"FetchDigestResponseServerError":var c=b.value.errorServerErrors.name;j.ERROR(i(),b.name,c);return d("WAResultOrError").makeError({type:"server-error",payload:c});case"FetchDigestResponseRequestError":c=b.value.errorRequestErrorsFetchDigest.name;j.ERROR(h(),b.name,c);return d("WAResultOrError").makeError({type:"request-error",payload:c});default:b.name;c=k(b.value.digestIdentityDigestBundleMixin);return l(c,a).then(function(a){return a==="ok"?d("WAResultOrError").makeResult():d("WAResultOrError").makeError({type:"compare-error",payload:a})})}})}function k(a){var b=d("WAConvertRegistrationIdMixin").registrationIdMixin(a),c=d("WAConvertSignedPreKeyMixin").convertSignedPreKeyMixin(a),e=a.listId.map(function(a){return d("WASignalKeys").castToPreKeyId(d("WAParsableXmlNode").convertBytesToUint(a.elementValue,3))});a=a.hashElementValue;return{regId:b,skeyId:c.id,preKeyIds:e,hash:a}}function l(a,c){var e,f,g,h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:if(!(a.regId!==c.regInfo.regId)){i.next=2;break}return i.abrupt("return","RegIdMismatch");case 2:if(!(a.skeyId!==c.signedPreKey.id)){i.next=4;break}return i.abrupt("return","SignedPreKeyIdMismatch");case 4:e=new Map();c.preKeys.forEach(function(a){return e.set(a.id,a)});f=a.preKeyIds.some(function(a){return!e.has(a)});if(!f){i.next=9;break}return i.abrupt("return","UnknownPreKey");case 9:g=a.preKeyIds.map(function(a){return e.get(a)}).filter(Boolean);i.next=12;return b("regeneratorRuntime").awrap(m(c,g));case 12:h=i.sent;if(d("WACryptoUtils").uint8ArraysEqual(h,a.hash)){i.next=15;break}return i.abrupt("return","HashMismatch");case 15:return i.abrupt("return","ok");case 16:case"end":return i.stop()}},null,this)}function m(a,b){var c=new(d("WABinary").Binary)();c.writeByteArray(a.regInfo.staticKeyPair.publicKey);c.writeByteArray(a.signedPreKey.keyPair.publicKey);c.writeByteArray(a.signedPreKey.signature);b.forEach(function(a){c.writeByteArray(a.keyPair.publicKey)});return d("WACryptoDependencies").getCrypto().subtle.digest("SHA-1",c.readByteArray()).then(function(a){return new Uint8Array(a)})}g.requestPreKeyDigestProtocol=a}),98);
__d("WARequestPreKeyDigest",["WABridge","WAErr","WAGetKeysForUpload","WAGlobals","WAJobDefinitions","WAJobOrchestratorTypes","WAJobs","WALogger","WAOdsEnums","WAPromiseManagement","WARequestPreKeyDigestProtocol","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["PreKey digest comparison failed: ",""]);h=function(){return a};return a}function i(a){var e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:g.next=2;return b("regeneratorRuntime").awrap(a(function(a){a=a.cryptoManager;return d("WAGetKeysForUpload").getKeysForUpload(a)}));case 2:e=g.sent;if(!(e.success===!1)){g.next=6;break}d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.PREKEY_DIGEST,key:"fail"});throw c("WAErr")("Error while loading keys: "+e.error);case 6:g.next=8;return b("regeneratorRuntime").awrap(d("WARequestPreKeyDigestProtocol").requestPreKeyDigestProtocol(e.value));case 8:f=g.sent;if(!(f.success===!1)){g.next=17;break}d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.PREKEY_DIGEST,key:"fail"});if(!(f.error.type==="compare-error")){g.next=16;break}d("WALogger").ERROR(h(),f.error.payload);g.next=15;return b("regeneratorRuntime").awrap(d("WAJobs").getJobManager().waitUntilPersisted(d("WAJobDefinitions").createStartJobInfo("generateAndUploadPreKeys",{scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.HIGH},reason:"prekey digest comparison failed",uniqueJob:!0})));case 15:return g.abrupt("return");case 16:throw c("WAErr")("Error while requesting key digest: "+f.error.type+" "+f.error.payload);case 17:f.success,d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.PREKEY_DIGEST,key:"success"});case 19:case"end":return g.stop()}},null,this)}a=d("WAJobs").getPersistedJobsApi().definePersistedJob().finalStep("requestPreKeyDigest",d("WAPromiseManagement").nullaryCacheWhilePending(function(){return i(function(a){return d("WAGlobals").getWaOneQueue().enqueue(a,{operationType:"request_prekey_digest",flush:!1})})})).end();g.requestPreKeyDigestFn=i;g.requestPreKeyDigest=a}),98);
__d("WAReceiptUtils",["WACryptoManagerUtils","WADeprecatedSendIq","WAPREList","WAPREMetrics","WAPreKeysStanzaUtils","WARequestPreKeyDigest","WAWap","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(a,c){var e,f,g,h,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:e=a.retryCount;f=e+1;g=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.RETRY_RECEIPTS_SENT,{"int":{retries:f}});if(!(f>=3)){k.next=6;break}k.next=6;return b("regeneratorRuntime").awrap(d("WARequestPreKeyDigest").requestPreKeyDigestFn(function(a){return a(c)}));case 6:h=null;if(!(f>=2)){k.next=11;break}k.next=10;return b("regeneratorRuntime").awrap(d("WACryptoManagerUtils").getSignalInfoForRetry(c.cryptoManager));case 10:h=k.sent;case 11:j=c.cryptoManager.regInfo.regId;g.endSuccess();return k.abrupt("return",i(a,f,j,h));case 14:case"end":return k.stop()}},null,this)}function a(a,c){var e,f,g,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:e=a.externalId,f=a.from,g=a.participant;f.type==="group"?i=f.groupJid:(f.type,i=f.deviceJid);j.t0=b("regeneratorRuntime");j.t1=d("WADeprecatedSendIq").deprecatedSendStanzaAndWaitForAck;j.next=6;return b("regeneratorRuntime").awrap(h(a,c));case 6:j.t2=j.sent;j.t3={id:e,"class":"receipt",from:i,participant:g};j.t4=j.t1(j.t2,j.t3);j.next=11;return j.t0.awrap.call(j.t0,j.t4);case 11:case"end":return j.stop()}},null,this)}function i(a,b,c,e){var f=null;if(e!=null){var g=e.keyType,h=e.signedPreKey,i=e.preKey;e=e.publicKey;var j=a.deviceIdentity!=null?d("WAWap").wap("device-identity",null,a.deviceIdentity):null;f=d("WAWap").wap("keys",null,d("WAWap").wap("type",null,d("WAWap").BIG_ENDIAN_CONTENT(g,1)),d("WAWap").wap("identity",null,e),d("WAPreKeysStanzaUtils").xmppPreKey(i),d("WAPreKeysStanzaUtils").xmppSignedPreKey(h),j)}a.from.type==="group"?g=a.from.groupJid:(a.from.type,g=a.from.deviceJid);return d("WAWap").wap("receipt",{category:a.category!=null?d("WAWap").CUSTOM_STRING(a.category):d("WAWap").DROP_ATTR,id:d("WAWap").CUSTOM_STRING(a.externalId),participant:a.participant?d("WAWap").DEVICE_JID(a.participant):d("WAWap").DROP_ATTR,recipient:a.recipient?d("WAWap").USER_JID(a.recipient):d("WAWap").DROP_ATTR,to:d("WAWap").JID(g),type:"retry"},d("WAWap").wap("retry",{count:d("WAWap").INT(b),id:d("WAWap").CUSTOM_STRING(a.externalId),t:d("WAWap").INT(a.ts),v:"1"}),d("WAWap").wap("registration",null,d("WAWap").BIG_ENDIAN_CONTENT(c)),f)}g.makeRetryReceipt=h;g.sendRetryReceipt=a}),98);
__d("WATransformRetryOrIndividualRegularMixinGroup",[],(function(a,b,c,d,e,f){"use strict";function a(a){return{retryCount:a.name==="Retry"?a.value.encEncRetryMixin.count:0,ciphertext:a.value.encEncTypeIndividualMixin.elementValue,encVersion:String(a.value.encEncVersion2Or3OrFutureproofMixinGroup.value.v),encType:a.value.encEncTypeIndividualMixin.type}}f.transformRetryOrIndividualRegularMixinGroup=a}),66);
__d("WAHandleIndividualMessageProtocol",["WACryptoPkcs7","WADecodeIncomingMsg","WAE2E.pb","WAErr","WAForceSecondRetryErrorTypes","WAICDCUtils","WAJids","WALogger","WAParseProtocol","WAParseV3Protocol","WAReceiptUtils","WAResultOrError","WATransformRetryOrIndividualRegularMixinGroup","decodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["enc version "," is not supported."]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unknown message content type: ",""]);i=function(){return a};return a}var j=d("WAParseV3Protocol").createV3ProtocolParser();function k(a){switch(a){case"ContentTypeText":return"text";case"ContentTypeLiveLocationSingle":return"live_location";case"ContentTypeMedia":return"media";case"ContentTypeMedianotify":case"ContentTypeMediaSingle":return"media";case"ContentTypePayIndividual":return"pay";case"ContentTypeReaction":return"reaction";case"ContentTypeList":return"product_list";case"ContentTypePollCreation":return"poll_creation";case"ContentTypePollVote":return"poll_vote";default:a;d("WALogger").ERROR(i(),a);return"text"}}function a(a){var b=a.from,e=a.recipientMixin;a=a.availableOrUnavailableMixinGroup;var f=d("WAJids").extractUserJid(b),g=e==null?f:e.recipient;f=e==null?f:"@me";if(a.name==="Unavailable")return{type:"Unavailable",author:f,chat:g,from:b,recipient:e==null?void 0:e.recipient,contentType:k(a.value.contentUnavailableMixins.name)};var h=a.value.retryOrIndividualRegularOrBotResponseMessageMixinGroup;if(h.name==="BotResponseMessage")throw c("WAErr")("BotResponseMessage is unsupported");return babelHelpers["extends"]({type:"Available",author:f,chat:g,from:b,recipient:e==null?void 0:e.recipient},d("WATransformRetryOrIndividualRegularMixinGroup").transformRetryOrIndividualRegularMixinGroup(h),{contentType:k(a.value.contentAvailableMixins.name)})}e=function(a){a=a.decryptedMessage;var b=a.plaintext,c=a.encVersion,e=a.author,f=a.chat,g=a.stanzaId;a=a.serverTs;if(c!=="2"&&c!=="3"){d("WALogger").WARN(h(),c);return d("WAResultOrError").makeError("unknown-plaintext")}var i=null;if(c==="2"){var k,l=d("WACryptoPkcs7").unpadPkcs7(b);l=d("decodeProtobuf").decodeProtobuf(d("WAE2E.pb").MessageSpec,l);if(l.deviceSentMessage!=null&&l.deviceSentMessage.destinationJid!==f)return d("WAResultOrError").makeError("invalid-device-sent-message");k=(k=l.deviceSentMessage)==null?void 0:k.message;k!=null&&(l=k);k={author:e,bytes:b,externalId:g,jid:f,proto:l,ts:a};i=d("WAParseProtocol").parseProtocol(k)}else{c;l=e==="@me"?f:null;k=d("WADecodeIncomingMsg").decodeIncomingMsg(b,"v3",l);if(k.version!=="v3"||k.type!=="subprotocol")return d("WAResultOrError").makeError("unknown-plaintext");i=j(k,f,g,e,a)}return d("WAResultOrError").makeResult(i)};f=function(a,b){var c=a.stanzaId,e=a.serverTs,f=a.retryCount,g=a.from,h=a.author,i=a.chat;a=a.deviceIdentity;h=h==="@me";return d("WAReceiptUtils").sendRetryReceipt({category:null,externalId:c,from:{deviceJid:g,type:"device"},participant:null,recipient:h?i:null,retryCount:f,ts:e,deviceIdentity:a},b)};var l=function(a,b){var c=a.stanzaId,e=a.serverTs,f=a.retryCount,g=a.from,h=a.author,i=a.chat,j=a.deviceIdentity;a=a.error;h=h==="@me";var k=f;d("WAForceSecondRetryErrorTypes").FORCE_SECOND_RETRY_ON.has(a)&&(k=Math.max(2,f));return d("WAReceiptUtils").makeRetryReceipt({category:null,externalId:c,from:{deviceJid:g,type:"device"},participant:null,recipient:h?i:null,retryCount:k,ts:e,deviceIdentity:j},b)};function b(a){var b=a.icdc,c=a.from;a=a.serverTs;d("WAICDCUtils").icdcFlushable.enqueue({icdc:b,from:c,serverTs:a})}g.parseIndividualMessage=a;g.decodeIndividualMessage=e;g.sendIndividualMessageRetryReceipt=f;g.makeIndividualMessageRetryReceipt=l;g.handleICDCPayloadFromIncomingMsg=b}),98);
__d("WASmaxOutReceiptBizOriginalEnvelopeMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.originalEnvelopeElementValue;a=d("WASmaxJsx").smax("biz",null,d("WASmaxJsx").smax("original_envelope",null,a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBizOriginalEnvelopeMixin=a}),98);
__d("WASmaxOutReceiptFromProxyAccountMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.receiptActualFrom;a=d("WASmaxJsx").smax("receipt",{actual_from:d("WAWap").JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeFromProxyAccountMixin=a}),98);
__d("WASmaxOutReceiptNeedPrivacyTokenMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("receipt",{privacy_token:"false"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNeedPrivacyTokenMixin=a}),98);
__d("WASmaxOutReceiptRecipientMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.receiptRecipient;a=d("WASmaxJsx").smax("receipt",{recipient:d("WAWap").USER_JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeRecipientMixin=a}),98);
__d("WASmaxOutReceiptSenderAggregatedPublishMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.itemId;a=d("WASmaxJsx").smax("item",{id:d("WAWap").STANZA_ID(a)});return a}function i(a){var b=a.itemArgs;a=a.receiptId;a=d("WASmaxJsx").smax("receipt",{id:d("WAWap").STANZA_ID(a)},d("WASmaxJsx").smax("list",null,d("WASmaxChildren").REPEATED_CHILD(h,b,0,255)));return a}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeSenderAggregatedPublishListItem=h;g.mergeSenderAggregatedPublishMixin=a}),98);
__d("WASmaxOutReceiptSingleMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.receiptId;a=d("WASmaxJsx").smax("receipt",{id:d("WAWap").STANZA_ID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeSingleMixin=a}),98);
__d("WASmaxOutReceiptSenderAggregatedPublishOrSingleMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutReceiptSenderAggregatedPublishMixin","WASmaxOutReceiptSingleMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.senderAggregatedPublish)return d("WASmaxOutReceiptSenderAggregatedPublishMixin").mergeSenderAggregatedPublishMixin(a,b.senderAggregatedPublish);if(b.single)return d("WASmaxOutReceiptSingleMixin").mergeSingleMixin(a,b.single);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeSenderAggregatedPublishOrSingleMixinGroup=a}),98);
__d("WASmaxOutReceiptBroadcastDeviceMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.receiptTo;a=a.receiptParticipant;b=d("WASmaxJsx").smax("receipt",{to:d("WAWap").BROADCAST_JID(b),participant:d("WAWap").DEVICE_JID(a)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBroadcastDeviceMixin=a}),98);
__d("WASmaxOutReceiptGroupDeviceMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.receiptTo;a=a.receiptParticipant;b=d("WASmaxJsx").smax("receipt",{to:d("WAWap").GROUP_JID(b),participant:d("WAWap").JID(a)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeGroupDeviceMixin=a}),98);
__d("WASmaxOutReceiptIndividualDeviceMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.receiptTo;a=d("WASmaxJsx").smax("receipt",{to:d("WAWap").JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIndividualDeviceMixin=a}),98);
__d("WASmaxOutReceiptStatusDeviceMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.receiptTo;a=a.receiptParticipant;b=d("WASmaxJsx").smax("receipt",{to:d("WAWap").JID(b),participant:d("WAWap").DEVICE_JID(a)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeStatusDeviceMixin=a}),98);
__d("WASmaxOutReceiptDeviceMixins",["WASmaxMixinGroupExhaustiveError","WASmaxOutReceiptBroadcastDeviceMixin","WASmaxOutReceiptGroupDeviceMixin","WASmaxOutReceiptIndividualDeviceMixin","WASmaxOutReceiptStatusDeviceMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.groupDevice)return d("WASmaxOutReceiptGroupDeviceMixin").mergeGroupDeviceMixin(a,b.groupDevice);if(b.individualDevice)return d("WASmaxOutReceiptIndividualDeviceMixin").mergeIndividualDeviceMixin(a,b.individualDevice);if(b.statusDevice)return d("WASmaxOutReceiptStatusDeviceMixin").mergeStatusDeviceMixin(a,b.statusDevice);if(b.broadcastDevice)return d("WASmaxOutReceiptBroadcastDeviceMixin").mergeBroadcastDeviceMixin(a,b.broadcastDevice);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeDeviceMixins=a}),98);
__d("WASmaxOutReceiptDeviceMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutReceiptDeviceMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.deviceMixinsArgs;a=d("WASmaxOutReceiptDeviceMixins").mergeDeviceMixins(d("WASmaxJsx").smax("receipt",null),a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeDeviceMixin=a}),98);
__d("WASmaxOutReceiptInteropDeviceMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.receiptTo;a=d("WASmaxJsx").smax("receipt",{to:d("WAWap").JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeInteropDeviceMixin=a}),98);
__d("WASmaxOutReceiptInteropUserMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.receiptTo;a=d("WASmaxJsx").smax("receipt",{to:d("WAWap").JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeInteropUserMixin=a}),98);
__d("WASmaxOutReceiptBroadcastUserMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.receiptTo;a=a.receiptParticipant;b=d("WASmaxJsx").smax("receipt",{to:d("WAWap").BROADCAST_JID(b),participant:d("WAWap").USER_JID(a)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBroadcastUserMixin=a}),98);
__d("WASmaxOutReceiptGroupUserMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.receiptTo;a=a.receiptParticipant;b=d("WASmaxJsx").smax("receipt",{to:d("WAWap").GROUP_JID(b),participant:d("WAWap").JID(a)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeGroupUserMixin=a}),98);
__d("WASmaxOutReceiptIndividualUserMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.receiptTo;a=d("WASmaxJsx").smax("receipt",{to:d("WAWap").JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIndividualUserMixin=a}),98);
__d("WASmaxOutReceiptStatusUserMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.receiptTo;a=a.receiptParticipant;b=d("WASmaxJsx").smax("receipt",{to:d("WAWap").JID(b),participant:d("WAWap").USER_JID(a)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeStatusUserMixin=a}),98);
__d("WASmaxOutReceiptUserMixins",["WASmaxMixinGroupExhaustiveError","WASmaxOutReceiptBroadcastUserMixin","WASmaxOutReceiptGroupUserMixin","WASmaxOutReceiptIndividualUserMixin","WASmaxOutReceiptStatusUserMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.groupUser)return d("WASmaxOutReceiptGroupUserMixin").mergeGroupUserMixin(a,b.groupUser);if(b.individualUser)return d("WASmaxOutReceiptIndividualUserMixin").mergeIndividualUserMixin(a,b.individualUser);if(b.statusUser)return d("WASmaxOutReceiptStatusUserMixin").mergeStatusUserMixin(a,b.statusUser);if(b.broadcastUser)return d("WASmaxOutReceiptBroadcastUserMixin").mergeBroadcastUserMixin(a,b.broadcastUser);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeUserMixins=a}),98);
__d("WASmaxOutReceiptUserMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutReceiptUserMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.userMixinsArgs;a=d("WASmaxOutReceiptUserMixins").mergeUserMixins(d("WASmaxJsx").smax("receipt",null),a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeUserMixin=a}),98);
__d("WASmaxOutReceiptUserOrDeviceOrInteropUserOrInteropDeviceMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutReceiptDeviceMixin","WASmaxOutReceiptInteropDeviceMixin","WASmaxOutReceiptInteropUserMixin","WASmaxOutReceiptUserMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.user)return d("WASmaxOutReceiptUserMixin").mergeUserMixin(a,b.user);if(b.device)return d("WASmaxOutReceiptDeviceMixin").mergeDeviceMixin(a,b.device);if(b.interopUser)return d("WASmaxOutReceiptInteropUserMixin").mergeInteropUserMixin(a,b.interopUser);if(b.interopDevice)return d("WASmaxOutReceiptInteropDeviceMixin").mergeInteropDeviceMixin(a,b.interopDevice);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeUserOrDeviceOrInteropUserOrInteropDeviceMixinGroup=a}),98);
__d("WASmaxOutReceiptPublishDeliveryRequest",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutReceiptBizOriginalEnvelopeMixin","WASmaxOutReceiptFromProxyAccountMixin","WASmaxOutReceiptNeedPrivacyTokenMixin","WASmaxOutReceiptRecipientMixin","WASmaxOutReceiptSenderAggregatedPublishOrSingleMixinGroup","WASmaxOutReceiptUserOrDeviceOrInteropUserOrInteropDeviceMixinGroup"],(function(a,b,c,d,e,f,g){function h(a){a=d("WASmaxOutReceiptBizOriginalEnvelopeMixin").mergeBizOriginalEnvelopeMixin(d("WASmaxJsx").smax("biz",null),a);return a}function a(a){var b=a.bizArgs,c=a.recipientMixinArgs,e=a.fromProxyAccountMixinArgs,f=a.hasNeedPrivacyToken,g=a.userOrDeviceOrInteropUserOrInteropDeviceMixinGroupArgs;a=a.senderAggregatedPublishOrSingleMixinGroupArgs;b=d("WASmaxOutReceiptSenderAggregatedPublishOrSingleMixinGroup").mergeSenderAggregatedPublishOrSingleMixinGroup(d("WASmaxOutReceiptUserOrDeviceOrInteropUserOrInteropDeviceMixinGroup").mergeUserOrDeviceOrInteropUserOrInteropDeviceMixinGroup(d("WASmaxMixins").optionalMerge(d("WASmaxOutReceiptNeedPrivacyTokenMixin").mergeNeedPrivacyTokenMixin,d("WASmaxMixins").optionalMerge(d("WASmaxOutReceiptFromProxyAccountMixin").mergeFromProxyAccountMixin,d("WASmaxMixins").optionalMerge(d("WASmaxOutReceiptRecipientMixin").mergeRecipientMixin,d("WASmaxJsx").smax("receipt",null,d("WASmaxChildren").OPTIONAL_CHILD(h,b)),c),e),f),g),a);return b}g.makePublishDeliveryRequestBiz=h;g.makePublishDeliveryRequest=a}),98);
__d("WASmaxOutReceiptSenderTypeMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("receipt",{type:"sender"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeSenderTypeMixin=a}),98);
__d("WASmaxOutReceiptPublishSenderBroadcastDeviceSenderTypeMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutReceiptBroadcastDeviceMixin","WASmaxOutReceiptSenderTypeMixin"],(function(a,b,c,d,e,f,g){function h(a){a=d("WASmaxOutReceiptSenderTypeMixin").mergeSenderTypeMixin(d("WASmaxOutReceiptBroadcastDeviceMixin").mergeBroadcastDeviceMixin(d("WASmaxJsx").smax("receipt",null),a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergePublishSenderBroadcastDeviceSenderTypeMixin=a}),98);
__d("WASmaxOutReceiptPublishSenderGroupDeviceSenderTypeMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutReceiptGroupDeviceMixin","WASmaxOutReceiptSenderTypeMixin"],(function(a,b,c,d,e,f,g){function h(a){a=d("WASmaxOutReceiptSenderTypeMixin").mergeSenderTypeMixin(d("WASmaxOutReceiptGroupDeviceMixin").mergeGroupDeviceMixin(d("WASmaxJsx").smax("receipt",null),a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergePublishSenderGroupDeviceSenderTypeMixin=a}),98);
__d("WASmaxOutReceiptPublishSenderIndividualDeviceSenderTypeMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutReceiptIndividualDeviceMixin","WASmaxOutReceiptRecipientMixin","WASmaxOutReceiptSenderTypeMixin"],(function(a,b,c,d,e,f,g){function h(a){a=d("WASmaxOutReceiptRecipientMixin").mergeRecipientMixin(d("WASmaxOutReceiptSenderTypeMixin").mergeSenderTypeMixin(d("WASmaxOutReceiptIndividualDeviceMixin").mergeIndividualDeviceMixin(d("WASmaxJsx").smax("receipt",null),a)),a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergePublishSenderIndividualDeviceSenderTypeMixin=a}),98);
__d("WASmaxOutReceiptPublishSenderStatusDeviceSenderTypeMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutReceiptSenderTypeMixin","WASmaxOutReceiptStatusDeviceMixin"],(function(a,b,c,d,e,f,g){function h(a){a=d("WASmaxOutReceiptSenderTypeMixin").mergeSenderTypeMixin(d("WASmaxOutReceiptStatusDeviceMixin").mergeStatusDeviceMixin(d("WASmaxJsx").smax("receipt",null),a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergePublishSenderStatusDeviceSenderTypeMixin=a}),98);
__d("WASmaxOutReceiptPublishSenderGroupOrPublishSenderIndividualOrPublishSenderStatusOrPublishSenderBroadcastDeviceSenderTypeMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutReceiptPublishSenderBroadcastDeviceSenderTypeMixin","WASmaxOutReceiptPublishSenderGroupDeviceSenderTypeMixin","WASmaxOutReceiptPublishSenderIndividualDeviceSenderTypeMixin","WASmaxOutReceiptPublishSenderStatusDeviceSenderTypeMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.publishSenderGroupDeviceSenderType)return d("WASmaxOutReceiptPublishSenderGroupDeviceSenderTypeMixin").mergePublishSenderGroupDeviceSenderTypeMixin(a,b.publishSenderGroupDeviceSenderType);if(b.publishSenderIndividualDeviceSenderType)return d("WASmaxOutReceiptPublishSenderIndividualDeviceSenderTypeMixin").mergePublishSenderIndividualDeviceSenderTypeMixin(a,b.publishSenderIndividualDeviceSenderType);if(b.publishSenderStatusDeviceSenderType)return d("WASmaxOutReceiptPublishSenderStatusDeviceSenderTypeMixin").mergePublishSenderStatusDeviceSenderTypeMixin(a,b.publishSenderStatusDeviceSenderType);if(b.publishSenderBroadcastDeviceSenderType)return d("WASmaxOutReceiptPublishSenderBroadcastDeviceSenderTypeMixin").mergePublishSenderBroadcastDeviceSenderTypeMixin(a,b.publishSenderBroadcastDeviceSenderType);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergePublishSenderGroupOrPublishSenderIndividualOrPublishSenderStatusOrPublishSenderBroadcastDeviceSenderTypeMixinGroup=a}),98);
__d("WASmaxOutReceiptPublishSenderRequest",["WASmaxJsx","WASmaxOutReceiptPublishSenderGroupOrPublishSenderIndividualOrPublishSenderStatusOrPublishSenderBroadcastDeviceSenderTypeMixinGroup","WASmaxOutReceiptSenderAggregatedPublishOrSingleMixinGroup"],(function(a,b,c,d,e,f,g){function a(a){var b=a.publishSenderGroupOrPublishSenderIndividualOrPublishSenderStatusOrPublishSenderBroadcastDeviceSenderTypeMixinGroupArgs;a=a.senderAggregatedPublishOrSingleMixinGroupArgs;b=d("WASmaxOutReceiptSenderAggregatedPublishOrSingleMixinGroup").mergeSenderAggregatedPublishOrSingleMixinGroup(d("WASmaxOutReceiptPublishSenderGroupOrPublishSenderIndividualOrPublishSenderStatusOrPublishSenderBroadcastDeviceSenderTypeMixinGroup").mergePublishSenderGroupOrPublishSenderIndividualOrPublishSenderStatusOrPublishSenderBroadcastDeviceSenderTypeMixinGroup(d("WASmaxJsx").smax("receipt",null),b),a);return b}g.makePublishSenderRequest=a}),98);
__d("WAHandleStreamError",["Promise","WABridge","WAHandleFailureUtils","WALogger","WAOdsEnums"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Stream error of type "," is causing a closed socket"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Code "," stream:error is received"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Conflict stream:error is received"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["bad-mac stream:error is received"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["xml-not-well-formed stream:error is received"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unacked ping id: ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["Client didn't send 'ack' back (type: ",", class: ","), closing socket. Unacked id: ",""]);o=function(){return a};return a}a=function(a){var b=a.ackClass,c=a.ackId;a=a.ackType;var e="ack";d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.STREAM_ERROR,key:e+"."+a+"."+b});d("WALogger").WARN(o(),a,b,c);return r(e)};c=function(a){a=a.pingId;var b="ping";d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.STREAM_ERROR,key:""+b});d("WALogger").WARN(n(),a);return r(b)};e=function(){var a="xml-not-well-formed";d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.STREAM_ERROR,key:""+a});d("WALogger").WARN(m());return r(a)};f=function(){var a="bad-mac";d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.STREAM_ERROR,key:""+a});d("WALogger").WARN(l());return r(a)};var p=function(a){var b,c=a.code;a=a.conflictReason;var e="conflict";d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.STREAM_ERROR,key:e+"."+((b=c)!=null?b:"undefined")+"."+((b=a)!=null?b:"undefined")});if(c===d("WAHandleFailureUtils").FAILURE_CODES.NOT_AUTHORIZED)return s();d("WALogger").WARN(k());return r(e)},q=function(a){a=a.code;var b="other";d("WALogger").WARN(j(),a);d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.STREAM_ERROR,key:b+"."+a});return a===d("WAHandleFailureUtils").FAILURE_CODES.NOT_AUTHORIZED?s():r(b)};function r(a){d("WALogger").WARN(i(),a);return(h||(h=b("Promise"))).resolve("CLOSE_SOCKET")}function s(){return(h||(h=b("Promise"))).resolve("NO_ACK")}g.handleAckKick=a;g.handlePingKick=c;g.handleXmlNotWellFormed=e;g.handleBadMac=f;g.handleConflict=p;g.handleStreamErrorCode=q}),98);
__d("WASmaxOutReceiptAppDataPeerCategoryMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("receipt",{category:"peer_appdata"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeAppDataPeerCategoryMixin=a}),98);
__d("WASmaxOutReceiptPublishAppDataPeerDeliveryRequest",["WASmaxJsx","WASmaxOutReceiptAppDataPeerCategoryMixin","WASmaxOutReceiptIndividualDeviceMixin","WASmaxOutReceiptSingleMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutReceiptAppDataPeerCategoryMixin").mergeAppDataPeerCategoryMixin(d("WASmaxOutReceiptSingleMixin").mergeSingleMixin(d("WASmaxOutReceiptIndividualDeviceMixin").mergeIndividualDeviceMixin(d("WASmaxJsx").smax("receipt",null),a),a));return a}g.makePublishAppDataPeerDeliveryRequest=a}),98);
__d("WASmaxReceiptPublishAppDataPeerDeliveryRPC",["WAComms","WASmaxOutReceiptPublishAppDataPeerDeliveryRequest","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){var c;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:c=d("WASmaxOutReceiptPublishAppDataPeerDeliveryRequest").makePublishAppDataPeerDeliveryRequest(a);e.next=3;return b("regeneratorRuntime").awrap(d("WAComms").castSmaxStanza(c));case 3:case"end":return e.stop()}},null,this)}g.sendPublishAppDataPeerDeliveryRPC=a}),98);
__d("WASendAppdataDeliveryReceiptProtocol",["WASmaxReceiptPublishAppDataPeerDeliveryRPC"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){var b=a.stanzaId;a=a.from;return d("WASmaxReceiptPublishAppDataPeerDeliveryRPC").sendPublishAppDataPeerDeliveryRPC({receiptTo:a,receiptId:b})};g.sendAppdataDeliveryReceiptProtocol=a}),98);
__d("WASendAppdataRetryReceiptProtocol",["WAReceiptUtils"],(function(a,b,c,d,e,f,g){"use strict";a=function(a,b){var c=a.stanzaId,e=a.from,f=a.serverTs;a=a.retryCount;return d("WAReceiptUtils").sendRetryReceipt({category:"peer_appdata",deviceIdentity:null,externalId:c,from:{deviceJid:e,type:"device"},participant:null,recipient:null,retryCount:a,ts:f},b)};g.sendAppdataRetryReceiptProtocol=a}),98);
__d("WASmaxInAppdataDeliverDeviceIdentityMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"device-identity");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytes(a.value);return!a.success?a:d("WAResultOrError").makeResult({deviceIdentityElementValue:a.value})}g.parseDeviceIdentityMixin=a}),98);
__d("WASmaxInAppdataDeliverEncRetryMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"count",1,4);return!b.success?b:d("WAResultOrError").makeResult({count:b.value})}g.parseEncRetryMixin=a}),98);
__d("WASmaxInAppdataDeliverEncHideDecryptionPlaceholderMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"decrypt-fail","hide");return!b.success?b:d("WAResultOrError").makeResult({decryptFail:b.value})}g.parseEncHideDecryptionPlaceholderMixin=a}),98);
__d("WASmaxInAppdataDeliverEncPayloadMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").contentBytesRange(a,1,1048576);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}g.parseEncPayloadMixin=a}),98);
__d("WASmaxInAppdataDeliverEnums",["WAJids"],(function(a,b,c,d,e,f,g){a={high:"high",low:"low"};b={msg:"msg",pkmsg:"pkmsg"};c={validators:[d("WAJids").validateDeviceJid,d("WAJids").validateGroupJid],typeName:"DeviceJid|GroupJid"};g.ENUM_HIGH_LOW=a;g.ENUM_MSG_PKMSG=b;g.DEVICEJID_GROUPJID=c}),98);
__d("WASmaxInAppdataDeliverEncTypeIndividualMixin",["WAResultOrError","WASmaxInAppdataDeliverEncHideDecryptionPlaceholderMixin","WASmaxInAppdataDeliverEncPayloadMixin","WASmaxInAppdataDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").attrStringEnum(a,"type",d("WASmaxInAppdataDeliverEnums").ENUM_MSG_PKMSG);if(!b.success)return b;var c=d("WASmaxInAppdataDeliverEncHideDecryptionPlaceholderMixin").parseEncHideDecryptionPlaceholderMixin(a);a=d("WASmaxInAppdataDeliverEncPayloadMixin").parseEncPayloadMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({type:b.value,encHideDecryptionPlaceholderMixin:c.success?c.value:null},a.value))}g.parseEncTypeIndividualMixin=a}),98);
__d("WASmaxInAppdataDeliverEncVersionFutureproofMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"v",3,void 0);return!b.success?b:d("WAResultOrError").makeResult({v:b.value})}g.parseEncVersionFutureproofMixin=a}),98);
__d("WASmaxInAppdataDeliverOfflineMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrIntRange(a,"offline",0,12);return!a.success?a:d("WAResultOrError").makeResult({offline:a.value})}g.parseOfflineMixin=a}),98);
__d("WASmaxInAppdataDeliverRegistrationIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"registration");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytesRange(a.value,4,4);return!a.success?a:d("WAResultOrError").makeResult({registrationElementValue:a.value})}g.parseRegistrationIDMixin=a}),98);
__d("WASmaxInAppdataDeliverPeerRequest",["WAResultOrError","WASmaxInAppdataDeliverDeviceIdentityMixin","WASmaxInAppdataDeliverEncRetryMixin","WASmaxInAppdataDeliverEncTypeIndividualMixin","WASmaxInAppdataDeliverEncVersionFutureproofMixin","WASmaxInAppdataDeliverEnums","WASmaxInAppdataDeliverOfflineMixin","WASmaxInAppdataDeliverRegistrationIDMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"appdata");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"enc");if(!b.success)return b;var c=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!c.success)return c;var e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"category","peer");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a,"push_priority",d("WASmaxInAppdataDeliverEnums").ENUM_HIGH_LOW);if(!f.success)return f;var g=d("WASmaxParseJid").attrDeviceJid(a,"from");if(!g.success)return g;var h=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!h.success)return h;var i=d("WASmaxInAppdataDeliverEncVersionFutureproofMixin").parseEncVersionFutureproofMixin(b.value);if(!i.success)return i;var j=d("WASmaxInAppdataDeliverEncRetryMixin").parseEncRetryMixin(b.value);b=d("WASmaxInAppdataDeliverEncTypeIndividualMixin").parseEncTypeIndividualMixin(b.value);if(!b.success)return b;var k=d("WASmaxInAppdataDeliverDeviceIdentityMixin").parseDeviceIdentityMixin(a),l=d("WASmaxInAppdataDeliverRegistrationIDMixin").parseRegistrationIDMixin(a);a=d("WASmaxInAppdataDeliverOfflineMixin").parseOfflineMixin(a);return d("WAResultOrError").makeResult({id:c.value,category:e.value,pushPriority:f.value,from:g.value,t:h.value,encEncVersionFutureproofMixin:i.value,encEncRetryMixin:j.success?j.value:null,encEncTypeIndividualMixin:b.value,deviceIdentityMixin:k.success?k.value:null,registrationIDMixin:l.success?l.value:null,offlineMixin:a.success?a.value:null})}g.parsePeerRequest=a}),98);
__d("WASmaxAppdataDeliverPeerRPC",["WASmaxInAppdataDeliverPeerRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInAppdataDeliverPeerRequest").parsePeerRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Peer",{Request:a}));return{parsedRequest:a.value}}g.receivePeerRPC=a}),98);
__d("WACreateHandleAppdata",["Promise","WAJids","WAResultOrError","WASendAppdataDeliveryReceiptProtocol","WASendAppdataRetryReceiptProtocol","WASmaxAppdataDeliverPeerRPC","WATagsLogger","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to send retry receipt due to ","}"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to send delivery receipt due to ","}"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["start handling..."]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["received appdata, but no handler is provied. Fallback to default ack."]);l=function(){return a};return a}var m=d("WATagsLogger").TAGS(["decision tree","handleAppdata"]);function a(a){return function(c,e,f){e=(e=a.appdataMessage)==null?void 0:e.handleAppdataMessage;if(e==null){m.ERROR(l());return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult("NO_ACK"))}m.DEV(k());c=d("WASmaxAppdataDeliverPeerRPC").receivePeerRPC(c);c=c.parsedRequest;var g=c.id,n=c.from,o=c.t,p=c.offlineMixin,q=c.encEncRetryMixin,r=c.encEncTypeIndividualMixin;c=c.encEncVersionFutureproofMixin;var s=d("WATimeUtils").castToUnixTime(o),t={from:n,author:d("WAJids").extractUserJid(n),retryCount:(o=q==null?void 0:q.count)!=null?o:0,ciphertext:r.elementValue,encVersion:String(c.v),encType:r.type,hideDecryptionFailure:((q=r.encHideDecryptionPlaceholderMixin)==null?void 0:q.decryptFail)==="hide",stanzaId:g};o=function(){return d("WASendAppdataDeliveryReceiptProtocol").sendAppdataDeliveryReceiptProtocol({from:n,stanzaId:g})["catch"](function(a){m.ERROR(j(),a);throw a})};c=function(){return d("WASendAppdataRetryReceiptProtocol").sendAppdataRetryReceiptProtocol({from:n,stanzaId:g,retryCount:t.retryCount,serverTs:s},{cryptoManager:f})["catch"](function(a){m.ERROR(i(),a);throw a})};return e({parsedAppdata:t,offline:p==null?void 0:p.offline,serverTs:s,sendDeliveryReceipt:o,sendRetryReceipt:c},{cryptoManager:f}).then(d("WAResultOrError").makeResult)}}g.createHandleAppdata=a}),98);
__d("WAHandleChatStateProtocol",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b;a.name==="Paused"?b="idle":(a.name,b=a.value.composingMedia==="audio"?"recording_audio":"typing");return b}f.parseChatStatus=a}),66);
__d("WASmaxInChatstateComposingMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"chatstate");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"composing");if(!b.success)return b;a=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,b.value,"media","audio");return!a.success?a:d("WAResultOrError").makeResult({composingMedia:a.value})}g.parseComposingMixin=a}),98);
__d("WASmaxInChatstatePausedMixin",["WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"chatstate");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"paused");return!b.success?b:d("WASmaxParseUtils").voidSuccess}g.parsePausedMixin=a}),98);
__d("WASmaxInChatstateComposingOrPausedMixinGroup",["WAResultOrError","WASmaxInChatstateComposingMixin","WASmaxInChatstatePausedMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInChatstateComposingMixin").parseComposingMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"Composing",value:b.value});var c=d("WASmaxInChatstatePausedMixin").parsePausedMixin(a);return c.success?d("WAResultOrError").makeResult({name:"Paused",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["Composing","Paused"],[b,c])}g.parseComposingOrPausedMixinGroup=a}),98);
__d("WASmaxInChatstateFromGroupMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"chatstate");if(!b.success)return b;b=d("WASmaxParseJid").attrGroupJid(a,"from");if(!b.success)return b;var c=d("WASmaxParseJid").attrUserJid(a,"participant");if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"participant_pn");return!a.success?a:d("WAResultOrError").makeResult({from:b.value,participant:c.value,participantPn:a.value})}g.parseFromGroupMixin=a}),98);
__d("WASmaxInChatstateFromUserMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"chatstate");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"from");return!b.success?b:d("WAResultOrError").makeResult({from:b.value})}g.parseFromUserMixin=a}),98);
__d("WASmaxInChatstateFromUserOrGroupMixinGroup",["WAResultOrError","WASmaxInChatstateFromGroupMixin","WASmaxInChatstateFromUserMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInChatstateFromUserMixin").parseFromUserMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"FromUser",value:b.value});var c=d("WASmaxInChatstateFromGroupMixin").parseFromGroupMixin(a);return c.success?d("WAResultOrError").makeResult({name:"FromGroup",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["FromUser","FromGroup"],[b,c])}g.parseFromUserOrGroupMixinGroup=a}),98);
__d("WASmaxInChatstateInternalTestMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"test");if(!a.success)return a;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a.value,"config");return!a.success?a:d("WAResultOrError").makeResult({testConfig:a.value})}g.parseInternalTestMixin=a}),98);
__d("WASmaxInChatstateServerNotificationRequest",["WAResultOrError","WASmaxInChatstateComposingOrPausedMixinGroup","WASmaxInChatstateFromUserOrGroupMixinGroup","WASmaxInChatstateInternalTestMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"chatstate");if(!b.success)return b;b=d("WASmaxInChatstateInternalTestMixin").parseInternalTestMixin(a);var c=d("WASmaxInChatstateFromUserOrGroupMixinGroup").parseFromUserOrGroupMixinGroup(a);if(!c.success)return c;a=d("WASmaxInChatstateComposingOrPausedMixinGroup").parseComposingOrPausedMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({internalTestMixin:b.success?b.value:null,fromUserOrGroupMixinGroup:c.value,composingOrPausedMixinGroup:a.value})}g.parseServerNotificationRequest=a}),98);
__d("WASmaxChatstateServerNotificationRPC",["WASmaxInChatstateServerNotificationRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInChatstateServerNotificationRequest").parseServerNotificationRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("ServerNotification",{Request:a}));return{parsedRequest:a.value}}g.receiveServerNotificationRPC=a}),98);
__d("WACreateHandleChatState",["Promise","WAHandleChatStateProtocol","WAResultOrError","WASmaxChatstateServerNotificationRPC"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||b("Promise")).resolve(d("WAResultOrError").makeResult("NO_ACK"));function a(a){var b,c=(b=a.individualMessage)==null?void 0:b.handleIndividualChatState,e=(b=a.groupMessage)==null?void 0:b.handleGroupChatState;return function(a){if(c==null&&e==null)return i;a=d("WASmaxChatstateServerNotificationRPC").receiveServerNotificationRPC(a);a=a.parsedRequest;var b=a.composingOrPausedMixinGroup;a=a.fromUserOrGroupMixinGroup;b=d("WAHandleChatStateProtocol").parseChatStatus(b);if(a.name==="FromUser"){var f;return(f=c==null?void 0:c({status:b,jid:a.value.from}).then(d("WAResultOrError").makeResult))!=null?f:i}else{a.name;return(f=e==null?void 0:e({status:b,jid:a.value.from,participant:a.value.participant,participantPn:a.value.participantPn}).then(d("WAResultOrError").makeResult))!=null?f:i}}}g.createHandleChatState=a}),98);
__d("WAHandleErrorStanzaProtocol",[],(function(a,b,c,d,e,f){"use strict";a=479;f.SMAX_INVALID_CODE=a}),66);
__d("WASmaxInSmaxInvalidErrorRequest",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"code","479");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","smax-invalid");return!a.success?a:d("WAResultOrError").makeResult({code:b.value,text:a.value})}g.parseErrorRequest=a}),98);
__d("WASmaxSmaxInvalidErrorRPC",["WASmaxInSmaxInvalidErrorRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInSmaxInvalidErrorRequest").parseErrorRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Error",{Request:a}));return{parsedRequest:a.value}}g.receiveErrorRPC=a}),98);
__d("WAUnknownStanzaError",["WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";a=d("WAResultOrError").makeError({type:"unknown-stanza"});g.unknownStanzaError=a}),98);
__d("WACreateHandleErrorStanza",["Promise","WAHandleErrorStanzaProtocol","WALogger","WAResultOrError","WASmaxParseUtils","WASmaxSmaxInvalidErrorRPC","WAUnknownStanzaError"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Receiced error from server: ",""]);i=function(){return a};return a}function a(a){var c=a.error;return function(a){var e=d("WASmaxParseUtils").attrInt(a,"code");if(!e.success)return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError);e=e.value;if((c==null?void 0:c.handleSmaxErrorStanza)!=null&&e===d("WAHandleErrorStanzaProtocol").SMAX_INVALID_CODE){var f=d("WASmaxSmaxInvalidErrorRPC").receiveErrorRPC(a);f=f.parsedRequest;return c.handleSmaxErrorStanza({code:d("WAHandleErrorStanzaProtocol").SMAX_INVALID_CODE,text:f.text}).then(d("WAResultOrError").makeResult)}if((c==null?void 0:c.handleErrorStanza)!=null)return c.handleErrorStanza({code:e}).then(d("WAResultOrError").makeResult);d("WALogger").ERROR(i(),a.toString());return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult("NO_ACK"))}}g.createHandleErrorStanza=a}),98);
__d("WASmaxInLoginEnums",[],(function(a,b,c,d,e,f){a={400:"400",401:"401",402:"402",403:"403",405:"405",406:"406",409:"409",412:"412",413:"413",414:"414",415:"415",416:"416",500:"500",501:"501",503:"503"};b={"false":"false","true":"true"};f.ENUM_400_401_402_403_405_406_409_412_413_414_415_416_500_501_503=a;f.ENUM_FALSE_TRUE=b}),66);
__d("WASmaxInLoginFailureRequest",["WAResultOrError","WASmaxInLoginEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"failure");if(!b.success)return b;b=d("WASmaxParseUtils").attrStringEnum(a,"reason",d("WASmaxInLoginEnums").ENUM_400_401_402_403_405_406_409_412_413_414_415_416_500_501_503);if(!b.success)return b;var c=d("WASmaxParseUtils").attrString(a,"location");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"code");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"expire",0,void 0);if(!f.success)return f;var g=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"retry",0,void 0);if(!g.success)return g;var h=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"t",0,void 0);if(!h.success)return h;var i=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"message");if(!i.success)return i;var j=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"vt",1,1e5);if(!j.success)return j;var k=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a,"has_offline",d("WASmaxInLoginEnums").ENUM_FALSE_TRUE);if(!k.success)return k;var l=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"url");if(!l.success)return l;var m=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"logout_message_header");if(!m.success)return m;var n=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"logout_message_subtext");if(!n.success)return n;var o=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"logout_message_locale");if(!o.success)return o;var p=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"logout_main_button_text");if(!p.success)return p;var q=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"logout_main_button_url");if(!q.success)return q;var r=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"logout_secondary_button_text");if(!r.success)return r;var s=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"logout_secondary_button_url");if(!s.success)return s;var t=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"logout_secondary_button_ch_entrypoint_id");if(!t.success)return t;var u=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"appeal_token");if(!u.success)return u;var v=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"violation_reason");if(!v.success)return v;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"source_acct",-1,2);return!a.success?a:d("WAResultOrError").makeResult({reason:b.value,location:c.value,code:e.value,expire:f.value,retry:g.value,t:h.value,message:i.value,vt:j.value,hasOffline:k.value,url:l.value,logoutMessageHeader:m.value,logoutMessageSubtext:n.value,logoutMessageLocale:o.value,logoutMainButtonText:p.value,logoutMainButtonUrl:q.value,logoutSecondaryButtonText:r.value,logoutSecondaryButtonUrl:s.value,logoutSecondaryButtonChEntrypointId:t.value,appealToken:u.value,violationReason:v.value,sourceAcct:a.value})}g.parseFailureRequest=a}),98);
__d("WASmaxLoginFailureRPC",["WASmaxInLoginFailureRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInLoginFailureRequest").parseFailureRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Failure",{Request:a}));return{parsedRequest:a.value}}g.receiveFailureRPC=a}),98);
__d("WACreateHandleFailure",["Promise","WAResultOrError","WASmaxLoginFailureRPC"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var c=(a=a.login)==null?void 0:a.handleLoginFailure;return function(a){if(c!=null){a=d("WASmaxLoginFailureRPC").receiveFailureRPC(a);a=a.parsedRequest;return c({reason:a.reason,location:a.location,expire:a.expire}).then(d("WAResultOrError").makeResult)}return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult("NO_ACK"))}}g.createHandleFailure=a}),98);
__d("WASmaxInDirtyBitsIQErrorBadRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","bad-request");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",400);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorBadRequestMixin=a}),98);
__d("WASmaxInDirtyBitsIQErrorFeatureNotImplementedMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","feature-not-implemented");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",501);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorFeatureNotImplementedMixin=a}),98);
__d("WASmaxInDirtyBitsIQErrorInternalServerErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","internal-server-error");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",500);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorInternalServerErrorMixin=a}),98);
__d("WASmaxInDirtyBitsIQErrorServiceUnavailableMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","service-unavailable");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",503);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorServiceUnavailableMixin=a}),98);
__d("WASmaxInDirtyBitsIQErrorBadRequestOrFeatureNotImplementedOrServiceUnavailableOrInternalServerErrorMixinGroup",["WAResultOrError","WASmaxInDirtyBitsIQErrorBadRequestMixin","WASmaxInDirtyBitsIQErrorFeatureNotImplementedMixin","WASmaxInDirtyBitsIQErrorInternalServerErrorMixin","WASmaxInDirtyBitsIQErrorServiceUnavailableMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInDirtyBitsIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:b.value});var c=d("WASmaxInDirtyBitsIQErrorFeatureNotImplementedMixin").parseIQErrorFeatureNotImplementedMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IQErrorFeatureNotImplemented",value:c.value});var e=d("WASmaxInDirtyBitsIQErrorServiceUnavailableMixin").parseIQErrorServiceUnavailableMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"IQErrorServiceUnavailable",value:e.value});var f=d("WASmaxInDirtyBitsIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(a);return f.success?d("WAResultOrError").makeResult({name:"IQErrorInternalServerError",value:f.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorBadRequest","IQErrorFeatureNotImplemented","IQErrorServiceUnavailable","IQErrorInternalServerError"],[b,c,e,f])}g.parseIQErrorBadRequestOrFeatureNotImplementedOrServiceUnavailableOrInternalServerErrorMixinGroup=a}),98);
__d("WASmaxInDirtyBitsIQErrorResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","error");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQErrorResponseMixin=a}),98);
__d("WASmaxInDirtyBitsCleanResponseError",["WAResultOrError","WASmaxInDirtyBitsIQErrorBadRequestOrFeatureNotImplementedOrServiceUnavailableOrInternalServerErrorMixinGroup","WASmaxInDirtyBitsIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInDirtyBitsIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInDirtyBitsIQErrorBadRequestOrFeatureNotImplementedOrServiceUnavailableOrInternalServerErrorMixinGroup").parseIQErrorBadRequestOrFeatureNotImplementedOrServiceUnavailableOrInternalServerErrorMixinGroup(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorIQErrorBadRequestOrFeatureNotImplementedOrServiceUnavailableOrInternalServerErrorMixinGroup:b.value}))}g.parseCleanResponseError=a}),98);
__d("WASmaxInDirtyBitsIQResultResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQResultResponseMixin=a}),98);
__d("WASmaxInDirtyBitsCleanResponseSuccess",["WASmaxInDirtyBitsIQResultResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxInDirtyBitsIQResultResponseMixin").parseIQResultResponseMixin(a,b);return!c.success?c:c}g.parseCleanResponseSuccess=a}),98);
__d("WASmaxOutDirtyBitsBaseIQSetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("iq",{id:d("WAWap").generateId(),type:"set"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBaseIQSetRequestMixin=a}),98);
__d("WASmaxOutDirtyBitsCleanTypeMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.cleanType;a=a.cleanTimestamp;b=d("WASmaxJsx").smax("clean",{type:d("WAWap").CUSTOM_STRING(b),timestamp:d("WASmaxAttrs").OPTIONAL(d("WAWap").INT,a)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeCleanTypeMixin=a}),98);
__d("WASmaxOutDirtyBitsCleanTypeWithTimestampMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.cleanTimestamp;a=d("WASmaxJsx").smax("clean",{type:"syncd_app_state",timestamp:d("WAWap").INT(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeCleanTypeWithTimestampMixin=a}),98);
__d("WASmaxOutDirtyBitsTypeCleanOrCleanWithTimestampMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutDirtyBitsCleanTypeMixin","WASmaxOutDirtyBitsCleanTypeWithTimestampMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.cleanType)return d("WASmaxOutDirtyBitsCleanTypeMixin").mergeCleanTypeMixin(a,b.cleanType);if(b.cleanTypeWithTimestamp)return d("WASmaxOutDirtyBitsCleanTypeWithTimestampMixin").mergeCleanTypeWithTimestampMixin(a,b.cleanTypeWithTimestamp);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeTypeCleanOrCleanWithTimestampMixinGroup=a}),98);
__d("WASmaxOutDirtyBitsCleanRequest",["WASmaxJsx","WASmaxOutDirtyBitsBaseIQSetRequestMixin","WASmaxOutDirtyBitsTypeCleanOrCleanWithTimestampMixinGroup","WAWap"],(function(a,b,c,d,e,f,g){function a(a){a=a.typeCleanOrCleanWithTimestampMixinGroupArgs;a=d("WASmaxOutDirtyBitsBaseIQSetRequestMixin").mergeBaseIQSetRequestMixin(d("WASmaxJsx").smax("iq",{to:d("WAWap").S_WHATSAPP_NET,xmlns:"urn:xmpp:whatsapp:dirty"},d("WASmaxOutDirtyBitsTypeCleanOrCleanWithTimestampMixinGroup").mergeTypeCleanOrCleanWithTimestampMixinGroup(d("WASmaxJsx").smax("clean",null),a)));return a}g.makeCleanRequest=a}),98);
__d("WASmaxDirtyBitsCleanRPC",["WAComms","WASmaxInDirtyBitsCleanResponseError","WASmaxInDirtyBitsCleanResponseSuccess","WASmaxOutDirtyBitsCleanRequest","WASmaxParsingFailure","WASmaxRpcUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:e=d("WASmaxOutDirtyBitsCleanRequest").makeCleanRequest(a);i.next=3;return b("regeneratorRuntime").awrap(d("WAComms").sendSmaxStanza(e,c));case 3:f=i.sent;g=d("WASmaxInDirtyBitsCleanResponseSuccess").parseCleanResponseSuccess(f,e);if(!g.success){i.next=7;break}return i.abrupt("return",{name:"CleanResponseSuccess",value:g.value});case 7:h=d("WASmaxInDirtyBitsCleanResponseError").parseCleanResponseError(f,e);if(!h.success){i.next=10;break}return i.abrupt("return",{name:"CleanResponseError",value:h.value});case 10:throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Clean",{Success:g,Error:h}));case 11:case"end":return i.stop()}},null,this)}g.sendCleanRPC=a}),98);
__d("WACleanDirtyBitsProtocol",["WALogger","WASmaxDirtyBitsCleanRPC","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to clean dirty bits for type: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendCleanRPC error: ",""]);i=function(){return a};return a}function a(a){var c,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:a.type==="syncd_app_state"?c={cleanTypeWithTimestamp:{cleanTimestamp:a.timestamp}}:c={cleanType:{cleanTimestamp:a.timestamp,cleanType:a.type}};f.next=3;return b("regeneratorRuntime").awrap(d("WASmaxDirtyBitsCleanRPC").sendCleanRPC({typeCleanOrCleanWithTimestampMixinGroupArgs:c}));case 3:e=f.sent,e.name!=="CleanResponseSuccess"&&(d("WALogger").WARN(i(),e),d("WALogger").ERROR(h(),a.type));case 5:case"end":return f.stop()}},null,this)}g.cleanDirtyBitsProtocol=a}),98);
__d("WASmaxInDirtyBitsEnums",[],(function(a,b,c,d,e,f){a={account_sync:"account_sync",groups:"groups",newsletter_metadata:"newsletter_metadata",syncd_app_state:"syncd_app_state"};f.ENUM_ACCOUNTSYNC_GROUPS_NEWSLETTERMETADATA_SYNCDAPPSTATE=a}),66);
__d("WASmaxInDirtyBitsNotifyRequest",["WAResultOrError","WASmaxInDirtyBitsEnums","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ib");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"dirty");if(!b.success)return b;a=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrDomainJid,a,"from","s.whatsapp.net");if(!a.success)return a;var c=d("WASmaxParseUtils").attrIntRange(b.value,"timestamp",0,void 0);if(!c.success)return c;b=d("WASmaxParseUtils").attrStringEnum(b.value,"type",d("WASmaxInDirtyBitsEnums").ENUM_ACCOUNTSYNC_GROUPS_NEWSLETTERMETADATA_SYNCDAPPSTATE);return!b.success?b:d("WAResultOrError").makeResult({from:a.value,dirtyTimestamp:c.value,dirtyType:b.value})}g.parseNotifyRequest=a}),98);
__d("WASmaxDirtyBitsNotifyRPC",["WASmaxInDirtyBitsNotifyRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInDirtyBitsNotifyRequest").parseNotifyRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Notify",{Request:a}));return{parsedRequest:a.value}}g.receiveNotifyRPC=a}),98);
__d("WAHandleDirtyBitsProtocol",["WASmaxDirtyBitsNotifyRPC"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a=d("WASmaxDirtyBitsNotifyRPC").receiveNotifyRPC(a);a=a.parsedRequest;var b=a.dirtyType;a=a.dirtyTimestamp;return{dirtyBitType:b,dirtyBitTimestamp:a}}g.parseDirtyBit=a}),98);
__d("WAHandleThreadMetadata",["WAGlobals","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var c;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:c=a.map(function(a){return a.from});e.next=3;return b("regeneratorRuntime").awrap(d("WAGlobals").getWaOneQueue().enqueue(function(a){a=a.cryptoManager;return a.storage.warmCache(c)},{operationType:"thread_metadata",flush:!1}));case 3:case"end":return e.stop()}},null,this)}g.handleThreadMetadata=a}),98);
__d("WASmaxDecisionTreeUtils",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=d("WASmaxParseUtils").maybeChildren(a);if(!b.success)return b;b=b.value;return b==null||b.length===0?d("WASmaxParseUtils").errorMessage(a,"to have at least 1 child, but found 0"):d("WAResultOrError").makeResult(b[0])}g.firstChild=a}),98);
__d("WASmaxInEdgeEdgeRoutingRequest",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ib");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"edge_routing");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(b.value,"routing_info");if(!b.success)return b;a=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrDomainJid,a,"from","s.whatsapp.net");if(!a.success)return a;b=d("WASmaxParseUtils").contentBytesRange(b.value,1,1024);return!b.success?b:d("WAResultOrError").makeResult({from:a.value,edgeRoutingRoutingInfoElementValue:b.value})}g.parseEdgeRoutingRequest=a}),98);
__d("WASmaxEdgeEdgeRoutingRPC",["WASmaxInEdgeEdgeRoutingRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInEdgeEdgeRoutingRequest").parseEdgeRoutingRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("EdgeRouting",{Request:a}));return{parsedRequest:a.value}}g.receiveEdgeRoutingRPC=a}),98);
__d("WASmaxInMessageRequestEnums",[],(function(a,b,c,d,e,f){a={complete:"complete","continue":"continue"};f.ENUM_COMPLETE_CONTINUE=a}),66);
__d("WASmaxInMessageRequestSpamMarkerRequest",["WAResultOrError","WASmaxInMessageRequestEnums","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ib");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"spam");if(!b.success)return b;a=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrDomainJid,a,"from","s.whatsapp.net");if(!a.success)return a;b=d("WASmaxParseUtils").attrStringEnum(b.value,"state",d("WASmaxInMessageRequestEnums").ENUM_COMPLETE_CONTINUE);return!b.success?b:d("WAResultOrError").makeResult({from:a.value,spamState:b.value})}g.parseSpamMarkerRequest=a}),98);
__d("WASmaxMessageRequestSpamMarkerRPC",["WASmaxInMessageRequestSpamMarkerRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInMessageRequestSpamMarkerRequest").parseSpamMarkerRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("SpamMarker",{Request:a}));return{parsedRequest:a.value}}g.receiveSpamMarkerRPC=a}),98);
__d("WASmaxInOfflineCompletionRequest",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ib");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"offline");if(!b.success)return b;a=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrDomainJid,a,"from","s.whatsapp.net");if(!a.success)return a;b=d("WASmaxParseUtils").attrIntRange(b.value,"count",0,void 0);return!b.success?b:d("WAResultOrError").makeResult({from:a.value,offlineCount:b.value})}g.parseCompletionRequest=a}),98);
__d("WASmaxOfflineCompletionRPC",["WASmaxInOfflineCompletionRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInOfflineCompletionRequest").parseCompletionRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Completion",{Request:a}));return{parsedRequest:a.value}}g.receiveCompletionRPC=a}),98);
__d("WASmaxInOfflinePreviewRequest",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ib");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"offline_preview");if(!b.success)return b;a=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrDomainJid,a,"from","s.whatsapp.net");if(!a.success)return a;var c=d("WASmaxParseUtils").attrIntRange(b.value,"count",0,void 0);if(!c.success)return c;var e=d("WASmaxParseUtils").attrIntRange(b.value,"message",0,void 0);if(!e.success)return e;var f=d("WASmaxParseUtils").attrIntRange(b.value,"receipt",0,void 0);if(!f.success)return f;var g=d("WASmaxParseUtils").attrIntRange(b.value,"notification",0,void 0);if(!g.success)return g;var h=d("WASmaxParseUtils").attrIntRange(b.value,"appdata",0,void 0);if(!h.success)return h;b=d("WASmaxParseUtils").attrIntRange(b.value,"call",0,void 0);return!b.success?b:d("WAResultOrError").makeResult({from:a.value,offlinePreviewCount:c.value,offlinePreviewMessage:e.value,offlinePreviewReceipt:f.value,offlinePreviewNotification:g.value,offlinePreviewAppdata:h.value,offlinePreviewCall:b.value})}g.parsePreviewRequest=a}),98);
__d("WASmaxOfflinePreviewRPC",["WASmaxInOfflinePreviewRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInOfflinePreviewRequest").parsePreviewRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Preview",{Request:a}));return{parsedRequest:a.value}}g.receivePreviewRPC=a}),98);
__d("WASmaxInOfflineEnums",["WAJids"],(function(a,b,c,d,e,f,g){b={validators:[(a=d("WAJids")).validateGroupJid,a.validateUserJid,a.validateUserJid,a.validateUserJid],typeName:"GroupJid|UserJid|UserJid|UserJid"};g.GROUPJID_USERJID_USERJID_USERJID=b}),98);
__d("WASmaxInOfflineThreadMetadataDelayedMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"item");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"from");return!b.success?b:d("WAResultOrError").makeResult({from:b.value})}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"status_msgs");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"count",0,void 0);if(!b.success)return b;a=d("WASmaxParseUtils").mapChildrenWithTag(a,"item",1,Infinity,h);return!a.success?a:d("WAResultOrError").makeResult({count:b.value,item:a.value})}function j(a){var b=d("WASmaxParseUtils").assertTag(a,"notifications");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"count",0,void 0);return!b.success?b:d("WAResultOrError").makeResult({count:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"thread_metadata");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"status_msgs",i);if(!b.success)return b;a=d("WASmaxParseUtils").optionalChildWithTag(a,"notifications",j);return!a.success?a:d("WAResultOrError").makeResult({statusMsgs:b.value,notifications:a.value})}g.parseThreadMetadataDelayedStatusMsgsItem=h;g.parseThreadMetadataDelayedStatusMsgs=i;g.parseThreadMetadataDelayedNotifications=j;g.parseThreadMetadataDelayedMixin=a}),98);
__d("WASmaxInOfflineThreadMetadataRequest",["WAResultOrError","WASmaxInOfflineEnums","WASmaxInOfflineThreadMetadataDelayedMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"item");if(!b.success)return b;b=d("WASmaxParseJid").attrJidEnum(a,"from",d("WASmaxInOfflineEnums").GROUPJID_USERJID_USERJID_USERJID);if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({from:b.value,t:a.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ib");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"thread_metadata");if(!b.success)return b;a=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrDomainJid,a,"from","s.whatsapp.net");if(!a.success)return a;var c=d("WASmaxInOfflineThreadMetadataDelayedMixin").parseThreadMetadataDelayedMixin(b.value);b=d("WASmaxParseUtils").mapChildrenWithTag(b.value,"item",0,50,h);return!b.success?b:d("WAResultOrError").makeResult({from:a.value,threadMetadataThreadMetadataDelayedMixin:c.success?c.value:null,threadMetadataItem:b.value})}g.parseThreadMetadataRequestThreadMetadataItem=h;g.parseThreadMetadataRequest=a}),98);
__d("WASmaxOfflineThreadMetadataRPC",["WASmaxInOfflineThreadMetadataRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInOfflineThreadMetadataRequest").parseThreadMetadataRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("ThreadMetadata",{Request:a}));return{parsedRequest:a.value}}g.receiveThreadMetadataRPC=a}),98);
__d("WACreateHandleInfoBulletin",["Promise","WACleanDirtyBitsProtocol","WAHandleDirtyBitsProtocol","WAHandleThreadMetadata","WALogger","WAResultOrError","WASmaxDecisionTreeUtils","WASmaxEdgeEdgeRoutingRPC","WASmaxMessageRequestSpamMarkerRPC","WASmaxOfflineCompletionRPC","WASmaxOfflinePreviewRPC","WASmaxOfflineThreadMetadataRPC","WATimeUtils","WAUnknownStanzaError"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleInfoBulletin: unknown incoming <ib>: ",""]);i=function(){return a};return a}var j=(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult("NO_ACK"));function a(a){return function(c){var e=d("WASmaxDecisionTreeUtils").firstChild(c);if(e.success===!1)return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError);e=e.value.tag;switch(e){case"edge_routing":var f;e=d("WASmaxEdgeEdgeRoutingRPC").receiveEdgeRoutingRPC(c).parsedRequest;e=e.edgeRoutingRoutingInfoElementValue;return(f=(f=a.comms)==null?void 0:f.handleEdgeRoutingInfo({edgeInfo:e}).then(d("WAResultOrError").makeResult))!=null?f:j;case"offline_preview":e=d("WASmaxOfflinePreviewRPC").receivePreviewRPC(c).parsedRequest;f={count:e.offlinePreviewCount,message:e.offlinePreviewMessage,receipt:e.offlinePreviewReceipt,notification:e.offlinePreviewNotification,appdata:e.offlinePreviewAppdata};return(e=(e=a.offline)==null?void 0:e.handleOfflineStart(f).then(d("WAResultOrError").makeResult))!=null?e:j;case"offline":f=d("WASmaxOfflineCompletionRPC").receiveCompletionRPC(c).parsedRequest.offlineCount;return(e=(e=a.offline)==null?void 0:e.handleOfflineEnd({offlineCount:f}).then(d("WAResultOrError").makeResult))!=null?e:j;case"thread_metadata":var g=d("WASmaxOfflineThreadMetadataRPC").receiveThreadMetadataRPC(c).parsedRequest.threadMetadataItem.map(function(a){var b=a.from;a=a.t;return{from:b,t:d("WATimeUtils").castToUnixTime(a)}});return d("WAHandleThreadMetadata").handleThreadMetadata(g).then(function(){var b;return(b=(b=a.offline)==null?void 0:b.handleThreadMetadata(g).then(d("WAResultOrError").makeResult))!=null?b:j});case"spam":f=d("WASmaxMessageRequestSpamMarkerRPC").receiveSpamMarkerRPC(c).parsedRequest.spamState;return(e=(e=a.spam)==null?void 0:e.handleSpam({spamState:f}).then(d("WAResultOrError").makeResult))!=null?e:j;case"dirty":f=d("WAHandleDirtyBitsProtocol").parseDirtyBit(c);var k=f.dirtyBitTimestamp,l=f.dirtyBitType;e=function(){return d("WACleanDirtyBitsProtocol").cleanDirtyBitsProtocol({timestamp:k,type:l})};switch(l){case"groups":return(f=(f=a.groupMessage)==null?void 0:f.handleGroupDirtyBit==null?void 0:f.handleGroupDirtyBit({dirtyBitTimestamp:k,cleanDirtyBits:e}).then(d("WAResultOrError").makeResult))!=null?f:j;case"account_sync":return(f=(f=a.accountSync)==null?void 0:f.handleAccountSyncDirtyBit({dirtyBitTimestamp:k,cleanDirtyBits:e}).then(d("WAResultOrError").makeResult))!=null?f:j;case"newsletter_metadata":return(f=(f=a.newsletter)==null?void 0:f.handleNewsletterDirtyBit({dirtyBitTimestamp:k,cleanDirtyBits:e}).then(d("WAResultOrError").makeResult))!=null?f:j;default:l;return(f=(f=a.syncd)==null?void 0:f.handleSyncdDirtyBit({dirtyBitTimestamp:k,cleanDirtyBits:e}).then(d("WAResultOrError").makeResult))!=null?f:j}default:d("WALogger").WARN(i(),c.toString());return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError)}}}g.createHandleInfoBulletin=a}),98);
__d("WAAdv",["WAAdv.pb","WABinary","WAByteArray","WACryptoDependencies","WACryptoHmac","WACryptoUtils","WAResultOrError","WASignalKeys","WASignalOther","WASignalSignatures","decodeProtobuf","encodeProtobuf","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h=new Uint8Array([6,0]),i=new Uint8Array([6,1]);function a(a){return a}function c(a){return a}function e(a){return a}function f(){var a=new Uint8Array(32);d("WACryptoDependencies").getCrypto().getRandomValues(a);return a}function j(a){var c,e,f,g,i,j,k,l,m,n,o,p,q;return b("regeneratorRuntime").async(function(r){while(1)switch(r.prev=r.next){case 0:c=a.advSignedDeviceIdentityHmacProtobuf,e=a.advSecretKey,f=a.identityPubKey;g=d("decodeProtobuf").decodeProtobuf(d("WAAdv.pb").ADVSignedDeviceIdentityHMACSpec,c);i=g.details;j=g.hmac;if(!(i==null)){r.next=6;break}return r.abrupt("return",d("WAResultOrError").makeError("missing-identity-hmac-details"));case 6:if(!(j==null)){r.next=8;break}return r.abrupt("return",d("WAResultOrError").makeError("missing-identity-hmac"));case 8:r.next=10;return b("regeneratorRuntime").awrap(d("WACryptoHmac").hmacSha256(e,i));case 10:k=r.sent;if(d("WACryptoUtils").arrayBuffersEqual(k,j)){r.next=13;break}return r.abrupt("return",d("WAResultOrError").makeError("hmac-mismatch"));case 13:l=d("decodeProtobuf").decodeProtobuf(d("WAAdv.pb").ADVSignedDeviceIdentitySpec,i);m=l.details;if(!(m==null)){r.next=17;break}return r.abrupt("return",d("WAResultOrError").makeError("missing-account-signature-details"));case 17:n=l.accountSignatureKey;if(!(n==null)){r.next=20;break}return r.abrupt("return",d("WAResultOrError").makeError("missing-account-signature-key"));case 20:o=l.accountSignature;if(!(o==null)){r.next=23;break}return r.abrupt("return",d("WAResultOrError").makeError("missing-account-signature"));case 23:p=d("WABinary").Binary.build(h,m,f).readByteArray();q=d("WASignalSignatures").verifyMsgSignalVariant(d("WASignalKeys").serializeIdentity(new Uint8Array(n)),p,d("WASignalOther").toBytes(o,64));if(q){r.next=27;break}return r.abrupt("return",d("WAResultOrError").makeError("signature-mismatch"));case 27:return r.abrupt("return",d("WAResultOrError").makeResult({advSignedDeviceIdentity:l}));case 28:case"end":return r.stop()}},null,this)}function k(a){var c,e,f,g,h,j,k,l,m;return b("regeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:c=a.advSignedDeviceIdentity,e=a.identityKeyPair;f=c.details;g=d("decodeProtobuf").decodeProtobuf(d("WAAdv.pb").ADVDeviceIdentitySpec,f);h=g.keyIndex;if(!(h==null)){n.next=6;break}return n.abrupt("return",d("WAResultOrError").makeError("missing-key-index"));case 6:j=d("WABinary").Binary.build(i,f,e.publicKey,c.accountSignatureKey).readByteArray();n.next=9;return b("regeneratorRuntime").awrap(d("WASignalSignatures").signMsg(e,j));case 9:k=n.sent;l=babelHelpers["extends"]({},c);l.deviceSignature=d("WAByteArray").uint8ArrayToBuffer(k);l.accountSignatureKey=void 0;m=d("encodeProtobuf").encodeProtobuf(d("WAAdv.pb").ADVSignedDeviceIdentitySpec,l).readByteArray();return n.abrupt("return",d("WAResultOrError").makeResult({signedDeviceIdentityProtobuf:m,keyIndex:h}));case 15:case"end":return n.stop()}},null,this)}g.castToAdvSignedDeviceIdentityHmacProtobuf=a;g.castToAdvSecretKey=c;g.castToAdvSignedDeviceIdentityProtobuf=e;g.generateAdvSecretKey=f;g.verifyAdvSignedDeviceIdentity=j;g.addDeviceSignatureToProtobuf=k}),98);
__d("WASmaxInMdBaseIQSetRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"iq");if(!b.success)return b;b=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","set");return!a.success?a:d("WAResultOrError").makeResult({id:b.value,type:a.value})}g.parseBaseIQSetRequestMixin=a}),98);
__d("WASmaxInMdSetToCompanionRequest",["WAResultOrError","WASmaxInMdBaseIQSetRequestMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"ref");if(!b.success)return b;b=d("WASmaxParseUtils").contentBytes(a);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"iq");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"pair-device");if(!b.success)return b;var c=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrDomainJid,a,"from","s.whatsapp.net");if(!c.success)return c;var e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"xmlns","md");if(!e.success)return e;a=d("WASmaxInMdBaseIQSetRequestMixin").parseBaseIQSetRequestMixin(a);if(!a.success)return a;b=d("WASmaxParseUtils").mapChildrenWithTag(b.value,"ref",6,6,h);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({from:c.value,xmlns:e.value},a.value,{pairDeviceRef:b.value}))}g.parseSetToCompanionRequestPairDeviceRef=h;g.parseSetToCompanionRequest=a}),98);
__d("WASmaxOutMdSetToCompanionResponseClientResponse",["WASmaxJsx","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);a=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrDomainJid,a,["from"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("iq",{id:d("WAWap").STANZA_ID(b.value),to:d("WAWap").DOMAIN_JID(a.value),type:"result"});return b}g.makeSetToCompanionResponseClientResponse=a}),98);
__d("WASmaxMdSetToCompanionRPC",["WASmaxInMdSetToCompanionRequest","WASmaxOutMdSetToCompanionResponseClientResponse","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMdSetToCompanionRequest").parseSetToCompanionRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("SetToCompanion",{Request:b}));return{parsedRequest:b.value,makeSetToCompanionResponseClientResponse:function(){return d("WASmaxOutMdSetToCompanionResponseClientResponse").makeSetToCompanionResponseClientResponse(a)}}}g.receiveSetToCompanionRPC=a}),98);
__d("WAHandlePairDeviceProtocol",["WABase64","WABinary","WAResultOrError","WASmaxMdSetToCompanionRPC"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a=d("WASmaxMdSetToCompanionRPC").receiveSetToCompanionRPC(a);var b=a.makeSetToCompanionResponseClientResponse;a=a.parsedRequest;a=a.pairDeviceRef.map(function(a){a=a.elementValue;a=new(d("WABinary").Binary)(a);return a.readString(a.size())});return d("WAResultOrError").makeResult({refs:a,makeAck:b})}b=function(a){var b=a.ref,c=a.publicAuthKey,e=a.publicIdentityKey;a=a.advSecretKey;return b+","+d("WABase64").encodeB64(c)+","+d("WABase64").encodeB64(e)+","+d("WABase64").encodeB64(a)};g.parsePairDevice=a;g.generateRegistrationQrCodeString=b}),98);
__d("WASmaxInMdEnums",[],(function(a,b,c,d,e,f){a={"false":"false","true":"true"};f.ENUM_FALSE_TRUE=a}),66);
__d("WASmaxInMdSetRegRequest",["WAResultOrError","WASmaxInMdBaseIQSetRequestMixin","WASmaxInMdEnums","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"biz");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"name");return!b.success?b:d("WAResultOrError").makeResult({name:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"iq");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"pair-success");if(!b.success)return b;var c=d("WASmaxParseUtils").flattenedChildWithTag(b.value,"device-identity");if(!c.success)return c;var e=d("WASmaxParseUtils").flattenedChildWithTag(b.value,"device");if(!e.success)return e;var f=d("WASmaxParseUtils").flattenedChildWithTag(b.value,"platform");if(!f.success)return f;b=d("WASmaxParseUtils").optionalChildWithTag(b.value,"biz",h);if(!b.success)return b;var g=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrDomainJid,a,"from","s.whatsapp.net");if(!g.success)return g;var i=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"xmlns","md");if(!i.success)return i;c=d("WASmaxParseUtils").contentBytesRange(c.value,1,500);if(!c.success)return c;var j=d("WASmaxParseJid").attrDeviceJid(e.value,"jid");if(!j.success)return j;var k=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrDeviceJid,e.value,"lid");if(!k.success)return k;e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,e.value,"beta",d("WASmaxInMdEnums").ENUM_FALSE_TRUE);if(!e.success)return e;f=d("WASmaxParseUtils").attrString(f.value,"name");if(!f.success)return f;a=d("WASmaxInMdBaseIQSetRequestMixin").parseBaseIQSetRequestMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({from:g.value,xmlns:i.value,pairSuccessDeviceIdentityElementValue:c.value,pairSuccessDeviceJid:j.value,pairSuccessDeviceLid:k.value,pairSuccessDeviceBeta:e.value,pairSuccessPlatformName:f.value},a.value,{pairSuccessBiz:b.value}))}g.parseSetRegRequestPairSuccessBiz=h;g.parseSetRegRequest=a}),98);
__d("WASmaxOutMdRegularCompanionSetRegResponseBundleMixin",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.keyAttestationKeyId;a=a.keyAttestationElementValue;b=d("WASmaxJsx").smax("key_attestation",{key_id:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,b)},a);return b}function i(a){a=a.gpiaElementValue;a=d("WASmaxJsx").smax("gpia",null,a);return a}function j(a){var b=a.keyAttestationArgs,c=a.gpiaArgs,e=a.deviceIdentityKeyIndex;a=a.deviceIdentityElementValue;e=d("WASmaxJsx").smax("smax$any",null,d("WASmaxJsx").smax("pair-device-sign",null,d("WASmaxJsx").smax("device-identity",{"key-index":d("WAWap").INT(e)},a),d("WASmaxChildren").OPTIONAL_CHILD(h,b),d("WASmaxChildren").OPTIONAL_CHILD(i,c)));return e}function a(a,b){b=j(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeRegularCompanionSetRegResponseBundlePairDeviceSignKeyAttestation=h;g.makeRegularCompanionSetRegResponseBundlePairDeviceSignGpia=i;g.mergeRegularCompanionSetRegResponseBundleMixin=a}),98);
__d("WASmaxOutMdSetRegResponseClientResponse",["WASmaxJsx","WASmaxOutMdRegularCompanionSetRegResponseBundleMixin","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a,b){b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,b,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);b=d("WASmaxOutMdRegularCompanionSetRegResponseBundleMixin").mergeRegularCompanionSetRegResponseBundleMixin(d("WASmaxJsx").smax("iq",{id:d("WAWap").STANZA_ID(b.value),to:d("WAWap").S_WHATSAPP_NET,type:"result"}),a);return b}g.makeSetRegResponseClientResponse=a}),98);
__d("WASmaxOutMdIQErrorNotAuthorizedMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("error",{text:"not-authorized",code:d("WAWap").INT(401)});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIQErrorNotAuthorizedMixin=a}),98);
__d("WASmaxOutMdSetRegResponseError",["WASmaxJsx","WASmaxOutMdIQErrorNotAuthorizedMixin","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);a=d("WASmaxJsx").smax("iq",{id:d("WAWap").STANZA_ID(a.value),to:d("WAWap").S_WHATSAPP_NET,type:"error"},d("WASmaxOutMdIQErrorNotAuthorizedMixin").mergeIQErrorNotAuthorizedMixin(d("WASmaxJsx").smax("error",null)));return a}g.makeSetRegResponseError=a}),98);
__d("WASmaxOutMdHostedCompanionSetRegResponseBundleMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.deviceIdentityElementValue;a=d("WASmaxJsx").smax("smax$any",null,d("WASmaxJsx").smax("hosted-pair-set",null,d("WASmaxJsx").smax("device-identity",null,a)));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeHostedCompanionSetRegResponseBundleMixin=a}),98);
__d("WASmaxOutMdSetRegResponseHostedClientResponse",["WASmaxJsx","WASmaxOutMdHostedCompanionSetRegResponseBundleMixin","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a,b){b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,b,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);b=d("WASmaxOutMdHostedCompanionSetRegResponseBundleMixin").mergeHostedCompanionSetRegResponseBundleMixin(d("WASmaxJsx").smax("iq",{id:d("WAWap").STANZA_ID(b.value),to:d("WAWap").S_WHATSAPP_NET,type:"result"}),a);return b}g.makeSetRegResponseHostedClientResponse=a}),98);
__d("WASmaxMdSetRegRPC",["WASmaxInMdSetRegRequest","WASmaxOutMdSetRegResponseClientResponse","WASmaxOutMdSetRegResponseError","WASmaxOutMdSetRegResponseHostedClientResponse","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMdSetRegRequest").parseSetRegRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("SetReg",{Request:b}));return{parsedRequest:b.value,makeSetRegResponseClientResponse:function(b){return d("WASmaxOutMdSetRegResponseClientResponse").makeSetRegResponseClientResponse(b,a)},makeSetRegResponseHostedClientResponse:function(b){return d("WASmaxOutMdSetRegResponseHostedClientResponse").makeSetRegResponseHostedClientResponse(b,a)},makeSetRegResponseError:function(){return d("WASmaxOutMdSetRegResponseError").makeSetRegResponseError(a)}}}g.receiveSetRegRPC=a}),98);
__d("WAHandlePairSuccessProtocol",["WAAdv","WAResultOrError","WASmaxMdSetRegRPC"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a=d("WASmaxMdSetRegRPC").receiveSetRegRPC(a);var b=a.makeSetRegResponseHostedClientResponse,c=a.makeSetRegResponseClientResponse,e=a.makeSetRegResponseError;a=a.parsedRequest;var f=a.pairSuccessDeviceIdentityElementValue,g=a.pairSuccessDeviceJid,h=a.pairSuccessPlatformName;a=a.pairSuccessBiz;return d("WAResultOrError").makeResult({bizName:a==null?void 0:a.name,platformName:h,deviceJid:g,advSignedDeviceIdentityHmacProtobuf:d("WAAdv").castToAdvSignedDeviceIdentityHmacProtobuf(f),makeSetRegResponseHostedClientResponse:b,makeSetRegResponseClientResponse:c,makeSetRegResponseError:e})}g.parsePairSuccess=a}),98);
__d("WASmaxInPingsServerPingRequest",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"iq");if(!b.success)return b;b=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrDomainJid,a,"from","s.whatsapp.net");if(!b.success)return b;var c=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!c.success)return c;var e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","get");if(!e.success)return e;var f=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"xmlns","urn:xmpp:ping");if(!f.success)return f;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStanzaId,a,"id");return!a.success?a:d("WAResultOrError").makeResult({from:b.value,t:c.value,type:e.value,xmlns:f.value,id:a.value})}g.parseServerPingRequest=a}),98);
__d("WASmaxOutPingsServerPingResponseClientResponse",["WASmaxAttrs","WASmaxJsx","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=a.hasIqXmlnsUrnx3Axmppx3Aping;a=a.iqTo;b=d("WASmaxJsx").smax("iq",{xmlns:d("WASmaxAttrs").OPTIONAL_LITERAL("urn:xmpp:ping",b),to:d("WAWap").JID(a),type:"result",id:d("WAWap").generateId()});return b}g.makeServerPingResponseClientResponse=a}),98);
__d("WASmaxOutPingsServerPingResponseClientResponseError",["WASmaxAttrs","WASmaxJsx","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b,c=a.iqTo,e=a.errorCode;a=a.errorText;c=d("WASmaxJsx").smax("iq",{to:(b=d("WAWap")).JID(c),type:"error",id:b.generateId()},d("WASmaxJsx").smax("error",{code:b.CUSTOM_STRING(e),text:d("WASmaxAttrs").OPTIONAL(b.CUSTOM_STRING,a)}));return c}g.makeServerPingResponseClientResponseError=a}),98);
__d("WASmaxPingsServerPingRPC",["WASmaxInPingsServerPingRequest","WASmaxOutPingsServerPingResponseClientResponse","WASmaxOutPingsServerPingResponseClientResponseError","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInPingsServerPingRequest").parseServerPingRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("ServerPing",{Request:a}));return{parsedRequest:a.value,makeServerPingResponseClientResponse:d("WASmaxOutPingsServerPingResponseClientResponse").makeServerPingResponseClientResponse,makeServerPingResponseClientResponseError:d("WASmaxOutPingsServerPingResponseClientResponseError").makeServerPingResponseClientResponseError}}g.receiveServerPingRPC=a}),98);
__d("WACreateHandleIq",["Promise","WAAdv","WAHandlePairDeviceProtocol","WAHandlePairSuccessProtocol","WAResultOrError","WASmaxParseUtils","WASmaxPingsServerPingRPC","WAUnknownStanzaError"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var c=a.md,e=a.comms;return function(a){var f=a.attrs;switch(f.xmlns){case"urn:xmpp:ping":f=e==null?void 0:e.handleServerPing;if(f!=null){var g=d("WASmaxPingsServerPingRPC").receiveServerPingRPC(a),i=g.parsedRequest.from,j=g.makeServerPingResponseClientResponse;return f({makeResponse:function(){return j({hasIqXmlnsUrnx3Axmppx3Aping:!1,iqTo:i})}}).then(d("WAResultOrError").makeResult)}break;case"md":g=d("WASmaxParseUtils").maybeChildren(a);if(g.success&&g.value!=null){f=g.value[0].tag;switch(f){case"pair-device":g=c==null?void 0:c.handlePairDevice;if(g!=null){f=d("WAHandlePairDeviceProtocol").parsePairDevice(a);f=f.value;var k=f.makeAck;f=f.refs;return g({generateRegistrationQrCodeString:d("WAHandlePairDeviceProtocol").generateRegistrationQrCodeString,makeAck:k,refs:f}).then(d("WAResultOrError").makeResult)}break;case"pair-success":g=c==null?void 0:c.handlePairSuccess;if(g!=null){k=d("WAHandlePairSuccessProtocol").parsePairSuccess(a);if(k.success)return g(babelHelpers["extends"]({},k.value,{addDeviceSignatureToProtobuf:d("WAAdv").addDeviceSignatureToProtobuf,verifyAdvSignedDeviceIdentity:d("WAAdv").verifyAdvSignedDeviceIdentity})).then(d("WAResultOrError").makeResult)}break}}}return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError)}}g.createHandleIq=a}),98);
__d("WACommonMessageBase",["WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.id,c=a.t,e=a.folderMixin,f=a.offlineMixin,g=a.metaHideDecryptionPlaceholderMixin,h=a.frankingMixin;return{stanzaId:b,serverTs:d("WATimeUtils").castToUnixTime(c),offline:f==null?void 0:f.offline,fbFolderId:e==null?void 0:e.folderId,hideDecryptionFailure:(g==null?void 0:g.metaDecryptFail)==="hide",frankingTag:h==null?void 0:(b=h.clientFrankingTagMixin)==null?void 0:b.frankingFrankingTagElementValue,reportingTag:h==null?void 0:h.frankingReportingTagElementValue,internalTestConfig:(c=a.internalTestMixin)==null?void 0:c.testConfig}}g.transformMessageParsedRequest=a}),98);
__d("WAHandleGroupMessageProtocol",["Promise","WACryptoManagerUtils","WACryptoPkcs7","WAE2E.pb","WAForceSecondRetryErrorTypes","WAGlobals","WAJids","WALogger","WAReceiptUtils","WAResultOrError","decodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["decryptGroupMessage error: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Fail to save senderKeySession ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["missing sender key in dual enc message"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["enc version "," is not supported."]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unknown message content type: ",""]);m=function(){return a};return a}function n(a){return a.name==="GroupDualEncMedia"?"ContentTypeMedia":a.value.contentDualMixins.name}function o(a){switch(a){case"ContentTypeText":return"text";case"ContentTypeLiveLocationSingle":return"live_location";case"ContentTypeMedia":return"media";case"ContentTypeMediaSingle":return"media";case"ContentTypePayGroup":return"pay";case"ContentTypeReaction":return"reaction";case"ContentTypeProductList":return"product_list";case"ContentTypePollCreation":return"poll_creation";case"ContentTypePollVote":return"poll_vote";case"ContentTypeScheduledCall":return"scheduled_call";default:a;d("WALogger").ERROR(m(),a);return"text"}}function a(a){var b=a.from,c=a.participant;a=a.groupDualOrSingleEncMixinGroup;var e=d("WAJids").extractUserJid(c);b={chat:b,author:e===d("WAGlobals").getMyUserJid()?"@me":e,from:c};switch(a.name){case"GroupSingleEnc":e=a.value;c=e.groupRetryOrBotResponseMessageOrGroupRegularMixinGroup;e=e.contentSingleMixins;return babelHelpers["extends"]({},b,{enc:p(c),contentType:o(e.name),type:"SingleEnc"});default:a.name;c=a.value.groupDualEncGroupDualEncMediaOrGroupDualEncNonMediaMediaMixinGroup;e=n(c);return babelHelpers["extends"]({},b,q(c),{type:"DualEnc",contentType:o(e)})}}function p(a){switch(a.name){case"GroupRetry":return{encVersion:a.value.encEncVersion2Or3OrFutureproofMixinGroup.value.v,ciphertext:a.value.encEncTypeIndividualMixin.elementValue,encType:a.value.encEncTypeIndividualMixin.type,retryCount:a.value.encEncRetryMixin.count};case"GroupRegular":a.name;return r(a.value.encEncVersion2Or3OrFutureproofMixinGroup.value,a.value.encEncTypeIndividualOrSenderKeyMixinGroup.value);default:a.name;return{ciphertext:a.value.encEncTypeMessageSecretMessageMixin.elementValue,encVersion:a.value.encEncVersion2OrFutureproofMixinGroup.value.v,encType:a.value.encEncTypeMessageSecretMessageMixin.type}}}function q(a){switch(a.name){case"GroupDualEncNonMedia":var b=a.value.enc,c=b[0];b=b[1];return{senderKeyDistributionEnc:r(c.encVersion2Or3OrFutureproofMixinGroup.value,c.encTypeSenderKeyOrIndividualMixinGroup.value),senderKeyMessageEnc:r(b.encVersion2Or3OrFutureproofMixinGroup.value,b.encTypeSenderKeyOrIndividualMixinGroup.value)};default:a.name;c=a.value.enc;b=c[0];a=c[1];return{senderKeyDistributionEnc:r(b.encVersion2Or3OrFutureproofMixinGroup.value,b.encTypeSenderKeyAndGroupMediaOrIndividualMixinGroup.value),senderKeyMessageEnc:r(a.encVersion2Or3OrFutureproofMixinGroup.value,a.encTypeSenderKeyAndGroupMediaOrIndividualMixinGroup.value)}}}function r(a,b){return{encVersion:a.v,ciphertext:b.elementValue,encType:b.type}}function c(a,b){return s(a,b)}function s(a,b){switch(a.type){case"DualEnc":var c=a.senderKeyDistributionEnc,e=a.senderKeyMessageEnc,f=a.from,g=a.chat,h=a.author;return t(c,f,g,b).then(function(a){if(!a.success)return a;if(c.encVersion!=="2"){d("WALogger").WARN(l(),c.encVersion);return d("WAResultOrError").makeError("unknown-sender-key-distribution-plaintext")}a=a.value.plaintext;a=d("WACryptoPkcs7").unpadPkcs7(a);a=d("decodeProtobuf").decodeProtobuf(d("WAE2E.pb").MessageSpec,a);a=(a=a.senderKeyDistributionMessage)==null?void 0:a.axolotlSenderKeyDistributionMessage;if(a==null){d("WALogger").ERROR(k());return d("WAResultOrError").makeError("group-decrypt-error")}return d("WACryptoManagerUtils").saveSenderKeySession(g,f,new Uint8Array(a),b).then(function(a){if(!a.success){d("WALogger").ERROR(j(),a.error);return d("WAResultOrError").makeError("group-decrypt-error")}return t(e,f,g,b)})}).then(function(a){return!a.success?{from:f,chat:g,author:h,retryCount:0,error:a.error,encVersion:e.encVersion,type:"Undecrypted"}:{from:f,chat:g,author:h,encVersion:e.encVersion,plaintext:a.value.plaintext,type:"Decrypted"}});default:a.type;var i=a.enc,m=a.from,n=a.chat,o=a.author;return t(i,m,n,b).then(function(a){if(!a.success){var b;return{from:m,chat:n,author:o,retryCount:(b=i.retryCount)!=null?b:0,error:a.error,encVersion:i.encVersion,type:"Undecrypted"}}return{from:m,chat:n,author:o,encVersion:i.encVersion,plaintext:a.value.plaintext,type:"Decrypted"}})}}function t(a,c,e,f){var g;a.encType==="msg"||a.encType==="pkmsg"?g=d("WACryptoManagerUtils").decryptMsg(a.encType,c,a.ciphertext,f):a.encType==="skmsg"?(a.encType,g=d("WACryptoManagerUtils").decryptGroupMsg(e,c,a.ciphertext,f)):(a.encType,g=(h||(h=b("Promise"))).resolve({}));return g.then(function(a){if(!a.success){d("WALogger").ERROR(i(),a.error);return d("WAResultOrError").makeError("group-decrypt-error")}return a.value==null?d("WAResultOrError").makeError("missing-content"):d("WAResultOrError").makeResult({plaintext:a.value.plaintext,remoteIdentity:a.value.remoteIdentity})})}e=function(a,b){var c=a.stanzaId,e=a.serverTs,f=a.retryCount,g=a.from,h=a.author,i=a.chat,j=a.deviceIdentity;a=a.error;h=h==="@me";var k=f;d("WAForceSecondRetryErrorTypes").FORCE_SECOND_RETRY_ON.has(a)&&(k=Math.max(2,f));return d("WAReceiptUtils").makeRetryReceipt({category:null,externalId:c,from:{groupJid:i,type:"group"},participant:g,recipient:h?d("WAJids").extractUserJid(g):null,retryCount:k,ts:e,deviceIdentity:j},b)};g.parseGroupMessage=a;g.decryptGroupMessage=c;g.makeGrouplMessageRetryReceipt=e}),98);
__d("WASendDeliveryReceiptProtocol",["Promise","WAComms","WAGlobals","WAJids","WASmaxOutReceiptPublishDeliveryRequest","WASmaxOutReceiptPublishSenderRequest"],(function(a,b,c,d,e,f,g){"use strict";var h;c=function(a){var c=a.stanzaId,e=a.author;a=a.from;if(!d("WAJids").isAuthorMe(e))return(h||(h=b("Promise"))).resolve(d("WAComms").castSmaxStanza(l({recipient:e,from:a,stanzaId:c})));else return(h||(h=b("Promise"))).resolve(d("WAComms").castSmaxStanza(m({recipient:d("WAGlobals").getMyUserJid(),stanzaId:c,recipientDevice:a})))};function i(a){var b=a.stanzaId,c=a.from;a=a.chat;var e=d("WAJids").extractUserJid(c);return d("WAJids").switchOnMsgrChatJidType(a,{group:function(a){return e===d("WAGlobals").getMyUserJid()?j({chat:a,from:c,stanzaId:b}):k({chat:a,from:c,stanzaId:b})},user:function(a){return e===d("WAGlobals").getMyUserJid()?m({recipient:e,recipientDevice:c,stanzaId:b}):l({recipient:e,from:c,stanzaId:b})}})}function a(a){d("WAComms").castSmaxStanza(i(a))}function j(a){var b=a.stanzaId,c=a.chat;a=a.from;c={publishSenderGroupDeviceSenderType:{receiptTo:c,receiptParticipant:a}};a={single:{receiptId:b}};b={publishSenderGroupOrPublishSenderIndividualOrPublishSenderStatusOrPublishSenderBroadcastDeviceSenderTypeMixinGroupArgs:c,senderAggregatedPublishOrSingleMixinGroupArgs:a};return d("WASmaxOutReceiptPublishSenderRequest").makePublishSenderRequest(b)}function k(a){var b=a.stanzaId,c=a.chat;a=a.from;c={device:{deviceMixinsArgs:{groupDevice:{receiptTo:c,receiptParticipant:a}}}};a={single:{receiptId:b}};b={senderAggregatedPublishOrSingleMixinGroupArgs:a,userOrDeviceOrInteropUserOrInteropDeviceMixinGroupArgs:c};return d("WASmaxOutReceiptPublishDeliveryRequest").makePublishDeliveryRequest(b)}function l(a){var b=a.stanzaId;a=a.from;a={device:{deviceMixinsArgs:{individualDevice:{receiptTo:a}}}};b={single:{receiptId:b}};b={senderAggregatedPublishOrSingleMixinGroupArgs:b,userOrDeviceOrInteropUserOrInteropDeviceMixinGroupArgs:a};return d("WASmaxOutReceiptPublishDeliveryRequest").makePublishDeliveryRequest(b)}function m(a){var b=a.recipientDevice,c=a.recipient;a=a.stanzaId;c={publishSenderIndividualDeviceSenderType:{receiptRecipient:c,receiptTo:b}};b={single:{receiptId:a}};a={publishSenderGroupOrPublishSenderIndividualOrPublishSenderStatusOrPublishSenderBroadcastDeviceSenderTypeMixinGroupArgs:c,senderAggregatedPublishOrSingleMixinGroupArgs:b};return d("WASmaxOutReceiptPublishSenderRequest").makePublishSenderRequest(a)}g.sendIndividualMessageDeliveryReceipt=c;g.makeDeliveryReceipt=i;g.sendDeliveryReceipt=a}),98);
__d("WACreateHandleGroupMessageBranch",["WAHandleGroupMessageProtocol","WAResultOrError","WASendDeliveryReceiptProtocol"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return function(b){var c=b.groupMixin,e=b.commonMessageBase,f=b.makeAck;b=b.ctx;c=d("WAHandleGroupMessageProtocol").parseGroupMessage(c);return a(babelHelpers["extends"]({},e,{parsedMessage:c,makeAck:f,makeDeliveryReceipt:d("WASendDeliveryReceiptProtocol").makeDeliveryReceipt,makeRetryReceipt:d("WAHandleGroupMessageProtocol").makeGrouplMessageRetryReceipt}),b).then(d("WAResultOrError").makeResult)}}g.createHandleGroupMessageBranch=a}),98);
__d("WACreateHandleIndividualMessageBranch",["WAHandleIndividualMessageProtocol","WAResultOrError","WASendDeliveryReceiptProtocol","WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["starting..."]);h=function(){return a};return a}var i=d("WATagsLogger").TAGS(["handleIndividualMessageBranch"]);function a(a){return function(b){var c,e=b.individualMixin,f=b.commonMessageBase,g=b.makeAck;b=b.ctx;i.DEV(h());e=(c=d("WAHandleIndividualMessageProtocol")).parseIndividualMessage(e);return a(babelHelpers["extends"]({},f,{parsedMessage:e,makeAck:g,sendRetryReceipt:c.sendIndividualMessageRetryReceipt,sendDeliveryReceipt:d("WASendDeliveryReceiptProtocol").sendIndividualMessageDeliveryReceipt,makeDeliveryReceipt:d("WASendDeliveryReceiptProtocol").makeDeliveryReceipt,makeRetryReceipt:c.makeIndividualMessageRetryReceipt,decodeMessage:c.decodeIndividualMessage}),b).then(d("WAResultOrError").makeResult)}}g.createHandleIndividualMessageBranch=a}),98);
__d("WASmaxInReceiptEnums",["WAJids"],(function(a,b,c,d,e,f,g){a={0:"0",1:"1",7:"7"};b={1002:"1002",1007:"1007",1008:"1008"};c={all:"all",none:"none"};e={"body-link":"body-link","cta-call":"cta-call","cta-url":"cta-url","media-doc":"media-doc","media-image":"media-image","media-video":"media-video","quick-reply":"quick-reply"};f={"cancellation-failed":"cancellation-failed","invalid-transition":"invalid-transition"};var h={CBP:"CBP",NBP:"NBP"},i={content:"content",title:"title"},j={delivery:"delivery",no_optimization:"no_optimization"},k={deliver:"deliver",delivery:"delivery"},l={"false":"false","true":"true"},m={"hsm-envelope-mismatch":"hsm-envelope-mismatch","structure-unavailable":"structure-unavailable"},n={validators:[(d=d("WAJids")).validateBroadcastJid,d.validateGroupJid],typeName:"BroadcastJid|GroupJid"},o={validators:[d.validateBroadcastJid,d.validateGroupJid,d.validateNewsletterJid,d.validateStatusJid],typeName:"BroadcastJid|GroupJid|NewsletterJid|StatusJid"},p={validators:[d.validateDeviceJid,d.validateBroadcastJid,d.validateDeviceJid,d.validateGroupJid],typeName:"DeviceJid|BroadcastJid|DeviceJid|GroupJid"},q={validators:[d.validateDeviceJid,d.validateBroadcastJid,d.validateDeviceJid,d.validateGroupJid,d.validateNewsletterJid,d.validateStatusJid],typeName:"DeviceJid|BroadcastJid|DeviceJid|GroupJid|NewsletterJid|StatusJid"},r={validators:[d.validateDeviceJid,d.validateDeviceJid],typeName:"DeviceJid|DeviceJid"};d={validators:[d.validateDeviceJid,d.validateUserJid,d.validateDeviceJid],typeName:"DeviceJid|UserJid|DeviceJid"};g.ENUM_0_1_7=a;g.ENUM_1002_1007_1008=b;g.ENUM_ALL_NONE=c;g.ENUM_BODYLINK_CTACALL_CTAURL_MEDIADOC_MEDIAIMAGE_MEDIAVIDEO_QUICKREPLY=e;g.ENUM_CANCELLATIONFAILED_INVALIDTRANSITION=f;g.ENUM_CBP_NBP=h;g.ENUM_CONTENT_TITLE=i;g.ENUM_DELIVERY_NOOPTIMIZATION=j;g.ENUM_DELIVER_DELIVERY=k;g.ENUM_FALSE_TRUE=l;g.ENUM_HSMENVELOPEMISMATCH_STRUCTUREUNAVAILABLE=m;g.BROADCASTJID_GROUPJID=n;g.BROADCASTJID_GROUPJID_NEWSLETTERJID_STATUSJID=o;g.DEVICEJID_BROADCASTJID_DEVICEJID_GROUPJID=p;g.DEVICEJID_BROADCASTJID_DEVICEJID_GROUPJID_NEWSLETTERJID_STATUSJID=q;g.DEVICEJID_DEVICEJID=r;g.DEVICEJID_USERJID_DEVICEJID=d}),98);
__d("WASmaxInReceiptDeprecatedEditMixin",["WAResultOrError","WASmaxInReceiptEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrStringEnum(a,"edit",d("WASmaxInReceiptEnums").ENUM_0_1_7);return!a.success?a:d("WAResultOrError").makeResult({edit:a.value})}g.parseDeprecatedEditMixin=a}),98);
__d("WASmaxInReceiptPublishSuccessMixin",["WAResultOrError","WASmaxInReceiptDeprecatedEditMixin","WASmaxInReceiptEnums","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"ack");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"class","receipt");if(!c.success)return c;var e=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!e.success)return e;e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",e.value);if(!e.success)return e;e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"t",0,void 0);if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a,"readreceipts",d("WASmaxInReceiptEnums").ENUM_ALL_NONE);if(!f.success)return f;b=d("WASmaxParseReference").attrStringFromReference(b,["type"]);if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type",b.value);if(!b.success)return b;b=d("WASmaxInReceiptDeprecatedEditMixin").parseDeprecatedEditMixin(a);return d("WAResultOrError").makeResult({"class":c.value,t:e.value,readreceipts:f.value,deprecatedEditMixin:b.success?b.value:null})}g.parsePublishSuccessMixin=a}),98);
__d("WASmaxInReceiptPublishPeerDeliveryResponseSuccess",["WASmaxInReceiptPublishSuccessMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"ack");if(!c.success)return c;c=d("WASmaxInReceiptPublishSuccessMixin").parsePublishSuccessMixin(a,b);return!c.success?c:c}g.parsePublishPeerDeliveryResponseSuccess=a}),98);
__d("WASmaxOutReceiptPeerMessageTypeMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("receipt",{type:"peer_msg"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergePeerMessageTypeMixin=a}),98);
__d("WASmaxOutReceiptPublishPeerDeliveryRequest",["WASmaxJsx","WASmaxOutReceiptIndividualDeviceMixin","WASmaxOutReceiptPeerMessageTypeMixin","WASmaxOutReceiptSingleMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutReceiptPeerMessageTypeMixin").mergePeerMessageTypeMixin(d("WASmaxOutReceiptSingleMixin").mergeSingleMixin(d("WASmaxOutReceiptIndividualDeviceMixin").mergeIndividualDeviceMixin(d("WASmaxJsx").smax("receipt",null),a),a));return a}g.makePublishPeerDeliveryRequest=a}),98);
__d("WASmaxReceiptPublishPeerDeliveryRPC",["WAComms","WASmaxInReceiptPublishPeerDeliveryResponseSuccess","WASmaxOutReceiptPublishPeerDeliveryRequest","WASmaxParsingFailure","WASmaxRpcUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:e=d("WASmaxOutReceiptPublishPeerDeliveryRequest").makePublishPeerDeliveryRequest(a);h.next=3;return b("regeneratorRuntime").awrap(d("WAComms").sendSmaxStanza(e,c));case 3:f=h.sent;g=d("WASmaxInReceiptPublishPeerDeliveryResponseSuccess").parsePublishPeerDeliveryResponseSuccess(f,e);if(!g.success){h.next=7;break}return h.abrupt("return",{name:"PublishPeerDeliveryResponseSuccess",value:g.value});case 7:throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("PublishPeerDelivery",{Success:g}));case 8:case"end":return h.stop()}},null,this)}g.sendPublishPeerDeliveryRPC=a}),98);
__d("WASmaxInReceiptPublishPeerReadResponseSuccess",["WASmaxInReceiptPublishSuccessMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"ack");if(!c.success)return c;c=d("WASmaxInReceiptPublishSuccessMixin").parsePublishSuccessMixin(a,b);return!c.success?c:c}g.parsePublishPeerReadResponseSuccess=a}),98);
__d("WASmaxOutReceiptHistorySyncTypeMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("receipt",{type:"hist_sync"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeHistorySyncTypeMixin=a}),98);
__d("WASmaxOutReceiptPublishPeerReadRequest",["WASmaxJsx","WASmaxOutReceiptHistorySyncTypeMixin","WASmaxOutReceiptIndividualDeviceMixin","WASmaxOutReceiptSingleMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutReceiptHistorySyncTypeMixin").mergeHistorySyncTypeMixin(d("WASmaxOutReceiptSingleMixin").mergeSingleMixin(d("WASmaxOutReceiptIndividualDeviceMixin").mergeIndividualDeviceMixin(d("WASmaxJsx").smax("receipt",null),a),a));return a}g.makePublishPeerReadRequest=a}),98);
__d("WASmaxReceiptPublishPeerReadRPC",["WAComms","WASmaxInReceiptPublishPeerReadResponseSuccess","WASmaxOutReceiptPublishPeerReadRequest","WASmaxParsingFailure","WASmaxRpcUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:e=d("WASmaxOutReceiptPublishPeerReadRequest").makePublishPeerReadRequest(a);h.next=3;return b("regeneratorRuntime").awrap(d("WAComms").sendSmaxStanza(e,c));case 3:f=h.sent;g=d("WASmaxInReceiptPublishPeerReadResponseSuccess").parsePublishPeerReadResponseSuccess(f,e);if(!g.success){h.next=7;break}return h.abrupt("return",{name:"PublishPeerReadResponseSuccess",value:g.value});case 7:throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("PublishPeerRead",{Success:g}));case 8:case"end":return h.stop()}},null,this)}g.sendPublishPeerReadRPC=a}),98);
__d("WAHandlePeerMessageProtocol",["WACryptoManagerUtils","WACryptoPkcs7","WAE2E.pb","WALogger","WAReceiptUtils","WAResultOrError","WASmaxReceiptPublishPeerDeliveryRPC","WASmaxReceiptPublishPeerReadRPC","WATransformRetryOrIndividualRegularMixinGroup","decodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["decodePeerMessage: no protocolMessage."]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["decodePeerMessage: enc version "," is not supported."]);i=function(){return a};return a}function a(a){var b=a.from;a=a.retryOrIndividualRegularMixinGroup;return babelHelpers["extends"]({from:b},d("WATransformRetryOrIndividualRegularMixinGroup").transformRetryOrIndividualRegularMixinGroup(a))}function b(a,b){var c=a.from,e=a.ciphertext,f=a.encType,g=a.encVersion;return d("WACryptoManagerUtils").decryptMsg(f,c,e,b).then(function(a){if(!a.success)return a;return a.value==null?d("WAResultOrError").makeError("missing-content"):d("WAResultOrError").makeResult({encVersion:g,plaintext:a.value.plaintext,remoteIdentity:a.value.remoteIdentity})})}function c(a){a=a.decryptedMessage;var b=a.plaintext;a=a.encVersion;if(a!=="2"){d("WALogger").WARN(i(),a);return d("WAResultOrError").makeError("unknown-plaintext")}a=d("WACryptoPkcs7").unpadPkcs7(b);b=d("decodeProtobuf").decodeProtobuf(d("WAE2E.pb").MessageSpec,a);if(b.protocolMessage==null){d("WALogger").WARN(h());return d("WAResultOrError").makeError("missing-protocol-message")}return d("WAResultOrError").makeResult(b.protocolMessage)}function e(a){var b=a.stanzaId;a=a.to;return d("WASmaxReceiptPublishPeerDeliveryRPC").sendPublishPeerDeliveryRPC({receiptId:b,receiptTo:a}).then(function(){})}function f(a){var b=a.stanzaId;a=a.to;return d("WASmaxReceiptPublishPeerReadRPC").sendPublishPeerReadRPC({receiptId:b,receiptTo:a}).then(function(){})}function j(a,b){var c=a.stanzaId,e=a.serverTs,f=a.retryCount,g=a.from;a=a.deviceIdentity;return d("WAReceiptUtils").sendRetryReceipt({category:"peer",externalId:c,from:{deviceJid:g,type:"device"},participant:null,recipient:null,retryCount:f,ts:e,deviceIdentity:a},b)}g.parsePeerMessage=a;g.decryptPeerMessage=b;g.decodePeerMessage=c;g.sendPeerMessageReceipt=e;g.sendHistorySyncReceipt=f;g.sendPeerMessageRetryReceipt=j}),98);
__d("WASmaxInMessageDeliverContentTypeTextMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","text");return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parseContentTypeTextMixin=a}),98);
__d("WASmaxInMessageDeliverDeviceIdentityMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"device-identity");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytes(a.value);return!a.success?a:d("WAResultOrError").makeResult({deviceIdentityElementValue:a.value})}g.parseDeviceIdentityMixin=a}),98);
__d("WASmaxInMessageDeliverEnums",["WAJids"],(function(a,b,c,d,e,f,g){a={0:"0",1:"1"};b={1:"1",2:"2"};c={1:"1",3:"3"};e={ACCEPT:"ACCEPT",REJECT:"REJECT",UNKNOWN:"UNKNOWN"};f={address_message:"address_message",form_message:"form_message",galaxy_message:"galaxy_message",menu_options:"menu_options"};var h={address_message:"address_message",galaxy_message:"galaxy_message"},i={allowlist:"allowlist",contacts:"contacts",denylist:"denylist"},j={allow:"allow",bypass:"bypass",deny:"deny",error:"error"},k={ASPRESENTED:"ASPRESENTED",BIMONTHLY:"BIMONTHLY",DAILY:"DAILY",FORTNIGHTLY:"FORTNIGHTLY",HALFYEARLY:"HALFYEARLY",MONTHLY:"MONTHLY",ONETIME:"ONETIME",QUARTERLY:"QUARTERLY",UNKNOWN:"UNKNOWN",WEEKLY:"WEEKLY",YEARLY:"YEARLY"},l={audio:"audio",avatar_sticker:"avatar_sticker",buttons_response:"buttons_response",cataloglink:"cataloglink",contact:"contact",contact_array:"contact_array",document:"document",genai_sticker:"genai_sticker",gif:"gif",history:"history",image:"image",list_response:"list_response",location:"location",native_flow_response:"native_flow_response",order:"order",product:"product",productlink:"productlink",ptt:"ptt",ptv:"ptv",sticker:"sticker",url:"url",vcard:"vcard",video:"video",xma:"xma"},m={audio:"audio",avatar_sticker:"avatar_sticker",buttons_response:"buttons_response",cataloglink:"cataloglink",contact:"contact",contact_array:"contact_array",document:"document",gif:"gif",history:"history",image:"image",list_response:"list_response",location:"location",native_flow_response:"native_flow_response",order:"order",product:"product",productlink:"productlink",ptt:"ptt",ptv:"ptv",sticker:"sticker",url:"url",vcard:"vcard",video:"video",xma:"xma"},n={audio:"audio",avatar_sticker:"avatar_sticker",cataloglink:"cataloglink",document:"document",genai_sticker:"genai_sticker",gif:"gif",image:"image",productlink:"productlink",ptt:"ptt",sticker:"sticker",url:"url",vcard:"vcard",video:"video"},o={buyer:"buyer",seller:"seller"},p={card:"card","net-banking":"net-banking",upi:"upi",wallet:"wallet"},q={catalog_message:"catalog_message",laneline_call:"laneline_call",menu_options:"menu_options",novi_complete_transaction:"novi_complete_transaction",novi_hub:"novi_hub",novi_login:"novi_login",novi_report_transaction:"novi_report_transaction",novi_view_bank_detail:"novi_view_bank_detail",novi_view_card_detail:"novi_view_card_detail",novi_view_code:"novi_view_code",novi_view_transaction:"novi_view_transaction",order_details:"order_details",order_status:"order_status",otp:"otp",payment_method:"payment_method",payment_status:"payment_status",voice_call:"voice_call"},r={creation:"creation",edit:"edit"},s={creation:"creation",edit:"edit",response:"response"},t={ctwa:"ctwa",username:"username"},u={EXACT:"EXACT",MAX:"MAX"},v={FAILURE:"FAILURE",INIT:"INIT",SUCCESS:"SUCCESS"},w={"false":"false","true":"true"},x={FBPAY:"FBPAY",NOVI:"NOVI",P2M_LITE:"P2M_LITE",UPI:"UPI"},y={first:"first",full:"full",inner:"inner",last:"last"},z={FULL:"FULL",MISSING_FIELD_NOT_PARTIAL:"MISSING_FIELD_NOT_PARTIAL",PARTIAL:"PARTIAL"},A={high:"high",high_force:"high_force",low:"low"},B={high:"high",low:"low",unknown:"unknown"},C={HPP_PAYMENT_LINK:"HPP_PAYMENT_LINK",UPI:"UPI"},D={incentive:"incentive",p2m:"p2m",p2p:"p2p",payout:"payout"},E={lid:"lid",pn:"pn"},F={matched:"matched",unmatched:"unmatched"},G={msg:"msg",pkmsg:"pkmsg"},H={request:"request",send:"send"},I={validators:[(d=d("WAJids")).validateDeviceJid,d.validateBroadcastJid,d.validateDeviceJid,d.validateGroupJid,d.validateStatusJid],typeName:"DeviceJid|BroadcastJid|DeviceJid|GroupJid|StatusJid"},J={validators:[d.validateDeviceJid,d.validateDeviceJid],typeName:"DeviceJid|DeviceJid"},K={validators:[d.validateDeviceJid,d.validateDeviceJid,d.validateDeviceJid],typeName:"DeviceJid|DeviceJid|DeviceJid"};d={validators:[d.validateGroupJid,d.validateUserJid],typeName:"GroupJid|UserJid"};g.ENUM_0_1=a;g.ENUM_1_2=b;g.ENUM_1_3=c;g.ENUM_ACCEPT_REJECT_UNKNOWN=e;g.ENUM_ADDRESSMESSAGE_FORMMESSAGE_GALAXYMESSAGE_MENUOPTIONS=f;g.ENUM_ADDRESSMESSAGE_GALAXYMESSAGE=h;g.ENUM_ALLOWLIST_CONTACTS_DENYLIST=i;g.ENUM_ALLOW_BYPASS_DENY_ERROR=j;g.ENUM_ASPRESENTED_BIMONTHLY_DAILY_FORTNIGHTLY_HALFYEARLY_MONTHLY_ONETIME_QUARTERLY_UNKNOWN_WEEKLY_YEARLY=k;g.ENUM_AUDIO_AVATARSTICKER_BUTTONSRESPONSE_CATALOGLINK_CONTACT_CONTACTARRAY_DOCUMENT_GENAISTICKER_GIF_HISTORY_IMAGE_LISTRESPONSE_LOCATION_NATIVEFLOWRESPONSE_ORDER_PRODUCT_PRODUCTLINK_PTT_PTV_STICKER_URL_VCARD_VIDEO_XMA=l;g.ENUM_AUDIO_AVATARSTICKER_BUTTONSRESPONSE_CATALOGLINK_CONTACT_CONTACTARRAY_DOCUMENT_GIF_HISTORY_IMAGE_LISTRESPONSE_LOCATION_NATIVEFLOWRESPONSE_ORDER_PRODUCT_PRODUCTLINK_PTT_PTV_STICKER_URL_VCARD_VIDEO_XMA=m;g.ENUM_AUDIO_AVATARSTICKER_CATALOGLINK_DOCUMENT_GENAISTICKER_GIF_IMAGE_PRODUCTLINK_PTT_STICKER_URL_VCARD_VIDEO=n;g.ENUM_BUYER_SELLER=o;g.ENUM_CARD_NETBANKING_UPI_WALLET=p;g.ENUM_CATALOGMESSAGE_LANELINECALL_MENUOPTIONS_NOVICOMPLETETRANSACTION_NOVIHUB_NOVILOGIN_NOVIREPORTTRANSACTION_NOVIVIEWBANKDETAIL_NOVIVIEWCARDDETAIL_NOVIVIEWCODE_NOVIVIEWTRANSACTION_ORDERDETAILS_ORDERSTATUS_OTP_PAYMENTMETHOD_PAYMENTSTATUS_VOICECALL=q;g.ENUM_CREATION_EDIT=r;g.ENUM_CREATION_EDIT_RESPONSE=s;g.ENUM_CTWA_USERNAME=t;g.ENUM_EXACT_MAX=u;g.ENUM_FAILURE_INIT_SUCCESS=v;g.ENUM_FALSE_TRUE=w;g.ENUM_FBPAY_NOVI_P2MLITE_UPI=x;g.ENUM_FIRST_FULL_INNER_LAST=y;g.ENUM_FULL_MISSINGFIELDNOTPARTIAL_PARTIAL=z;g.ENUM_HIGH_HIGHFORCE_LOW=A;g.ENUM_HIGH_LOW_UNKNOWN=B;g.ENUM_HPPPAYMENTLINK_UPI=C;g.ENUM_INCENTIVE_P2M_P2P_PAYOUT=D;g.ENUM_LID_PN=E;g.ENUM_MATCHED_UNMATCHED=F;g.ENUM_MSG_PKMSG=G;g.ENUM_REQUEST_SEND=H;g.DEVICEJID_BROADCASTJID_DEVICEJID_GROUPJID_STATUSJID=I;g.DEVICEJID_DEVICEJID=J;g.DEVICEJID_DEVICEJID_DEVICEJID=K;g.GROUPJID_USERJID=d}),98);
__d("WASmaxInMessageDeliverRegistrationIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"registration");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytesRange(a.value,4,4);return!a.success?a:d("WAResultOrError").makeResult({registrationElementValue:a.value})}g.parseRegistrationIDMixin=a}),98);
__d("WASmaxInMessageDeliverEncHideDecryptionPlaceholderMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"decrypt-fail","hide");return!b.success?b:d("WAResultOrError").makeResult({decryptFail:b.value})}g.parseEncHideDecryptionPlaceholderMixin=a}),98);
__d("WASmaxInMessageDeliverEncPayloadMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").contentBytesRange(a,1,1048576);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}g.parseEncPayloadMixin=a}),98);
__d("WASmaxInMessageDeliverEncTypeIndividualMixin",["WAResultOrError","WASmaxInMessageDeliverEncHideDecryptionPlaceholderMixin","WASmaxInMessageDeliverEncPayloadMixin","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").attrStringEnum(a,"type",d("WASmaxInMessageDeliverEnums").ENUM_MSG_PKMSG);if(!b.success)return b;var c=d("WASmaxInMessageDeliverEncHideDecryptionPlaceholderMixin").parseEncHideDecryptionPlaceholderMixin(a);a=d("WASmaxInMessageDeliverEncPayloadMixin").parseEncPayloadMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({type:b.value,encHideDecryptionPlaceholderMixin:c.success?c.value:null},a.value))}g.parseEncTypeIndividualMixin=a}),98);
__d("WASmaxInMessageDeliverEncVersion2Mixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"v","2");return!b.success?b:d("WAResultOrError").makeResult({v:b.value})}g.parseEncVersion2Mixin=a}),98);
__d("WASmaxInMessageDeliverEncVersion3Mixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"v","3");return!b.success?b:d("WAResultOrError").makeResult({v:b.value})}g.parseEncVersion3Mixin=a}),98);
__d("WASmaxInMessageDeliverEncVersionFutureproofMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"v",3,void 0);return!b.success?b:d("WAResultOrError").makeResult({v:b.value})}g.parseEncVersionFutureproofMixin=a}),98);
__d("WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup",["WAResultOrError","WASmaxInMessageDeliverEncVersion2Mixin","WASmaxInMessageDeliverEncVersion3Mixin","WASmaxInMessageDeliverEncVersionFutureproofMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverEncVersion2Mixin").parseEncVersion2Mixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"EncVersion2",value:b.value});var c=d("WASmaxInMessageDeliverEncVersion3Mixin").parseEncVersion3Mixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"EncVersion3",value:c.value});var e=d("WASmaxInMessageDeliverEncVersionFutureproofMixin").parseEncVersionFutureproofMixin(a);return e.success?d("WAResultOrError").makeResult({name:"EncVersionFutureproof",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["EncVersion2","EncVersion3","EncVersionFutureproof"],[b,c,e])}g.parseEncVersion2Or3OrFutureproofMixinGroup=a}),98);
__d("WASmaxInMessageDeliverIndividualRegularMixin",["WAResultOrError","WASmaxInMessageDeliverEncTypeIndividualMixin","WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"enc");if(!b.success)return b;a=d("WASmaxInMessageDeliverEncTypeIndividualMixin").parseEncTypeIndividualMixin(b.value);if(!a.success)return a;b=d("WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup").parseEncVersion2Or3OrFutureproofMixinGroup(b.value);return!b.success?b:d("WAResultOrError").makeResult({encEncTypeIndividualMixin:a.value,encEncVersion2Or3OrFutureproofMixinGroup:b.value})}g.parseIndividualRegularMixin=a}),98);
__d("WASmaxInMessageDeliverEncRetryMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"count",1,4);return!b.success?b:d("WAResultOrError").makeResult({count:b.value})}g.parseEncRetryMixin=a}),98);
__d("WASmaxInMessageDeliverRetryMixin",["WAResultOrError","WASmaxInMessageDeliverEncRetryMixin","WASmaxInMessageDeliverEncTypeIndividualMixin","WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"enc");if(!b.success)return b;a=d("WASmaxInMessageDeliverEncRetryMixin").parseEncRetryMixin(b.value);if(!a.success)return a;var c=d("WASmaxInMessageDeliverEncTypeIndividualMixin").parseEncTypeIndividualMixin(b.value);if(!c.success)return c;b=d("WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup").parseEncVersion2Or3OrFutureproofMixinGroup(b.value);return!b.success?b:d("WAResultOrError").makeResult({encEncRetryMixin:a.value,encEncTypeIndividualMixin:c.value,encEncVersion2Or3OrFutureproofMixinGroup:b.value})}g.parseRetryMixin=a}),98);
__d("WASmaxInMessageDeliverRetryOrIndividualRegularMixinGroup",["WAResultOrError","WASmaxInMessageDeliverIndividualRegularMixin","WASmaxInMessageDeliverRetryMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverRetryMixin").parseRetryMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"Retry",value:b.value});var c=d("WASmaxInMessageDeliverIndividualRegularMixin").parseIndividualRegularMixin(a);return c.success?d("WAResultOrError").makeResult({name:"IndividualRegular",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["Retry","IndividualRegular"],[b,c])}g.parseRetryOrIndividualRegularMixinGroup=a}),98);
__d("WASmaxInMessageDeliverPeerRequest",["WAResultOrError","WASmaxInMessageDeliverContentTypeTextMixin","WASmaxInMessageDeliverDeviceIdentityMixin","WASmaxInMessageDeliverEnums","WASmaxInMessageDeliverRegistrationIDMixin","WASmaxInMessageDeliverRetryOrIndividualRegularMixinGroup","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"category","peer");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a,"push_priority",d("WASmaxInMessageDeliverEnums").ENUM_HIGH_HIGHFORCE_LOW);if(!e.success)return e;var f=d("WASmaxParseJid").attrDeviceJid(a,"from");if(!f.success)return f;var g=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!g.success)return g;var h=d("WASmaxInMessageDeliverContentTypeTextMixin").parseContentTypeTextMixin(a);if(!h.success)return h;var i=d("WASmaxInMessageDeliverRegistrationIDMixin").parseRegistrationIDMixin(a),j=d("WASmaxInMessageDeliverDeviceIdentityMixin").parseDeviceIdentityMixin(a);a=d("WASmaxInMessageDeliverRetryOrIndividualRegularMixinGroup").parseRetryOrIndividualRegularMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({id:b.value,category:c.value,pushPriority:e.value,from:f.value,t:g.value},h.value,{registrationIDMixin:i.success?i.value:null,deviceIdentityMixin:j.success?j.value:null,retryOrIndividualRegularMixinGroup:a.value}))}g.parsePeerRequest=a}),98);
__d("WASmaxOutMessageDeliverPeerResponseSuccess",["WASmaxJsx","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrDeviceJid,a,["from"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);a=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{to:d("WAWap").DEVICE_JID(b.value),"class":"message",id:d("WAWap").STANZA_ID(c.value),type:d("WAWap").CUSTOM_STRING(a.value)});return b}g.makePeerResponseSuccess=a}),98);
__d("WASmaxMessageDeliverPeerRPC",["WASmaxInMessageDeliverPeerRequest","WASmaxOutMessageDeliverPeerResponseSuccess","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverPeerRequest").parsePeerRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Peer",{Request:b}));return{parsedRequest:b.value,makePeerResponseSuccess:function(){return d("WASmaxOutMessageDeliverPeerResponseSuccess").makePeerResponseSuccess(a)}}}g.receivePeerRPC=a}),98);
__d("WACreateHandlePeerMessageBranch",["Promise","WAHandlePeerMessageProtocol","WAResultOrError","WASmaxMessageDeliverPeerRPC","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var c=a.peerMessage;return function(a,e){a=d("WASmaxMessageDeliverPeerRPC").receivePeerRPC(a);var f=a.makePeerResponseSuccess;a=a.parsedRequest;var g=a.id,i=a.from,j=a.retryOrIndividualRegularMixinGroup;a=a.t;if(c!=null){var k;return c.handlePeerMessage({from:i,parsedMessage:(k=d("WAHandlePeerMessageProtocol")).parsePeerMessage({from:i,retryOrIndividualRegularMixinGroup:j}),stanzaId:g,sendPeerMessageReceipt:k.sendPeerMessageReceipt,sendHistorySyncReceipt:k.sendHistorySyncReceipt,sendRetryReceipt:k.sendPeerMessageRetryReceipt,makeAck:f,decryptMessage:k.decryptPeerMessage,decodeMessage:k.decodePeerMessage,serverTs:d("WATimeUtils").castToUnixTime(a)},e).then(d("WAResultOrError").makeResult)}return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult(f()))}}g.createHandlePeerMessageBranch=a}),98);
__d("WASmaxInMessageDeliverAdminEditMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"edit","3");return!b.success?b:d("WAResultOrError").makeResult({edit:b.value})}g.parseAdminEditMixin=a}),98);
__d("WASmaxInMessageDeliverContentTypeMediaMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","media");return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parseContentTypeMediaMixin=a}),98);
__d("WASmaxInMessageDeliverPayloadMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"plaintext");if(!b.success)return b;b=d("WASmaxParseUtils").contentBytesRange(a,1,1048576);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}g.parsePayloadMixin=a}),98);
__d("WASmaxInMessageDeliverNewsletterMediaMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeMediaMixin","WASmaxInMessageDeliverEnums","WASmaxInMessageDeliverPayloadMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"plaintext");if(!b.success)return b;var c=d("WASmaxParseUtils").attrStringEnum(b.value,"mediatype",d("WASmaxInMessageDeliverEnums").ENUM_AUDIO_AVATARSTICKER_CATALOGLINK_DOCUMENT_GENAISTICKER_GIF_IMAGE_PRODUCTLINK_PTT_STICKER_URL_VCARD_VIDEO);if(!c.success)return c;b=d("WASmaxInMessageDeliverPayloadMixin").parsePayloadMixin(b.value);if(!b.success)return b;a=d("WASmaxInMessageDeliverContentTypeMediaMixin").parseContentTypeMediaMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({plaintextMediatype:c.value,plaintextPayloadMixin:b.value},a.value))}g.parseNewsletterMediaMixin=a}),98);
__d("WASmaxInMessageDeliverNewsletterTextMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeTextMixin","WASmaxInMessageDeliverPayloadMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"plaintext");if(!b.success)return b;b=d("WASmaxInMessageDeliverPayloadMixin").parsePayloadMixin(b.value);if(!b.success)return b;a=d("WASmaxInMessageDeliverContentTypeTextMixin").parseContentTypeTextMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({plaintextPayloadMixin:b.value},a.value))}g.parseNewsletterTextMixin=a}),98);
__d("WASmaxInMessageDeliverNewsletterTextOrMediaMixinGroup",["WAResultOrError","WASmaxInMessageDeliverNewsletterMediaMixin","WASmaxInMessageDeliverNewsletterTextMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverNewsletterTextMixin").parseNewsletterTextMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NewsletterText",value:b.value});var c=d("WASmaxInMessageDeliverNewsletterMediaMixin").parseNewsletterMediaMixin(a);return c.success?d("WAResultOrError").makeResult({name:"NewsletterMedia",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["NewsletterText","NewsletterMedia"],[b,c])}g.parseNewsletterTextOrMediaMixinGroup=a}),98);
__d("WASmaxInMessageDeliverNewsletterEditMixin",["WAResultOrError","WASmaxInMessageDeliverAdminEditMixin","WASmaxInMessageDeliverNewsletterTextOrMediaMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverAdminEditMixin").parseAdminEditMixin(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverNewsletterTextOrMediaMixinGroup").parseNewsletterTextOrMediaMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{newsletterTextOrMediaMixinGroup:a.value}))}g.parseNewsletterEditMixin=a}),98);
__d("WASmaxInMessageDeliverContentTypePollCreationMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","poll");if(!a.success)return a;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,b.value,"polltype","creation");return!b.success?b:d("WAResultOrError").makeResult({type:a.value,metaPolltype:b.value})}g.parseContentTypePollCreationMixin=a}),98);
__d("WASmaxInMessageDeliverNewsletterPollCreationMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypePollCreationMixin","WASmaxInMessageDeliverPayloadMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"plaintext");if(!b.success)return b;b=d("WASmaxInMessageDeliverPayloadMixin").parsePayloadMixin(b.value);if(!b.success)return b;a=d("WASmaxInMessageDeliverContentTypePollCreationMixin").parseContentTypePollCreationMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({plaintextPayloadMixin:b.value},a.value))}g.parseNewsletterPollCreationMixin=a}),98);
__d("WASmaxInMessageDeliverContentTypePollVoteMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","poll");if(!a.success)return a;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,b.value,"polltype","vote");return!b.success?b:d("WAResultOrError").makeResult({type:a.value,metaPolltype:b.value})}g.parseContentTypePollVoteMixin=a}),98);
__d("WASmaxInMessageDeliverNewsletterPollVoteMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypePollVoteMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"vote");if(!b.success)return b;b=d("WASmaxParseUtils").contentBytesRange(a,32,32);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"votes");if(!b.success)return b;a=d("WASmaxInMessageDeliverContentTypePollVoteMixin").parseContentTypePollVoteMixin(a);if(!a.success)return a;b=d("WASmaxParseUtils").mapChildrenWithTag(b.value,"vote",0,1e3,h);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{votesVote:b.value}))}g.parseNewsletterPollVoteVotesVote=h;g.parseNewsletterPollVoteMixin=a}),98);
__d("WASmaxInMessageDeliverContentTypeReactionMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","reaction");return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parseContentTypeReactionMixin=a}),98);
__d("WASmaxInMessageDeliverNewsletterReactionMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeReactionMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"reaction");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(b.value,"code");if(!b.success)return b;a=d("WASmaxInMessageDeliverContentTypeReactionMixin").parseContentTypeReactionMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({reactionCode:b.value},a.value))}g.parseNewsletterReactionMixin=a}),98);
__d("WASmaxInMessageDeliverRevokeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"edit","7");return!b.success?b:d("WAResultOrError").makeResult({edit:b.value})}g.parseRevokeMixin=a}),98);
__d("WASmaxInMessageDeliverNewsletterReactionRevokeMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeReactionMixin","WASmaxInMessageDeliverRevokeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"reaction");if(!b.success)return b;b=d("WASmaxInMessageDeliverRevokeMixin").parseRevokeMixin(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverContentTypeReactionMixin").parseContentTypeReactionMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,a.value))}g.parseNewsletterReactionRevokeMixin=a}),98);
__d("WASmaxInMessageDeliverAdminRevokeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"edit","8");return!b.success?b:d("WAResultOrError").makeResult({edit:b.value})}g.parseAdminRevokeMixin=a}),98);
__d("WASmaxInMessageDeliverNewsletterRevokeMixin",["WAResultOrError","WASmaxInMessageDeliverAdminRevokeMixin","WASmaxInMessageDeliverContentTypeTextMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"plaintext");if(!b.success)return b;b=d("WASmaxInMessageDeliverAdminRevokeMixin").parseAdminRevokeMixin(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverContentTypeTextMixin").parseContentTypeTextMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,a.value))}g.parseNewsletterRevokeMixin=a}),98);
__d("WASmaxInMessageDeliverNewsletterMessageFanoutContent",["WAResultOrError","WASmaxInMessageDeliverNewsletterEditMixin","WASmaxInMessageDeliverNewsletterMediaMixin","WASmaxInMessageDeliverNewsletterPollCreationMixin","WASmaxInMessageDeliverNewsletterPollVoteMixin","WASmaxInMessageDeliverNewsletterReactionMixin","WASmaxInMessageDeliverNewsletterReactionRevokeMixin","WASmaxInMessageDeliverNewsletterRevokeMixin","WASmaxInMessageDeliverNewsletterTextMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverNewsletterEditMixin").parseNewsletterEditMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NewsletterEdit",value:b.value});var c=d("WASmaxInMessageDeliverNewsletterRevokeMixin").parseNewsletterRevokeMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"NewsletterRevoke",value:c.value});var e=d("WASmaxInMessageDeliverNewsletterTextMixin").parseNewsletterTextMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"NewsletterText",value:e.value});var f=d("WASmaxInMessageDeliverNewsletterMediaMixin").parseNewsletterMediaMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"NewsletterMedia",value:f.value});var g=d("WASmaxInMessageDeliverNewsletterReactionMixin").parseNewsletterReactionMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"NewsletterReaction",value:g.value});var h=d("WASmaxInMessageDeliverNewsletterReactionRevokeMixin").parseNewsletterReactionRevokeMixin(a);if(h.success)return d("WAResultOrError").makeResult({name:"NewsletterReactionRevoke",value:h.value});var i=d("WASmaxInMessageDeliverNewsletterPollCreationMixin").parseNewsletterPollCreationMixin(a);if(i.success)return d("WAResultOrError").makeResult({name:"NewsletterPollCreation",value:i.value});var j=d("WASmaxInMessageDeliverNewsletterPollVoteMixin").parseNewsletterPollVoteMixin(a);return j.success?d("WAResultOrError").makeResult({name:"NewsletterPollVote",value:j.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["NewsletterEdit","NewsletterRevoke","NewsletterText","NewsletterMedia","NewsletterReaction","NewsletterReactionRevoke","NewsletterPollCreation","NewsletterPollVote"],[b,c,e,f,g,h,i,j])}g.parseNewsletterMessageFanoutContent=a}),98);
__d("WASmaxInMessageDeliverNewsletterMessageLastEditTimestampMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,b.value,"msg_edit_t",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({metaMsgEditT:a.value})}g.parseNewsletterMessageLastEditTimestampMixin=a}),98);
__d("WASmaxInMessageDeliverNewsletterMessageOriginalTimestampMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,b.value,"original_msg_t",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({metaOriginalMsgT:a.value})}g.parseNewsletterMessageOriginalTimestampMixin=a}),98);
__d("WASmaxInMessageDeliverNewsletterMessageFanoutMixin",["WAResultOrError","WASmaxInMessageDeliverNewsletterMessageFanoutContent","WASmaxInMessageDeliverNewsletterMessageLastEditTimestampMixin","WASmaxInMessageDeliverNewsletterMessageOriginalTimestampMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!b.success)return b;var c=d("WASmaxParseUtils").attrIntRange(a,"server_id",99,2147476647);if(!c.success)return c;var e=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!e.success)return e;var f=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,a,"is_sender","true");if(!f.success)return f;var g=d("WASmaxInMessageDeliverNewsletterMessageOriginalTimestampMixin").parseNewsletterMessageOriginalTimestampMixin(a),h=d("WASmaxInMessageDeliverNewsletterMessageLastEditTimestampMixin").parseNewsletterMessageLastEditTimestampMixin(a);a=d("WASmaxInMessageDeliverNewsletterMessageFanoutContent").parseNewsletterMessageFanoutContent(a);return!a.success?a:d("WAResultOrError").makeResult({id:b.value,serverId:c.value,t:e.value,isSender:f.value,newsletterMessageOriginalTimestampMixin:g.success?g.value:null,newsletterMessageLastEditTimestampMixin:h.success?h.value:null,newsletterMessageFanoutContent:a.value})}g.parseNewsletterMessageFanoutMixin=a}),98);
__d("WASmaxInMessageDeliverOfflineMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrIntRange(a,"offline",0,12);return!a.success?a:d("WAResultOrError").makeResult({offline:a.value})}g.parseOfflineMixin=a}),98);
__d("WASmaxInMessageDeliverNewsletterMessageWithJIDMixin",["WAResultOrError","WASmaxInMessageDeliverNewsletterMessageFanoutMixin","WASmaxInMessageDeliverOfflineMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseJid").attrNewsletterJid(a,"from");if(!b.success)return b;var c=d("WASmaxInMessageDeliverNewsletterMessageFanoutMixin").parseNewsletterMessageFanoutMixin(a);if(!c.success)return c;a=d("WASmaxInMessageDeliverOfflineMixin").parseOfflineMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({from:b.value},c.value,{offlineMixin:a.success?a.value:null}))}g.parseNewsletterMessageWithJIDMixin=a}),98);
__d("WASmaxInMessageDeliverNewsletterRequest",["WASmaxInMessageDeliverNewsletterMessageWithJIDMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverNewsletterMessageWithJIDMixin").parseNewsletterMessageWithJIDMixin(a);return!b.success?b:b}g.parseNewsletterRequest=a}),98);
__d("WASmaxOutMessageDeliverCommonAckMixin",["WASmaxJsx","WASmaxMixins","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrNewsletterJid,a,["from"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);a=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{to:d("WAWap").JID(b.value),"class":"message",id:d("WAWap").STANZA_ID(c.value),type:d("WAWap").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeCommonAckMixin=a}),98);
__d("WASmaxOutMessageDeliverNewsletterResponseError",["WASmaxJsx","WASmaxOutMessageDeliverCommonAckMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutMessageDeliverCommonAckMixin").mergeCommonAckMixin(d("WASmaxJsx").smax("ack",{error:"406"}),a);return a}g.makeNewsletterResponseError=a}),98);
__d("WASmaxOutMessageDeliverNewsletterResponseSuccess",["WASmaxJsx","WASmaxOutMessageDeliverCommonAckMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutMessageDeliverCommonAckMixin").mergeCommonAckMixin(d("WASmaxJsx").smax("ack",null),a);return a}g.makeNewsletterResponseSuccess=a}),98);
__d("WASmaxMessageDeliverNewsletterRPC",["WASmaxInMessageDeliverNewsletterRequest","WASmaxOutMessageDeliverNewsletterResponseError","WASmaxOutMessageDeliverNewsletterResponseSuccess","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverNewsletterRequest").parseNewsletterRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Newsletter",{Request:b}));return{parsedRequest:b.value,makeNewsletterResponseError:function(){return d("WASmaxOutMessageDeliverNewsletterResponseError").makeNewsletterResponseError(a)},makeNewsletterResponseSuccess:function(){return d("WASmaxOutMessageDeliverNewsletterResponseSuccess").makeNewsletterResponseSuccess(a)}}}g.receiveNewsletterRPC=a}),98);
__d("WASmaxInMessageDeliverAutomatedMixin",["WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"automated");return!b.success?b:d("WASmaxParseUtils").voidSuccess}g.parseAutomatedMixin=a}),98);
__d("WASmaxInMessageDeliverBizAcceptTsMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(b.value,"accept_ts",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({bizAcceptTs:a.value})}g.parseBizAcceptTsMixin=a}),98);
__d("WASmaxInMessageDeliverBizROIMetricsGatingFlagsMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!b.success)return b;a=d("WASmaxParseUtils").attrStringEnum(b.value,"roi_enabled",d("WASmaxInMessageDeliverEnums").ENUM_0_1);return!a.success?a:d("WAResultOrError").makeResult({bizRoiEnabled:a.value})}g.parseBizROIMetricsGatingFlagsMixin=a}),98);
__d("WASmaxInMessageDeliverBizRolesMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(b.value,"host_storage",1,100);if(!a.success)return a;var c=d("WASmaxParseUtils").attrIntRange(b.value,"actual_actors",1,100);if(!c.success)return c;b=d("WASmaxParseUtils").attrIntRange(b.value,"privacy_mode_ts",0,void 0);return!b.success?b:d("WAResultOrError").makeResult({bizHostStorage:a.value,bizActualActors:c.value,bizPrivacyModeTs:b.value})}g.parseBizRolesMixin=a}),98);
__d("WASmaxInMessageDeliverBusinessBotGatingMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!b.success)return b;a=d("WASmaxParseUtils").flattenedChildWithTag(b.value,"gating");if(!a.success)return a;b=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"bot");if(!b.success)return b;a=d("WASmaxParseUtils").attrStringEnum(b.value,"state",d("WASmaxInMessageDeliverEnums").ENUM_ALLOW_BYPASS_DENY_ERROR);if(!a.success)return a;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,b.value,"v",1,void 0);return!b.success?b:d("WAResultOrError").makeResult({bizGatingBotState:a.value,bizGatingBotV:b.value})}g.parseBusinessBotGatingMixin=a}),98);
__d("WASmaxInMessageDeliverConversionRecipientStatusMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"conversion");if(!b.success)return b;a=d("WASmaxParseUtils").attrStringEnum(b.value,"recipient_status",d("WASmaxInMessageDeliverEnums").ENUM_MATCHED_UNMATCHED);return!a.success?a:d("WAResultOrError").makeResult({conversionRecipientStatus:a.value})}g.parseConversionRecipientStatusMixin=a}),98);
__d("WASmaxInMessageDeliverClickToWhatsAppTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"source_url");if(!b.success)return b;b=d("WASmaxParseUtils").contentString(a);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ctwa");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"source_url",h);if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"conversion_source");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"conversion_data");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"source_type");if(!f.success)return f;var g=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"entry_point_conversion_source");if(!g.success)return g;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"entry_point_conversion_app");return!a.success?a:d("WAResultOrError").makeResult({conversionSource:c.value,conversionData:e.value,sourceType:f.value,entryPointConversionSource:g.value,entryPointConversionApp:a.value,sourceUrl:b.value})}g.parseClickToWhatsAppTypeSourceUrl=h;g.parseClickToWhatsAppTypeMixin=a}),98);
__d("WASmaxInMessageDeliverCtwaConversionMixin",["WAResultOrError","WASmaxInMessageDeliverClickToWhatsAppTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"ctwa");if(!b.success)return b;b=d("WASmaxInMessageDeliverClickToWhatsAppTypeMixin").parseClickToWhatsAppTypeMixin(a);return!b.success?b:b}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"ctwa",h);return!b.success?b:d("WAResultOrError").makeResult({ctwa:b.value})}g.parseCtwaConversionCtwa=h;g.parseCtwaConversionMixin=a}),98);
__d("WASmaxInMessageDeliverButtonsMixin",["WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!b.success)return b;a=d("WASmaxParseUtils").flattenedChildWithTag(b.value,"buttons");return!a.success?a:d("WASmaxParseUtils").voidSuccess}g.parseButtonsMixin=a}),98);
__d("WASmaxInMessageDeliverHSMReviewMetadataMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"category");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"tag");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"id");if(!e.success)return e;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"sub_tag");return!a.success?a:d("WAResultOrError").makeResult({category:b.value,tag:c.value,id:e.value,subTag:a.value})}g.parseHSMReviewMetadataMixin=a}),98);
__d("WASmaxInMessageDeliverHsmMixin",["WASmaxInMessageDeliverHSMReviewMetadataMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"hsm");if(!b.success)return b;a=d("WASmaxInMessageDeliverHSMReviewMetadataMixin").parseHSMReviewMetadataMixin(b.value);return!a.success?a:a}g.parseHsmMixin=a}),98);
__d("WASmaxInMessageDeliverExtensionsMetadataMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"capability");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"name");return!b.success?b:d("WAResultOrError").makeResult({name:b.value})}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"capabilities");if(!b.success)return b;b=d("WASmaxParseUtils").mapChildrenWithTag(a,"capability",1,50,h);return!b.success?b:d("WAResultOrError").makeResult({capability:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"native_flow");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"extensions_metadata");if(!b.success)return b;a=d("WASmaxParseUtils").optionalChildWithTag(b.value,"capabilities",i);if(!a.success)return a;var c=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,b.value,"well_version",1,void 0);if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,b.value,"data_api_version",1,void 0);if(!e.success)return e;b=d("WASmaxParseUtils").attrIntRange(b.value,"flow_message_version",1,void 0);return!b.success?b:d("WAResultOrError").makeResult({extensionsMetadataWellVersion:c.value,extensionsMetadataDataApiVersion:e.value,extensionsMetadataFlowMessageVersion:b.value,extensionsMetadataCapabilities:a.value})}g.parseExtensionsMetadataExtensionsMetadataCapabilitiesCapability=h;g.parseExtensionsMetadataExtensionsMetadataCapabilities=i;g.parseExtensionsMetadataMixin=a}),98);
__d("WASmaxInMessageDeliverNativeFlowMessageTypeMixin",["WAResultOrError","WASmaxInMessageDeliverExtensionsMetadataMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"interactive");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"native_flow");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","native_flow");if(!a.success)return a;var c=d("WASmaxParseUtils").attrString(b.value,"name");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,b.value,"v",1,void 0);if(!e.success)return e;b=d("WASmaxInMessageDeliverExtensionsMetadataMixin").parseExtensionsMetadataMixin(b.value);return d("WAResultOrError").makeResult({type:a.value,nativeFlowName:c.value,nativeFlowV:e.value,nativeFlowExtensionsMetadataMixin:b.success?b.value:null})}g.parseNativeFlowMessageTypeMixin=a}),98);
__d("WASmaxInMessageDeliverInteractiveMixin",["WAResultOrError","WASmaxInMessageDeliverNativeFlowMessageTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!b.success)return b;a=d("WASmaxParseUtils").flattenedChildWithTag(b.value,"interactive");if(!a.success)return a;b=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,a.value,"v","1");if(!b.success)return b;a=d("WASmaxInMessageDeliverNativeFlowMessageTypeMixin").parseNativeFlowMessageTypeMixin(a.value);return!a.success?a:d("WAResultOrError").makeResult({bizInteractiveV:b.value,bizInteractiveNativeFlowMessageTypeMixin:a.value})}g.parseInteractiveMixin=a}),98);
__d("WASmaxInMessageDeliverNativeFlowMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!b.success)return b;a=d("WASmaxParseUtils").attrStringEnum(b.value,"native_flow_name",d("WASmaxInMessageDeliverEnums").ENUM_CATALOGMESSAGE_LANELINECALL_MENUOPTIONS_NOVICOMPLETETRANSACTION_NOVIHUB_NOVILOGIN_NOVIREPORTTRANSACTION_NOVIVIEWBANKDETAIL_NOVIVIEWCARDDETAIL_NOVIVIEWCODE_NOVIVIEWTRANSACTION_ORDERDETAILS_ORDERSTATUS_OTP_PAYMENTMETHOD_PAYMENTSTATUS_VOICECALL);if(!a.success)return a;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,b.value,"native_flow_version",1,void 0);return!b.success?b:d("WAResultOrError").makeResult({bizNativeFlowName:a.value,bizNativeFlowVersion:b.value})}g.parseNativeFlowMixin=a}),98);
__d("WASmaxInMessageDeliverProductListMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!b.success)return b;a=d("WASmaxParseUtils").flattenedChildWithTag(b.value,"list");if(!a.success)return a;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a.value,"type","product_list");return!b.success?b:d("WAResultOrError").makeResult({bizListType:b.value})}g.parseProductListMixin=a}),98);
__d("WASmaxInMessageDeliverHsmOrButtonsOrNativeFlowOrInteractiveOrProductListMixinGroup",["WAResultOrError","WASmaxInMessageDeliverButtonsMixin","WASmaxInMessageDeliverHsmMixin","WASmaxInMessageDeliverInteractiveMixin","WASmaxInMessageDeliverNativeFlowMixin","WASmaxInMessageDeliverProductListMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverHsmMixin").parseHsmMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"Hsm",value:b.value});var c=d("WASmaxInMessageDeliverButtonsMixin").parseButtonsMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"Buttons",value:c.value});var e=d("WASmaxInMessageDeliverNativeFlowMixin").parseNativeFlowMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"NativeFlow",value:e.value});var f=d("WASmaxInMessageDeliverInteractiveMixin").parseInteractiveMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"Interactive",value:f.value});var g=d("WASmaxInMessageDeliverProductListMixin").parseProductListMixin(a);return g.success?d("WAResultOrError").makeResult({name:"ProductList",value:g.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["Hsm","Buttons","NativeFlow","Interactive","ProductList"],[b,c,e,f,g])}g.parseHsmOrButtonsOrNativeFlowOrInteractiveOrProductListMixinGroup=a}),98);
__d("WASmaxInMessageDeliverBizOriginalEnvelopeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"biz");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"original_envelope");if(!b.success)return b;a=d("WASmaxParseUtils").contentBytesRange(b.value,1,102400);return!a.success?a:d("WAResultOrError").makeResult({originalEnvelopeElementValue:a.value})}g.parseBizOriginalEnvelopeMixin=a}),98);
__d("WASmaxInMessageDeliverOriginalEnvelopeMixin",["WASmaxInMessageDeliverBizOriginalEnvelopeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!b.success)return b;a=d("WASmaxInMessageDeliverBizOriginalEnvelopeMixin").parseBizOriginalEnvelopeMixin(b.value);return!a.success?a:a}g.parseOriginalEnvelopeMixin=a}),98);
__d("WASmaxInMessageDeliverBizMixin",["WAResultOrError","WASmaxInMessageDeliverBizAcceptTsMixin","WASmaxInMessageDeliverBizROIMetricsGatingFlagsMixin","WASmaxInMessageDeliverBizRolesMixin","WASmaxInMessageDeliverBusinessBotGatingMixin","WASmaxInMessageDeliverConversionRecipientStatusMixin","WASmaxInMessageDeliverCtwaConversionMixin","WASmaxInMessageDeliverHsmOrButtonsOrNativeFlowOrInteractiveOrProductListMixinGroup","WASmaxInMessageDeliverOriginalEnvelopeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverBizRolesMixin").parseBizRolesMixin(a);var c=d("WASmaxInMessageDeliverBizAcceptTsMixin").parseBizAcceptTsMixin(a),e=d("WASmaxInMessageDeliverBizROIMetricsGatingFlagsMixin").parseBizROIMetricsGatingFlagsMixin(a),f=d("WASmaxInMessageDeliverOriginalEnvelopeMixin").parseOriginalEnvelopeMixin(a),g=d("WASmaxInMessageDeliverConversionRecipientStatusMixin").parseConversionRecipientStatusMixin(a),h=d("WASmaxInMessageDeliverCtwaConversionMixin").parseCtwaConversionMixin(a),i=d("WASmaxInMessageDeliverBusinessBotGatingMixin").parseBusinessBotGatingMixin(a);a=d("WASmaxInMessageDeliverHsmOrButtonsOrNativeFlowOrInteractiveOrProductListMixinGroup").parseHsmOrButtonsOrNativeFlowOrInteractiveOrProductListMixinGroup(a);return d("WAResultOrError").makeResult({bizRolesMixin:b.success?b.value:null,bizAcceptTsMixin:c.success?c.value:null,bizROIMetricsGatingFlagsMixin:e.success?e.value:null,originalEnvelopeMixin:f.success?f.value:null,conversionRecipientStatusMixin:g.success?g.value:null,ctwaConversionMixin:h.success?h.value:null,businessBotGatingMixin:i.success?i.value:null,hsmOrButtonsOrNativeFlowOrInteractiveOrProductListMixinGroup:a.success?a.value:null})}g.parseBizMixin=a}),98);
__d("WASmaxInMessageDeliverDHashMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"dhash");return!b.success?b:d("WAResultOrError").makeResult({dhash:b.value})}g.parseDHashMixin=a}),98);
__d("WASmaxInMessageDeliverFolderIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrInt(a,"folder_id");return!a.success?a:d("WAResultOrError").makeResult({folderId:a.value})}g.parseFolderIDMixin=a}),98);
__d("WASmaxInMessageDeliverFolderMixin",["WASmaxInMessageDeliverFolderIDMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxInMessageDeliverFolderIDMixin").parseFolderIDMixin(b.value);return!a.success?a:a}g.parseFolderMixin=a}),98);
__d("WASmaxInMessageDeliverClientFrankingTagMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"franking");if(!a.success)return a;a=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"franking_tag");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytesRange(a.value,32,128);return!a.success?a:d("WAResultOrError").makeResult({frankingFrankingTagElementValue:a.value})}g.parseClientFrankingTagMixin=a}),98);
__d("WASmaxInMessageDeliverServerFrankingTagMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"franking");if(!a.success)return a;a=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"reporting_tag");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytesRange(a.value,16,128);return!a.success?a:d("WAResultOrError").makeResult({frankingReportingTagElementValue:a.value})}g.parseServerFrankingTagMixin=a}),98);
__d("WASmaxInMessageDeliverFrankingMixin",["WAResultOrError","WASmaxInMessageDeliverClientFrankingTagMixin","WASmaxInMessageDeliverServerFrankingTagMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverClientFrankingTagMixin").parseClientFrankingTagMixin(a);a=d("WASmaxInMessageDeliverServerFrankingTagMixin").parseServerFrankingTagMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({clientFrankingTagMixin:b.success?b.value:null},a.value))}g.parseFrankingMixin=a}),98);
__d("WASmaxInMessageDeliverInternalTestMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"test");if(!a.success)return a;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a.value,"config");return!a.success?a:d("WAResultOrError").makeResult({testConfig:a.value})}g.parseInternalTestMixin=a}),98);
__d("WASmaxInMessageDeliverMetaHideDecryptionPlaceholderMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!a.success)return a;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a.value,"decrypt-fail","hide");return!a.success?a:d("WAResultOrError").makeResult({metaDecryptFail:a.value})}g.parseMetaHideDecryptionPlaceholderMixin=a}),98);
__d("WASmaxInMessageDeliverMulticastMixin",["WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"multicast");return!b.success?b:d("WASmaxParseUtils").voidSuccess}g.parseMulticastMixin=a}),98);
__d("WASmaxInMessageDeliverPaddingMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"padding");if(!b.success)return b;a=d("WASmaxParseUtils").contentBytesRange(b.value,0,128);return!a.success?a:d("WAResultOrError").makeResult({paddingElementValue:a.value})}g.parsePaddingMixin=a}),98);
__d("WASmaxInMessageDeliverPreFilledNumberMixin",["WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"url_number");return!b.success?b:d("WASmaxParseUtils").voidSuccess}g.parsePreFilledNumberMixin=a}),98);
__d("WASmaxInMessageDeliverPreFilledTextMixin",["WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"url_text");return!b.success?b:d("WASmaxParseUtils").voidSuccess}g.parsePreFilledTextMixin=a}),98);
__d("WASmaxInMessageDeliverPushNameMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"notify");return!b.success?b:d("WAResultOrError").makeResult({notify:b.value})}g.parsePushNameMixin=a}),98);
__d("WASmaxInMessageDeliverRequestIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"trace");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"request_id");if(!b.success)return b;a=d("WASmaxParseUtils").contentBytesRange(b.value,1,16);return!a.success?a:d("WAResultOrError").makeResult({requestIdElementValue:a.value})}g.parseRequestIDMixin=a}),98);
__d("WASmaxInMessageDeliverTraceIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"edge_id");if(!b.success)return b;b=d("WASmaxParseUtils").contentBytesRange(a,1,8);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"trace");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"trace_id");if(!b.success)return b;a=d("WASmaxParseUtils").optionalChildWithTag(a,"edge_id",h);if(!a.success)return a;b=d("WASmaxParseUtils").contentBytesRange(b.value,1,8);return!b.success?b:d("WAResultOrError").makeResult({traceIdElementValue:b.value,edgeId:a.value})}g.parseTraceIDEdgeId=h;g.parseTraceIDMixin=a}),98);
__d("WASmaxInMessageDeliverRequestOrTraceIDMixinGroup",["WAResultOrError","WASmaxInMessageDeliverRequestIDMixin","WASmaxInMessageDeliverTraceIDMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverRequestIDMixin").parseRequestIDMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"RequestID",value:b.value});var c=d("WASmaxInMessageDeliverTraceIDMixin").parseTraceIDMixin(a);return c.success?d("WAResultOrError").makeResult({name:"TraceID",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["RequestID","TraceID"],[b,c])}g.parseRequestOrTraceIDMixinGroup=a}),98);
__d("WASmaxInMessageDeliverTraceContextMixin",["WAResultOrError","WASmaxInMessageDeliverRequestOrTraceIDMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"trace");if(!a.success)return a;a=d("WASmaxInMessageDeliverRequestOrTraceIDMixinGroup").parseRequestOrTraceIDMixinGroup(a.value);return!a.success?a:d("WAResultOrError").makeResult({traceRequestOrTraceIDMixinGroup:a.value})}g.parseTraceContextMixin=a}),98);
__d("WASmaxInMessageDeliverTriggerBlockMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"tb_cooldown",0,void 0);if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(a,"tb_expiration_ts",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({tbCooldown:b.value,tbExpirationTs:a.value})}g.parseTriggerBlockMixin=a}),98);
__d("WASmaxInMessageDeliverTriggerMessageCSATAttributesMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").attrIntRange(a,"tm_csat_cooldown",0,void 0);if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(a,"tm_csat_exp_ts",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({tmCsatCooldown:b.value,tmCsatExpTs:a.value})}g.parseTriggerMessageCSATAttributesMixin=a}),98);
__d("WASmaxInMessageDeliverTriggerMessageCSATMixin",["WASmaxInMessageDeliverTriggerMessageCSATAttributesMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxInMessageDeliverTriggerMessageCSATAttributesMixin").parseTriggerMessageCSATAttributesMixin(b.value);return!a.success?a:a}g.parseTriggerMessageCSATMixin=a}),98);
__d("WASmaxInMessageDeliverVerifiedNameCertificateMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"verified_name");if(!b.success)return b;a=d("WASmaxParseUtils").attrInt(b.value,"v");if(!a.success)return a;var c=d("WASmaxParseUtils").attrStringEnum(b.value,"verified_level",d("WASmaxInMessageDeliverEnums").ENUM_HIGH_LOW_UNKNOWN);if(!c.success)return c;b=d("WASmaxParseUtils").contentBytesRange(b.value,1,1024);return!b.success?b:d("WAResultOrError").makeResult({verifiedNameV:a.value,verifiedNameVerifiedLevel:c.value,verifiedNameElementValue:b.value})}g.parseVerifiedNameCertificateMixin=a}),98);
__d("WASmaxInMessageDeliverVerifiedNameLevelMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").attrStringEnum(a,"verified_level",d("WASmaxInMessageDeliverEnums").ENUM_HIGH_LOW_UNKNOWN);return!b.success?b:d("WAResultOrError").makeResult({verifiedLevel:b.value})}g.parseVerifiedNameLevelMixin=a}),98);
__d("WASmaxInMessageDeliverVerifiedNameNameMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"verified_name");return!b.success?b:d("WAResultOrError").makeResult({verifiedName:b.value})}g.parseVerifiedNameNameMixin=a}),98);
__d("WASmaxInMessageDeliverVerifiedNameMixin",["WAResultOrError","WASmaxInMessageDeliverVerifiedNameCertificateMixin","WASmaxInMessageDeliverVerifiedNameLevelMixin","WASmaxInMessageDeliverVerifiedNameNameMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverVerifiedNameNameMixin").parseVerifiedNameNameMixin(a);if(!b.success)return b;var c=d("WASmaxInMessageDeliverVerifiedNameLevelMixin").parseVerifiedNameLevelMixin(a);if(!c.success)return c;a=d("WASmaxInMessageDeliverVerifiedNameCertificateMixin").parseVerifiedNameCertificateMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,c.value,{verifiedNameCertificateMixin:a.success?a.value:null}))}g.parseVerifiedNameMixin=a}),98);
__d("WASmaxInMessageDeliverClientReportingTokenMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"reporting");if(!a.success)return a;a=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"reporting_token");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytesRange(a.value,32,128);return!a.success?a:d("WAResultOrError").makeResult({reportingReportingTokenElementValue:a.value})}g.parseClientReportingTokenMixin=a}),98);
__d("WASmaxInMessageDeliverServerReportingTokenMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"reporting");if(!a.success)return a;a=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"reporting_tag");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytesRange(a.value,16,128);return!a.success?a:d("WAResultOrError").makeResult({reportingReportingTagElementValue:a.value})}g.parseServerReportingTokenMixin=a}),98);
__d("WASmaxInMessageDeliverWaReportingMixin",["WAResultOrError","WASmaxInMessageDeliverClientReportingTokenMixin","WASmaxInMessageDeliverServerReportingTokenMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverClientReportingTokenMixin").parseClientReportingTokenMixin(a);a=d("WASmaxInMessageDeliverServerReportingTokenMixin").parseServerReportingTokenMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({clientReportingTokenMixin:b.success?b.value:null},a.value))}g.parseWaReportingMixin=a}),98);
__d("WASmaxInMessageDeliverBaseMixin",["WAResultOrError","WASmaxInMessageDeliverAutomatedMixin","WASmaxInMessageDeliverBizMixin","WASmaxInMessageDeliverDHashMixin","WASmaxInMessageDeliverDeviceIdentityMixin","WASmaxInMessageDeliverFolderMixin","WASmaxInMessageDeliverFrankingMixin","WASmaxInMessageDeliverInternalTestMixin","WASmaxInMessageDeliverMetaHideDecryptionPlaceholderMixin","WASmaxInMessageDeliverMulticastMixin","WASmaxInMessageDeliverOfflineMixin","WASmaxInMessageDeliverPaddingMixin","WASmaxInMessageDeliverPreFilledNumberMixin","WASmaxInMessageDeliverPreFilledTextMixin","WASmaxInMessageDeliverPushNameMixin","WASmaxInMessageDeliverRegistrationIDMixin","WASmaxInMessageDeliverTraceContextMixin","WASmaxInMessageDeliverTriggerBlockMixin","WASmaxInMessageDeliverTriggerMessageCSATMixin","WASmaxInMessageDeliverVerifiedNameMixin","WASmaxInMessageDeliverWaReportingMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverTriggerBlockMixin").parseTriggerBlockMixin(a);var c=d("WASmaxInMessageDeliverTriggerMessageCSATMixin").parseTriggerMessageCSATMixin(a),e=d("WASmaxInMessageDeliverOfflineMixin").parseOfflineMixin(a),f=d("WASmaxInMessageDeliverPushNameMixin").parsePushNameMixin(a),g=d("WASmaxInMessageDeliverDeviceIdentityMixin").parseDeviceIdentityMixin(a),h=d("WASmaxInMessageDeliverVerifiedNameMixin").parseVerifiedNameMixin(a),i=d("WASmaxInMessageDeliverBizMixin").parseBizMixin(a),j=d("WASmaxInMessageDeliverMulticastMixin").parseMulticastMixin(a),k=d("WASmaxInMessageDeliverPreFilledTextMixin").parsePreFilledTextMixin(a),l=d("WASmaxInMessageDeliverPreFilledNumberMixin").parsePreFilledNumberMixin(a),m=d("WASmaxInMessageDeliverAutomatedMixin").parseAutomatedMixin(a),n=d("WASmaxInMessageDeliverDHashMixin").parseDHashMixin(a),o=d("WASmaxInMessageDeliverRegistrationIDMixin").parseRegistrationIDMixin(a),p=d("WASmaxInMessageDeliverFolderMixin").parseFolderMixin(a),q=d("WASmaxInMessageDeliverFrankingMixin").parseFrankingMixin(a),r=d("WASmaxInMessageDeliverWaReportingMixin").parseWaReportingMixin(a),s=d("WASmaxInMessageDeliverInternalTestMixin").parseInternalTestMixin(a),t=d("WASmaxInMessageDeliverMetaHideDecryptionPlaceholderMixin").parseMetaHideDecryptionPlaceholderMixin(a),u=d("WASmaxInMessageDeliverTraceContextMixin").parseTraceContextMixin(a);a=d("WASmaxInMessageDeliverPaddingMixin").parsePaddingMixin(a);return d("WAResultOrError").makeResult({triggerBlockMixin:b.success?b.value:null,triggerMessageCSATMixin:c.success?c.value:null,offlineMixin:e.success?e.value:null,pushNameMixin:f.success?f.value:null,deviceIdentityMixin:g.success?g.value:null,verifiedNameMixin:h.success?h.value:null,bizMixin:i.success?i.value:null,hasMulticastMixin:j.success,hasPreFilledTextMixin:k.success,hasPreFilledNumberMixin:l.success,hasAutomatedMixin:m.success,dHashMixin:n.success?n.value:null,registrationIDMixin:o.success?o.value:null,folderMixin:p.success?p.value:null,frankingMixin:q.success?q.value:null,waReportingMixin:r.success?r.value:null,internalTestMixin:s.success?s.value:null,metaHideDecryptionPlaceholderMixin:t.success?t.value:null,traceContextMixin:u.success?u.value:null,paddingMixin:a.success?a.value:null})}g.parseBaseMixin=a}),98);
__d("WASmaxInMessageDeliverEncMediaTypeFutureproofMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"mediatype");return!b.success?b:d("WAResultOrError").makeResult({mediatype:b.value})}g.parseEncMediaTypeFutureproofMixin=a}),98);
__d("WASmaxInMessageDeliverAvatarStickerTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"sticker_type","avatar");return!b.success?b:d("WAResultOrError").makeResult({stickerType:b.value})}g.parseAvatarStickerTypeMixin=a}),98);
__d("WASmaxInMessageDeliverMediaTypeMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").attrStringEnum(a,"mediatype",d("WASmaxInMessageDeliverEnums").ENUM_AUDIO_AVATARSTICKER_BUTTONSRESPONSE_CATALOGLINK_CONTACT_CONTACTARRAY_DOCUMENT_GENAISTICKER_GIF_HISTORY_IMAGE_LISTRESPONSE_LOCATION_NATIVEFLOWRESPONSE_ORDER_PRODUCT_PRODUCTLINK_PTT_PTV_STICKER_URL_VCARD_VIDEO_XMA);return!b.success?b:d("WAResultOrError").makeResult({mediatype:b.value})}g.parseMediaTypeMixin=a}),98);
__d("WASmaxInMessageDeliverEncMediaTypeMixin",["WAResultOrError","WASmaxInMessageDeliverAvatarStickerTypeMixin","WASmaxInMessageDeliverEnums","WASmaxInMessageDeliverMediaTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a,"native_flow_name",d("WASmaxInMessageDeliverEnums").ENUM_ADDRESSMESSAGE_FORMMESSAGE_GALAXYMESSAGE_MENUOPTIONS);if(!b.success)return b;var c=d("WASmaxInMessageDeliverMediaTypeMixin").parseMediaTypeMixin(a);if(!c.success)return c;a=d("WASmaxInMessageDeliverAvatarStickerTypeMixin").parseAvatarStickerTypeMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({nativeFlowName:b.value},c.value,{avatarStickerTypeMixin:a.success?a.value:null}))}g.parseEncMediaTypeMixin=a}),98);
__d("WASmaxInMessageDeliverEncMediaTypeEncMediaTypeOrEncMediaTypeFutureproofMixinGroup",["WAResultOrError","WASmaxInMessageDeliverEncMediaTypeFutureproofMixin","WASmaxInMessageDeliverEncMediaTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverEncMediaTypeMixin").parseEncMediaTypeMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"EncMediaType",value:b.value});var c=d("WASmaxInMessageDeliverEncMediaTypeFutureproofMixin").parseEncMediaTypeFutureproofMixin(a);return c.success?d("WAResultOrError").makeResult({name:"EncMediaTypeFutureproof",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["EncMediaType","EncMediaTypeFutureproof"],[b,c])}g.parseEncMediaTypeEncMediaTypeOrEncMediaTypeFutureproofMixinGroup=a}),98);
__d("WASmaxInMessageDeliverEncTypeSenderKeyMixin",["WAResultOrError","WASmaxInMessageDeliverEncHideDecryptionPlaceholderMixin","WASmaxInMessageDeliverEncPayloadMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","skmsg");if(!b.success)return b;var c=d("WASmaxInMessageDeliverEncHideDecryptionPlaceholderMixin").parseEncHideDecryptionPlaceholderMixin(a);a=d("WASmaxInMessageDeliverEncPayloadMixin").parseEncPayloadMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({type:b.value,encHideDecryptionPlaceholderMixin:c.success?c.value:null},a.value))}g.parseEncTypeSenderKeyMixin=a}),98);
__d("WASmaxInMessageDeliverEncTypeSenderKeyAndBroadcastMediaMixin",["WAResultOrError","WASmaxInMessageDeliverEncMediaTypeEncMediaTypeOrEncMediaTypeFutureproofMixinGroup","WASmaxInMessageDeliverEncTypeSenderKeyMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxInMessageDeliverEncTypeSenderKeyMixin").parseEncTypeSenderKeyMixin(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverEncMediaTypeEncMediaTypeOrEncMediaTypeFutureproofMixinGroup").parseEncMediaTypeEncMediaTypeOrEncMediaTypeFutureproofMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{encMediaTypeEncMediaTypeOrEncMediaTypeFutureproofMixinGroup:a.value}))}g.parseEncTypeSenderKeyAndBroadcastMediaMixin=a}),98);
__d("WASmaxInMessageDeliverEncTypeSenderKeyAndBroadcastMediaOrIndividualMixinGroup",["WAResultOrError","WASmaxInMessageDeliverEncTypeIndividualMixin","WASmaxInMessageDeliverEncTypeSenderKeyAndBroadcastMediaMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverEncTypeSenderKeyAndBroadcastMediaMixin").parseEncTypeSenderKeyAndBroadcastMediaMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"EncTypeSenderKeyAndBroadcastMedia",value:b.value});var c=d("WASmaxInMessageDeliverEncTypeIndividualMixin").parseEncTypeIndividualMixin(a);return c.success?d("WAResultOrError").makeResult({name:"EncTypeIndividual",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["EncTypeSenderKeyAndBroadcastMedia","EncTypeIndividual"],[b,c])}g.parseEncTypeSenderKeyAndBroadcastMediaOrIndividualMixinGroup=a}),98);
__d("WASmaxInMessageDeliverBroadcastDualEncMediaMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeMediaMixin","WASmaxInMessageDeliverEncTypeSenderKeyAndBroadcastMediaOrIndividualMixinGroup","WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup").parseEncVersion2Or3OrFutureproofMixinGroup(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverEncTypeSenderKeyAndBroadcastMediaOrIndividualMixinGroup").parseEncTypeSenderKeyAndBroadcastMediaOrIndividualMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({encVersion2Or3OrFutureproofMixinGroup:b.value,encTypeSenderKeyAndBroadcastMediaOrIndividualMixinGroup:a.value})}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"rcat");if(!b.success)return b;b=d("WASmaxParseUtils").contentBytes(a);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"rcat",i);if(!b.success)return b;var c=d("WASmaxInMessageDeliverContentTypeMediaMixin").parseContentTypeMediaMixin(a);if(!c.success)return c;a=d("WASmaxParseUtils").mapChildrenWithTag(a,"enc",2,2,h);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},c.value,{rcat:b.value,enc:a.value}))}g.parseBroadcastDualEncMediaEnc=h;g.parseBroadcastDualEncMediaRcat=i;g.parseBroadcastDualEncMediaMixin=a}),98);
__d("WASmaxInMessageDeliverEncTypeSenderKeyOrIndividualMixinGroup",["WAResultOrError","WASmaxInMessageDeliverEncTypeIndividualMixin","WASmaxInMessageDeliverEncTypeSenderKeyMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverEncTypeSenderKeyMixin").parseEncTypeSenderKeyMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"EncTypeSenderKey",value:b.value});var c=d("WASmaxInMessageDeliverEncTypeIndividualMixin").parseEncTypeIndividualMixin(a);return c.success?d("WAResultOrError").makeResult({name:"EncTypeIndividual",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["EncTypeSenderKey","EncTypeIndividual"],[b,c])}g.parseEncTypeSenderKeyOrIndividualMixinGroup=a}),98);
__d("WASmaxInMessageDeliverBroadcastDualEncNonMediaMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeTextMixin","WASmaxInMessageDeliverEncTypeSenderKeyOrIndividualMixinGroup","WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup").parseEncVersion2Or3OrFutureproofMixinGroup(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverEncTypeSenderKeyOrIndividualMixinGroup").parseEncTypeSenderKeyOrIndividualMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({encVersion2Or3OrFutureproofMixinGroup:b.value,encTypeSenderKeyOrIndividualMixinGroup:a.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverContentTypeTextMixin").parseContentTypeTextMixin(a);if(!b.success)return b;a=d("WASmaxParseUtils").mapChildrenWithTag(a,"enc",2,2,h);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{enc:a.value}))}g.parseBroadcastDualEncNonMediaEnc=h;g.parseBroadcastDualEncNonMediaMixin=a}),98);
__d("WASmaxInMessageDeliverBroadcastDualEncBroadcastDualEncMediaOrBroadcastDualEncNonMediaMediaMixinGroup",["WAResultOrError","WASmaxInMessageDeliverBroadcastDualEncMediaMixin","WASmaxInMessageDeliverBroadcastDualEncNonMediaMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverBroadcastDualEncMediaMixin").parseBroadcastDualEncMediaMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"BroadcastDualEncMedia",value:b.value});var c=d("WASmaxInMessageDeliverBroadcastDualEncNonMediaMixin").parseBroadcastDualEncNonMediaMixin(a);return c.success?d("WAResultOrError").makeResult({name:"BroadcastDualEncNonMedia",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["BroadcastDualEncMedia","BroadcastDualEncNonMedia"],[b,c])}g.parseBroadcastDualEncBroadcastDualEncMediaOrBroadcastDualEncNonMediaMediaMixinGroup=a}),98);
__d("WASmaxInMessageDeliverBroadcastEphemeralMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrString(a,"eph_setting");return!a.success?a:d("WAResultOrError").makeResult({ephSetting:a.value})}g.parseBroadcastEphemeralMixin=a}),98);
__d("WASmaxInMessageDeliverToUserMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"to");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"jid");return!b.success?b:d("WAResultOrError").makeResult({jid:b.value})}g.parseToUserMixin=a}),98);
__d("WASmaxInMessageDeliverBroadcastParticipantsMixin",["WAResultOrError","WASmaxInMessageDeliverBroadcastEphemeralMixin","WASmaxInMessageDeliverToUserMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"to");if(!b.success)return b;b=d("WASmaxInMessageDeliverToUserMixin").parseToUserMixin(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverBroadcastEphemeralMixin").parseBroadcastEphemeralMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{broadcastEphemeralMixin:a.success?a.value:null}))}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"participants");if(!b.success)return b;a=d("WASmaxParseUtils").mapChildrenWithTag(b.value,"to",0,256,h);return!a.success?a:d("WAResultOrError").makeResult({participantsTo:a.value})}g.parseBroadcastParticipantsParticipantsTo=h;g.parseBroadcastParticipantsMixin=a}),98);
__d("WASmaxInMessageDeliverBroadcastDualEncMixin",["WAResultOrError","WASmaxInMessageDeliverBroadcastDualEncBroadcastDualEncMediaOrBroadcastDualEncNonMediaMediaMixinGroup","WASmaxInMessageDeliverBroadcastParticipantsMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverBroadcastParticipantsMixin").parseBroadcastParticipantsMixin(a);a=d("WASmaxInMessageDeliverBroadcastDualEncBroadcastDualEncMediaOrBroadcastDualEncNonMediaMediaMixinGroup").parseBroadcastDualEncBroadcastDualEncMediaOrBroadcastDualEncNonMediaMediaMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({broadcastParticipantsMixin:b.success?b.value:null,broadcastDualEncBroadcastDualEncMediaOrBroadcastDualEncNonMediaMediaMixinGroup:a.value})}g.parseBroadcastDualEncMixin=a}),98);
__d("WASmaxInMessageDeliverContentTypeMedianotifyMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","medianotify");return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parseContentTypeMedianotifyMixin=a}),98);
__d("WASmaxInMessageDeliverContentTypeMediaOrMedianotifyMixinGroup",["WAResultOrError","WASmaxInMessageDeliverContentTypeMediaMixin","WASmaxInMessageDeliverContentTypeMedianotifyMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverContentTypeMediaMixin").parseContentTypeMediaMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"ContentTypeMedia",value:b.value});var c=d("WASmaxInMessageDeliverContentTypeMedianotifyMixin").parseContentTypeMedianotifyMixin(a);return c.success?d("WAResultOrError").makeResult({name:"ContentTypeMedianotify",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["ContentTypeMedia","ContentTypeMedianotify"],[b,c])}g.parseContentTypeMediaOrMedianotifyMixinGroup=a}),98);
__d("WASmaxInMessageDeliverContentTypeMediaSingleMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeMediaOrMedianotifyMixinGroup","WASmaxInMessageDeliverEncMediaTypeEncMediaTypeOrEncMediaTypeFutureproofMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"rcat");if(!b.success)return b;b=d("WASmaxParseUtils").contentBytes(a);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"enc");if(!b.success)return b;var c=d("WASmaxParseUtils").optionalChildWithTag(a,"rcat",h);if(!c.success)return c;b=d("WASmaxInMessageDeliverEncMediaTypeEncMediaTypeOrEncMediaTypeFutureproofMixinGroup").parseEncMediaTypeEncMediaTypeOrEncMediaTypeFutureproofMixinGroup(b.value);if(!b.success)return b;a=d("WASmaxInMessageDeliverContentTypeMediaOrMedianotifyMixinGroup").parseContentTypeMediaOrMedianotifyMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({encEncMediaTypeEncMediaTypeOrEncMediaTypeFutureproofMixinGroup:b.value,contentTypeMediaOrMedianotifyMixinGroup:a.value,rcat:c.value})}g.parseContentTypeMediaSingleRcat=h;g.parseContentTypeMediaSingleMixin=a}),98);
__d("WASmaxInMessageDeliverContentTypeTextOrMediaSingleMixinGroup",["WAResultOrError","WASmaxInMessageDeliverContentTypeMediaSingleMixin","WASmaxInMessageDeliverContentTypeTextMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverContentTypeTextMixin").parseContentTypeTextMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"ContentTypeText",value:b.value});var c=d("WASmaxInMessageDeliverContentTypeMediaSingleMixin").parseContentTypeMediaSingleMixin(a);return c.success?d("WAResultOrError").makeResult({name:"ContentTypeMediaSingle",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["ContentTypeText","ContentTypeMediaSingle"],[b,c])}g.parseContentTypeTextOrMediaSingleMixinGroup=a}),98);
__d("WASmaxInMessageDeliverEncTypeIndividualOrSenderKeyMixinGroup",["WAResultOrError","WASmaxInMessageDeliverEncTypeIndividualMixin","WASmaxInMessageDeliverEncTypeSenderKeyMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverEncTypeIndividualMixin").parseEncTypeIndividualMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"EncTypeIndividual",value:b.value});var c=d("WASmaxInMessageDeliverEncTypeSenderKeyMixin").parseEncTypeSenderKeyMixin(a);return c.success?d("WAResultOrError").makeResult({name:"EncTypeSenderKey",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["EncTypeIndividual","EncTypeSenderKey"],[b,c])}g.parseEncTypeIndividualOrSenderKeyMixinGroup=a}),98);
__d("WASmaxInMessageDeliverBroadcastRegularMixin",["WAResultOrError","WASmaxInMessageDeliverBroadcastParticipantsMixin","WASmaxInMessageDeliverEncTypeIndividualOrSenderKeyMixinGroup","WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"enc");if(!b.success)return b;a=d("WASmaxInMessageDeliverBroadcastParticipantsMixin").parseBroadcastParticipantsMixin(a);var c=d("WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup").parseEncVersion2Or3OrFutureproofMixinGroup(b.value);if(!c.success)return c;b=d("WASmaxInMessageDeliverEncTypeIndividualOrSenderKeyMixinGroup").parseEncTypeIndividualOrSenderKeyMixinGroup(b.value);return!b.success?b:d("WAResultOrError").makeResult({broadcastParticipantsMixin:a.success?a.value:null,encEncVersion2Or3OrFutureproofMixinGroup:c.value,encEncTypeIndividualOrSenderKeyMixinGroup:b.value})}g.parseBroadcastRegularMixin=a}),98);
__d("WASmaxInMessageDeliverRetryOrBroadcastRegularMixinGroup",["WAResultOrError","WASmaxInMessageDeliverBroadcastRegularMixin","WASmaxInMessageDeliverRetryMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverRetryMixin").parseRetryMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"Retry",value:b.value});var c=d("WASmaxInMessageDeliverBroadcastRegularMixin").parseBroadcastRegularMixin(a);return c.success?d("WAResultOrError").makeResult({name:"BroadcastRegular",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["Retry","BroadcastRegular"],[b,c])}g.parseRetryOrBroadcastRegularMixinGroup=a}),98);
__d("WASmaxInMessageDeliverBroadcastSingleEncMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeTextOrMediaSingleMixinGroup","WASmaxInMessageDeliverRetryOrBroadcastRegularMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverContentTypeTextOrMediaSingleMixinGroup").parseContentTypeTextOrMediaSingleMixinGroup(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverRetryOrBroadcastRegularMixinGroup").parseRetryOrBroadcastRegularMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({contentTypeTextOrMediaSingleMixinGroup:b.value,retryOrBroadcastRegularMixinGroup:a.value})}g.parseBroadcastSingleEncMixin=a}),98);
__d("WASmaxInMessageDeliverBroadcastDualOrSingleEncMixinGroup",["WAResultOrError","WASmaxInMessageDeliverBroadcastDualEncMixin","WASmaxInMessageDeliverBroadcastSingleEncMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverBroadcastDualEncMixin").parseBroadcastDualEncMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"BroadcastDualEnc",value:b.value});var c=d("WASmaxInMessageDeliverBroadcastSingleEncMixin").parseBroadcastSingleEncMixin(a);return c.success?d("WAResultOrError").makeResult({name:"BroadcastSingleEnc",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["BroadcastDualEnc","BroadcastSingleEnc"],[b,c])}g.parseBroadcastDualOrSingleEncMixinGroup=a}),98);
__d("WASmaxInMessageDeliverFanoutCountMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrInt(a,"count");return!a.success?a:d("WAResultOrError").makeResult({count:a.value})}g.parseFanoutCountMixin=a}),98);
__d("WASmaxInMessageDeliverMessageEditMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"edit","1");return!b.success?b:d("WAResultOrError").makeResult({edit:b.value})}g.parseMessageEditMixin=a}),98);
__d("WASmaxInMessageDeliverMessageEditOrRevokeOrBroadcastEphemeralMixinGroup",["WAResultOrError","WASmaxInMessageDeliverBroadcastEphemeralMixin","WASmaxInMessageDeliverMessageEditMixin","WASmaxInMessageDeliverRevokeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverMessageEditMixin").parseMessageEditMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"MessageEdit",value:b.value});var c=d("WASmaxInMessageDeliverRevokeMixin").parseRevokeMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"Revoke",value:c.value});var e=d("WASmaxInMessageDeliverBroadcastEphemeralMixin").parseBroadcastEphemeralMixin(a);return e.success?d("WAResultOrError").makeResult({name:"BroadcastEphemeral",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["MessageEdit","Revoke","BroadcastEphemeral"],[b,c,e])}g.parseMessageEditOrRevokeOrBroadcastEphemeralMixinGroup=a}),98);
__d("WASmaxInMessageDeliverSMBBroadcastSourceMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,b.value,"biz_source","smb_promo");return!a.success?a:d("WAResultOrError").makeResult({metaBizSource:a.value})}g.parseSMBBroadcastSourceMixin=a}),98);
__d("WASmaxInMessageDeliverSMBBroadcastSourceWithCampaignMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!a.success)return a;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,b.value,"biz_source","smb_promo");if(!b.success)return b;a=d("WASmaxParseUtils").attrString(a.value,"campaign_id");return!a.success?a:d("WAResultOrError").makeResult({metaBizSource:b.value,bizCampaignId:a.value})}g.parseSMBBroadcastSourceWithCampaignMixin=a}),98);
__d("WASmaxInMessageDeliverBroadcastMixin",["WAResultOrError","WASmaxInMessageDeliverBroadcastDualOrSingleEncMixinGroup","WASmaxInMessageDeliverEnums","WASmaxInMessageDeliverFanoutCountMixin","WASmaxInMessageDeliverMessageEditOrRevokeOrBroadcastEphemeralMixinGroup","WASmaxInMessageDeliverSMBBroadcastSourceMixin","WASmaxInMessageDeliverSMBBroadcastSourceWithCampaignMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseJid").attrBroadcastJid(a,"from");if(!b.success)return b;var c=d("WASmaxParseJid").attrJidEnum(a,"participant",d("WASmaxInMessageDeliverEnums").DEVICEJID_DEVICEJID);if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"participant_pn");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"participant_lid");if(!f.success)return f;var g=d("WASmaxInMessageDeliverFanoutCountMixin").parseFanoutCountMixin(a),h=d("WASmaxInMessageDeliverSMBBroadcastSourceMixin").parseSMBBroadcastSourceMixin(a),i=d("WASmaxInMessageDeliverSMBBroadcastSourceWithCampaignMixin").parseSMBBroadcastSourceWithCampaignMixin(a),j=d("WASmaxInMessageDeliverBroadcastDualOrSingleEncMixinGroup").parseBroadcastDualOrSingleEncMixinGroup(a);if(!j.success)return j;a=d("WASmaxInMessageDeliverMessageEditOrRevokeOrBroadcastEphemeralMixinGroup").parseMessageEditOrRevokeOrBroadcastEphemeralMixinGroup(a);return d("WAResultOrError").makeResult({from:b.value,participant:c.value,participantPn:e.value,participantLid:f.value,fanoutCountMixin:g.success?g.value:null,sMBBroadcastSourceMixin:h.success?h.value:null,sMBBroadcastSourceWithCampaignMixin:i.success?i.value:null,broadcastDualOrSingleEncMixinGroup:j.value,messageEditOrRevokeOrBroadcastEphemeralMixinGroup:a.success?a.value:null})}g.parseBroadcastMixin=a}),98);
__d("WASmaxInMessageDeliverBotThreadIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"thread_id");return!b.success?b:d("WAResultOrError").makeResult({threadId:b.value})}g.parseBotThreadIDMixin=a}),98);
__d("WASmaxInMessageDeliverDisplayNameMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrString(a,"display_name");return!a.success?a:d("WAResultOrError").makeResult({displayName:a.value})}g.parseDisplayNameMixin=a}),98);
__d("WASmaxInMessageDeliverGroupAddressingModeMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrStringEnum(a,"addressing_mode",d("WASmaxInMessageDeliverEnums").ENUM_LID_PN);return!a.success?a:d("WAResultOrError").makeResult({addressingMode:a.value})}g.parseGroupAddressingModeMixin=a}),98);
__d("WASmaxInMessageDeliverEncListMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"mediatype","list");return!b.success?b:d("WAResultOrError").makeResult({mediatype:b.value})}g.parseEncListMixin=a}),98);
__d("WASmaxInMessageDeliverEncLiveLocationMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"mediatype","livelocation");if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(a,"duration",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({mediatype:b.value,duration:a.value})}g.parseEncLiveLocationMixin=a}),98);
__d("WASmaxInMessageDeliverEncLiveLocationOrListOrMediaTypeOrMediaTypeFutureproofMixinGroup",["WAResultOrError","WASmaxInMessageDeliverEncListMixin","WASmaxInMessageDeliverEncLiveLocationMixin","WASmaxInMessageDeliverEncMediaTypeFutureproofMixin","WASmaxInMessageDeliverEncMediaTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverEncLiveLocationMixin").parseEncLiveLocationMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"EncLiveLocation",value:b.value});var c=d("WASmaxInMessageDeliverEncListMixin").parseEncListMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"EncList",value:c.value});var e=d("WASmaxInMessageDeliverEncMediaTypeMixin").parseEncMediaTypeMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"EncMediaType",value:e.value});var f=d("WASmaxInMessageDeliverEncMediaTypeFutureproofMixin").parseEncMediaTypeFutureproofMixin(a);return f.success?d("WAResultOrError").makeResult({name:"EncMediaTypeFutureproof",value:f.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["EncLiveLocation","EncList","EncMediaType","EncMediaTypeFutureproof"],[b,c,e,f])}g.parseEncLiveLocationOrListOrMediaTypeOrMediaTypeFutureproofMixinGroup=a}),98);
__d("WASmaxInMessageDeliverEncTypeSenderKeyAndGroupMediaMixin",["WAResultOrError","WASmaxInMessageDeliverEncLiveLocationOrListOrMediaTypeOrMediaTypeFutureproofMixinGroup","WASmaxInMessageDeliverEncTypeSenderKeyMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxInMessageDeliverEncTypeSenderKeyMixin").parseEncTypeSenderKeyMixin(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverEncLiveLocationOrListOrMediaTypeOrMediaTypeFutureproofMixinGroup").parseEncLiveLocationOrListOrMediaTypeOrMediaTypeFutureproofMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{encLiveLocationOrListOrMediaTypeOrMediaTypeFutureproofMixinGroup:a.value}))}g.parseEncTypeSenderKeyAndGroupMediaMixin=a}),98);
__d("WASmaxInMessageDeliverEncTypeSenderKeyAndGroupMediaOrIndividualMixinGroup",["WAResultOrError","WASmaxInMessageDeliverEncTypeIndividualMixin","WASmaxInMessageDeliverEncTypeSenderKeyAndGroupMediaMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverEncTypeSenderKeyAndGroupMediaMixin").parseEncTypeSenderKeyAndGroupMediaMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"EncTypeSenderKeyAndGroupMedia",value:b.value});var c=d("WASmaxInMessageDeliverEncTypeIndividualMixin").parseEncTypeIndividualMixin(a);return c.success?d("WAResultOrError").makeResult({name:"EncTypeIndividual",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["EncTypeSenderKeyAndGroupMedia","EncTypeIndividual"],[b,c])}g.parseEncTypeSenderKeyAndGroupMediaOrIndividualMixinGroup=a}),98);
__d("WASmaxInMessageDeliverGroupDualEncMediaMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeMediaMixin","WASmaxInMessageDeliverEncTypeSenderKeyAndGroupMediaOrIndividualMixinGroup","WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup").parseEncVersion2Or3OrFutureproofMixinGroup(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverEncTypeSenderKeyAndGroupMediaOrIndividualMixinGroup").parseEncTypeSenderKeyAndGroupMediaOrIndividualMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({encVersion2Or3OrFutureproofMixinGroup:b.value,encTypeSenderKeyAndGroupMediaOrIndividualMixinGroup:a.value})}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"rcat");if(!b.success)return b;b=d("WASmaxParseUtils").contentBytes(a);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"rcat",i);if(!b.success)return b;var c=d("WASmaxInMessageDeliverContentTypeMediaMixin").parseContentTypeMediaMixin(a);if(!c.success)return c;a=d("WASmaxParseUtils").mapChildrenWithTag(a,"enc",2,2,h);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},c.value,{rcat:b.value,enc:a.value}))}g.parseGroupDualEncMediaEnc=h;g.parseGroupDualEncMediaRcat=i;g.parseGroupDualEncMediaMixin=a}),98);
__d("WASmaxInMessageDeliverContentTypeEventMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","event");if(!a.success)return a;b=d("WASmaxParseUtils").attrStringEnum(b.value,"event_type",d("WASmaxInMessageDeliverEnums").ENUM_CREATION_EDIT_RESPONSE);return!b.success?b:d("WAResultOrError").makeResult({type:a.value,metaEventType:b.value})}g.parseContentTypeEventMixin=a}),98);
__d("WASmaxInMessageDeliverDeprecatedPayTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"mediatype","pay");return!b.success?b:d("WAResultOrError").makeResult({mediatype:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").mapHomogeneousChildrenWithTag(a,"enc",h);return!b.success?b:d("WAResultOrError").makeResult({enc:b.value})}g.parseDeprecatedPayTypeEnc=h;g.parseDeprecatedPayTypeMixin=a}),98);
__d("WASmaxInMessageDeliverContentTypePayMixin",["WAResultOrError","WASmaxInMessageDeliverDeprecatedPayTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","pay");if(!b.success)return b;a=d("WASmaxInMessageDeliverDeprecatedPayTypeMixin").parseDeprecatedPayTypeMixin(a);return d("WAResultOrError").makeResult({type:b.value,deprecatedPayTypeMixin:a.success?a.value:null})}g.parseContentTypePayMixin=a}),98);
__d("WASmaxInMessageDeliverLegacyAmountMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"pay");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"currency");if(!b.success)return b;a=d("WASmaxParseUtils").attrString(a,"amount");return!a.success?a:d("WAResultOrError").makeResult({currency:b.value,amount:a.value})}g.parseLegacyAmountMixin=a}),98);
__d("WASmaxInMessageDeliverMoneyMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"money");if(!a.success)return a;var b=d("WASmaxParseUtils").attrString(a.value,"value");if(!b.success)return b;var c=d("WASmaxParseUtils").attrString(a.value,"offset");if(!c.success)return c;a=d("WASmaxParseUtils").attrString(a.value,"currency");return!a.success?a:d("WAResultOrError").makeResult({moneyValue:b.value,moneyOffset:c.value,moneyCurrency:a.value})}g.parseMoneyMixin=a}),98);
__d("WASmaxInMessageDeliverPayNodeTypeMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"pay");if(!b.success)return b;b=d("WASmaxParseUtils").attrStringEnum(a,"type",d("WASmaxInMessageDeliverEnums").ENUM_REQUEST_SEND);return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parsePayNodeTypeMixin=a}),98);
__d("WASmaxInMessageDeliverTransactionSyncStatusMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrStringEnum(a,"sync-status",d("WASmaxInMessageDeliverEnums").ENUM_FULL_MISSINGFIELDNOTPARTIAL_PARTIAL);return!a.success?a:d("WAResultOrError").makeResult({syncStatus:a.value})}g.parseTransactionSyncStatusMixin=a}),98);
__d("WASmaxInMessageDeliverGroupDeliverSendPayNodeMixin",["WAResultOrError","WASmaxInMessageDeliverLegacyAmountMixin","WASmaxInMessageDeliverMoneyMixin","WASmaxInMessageDeliverPayNodeTypeMixin","WASmaxInMessageDeliverTransactionSyncStatusMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"amount");if(!b.success)return b;b=d("WASmaxInMessageDeliverMoneyMixin").parseMoneyMixin(a);return!b.success?b:b}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"pay");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"amount",h);if(!b.success)return b;var c=d("WASmaxParseJid").attrUserJid(a,"receiver");if(!c.success)return c;var e=d("WASmaxParseUtils").attrString(a,"transaction-id");if(!e.success)return e;var f=d("WASmaxParseUtils").attrString(a,"id");if(!f.success)return f;var g=d("WASmaxParseJid").attrGroupJid(a,"group");if(!g.success)return g;var i=d("WASmaxInMessageDeliverPayNodeTypeMixin").parsePayNodeTypeMixin(a);if(!i.success)return i;var j=d("WASmaxInMessageDeliverTransactionSyncStatusMixin").parseTransactionSyncStatusMixin(a);if(!j.success)return j;a=d("WASmaxInMessageDeliverLegacyAmountMixin").parseLegacyAmountMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({receiver:c.value,transactionId:e.value,id:f.value,group:g.value},i.value,j.value,a.value,{amount:b.value}))}g.parseGroupDeliverSendPayNodeAmount=h;g.parseGroupDeliverSendPayNodeMixin=a}),98);
__d("WASmaxInMessageDeliverBasePayNodeMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxInMessageDeliverPayNodeTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"pay");if(!b.success)return b;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"country");if(!b.success)return b;var c=d("WASmaxParseUtils").attrIntRange(a,"version",0,void 0);if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a,"is_first_send",d("WASmaxInMessageDeliverEnums").ENUM_0_1);if(!e.success)return e;a=d("WASmaxInMessageDeliverPayNodeTypeMixin").parsePayNodeTypeMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({country:b.value,version:c.value,isFirstSend:e.value},a.value))}g.parseBasePayNodeMixin=a}),98);
__d("WASmaxInMessageDeliverIndividualRequestPayNodeMixin",["WAResultOrError","WASmaxInMessageDeliverBasePayNodeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"pay");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"expiry-ts");if(!b.success)return b;var c=d("WASmaxParseUtils").attrString(a,"request-id");if(!c.success)return c;a=d("WASmaxInMessageDeliverBasePayNodeMixin").parseBasePayNodeMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({expiryTs:b.value,requestId:c.value},a.value))}g.parseIndividualRequestPayNodeMixin=a}),98);
__d("WASmaxInMessageDeliverGroupRequestPayNodeMixin",["WAResultOrError","WASmaxInMessageDeliverIndividualRequestPayNodeMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"pay");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"sender");if(!b.success)return b;a=d("WASmaxInMessageDeliverIndividualRequestPayNodeMixin").parseIndividualRequestPayNodeMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({sender:b.value},a.value))}g.parseGroupRequestPayNodeMixin=a}),98);
__d("WASmaxInMessageDeliverGroupRequestOrDeliverSendPayNodeMixinGroup",["WAResultOrError","WASmaxInMessageDeliverGroupDeliverSendPayNodeMixin","WASmaxInMessageDeliverGroupRequestPayNodeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverGroupRequestPayNodeMixin").parseGroupRequestPayNodeMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"GroupRequestPayNode",value:b.value});var c=d("WASmaxInMessageDeliverGroupDeliverSendPayNodeMixin").parseGroupDeliverSendPayNodeMixin(a);return c.success?d("WAResultOrError").makeResult({name:"GroupDeliverSendPayNode",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["GroupRequestPayNode","GroupDeliverSendPayNode"],[b,c])}g.parseGroupRequestOrDeliverSendPayNodeMixinGroup=a}),98);
__d("WASmaxInMessageDeliverGroupDeliverPayNodeMixin",["WAResultOrError","WASmaxInMessageDeliverGroupRequestOrDeliverSendPayNodeMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"pay");if(!b.success)return b;b=d("WASmaxInMessageDeliverGroupRequestOrDeliverSendPayNodeMixinGroup").parseGroupRequestOrDeliverSendPayNodeMixinGroup(a);return!b.success?b:d("WAResultOrError").makeResult({groupRequestOrDeliverSendPayNodeMixinGroup:b.value})}g.parseGroupDeliverPayNodeMixin=a}),98);
__d("WASmaxInMessageDeliverGroupDeliverPayNodeMessageMixin",["WASmaxInMessageDeliverGroupDeliverPayNodeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"pay");if(!b.success)return b;a=d("WASmaxInMessageDeliverGroupDeliverPayNodeMixin").parseGroupDeliverPayNodeMixin(b.value);return!a.success?a:a}g.parseGroupDeliverPayNodeMessageMixin=a}),98);
__d("WASmaxInMessageDeliverIncentiveOfferClaimMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"offer_claim");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"offer_id",1,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"id",1,void 0);if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"incentive_payment_id");if(!e.success)return e;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"parent_transaction_id");return!a.success?a:d("WAResultOrError").makeResult({offerId:b.value,id:c.value,incentivePaymentId:e.value,parentTransactionId:a.value})}g.parseIncentiveOfferClaimMixin=a}),98);
__d("WASmaxInMessageDeliverInstallmentMixin",["WAResultOrError","WASmaxInMessageDeliverMoneyMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"due_amount");if(!b.success)return b;b=d("WASmaxInMessageDeliverMoneyMixin").parseMoneyMixin(a);return!b.success?b:b}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"interest");if(!b.success)return b;b=d("WASmaxInMessageDeliverMoneyMixin").parseMoneyMixin(a);return!b.success?b:b}function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"installment");if(!a.success)return a;var b=d("WASmaxParseUtils").optionalChildWithTag(a.value,"due_amount",h);if(!b.success)return b;var c=d("WASmaxParseUtils").optionalChildWithTag(a.value,"interest",i);if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a.value,"max_count",1,50);if(!e.success)return e;a=d("WASmaxParseUtils").attrIntRange(a.value,"selected_count",1,50);return!a.success?a:d("WAResultOrError").makeResult({installmentMaxCount:e.value,installmentSelectedCount:a.value,installmentDueAmount:b.value,installmentInterest:c.value})}g.parseInstallmentInstallmentDueAmount=h;g.parseInstallmentInstallmentInterest=i;g.parseInstallmentMixin=a}),98);
__d("WASmaxInMessageDeliverBeneficiaryMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"beneficiary");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"name");if(!b.success)return b;var c=d("WASmaxParseUtils").attrString(a,"address_line1");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"address_line2");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"city");if(!f.success)return f;var g=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"state");if(!g.success)return g;var h=d("WASmaxParseUtils").attrString(a,"country");if(!h.success)return h;a=d("WASmaxParseUtils").attrString(a,"postal_code");return!a.success?a:d("WAResultOrError").makeResult({name:b.value,addressLine1:c.value,addressLine2:e.value,city:f.value,state:g.value,country:h.value,postalCode:a.value})}g.parseBeneficiaryMixin=a}),98);
__d("WASmaxInMessageDeliverBeneficiariesMixin",["WAResultOrError","WASmaxInMessageDeliverBeneficiaryMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"beneficiary");if(!b.success)return b;b=d("WASmaxInMessageDeliverBeneficiaryMixin").parseBeneficiaryMixin(a);return!b.success?b:b}function a(a){a=d("WASmaxParseUtils").mapChildrenWithTag(a,"beneficiary",1,5,h);return!a.success?a:d("WAResultOrError").makeResult({beneficiary:a.value})}g.parseBeneficiariesBeneficiary=h;g.parseBeneficiariesMixin=a}),98);
__d("WASmaxInMessageDeliverOrderInPaymentMixin",["WAResultOrError","WASmaxInMessageDeliverBeneficiariesMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"beneficiaries");if(!b.success)return b;b=d("WASmaxInMessageDeliverBeneficiariesMixin").parseBeneficiariesMixin(a);return!b.success?b:b}function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"order");if(!a.success)return a;var b=d("WASmaxParseUtils").optionalChildWithTag(a.value,"beneficiaries",h);if(!b.success)return b;var c=d("WASmaxParseUtils").attrString(a.value,"id");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStanzaId,a.value,"message_id");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a.value,"payment_config_id");if(!f.success)return f;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a.value,"type");return!a.success?a:d("WAResultOrError").makeResult({orderId:c.value,orderMessageId:e.value,orderPaymentConfigId:f.value,orderType:a.value,orderBeneficiaries:b.value})}g.parseOrderInPaymentOrderBeneficiaries=h;g.parseOrderInPaymentMixin=a}),98);
__d("WASmaxInMessageDeliverTransactionErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"error-code",1,1e7);if(!b.success)return b;a=d("WASmaxParseUtils").attrString(a,"error-text");return!a.success?a:d("WAResultOrError").makeResult({errorCode:b.value,errorText:a.value})}g.parseTransactionErrorMixin=a}),98);
__d("WASmaxInMessageDeliverTransactionTypeMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrStringEnum(a,"transaction-type",d("WASmaxInMessageDeliverEnums").ENUM_INCENTIVE_P2M_P2P_PAYOUT);return!a.success?a:d("WAResultOrError").makeResult({transactionType:a.value})}g.parseTransactionTypeMixin=a}),98);
__d("WASmaxInMessageDeliverFullTransactionBaseMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxInMessageDeliverIncentiveOfferClaimMixin","WASmaxInMessageDeliverInstallmentMixin","WASmaxInMessageDeliverMoneyMixin","WASmaxInMessageDeliverOrderInPaymentMixin","WASmaxInMessageDeliverTransactionErrorMixin","WASmaxInMessageDeliverTransactionSyncStatusMixin","WASmaxInMessageDeliverTransactionTypeMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"offer_claim");if(!b.success)return b;b=d("WASmaxInMessageDeliverIncentiveOfferClaimMixin").parseIncentiveOfferClaimMixin(a);return!b.success?b:b}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"amount");if(!b.success)return b;b=d("WASmaxInMessageDeliverMoneyMixin").parseMoneyMixin(a);return!b.success?b:b}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"offer_claim",h);if(!b.success)return b;var c=d("WASmaxParseUtils").optionalChildWithTag(a,"amount",i);if(!c.success)return c;var e=d("WASmaxParseUtils").attrString(a,"id");if(!e.success)return e;var f=d("WASmaxParseJid").attrUserJid(a,"sender");if(!f.success)return f;var g=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"sender-alias");if(!g.success)return g;var j=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"sender-name");if(!j.success)return j;var k=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"receiver-name");if(!k.success)return k;var l=d("WASmaxParseJid").attrUserJid(a,"receiver");if(!l.success)return l;var m=d("WASmaxParseUtils").attrString(a,"currency");if(!m.success)return m;var n=d("WASmaxParseUtils").attrString(a,"amount");if(!n.success)return n;var o=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"credential-id");if(!o.success)return o;var p=d("WASmaxParseUtils").attrIntRange(a,"ts",0,void 0);if(!p.success)return p;var q=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"created-ts",0,void 0);if(!q.success)return q;var r=d("WASmaxParseUtils").attrString(a,"status");if(!r.success)return r;var s=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStanzaId,a,"message-id");if(!s.success)return s;var t=d("WASmaxParseUtils").attrIntRange(a,"counter",0,void 0);if(!t.success)return t;var u=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"expiry-ts",0,void 0);if(!u.success)return u;var v=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrGroupJid,a,"group");if(!v.success)return v;var w=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a,"service",d("WASmaxInMessageDeliverEnums").ENUM_FBPAY_NOVI_P2MLITE_UPI);if(!w.success)return w;var x=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"merchant-name");if(!x.success)return x;var y=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"note");if(!y.success)return y;var z=d("WASmaxInMessageDeliverTransactionErrorMixin").parseTransactionErrorMixin(a),A=d("WASmaxInMessageDeliverTransactionTypeMixin").parseTransactionTypeMixin(a);if(!A.success)return A;var B=d("WASmaxInMessageDeliverTransactionSyncStatusMixin").parseTransactionSyncStatusMixin(a);if(!B.success)return B;var C=d("WASmaxInMessageDeliverOrderInPaymentMixin").parseOrderInPaymentMixin(a);a=d("WASmaxInMessageDeliverInstallmentMixin").parseInstallmentMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({id:e.value,sender:f.value,senderAlias:g.value,senderName:j.value,receiverName:k.value,receiver:l.value,currency:m.value,amount:n.value,credentialId:o.value,ts:p.value,createdTs:q.value,status:r.value,messageId:s.value,counter:t.value,expiryTs:u.value,group:v.value,service:w.value,merchantName:x.value,note:y.value,transactionErrorMixin:z.success?z.value:null},A.value,B.value,{orderInPaymentMixin:C.success?C.value:null,installmentMixin:a.success?a.value:null,offerClaim:b.value,childAmount:c.value}))}g.parseFullTransactionBaseOfferClaim=h;g.parseFullTransactionBaseAmount=i;g.parseFullTransactionBaseMixin=a}),98);
__d("WASmaxInMessageDeliverP2MTransactionProtocolMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"psp_transaction_id");return!b.success?b:d("WAResultOrError").makeResult({pspTransactionId:b.value})}g.parseP2MTransactionProtocolMixin=a}),98);
__d("WASmaxInMessageDeliverPaymentInitiatorMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrStringEnum(a,"payment_initiator",d("WASmaxInMessageDeliverEnums").ENUM_BUYER_SELLER);return!a.success?a:d("WAResultOrError").makeResult({paymentInitiator:a.value})}g.parsePaymentInitiatorMixin=a}),98);
__d("WASmaxInMessageDeliverTransactionNUXReceiverMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxParseUtils").attrStringEnum(a,"is-nux-receiver",d("WASmaxInMessageDeliverEnums").ENUM_0_1);return!b.success?b:d("WAResultOrError").makeResult({isNuxReceiver:b.value})}g.parseTransactionNUXReceiverMixin=a}),98);
__d("WASmaxInMessageDeliverBRTransactionMixin",["WAResultOrError","WASmaxInMessageDeliverFullTransactionBaseMixin","WASmaxInMessageDeliverP2MTransactionProtocolMixin","WASmaxInMessageDeliverPaymentInitiatorMixin","WASmaxInMessageDeliverTransactionNUXReceiverMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxInMessageDeliverFullTransactionBaseMixin").parseFullTransactionBaseMixin(a);if(!b.success)return b;var c=d("WASmaxInMessageDeliverP2MTransactionProtocolMixin").parseP2MTransactionProtocolMixin(a),e=d("WASmaxInMessageDeliverTransactionNUXReceiverMixin").parseTransactionNUXReceiverMixin(a);if(!e.success)return e;a=d("WASmaxInMessageDeliverPaymentInitiatorMixin").parsePaymentInitiatorMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{p2MTransactionProtocolMixin:c.success?c.value:null},e.value,{paymentInitiatorMixin:a.success?a.value:null}))}g.parseBRTransactionMixin=a}),98);
__d("WASmaxInMessageDeliverCAPITransactionMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"id");if(!b.success)return b;var c=d("WASmaxParseJid").attrUserJid(a,"sender");if(!c.success)return c;a=d("WASmaxParseJid").attrUserJid(a,"receiver");return!a.success?a:d("WAResultOrError").makeResult({id:b.value,sender:c.value,receiver:a.value})}g.parseCAPITransactionMixin=a}),98);
__d("WASmaxInMessageDeliverIDTransactionGoPayMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"onboarding-provider","GO");if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"onboarding-provider-id","GO");if(!c.success)return c;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"onboarding-provider-name","GoPay");return!a.success?a:d("WAResultOrError").makeResult({onboardingProvider:b.value,onboardingProviderId:c.value,onboardingProviderName:a.value})}g.parseIDTransactionGoPayMixin=a}),98);
__d("WASmaxInMessageDeliverIDTransactionOttoCashMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"onboarding-provider","OTTO");if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"onboarding-provider-id","OTTO");if(!c.success)return c;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"onboarding-provider-name","OttoCash");return!a.success?a:d("WAResultOrError").makeResult({onboardingProvider:b.value,onboardingProviderId:c.value,onboardingProviderName:a.value})}g.parseIDTransactionOttoCashMixin=a}),98);
__d("WASmaxInMessageDeliverIDTransactionOvoMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"onboarding-provider","OVO");if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"onboarding-provider-id","OVO");if(!c.success)return c;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"onboarding-provider-name","OVO");return!a.success?a:d("WAResultOrError").makeResult({onboardingProvider:b.value,onboardingProviderId:c.value,onboardingProviderName:a.value})}g.parseIDTransactionOvoMixin=a}),98);
__d("WASmaxInMessageDeliverIDTransactionGoPayOrOttoCashOrOvoMixinGroup",["WAResultOrError","WASmaxInMessageDeliverIDTransactionGoPayMixin","WASmaxInMessageDeliverIDTransactionOttoCashMixin","WASmaxInMessageDeliverIDTransactionOvoMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverIDTransactionGoPayMixin").parseIDTransactionGoPayMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IDTransactionGoPay",value:b.value});var c=d("WASmaxInMessageDeliverIDTransactionOttoCashMixin").parseIDTransactionOttoCashMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IDTransactionOttoCash",value:c.value});var e=d("WASmaxInMessageDeliverIDTransactionOvoMixin").parseIDTransactionOvoMixin(a);return e.success?d("WAResultOrError").makeResult({name:"IDTransactionOvo",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IDTransactionGoPay","IDTransactionOttoCash","IDTransactionOvo"],[b,c,e])}g.parseIDTransactionGoPayOrOttoCashOrOvoMixinGroup=a}),98);
__d("WASmaxInMessageDeliverIDTransactionProtocolMixin",["WAResultOrError","WASmaxInMessageDeliverIDTransactionGoPayOrOttoCashOrOvoMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxInMessageDeliverIDTransactionGoPayOrOttoCashOrOvoMixinGroup").parseIDTransactionGoPayOrOttoCashOrOvoMixinGroup(a);return!b.success?b:d("WAResultOrError").makeResult({iDTransactionGoPayOrOttoCashOrOvoMixinGroup:b.value})}g.parseIDTransactionProtocolMixin=a}),98);
__d("WASmaxInMessageDeliverIDTransactionMixin",["WAResultOrError","WASmaxInMessageDeliverFullTransactionBaseMixin","WASmaxInMessageDeliverIDTransactionProtocolMixin","WASmaxInMessageDeliverTransactionNUXReceiverMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxInMessageDeliverFullTransactionBaseMixin").parseFullTransactionBaseMixin(a);if(!b.success)return b;var c=d("WASmaxInMessageDeliverIDTransactionProtocolMixin").parseIDTransactionProtocolMixin(a);if(!c.success)return c;a=d("WASmaxInMessageDeliverTransactionNUXReceiverMixin").parseTransactionNUXReceiverMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,c.value,a.value))}g.parseIDTransactionMixin=a}),98);
__d("WASmaxInMessageDeliverMXTransactionProtocolMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"bank-transaction-id");if(!b.success)return b;var c=d("WASmaxParseUtils").attrString(a,"spei-transaction-id");if(!c.success)return c;a=d("WASmaxParseUtils").attrIntRange(a,"spei-ref-num",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({bankTransactionId:b.value,speiTransactionId:c.value,speiRefNum:a.value})}g.parseMXTransactionProtocolMixin=a}),98);
__d("WASmaxInMessageDeliverMXTransactionMixin",["WAResultOrError","WASmaxInMessageDeliverFullTransactionBaseMixin","WASmaxInMessageDeliverMXTransactionProtocolMixin","WASmaxInMessageDeliverTransactionNUXReceiverMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxInMessageDeliverFullTransactionBaseMixin").parseFullTransactionBaseMixin(a);if(!b.success)return b;var c=d("WASmaxInMessageDeliverMXTransactionProtocolMixin").parseMXTransactionProtocolMixin(a);if(!c.success)return c;a=d("WASmaxInMessageDeliverTransactionNUXReceiverMixin").parseTransactionNUXReceiverMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,c.value,a.value))}g.parseMXTransactionMixin=a}),98);
__d("WASmaxInMessageDeliverP2MLiteTransactionProtocolMixin",["WAResultOrError","WASmaxInMessageDeliverP2MTransactionProtocolMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"psp_receipt_url");if(!b.success)return b;a=d("WASmaxInMessageDeliverP2MTransactionProtocolMixin").parseP2MTransactionProtocolMixin(a);return d("WAResultOrError").makeResult({pspReceiptUrl:b.value,p2MTransactionProtocolMixin:a.success?a.value:null})}g.parseP2MLiteTransactionProtocolMixin=a}),98);
__d("WASmaxInMessageDeliverP2MLiteTransactionMixin",["WAResultOrError","WASmaxInMessageDeliverFullTransactionBaseMixin","WASmaxInMessageDeliverP2MLiteTransactionProtocolMixin","WASmaxInMessageDeliverTransactionNUXReceiverMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxInMessageDeliverFullTransactionBaseMixin").parseFullTransactionBaseMixin(a);if(!b.success)return b;var c=d("WASmaxInMessageDeliverP2MLiteTransactionProtocolMixin").parseP2MLiteTransactionProtocolMixin(a);if(!c.success)return c;a=d("WASmaxInMessageDeliverTransactionNUXReceiverMixin").parseTransactionNUXReceiverMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,c.value,a.value))}g.parseP2MLiteTransactionMixin=a}),98);
__d("WASmaxInMessageDeliverUPIComplaintMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"complaint");if(!b.success)return b;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"complaint-status");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"created-ts",0,void 0);if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"updated-ts",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({complaintStatus:b.value,createdTs:c.value,updatedTs:a.value})}g.parseUPIComplaintMixin=a}),98);
__d("WASmaxInMessageDeliverUPIInternationalFxDetailMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"fx-detail");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"base-amount");if(!b.success)return b;var c=d("WASmaxParseUtils").attrString(a,"currency-fx");if(!c.success)return c;var e=d("WASmaxParseUtils").attrString(a,"currency-markup");if(!e.success)return e;a=d("WASmaxParseUtils").attrString(a,"base-currency");return!a.success?a:d("WAResultOrError").makeResult({baseAmount:b.value,currencyFx:c.value,currencyMarkup:e.value,baseCurrency:a.value})}g.parseUPIInternationalFxDetailMixin=a}),98);
__d("WASmaxInMessageDeliverUPIInternationalTransactionDetailMixin",["WAResultOrError","WASmaxInMessageDeliverUPIInternationalFxDetailMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"international-transaction-detail");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"fx-detail");if(!b.success)return b;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"invoice-number");if(!a.success)return a;b=d("WASmaxInMessageDeliverUPIInternationalFxDetailMixin").parseUPIInternationalFxDetailMixin(b.value);return!b.success?b:d("WAResultOrError").makeResult({invoiceNumber:a.value,fxDetailUPIInternationalFxDetailMixin:b.value})}g.parseUPIInternationalTransactionDetailMixin=a}),98);
__d("WASmaxInMessageDeliverP2MHybridExternalPaymentMethodMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").attrStringEnum(a,"type",d("WASmaxInMessageDeliverEnums").ENUM_CARD_NETBANKING_UPI_WALLET);if(!b.success)return b;a=d("WASmaxParseUtils").attrString(a,"name");return!a.success?a:d("WAResultOrError").makeResult({type:b.value,name:a.value})}g.parseP2MHybridExternalPaymentMethodMixin=a}),98);
__d("WASmaxInMessageDeliverUPITransactionProtocolWithP2MHybridMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxInMessageDeliverMoneyMixin","WASmaxInMessageDeliverP2MHybridExternalPaymentMethodMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"offer");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"id");return!b.success?b:d("WAResultOrError").makeResult({id:b.value})}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"external_payment_method");if(!b.success)return b;b=d("WASmaxInMessageDeliverP2MHybridExternalPaymentMethodMixin").parseP2MHybridExternalPaymentMethodMixin(a);return!b.success?b:b}function j(a){var b=d("WASmaxParseUtils").assertTag(a,"offer_amount");if(!b.success)return b;b=d("WASmaxInMessageDeliverMoneyMixin").parseMoneyMixin(a);return!b.success?b:b}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"external_payment_method",i);if(!b.success)return b;var c=d("WASmaxParseUtils").optionalChildWithTag(a,"offer_amount",j);if(!c.success)return c;var e=d("WASmaxParseUtils").attrStringEnum(a,"is_p2m_hybrid",d("WASmaxInMessageDeliverEnums").ENUM_0_1);if(!e.success)return e;var f=d("WASmaxParseUtils").attrStringEnum(a,"payment_instrument_type",d("WASmaxInMessageDeliverEnums").ENUM_HPPPAYMENTLINK_UPI);if(!f.success)return f;a=d("WASmaxParseUtils").mapChildrenWithTag(a,"offer",0,Infinity,h);return!a.success?a:d("WAResultOrError").makeResult({isP2mHybrid:e.value,paymentInstrumentType:f.value,externalPaymentMethod:b.value,offerAmount:c.value,offer:a.value})}g.parseUPITransactionProtocolWithP2MHybridOffer=h;g.parseUPITransactionProtocolWithP2MHybridExternalPaymentMethod=i;g.parseUPITransactionProtocolWithP2MHybridOfferAmount=j;g.parseUPITransactionProtocolWithP2MHybridMixin=a}),98);
__d("WASmaxInMessageDeliverFrequencyRuleMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrStringEnum(a,"frequency-rule",d("WASmaxInMessageDeliverEnums").ENUM_ASPRESENTED_BIMONTHLY_DAILY_FORTNIGHTLY_HALFYEARLY_MONTHLY_ONETIME_QUARTERLY_UNKNOWN_WEEKLY_YEARLY);return!a.success?a:d("WAResultOrError").makeResult({frequencyRule:a.value})}g.parseFrequencyRuleMixin=a}),98);
__d("WASmaxInMessageDeliverUPIMandateBaseMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxInMessageDeliverFrequencyRuleMixin","WASmaxInMessageDeliverMoneyMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"mandate");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"original-amount");if(!b.success)return b;var c=d("WASmaxParseUtils").attrString(a,"mandate-no");if(!c.success)return c;var e=d("WASmaxParseUtils").attrStringEnum(a,"amount-rule",d("WASmaxInMessageDeliverEnums").ENUM_EXACT_MAX);if(!e.success)return e;var f=d("WASmaxParseUtils").attrIntRange(a,"start-ts",0,void 0);if(!f.success)return f;var g=d("WASmaxParseUtils").attrIntRange(a,"end-ts",0,void 0);if(!g.success)return g;var h=d("WASmaxParseUtils").attrStringEnum(a,"is-revocable",d("WASmaxInMessageDeliverEnums").ENUM_0_1);if(!h.success)return h;var i=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"purpose-code");if(!i.success)return i;var j=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"mandate-name");if(!j.success)return j;var k=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"error-code",1,1e7);if(!k.success)return k;b=d("WASmaxInMessageDeliverMoneyMixin").parseMoneyMixin(b.value);if(!b.success)return b;a=d("WASmaxInMessageDeliverFrequencyRuleMixin").parseFrequencyRuleMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({mandateNo:c.value,amountRule:e.value,startTs:f.value,endTs:g.value,isRevocable:h.value,purposeCode:i.value,mandateName:j.value,errorCode:k.value,originalAmountMoneyMixin:b.value},a.value))}g.parseUPIMandateBaseMixin=a}),98);
__d("WASmaxInMessageDeliverUPIMandateUpdateBaseMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxInMessageDeliverMoneyMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"mandate-update");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"amount");if(!b.success)return b;var c=d("WASmaxParseUtils").attrIntRange(a,"end-ts",0,void 0);if(!c.success)return c;var e=d("WASmaxParseUtils").attrString(a,"seq-no");if(!e.success)return e;var f=d("WASmaxParseUtils").attrString(a,"mandate-update-info");if(!f.success)return f;var g=d("WASmaxParseUtils").attrStringEnum(a,"status",d("WASmaxInMessageDeliverEnums").ENUM_FAILURE_INIT_SUCCESS);if(!g.success)return g;var h=d("WASmaxParseUtils").attrStringEnum(a,"action",d("WASmaxInMessageDeliverEnums").ENUM_ACCEPT_REJECT_UNKNOWN);if(!h.success)return h;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"error-code",1,1e7);if(!a.success)return a;b=d("WASmaxInMessageDeliverMoneyMixin").parseMoneyMixin(b.value);return!b.success?b:d("WAResultOrError").makeResult({endTs:c.value,seqNo:e.value,mandateUpdateInfo:f.value,status:g.value,action:h.value,errorCode:a.value,amountMoneyMixin:b.value})}g.parseUPIMandateUpdateBaseMixin=a}),98);
__d("WASmaxInMessageDeliverUPIMandateWithUpdateMixin",["WASmaxInMessageDeliverUPIMandateUpdateBaseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"mandate");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"mandate-update");if(!b.success)return b;a=d("WASmaxInMessageDeliverUPIMandateUpdateBaseMixin").parseUPIMandateUpdateBaseMixin(b.value);return!a.success?a:a}g.parseUPIMandateWithUpdateMixin=a}),98);
__d("WASmaxInMessageDeliverUPITransactionWithMandateMixin",["WAResultOrError","WASmaxInMessageDeliverUPIMandateBaseMixin","WASmaxInMessageDeliverUPIMandateWithUpdateMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"mandate");if(!b.success)return b;a=d("WASmaxInMessageDeliverUPIMandateBaseMixin").parseUPIMandateBaseMixin(b.value);if(!a.success)return a;b=d("WASmaxInMessageDeliverUPIMandateWithUpdateMixin").parseUPIMandateWithUpdateMixin(b.value);return d("WAResultOrError").makeResult({mandateUPIMandateBaseMixin:a.value,mandateUPIMandateWithUpdateMixin:b.success?b.value:null})}g.parseUPITransactionWithMandateMixin=a}),98);
__d("WASmaxInMessageDeliverUPITransactionProtocolMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxInMessageDeliverUPIComplaintMixin","WASmaxInMessageDeliverUPIInternationalTransactionDetailMixin","WASmaxInMessageDeliverUPITransactionProtocolWithP2MHybridMixin","WASmaxInMessageDeliverUPITransactionWithMandateMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"complaint");if(!b.success)return b;b=d("WASmaxInMessageDeliverUPIComplaintMixin").parseUPIComplaintMixin(a);return!b.success?b:b}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"international-transaction-detail");if(!b.success)return b;b=d("WASmaxInMessageDeliverUPIInternationalTransactionDetailMixin").parseUPIInternationalTransactionDetailMixin(a);return!b.success?b:b}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"complaint",h);if(!b.success)return b;var c=d("WASmaxParseUtils").optionalChildWithTag(a,"international-transaction-detail",i);if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"sender-alias");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"receiver-alias");if(!f.success)return f;var g=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"receiver-name");if(!g.success)return g;var j=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"bank-transaction-id");if(!j.success)return j;var k=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"seq-no");if(!k.success)return k;var l=d("WASmaxParseUtils").attrStringEnum(a,"is_vpa",d("WASmaxInMessageDeliverEnums").ENUM_0_1);if(!l.success)return l;var m=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"ref-url");if(!m.success)return m;var n=d("WASmaxParseUtils").attrStringEnum(a,"is-mandate",d("WASmaxInMessageDeliverEnums").ENUM_0_1);if(!n.success)return n;var o=d("WASmaxParseUtils").attrStringEnum(a,"is-collect",d("WASmaxInMessageDeliverEnums").ENUM_0_1);if(!o.success)return o;var p=d("WASmaxParseUtils").attrStringEnum(a,"nodal",d("WASmaxInMessageDeliverEnums").ENUM_0_1);if(!p.success)return p;var q=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a,"is-complaint-eligible",d("WASmaxInMessageDeliverEnums").ENUM_0_1);if(!q.success)return q;var r=d("WASmaxInMessageDeliverUPITransactionWithMandateMixin").parseUPITransactionWithMandateMixin(a);a=d("WASmaxInMessageDeliverUPITransactionProtocolWithP2MHybridMixin").parseUPITransactionProtocolWithP2MHybridMixin(a);return d("WAResultOrError").makeResult({senderAlias:e.value,receiverAlias:f.value,receiverName:g.value,bankTransactionId:j.value,seqNo:k.value,isVpa:l.value,refUrl:m.value,isMandate:n.value,isCollect:o.value,nodal:p.value,isComplaintEligible:q.value,uPITransactionWithMandateMixin:r.success?r.value:null,uPITransactionProtocolWithP2MHybridMixin:a.success?a.value:null,complaint:b.value,internationalTransactionDetail:c.value})}g.parseUPITransactionProtocolComplaint=h;g.parseUPITransactionProtocolInternationalTransactionDetail=i;g.parseUPITransactionProtocolMixin=a}),98);
__d("WASmaxInMessageDeliverUPITransactionMixin",["WAResultOrError","WASmaxInMessageDeliverFullTransactionBaseMixin","WASmaxInMessageDeliverUPITransactionProtocolMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxInMessageDeliverFullTransactionBaseMixin").parseFullTransactionBaseMixin(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverUPITransactionProtocolMixin").parseUPITransactionProtocolMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,a.value))}g.parseUPITransactionMixin=a}),98);
__d("WASmaxInMessageDeliverPayTransactions",["WAResultOrError","WASmaxInMessageDeliverBRTransactionMixin","WASmaxInMessageDeliverCAPITransactionMixin","WASmaxInMessageDeliverIDTransactionMixin","WASmaxInMessageDeliverMXTransactionMixin","WASmaxInMessageDeliverP2MLiteTransactionMixin","WASmaxInMessageDeliverUPITransactionMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverUPITransactionMixin").parseUPITransactionMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"UPITransaction",value:b.value});var c=d("WASmaxInMessageDeliverMXTransactionMixin").parseMXTransactionMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"MXTransaction",value:c.value});var e=d("WASmaxInMessageDeliverIDTransactionMixin").parseIDTransactionMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"IDTransaction",value:e.value});var f=d("WASmaxInMessageDeliverP2MLiteTransactionMixin").parseP2MLiteTransactionMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"P2MLiteTransaction",value:f.value});var g=d("WASmaxInMessageDeliverBRTransactionMixin").parseBRTransactionMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"BRTransaction",value:g.value});var h=d("WASmaxInMessageDeliverCAPITransactionMixin").parseCAPITransactionMixin(a);return h.success?d("WAResultOrError").makeResult({name:"CAPITransaction",value:h.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["UPITransaction","MXTransaction","IDTransaction","P2MLiteTransaction","BRTransaction","CAPITransaction"],[b,c,e,f,g,h])}g.parsePayTransactions=a}),98);
__d("WASmaxInMessageDeliverPayTransactionAnyMixin",["WAResultOrError","WASmaxInMessageDeliverPayTransactions","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxInMessageDeliverPayTransactions").parsePayTransactions(a);return!b.success?b:d("WAResultOrError").makeResult({payTransactions:b.value})}g.parsePayTransactionAnyMixin=a}),98);
__d("WASmaxInMessageDeliverPayTransactionMessageMixin",["WASmaxInMessageDeliverPayTransactionAnyMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"transaction");if(!b.success)return b;a=d("WASmaxInMessageDeliverPayTransactionAnyMixin").parsePayTransactionAnyMixin(b.value);return!a.success?a:a}g.parsePayTransactionMessageMixin=a}),98);
__d("WASmaxInMessageDeliverGroupDeliverPayNodeOrPayTransactionMessageMixinGroup",["WAResultOrError","WASmaxInMessageDeliverGroupDeliverPayNodeMessageMixin","WASmaxInMessageDeliverPayTransactionMessageMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverGroupDeliverPayNodeMessageMixin").parseGroupDeliverPayNodeMessageMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"GroupDeliverPayNodeMessage",value:b.value});var c=d("WASmaxInMessageDeliverPayTransactionMessageMixin").parsePayTransactionMessageMixin(a);return c.success?d("WAResultOrError").makeResult({name:"PayTransactionMessage",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["GroupDeliverPayNodeMessage","PayTransactionMessage"],[b,c])}g.parseGroupDeliverPayNodeOrPayTransactionMessageMixinGroup=a}),98);
__d("WASmaxInMessageDeliverContentTypePayGroupMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypePayMixin","WASmaxInMessageDeliverGroupDeliverPayNodeOrPayTransactionMessageMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverContentTypePayMixin").parseContentTypePayMixin(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverGroupDeliverPayNodeOrPayTransactionMessageMixinGroup").parseGroupDeliverPayNodeOrPayTransactionMessageMixinGroup(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{groupDeliverPayNodeOrPayTransactionMessageMixinGroup:a.success?a.value:null}))}g.parseContentTypePayGroupMixin=a}),98);
__d("WASmaxInMessageDeliverContentTypeScheduledCallMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","scheduled-call");if(!a.success)return a;b=d("WASmaxParseUtils").attrStringEnum(b.value,"scheduled_call_type",d("WASmaxInMessageDeliverEnums").ENUM_CREATION_EDIT);return!b.success?b:d("WAResultOrError").makeResult({type:a.value,metaScheduledCallType:b.value})}g.parseContentTypeScheduledCallMixin=a}),98);
__d("WASmaxInMessageDeliverContentDualMixins",["WAResultOrError","WASmaxInMessageDeliverContentTypeEventMixin","WASmaxInMessageDeliverContentTypePayGroupMixin","WASmaxInMessageDeliverContentTypePollCreationMixin","WASmaxInMessageDeliverContentTypePollVoteMixin","WASmaxInMessageDeliverContentTypeReactionMixin","WASmaxInMessageDeliverContentTypeScheduledCallMixin","WASmaxInMessageDeliverContentTypeTextMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverContentTypeTextMixin").parseContentTypeTextMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"ContentTypeText",value:b.value});var c=d("WASmaxInMessageDeliverContentTypePayGroupMixin").parseContentTypePayGroupMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"ContentTypePayGroup",value:c.value});var e=d("WASmaxInMessageDeliverContentTypeReactionMixin").parseContentTypeReactionMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"ContentTypeReaction",value:e.value});var f=d("WASmaxInMessageDeliverContentTypePollCreationMixin").parseContentTypePollCreationMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"ContentTypePollCreation",value:f.value});var g=d("WASmaxInMessageDeliverContentTypePollVoteMixin").parseContentTypePollVoteMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"ContentTypePollVote",value:g.value});var h=d("WASmaxInMessageDeliverContentTypeScheduledCallMixin").parseContentTypeScheduledCallMixin(a);if(h.success)return d("WAResultOrError").makeResult({name:"ContentTypeScheduledCall",value:h.value});var i=d("WASmaxInMessageDeliverContentTypeEventMixin").parseContentTypeEventMixin(a);return i.success?d("WAResultOrError").makeResult({name:"ContentTypeEvent",value:i.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["ContentTypeText","ContentTypePayGroup","ContentTypeReaction","ContentTypePollCreation","ContentTypePollVote","ContentTypeScheduledCall","ContentTypeEvent"],[b,c,e,f,g,h,i])}g.parseContentDualMixins=a}),98);
__d("WASmaxInMessageDeliverGroupDualEncNonMediaMixin",["WAResultOrError","WASmaxInMessageDeliverContentDualMixins","WASmaxInMessageDeliverEncTypeSenderKeyOrIndividualMixinGroup","WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup").parseEncVersion2Or3OrFutureproofMixinGroup(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverEncTypeSenderKeyOrIndividualMixinGroup").parseEncTypeSenderKeyOrIndividualMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({encVersion2Or3OrFutureproofMixinGroup:b.value,encTypeSenderKeyOrIndividualMixinGroup:a.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverContentDualMixins").parseContentDualMixins(a);if(!b.success)return b;a=d("WASmaxParseUtils").mapChildrenWithTag(a,"enc",2,2,h);return!a.success?a:d("WAResultOrError").makeResult({contentDualMixins:b.value,enc:a.value})}g.parseGroupDualEncNonMediaEnc=h;g.parseGroupDualEncNonMediaMixin=a}),98);
__d("WASmaxInMessageDeliverGroupDualEncGroupDualEncMediaOrGroupDualEncNonMediaMediaMixinGroup",["WAResultOrError","WASmaxInMessageDeliverGroupDualEncMediaMixin","WASmaxInMessageDeliverGroupDualEncNonMediaMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverGroupDualEncMediaMixin").parseGroupDualEncMediaMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"GroupDualEncMedia",value:b.value});var c=d("WASmaxInMessageDeliverGroupDualEncNonMediaMixin").parseGroupDualEncNonMediaMixin(a);return c.success?d("WAResultOrError").makeResult({name:"GroupDualEncNonMedia",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["GroupDualEncMedia","GroupDualEncNonMedia"],[b,c])}g.parseGroupDualEncGroupDualEncMediaOrGroupDualEncNonMediaMediaMixinGroup=a}),98);
__d("WASmaxInMessageDeliverGroupDualEncMixin",["WAResultOrError","WASmaxInMessageDeliverGroupDualEncGroupDualEncMediaOrGroupDualEncNonMediaMediaMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverGroupDualEncGroupDualEncMediaOrGroupDualEncNonMediaMediaMixinGroup").parseGroupDualEncGroupDualEncMediaOrGroupDualEncNonMediaMediaMixinGroup(a);return!b.success?b:d("WAResultOrError").makeResult({groupDualEncGroupDualEncMediaOrGroupDualEncNonMediaMediaMixinGroup:b.value})}g.parseGroupDualEncMixin=a}),98);
__d("WASmaxInMessageDeliverEncLiveLocationDeprecatedMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"mediatype","livelocation");if(!b.success)return b;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"duration",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({mediatype:b.value,duration:a.value})}g.parseEncLiveLocationDeprecatedMixin=a}),98);
__d("WASmaxInMessageDeliverEncLiveLocationEncLiveLocationOrEncLiveLocationDeprecatedMixinGroup",["WAResultOrError","WASmaxInMessageDeliverEncLiveLocationDeprecatedMixin","WASmaxInMessageDeliverEncLiveLocationMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverEncLiveLocationMixin").parseEncLiveLocationMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"EncLiveLocation",value:b.value});var c=d("WASmaxInMessageDeliverEncLiveLocationDeprecatedMixin").parseEncLiveLocationDeprecatedMixin(a);return c.success?d("WAResultOrError").makeResult({name:"EncLiveLocationDeprecated",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["EncLiveLocation","EncLiveLocationDeprecated"],[b,c])}g.parseEncLiveLocationEncLiveLocationOrEncLiveLocationDeprecatedMixinGroup=a}),98);
__d("WASmaxInMessageDeliverLiveLocationModeMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").attrStringEnum(b.value,"liveloc_mode",d("WASmaxInMessageDeliverEnums").ENUM_LID_PN);return!a.success?a:d("WAResultOrError").makeResult({metaLivelocMode:a.value})}g.parseLiveLocationModeMixin=a}),98);
__d("WASmaxInMessageDeliverContentTypeLiveLocationSingleMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeMediaMixin","WASmaxInMessageDeliverEncLiveLocationEncLiveLocationOrEncLiveLocationDeprecatedMixinGroup","WASmaxInMessageDeliverLiveLocationModeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"enc");if(!b.success)return b;var c=d("WASmaxInMessageDeliverContentTypeMediaMixin").parseContentTypeMediaMixin(a);if(!c.success)return c;a=d("WASmaxInMessageDeliverLiveLocationModeMixin").parseLiveLocationModeMixin(a);b=d("WASmaxInMessageDeliverEncLiveLocationEncLiveLocationOrEncLiveLocationDeprecatedMixinGroup").parseEncLiveLocationEncLiveLocationOrEncLiveLocationDeprecatedMixinGroup(b.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},c.value,{liveLocationModeMixin:a.success?a.value:null,encEncLiveLocationEncLiveLocationOrEncLiveLocationDeprecatedMixinGroup:b.value}))}g.parseContentTypeLiveLocationSingleMixin=a}),98);
__d("WASmaxInMessageDeliverContentTypeProductListMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeMediaMixin","WASmaxInMessageDeliverEncListMixin","WASmaxInMessageDeliverProductListMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"enc");if(!b.success)return b;b=d("WASmaxInMessageDeliverEncListMixin").parseEncListMixin(b.value);if(!b.success)return b;var c=d("WASmaxInMessageDeliverContentTypeMediaMixin").parseContentTypeMediaMixin(a);if(!c.success)return c;a=d("WASmaxInMessageDeliverProductListMixin").parseProductListMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({encEncListMixin:b.value},c.value,a.value))}g.parseContentTypeProductListMixin=a}),98);
__d("WASmaxInMessageDeliverContentSingleMixins",["WAResultOrError","WASmaxInMessageDeliverContentTypeEventMixin","WASmaxInMessageDeliverContentTypeLiveLocationSingleMixin","WASmaxInMessageDeliverContentTypeMediaSingleMixin","WASmaxInMessageDeliverContentTypePayGroupMixin","WASmaxInMessageDeliverContentTypePollCreationMixin","WASmaxInMessageDeliverContentTypePollVoteMixin","WASmaxInMessageDeliverContentTypeProductListMixin","WASmaxInMessageDeliverContentTypeReactionMixin","WASmaxInMessageDeliverContentTypeScheduledCallMixin","WASmaxInMessageDeliverContentTypeTextMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverContentTypeTextMixin").parseContentTypeTextMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"ContentTypeText",value:b.value});var c=d("WASmaxInMessageDeliverContentTypeLiveLocationSingleMixin").parseContentTypeLiveLocationSingleMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"ContentTypeLiveLocationSingle",value:c.value});var e=d("WASmaxInMessageDeliverContentTypeMediaSingleMixin").parseContentTypeMediaSingleMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"ContentTypeMediaSingle",value:e.value});var f=d("WASmaxInMessageDeliverContentTypePayGroupMixin").parseContentTypePayGroupMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"ContentTypePayGroup",value:f.value});var g=d("WASmaxInMessageDeliverContentTypeReactionMixin").parseContentTypeReactionMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"ContentTypeReaction",value:g.value});var h=d("WASmaxInMessageDeliverContentTypeProductListMixin").parseContentTypeProductListMixin(a);if(h.success)return d("WAResultOrError").makeResult({name:"ContentTypeProductList",value:h.value});var i=d("WASmaxInMessageDeliverContentTypePollCreationMixin").parseContentTypePollCreationMixin(a);if(i.success)return d("WAResultOrError").makeResult({name:"ContentTypePollCreation",value:i.value});var j=d("WASmaxInMessageDeliverContentTypePollVoteMixin").parseContentTypePollVoteMixin(a);if(j.success)return d("WAResultOrError").makeResult({name:"ContentTypePollVote",value:j.value});var k=d("WASmaxInMessageDeliverContentTypeScheduledCallMixin").parseContentTypeScheduledCallMixin(a);if(k.success)return d("WAResultOrError").makeResult({name:"ContentTypeScheduledCall",value:k.value});var l=d("WASmaxInMessageDeliverContentTypeEventMixin").parseContentTypeEventMixin(a);return l.success?d("WAResultOrError").makeResult({name:"ContentTypeEvent",value:l.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["ContentTypeText","ContentTypeLiveLocationSingle","ContentTypeMediaSingle","ContentTypePayGroup","ContentTypeReaction","ContentTypeProductList","ContentTypePollCreation","ContentTypePollVote","ContentTypeScheduledCall","ContentTypeEvent"],[b,c,e,f,g,h,i,j,k,l])}g.parseContentSingleMixins=a}),98);
__d("WASmaxInMessageDeliverBotResponseMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"bot");if(!b.success)return b;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStanzaId,a,"edit_target_id");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"sender_timestamp_ms",0,void 0);if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a,"edit",d("WASmaxInMessageDeliverEnums").ENUM_FIRST_FULL_INNER_LAST);return!a.success?a:d("WAResultOrError").makeResult({editTargetId:b.value,senderTimestampMs:c.value,edit:a.value})}g.parseBotResponseMixin=a}),98);
__d("WASmaxInMessageDeliverEmptyBizMixin",["WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");return!b.success?b:d("WASmaxParseUtils").voidSuccess}g.parseEmptyBizMixin=a}),98);
__d("WASmaxInMessageDeliverEncTypeMessageSecretMessageMixin",["WAResultOrError","WASmaxInMessageDeliverEncPayloadMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","msmsg");if(!b.success)return b;a=d("WASmaxInMessageDeliverEncPayloadMixin").parseEncPayloadMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({type:b.value},a.value))}g.parseEncTypeMessageSecretMessageMixin=a}),98);
__d("WASmaxInMessageDeliverEncVersion2OrFutureproofMixinGroup",["WAResultOrError","WASmaxInMessageDeliverEncVersion2Mixin","WASmaxInMessageDeliverEncVersionFutureproofMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverEncVersion2Mixin").parseEncVersion2Mixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"EncVersion2",value:b.value});var c=d("WASmaxInMessageDeliverEncVersionFutureproofMixin").parseEncVersionFutureproofMixin(a);return c.success?d("WAResultOrError").makeResult({name:"EncVersionFutureproof",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["EncVersion2","EncVersionFutureproof"],[b,c])}g.parseEncVersion2OrFutureproofMixinGroup=a}),98);
__d("WASmaxInMessageDeliverMessageTargetMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"meta");if(!b.success)return b;b=d("WASmaxParseUtils").attrStanzaId(a,"target_id");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"target_sender_jid");if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrJidEnum,a,"target_chat_jid",d("WASmaxInMessageDeliverEnums").GROUPJID_USERJID);return!a.success?a:d("WAResultOrError").makeResult({targetId:b.value,targetSenderJid:c.value,targetChatJid:a.value})}g.parseMessageTargetMixin=a}),98);
__d("WASmaxInMessageDeliverBotResponseMessageMixin",["WAResultOrError","WASmaxInMessageDeliverBotResponseMixin","WASmaxInMessageDeliverEmptyBizMixin","WASmaxInMessageDeliverEncTypeMessageSecretMessageMixin","WASmaxInMessageDeliverEncVersion2OrFutureproofMixinGroup","WASmaxInMessageDeliverMessageTargetMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"bot");if(!b.success)return b;var c=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!c.success)return c;var e=d("WASmaxParseUtils").flattenedChildWithTag(a,"enc");if(!e.success)return e;b=d("WASmaxInMessageDeliverBotResponseMixin").parseBotResponseMixin(b.value);if(!b.success)return b;c=d("WASmaxInMessageDeliverMessageTargetMixin").parseMessageTargetMixin(c.value);if(!c.success)return c;var f=d("WASmaxInMessageDeliverEncTypeMessageSecretMessageMixin").parseEncTypeMessageSecretMessageMixin(e.value);if(!f.success)return f;a=d("WASmaxInMessageDeliverEmptyBizMixin").parseEmptyBizMixin(a);e=d("WASmaxInMessageDeliverEncVersion2OrFutureproofMixinGroup").parseEncVersion2OrFutureproofMixinGroup(e.value);return!e.success?e:d("WAResultOrError").makeResult({botBotResponseMixin:b.value,metaMessageTargetMixin:c.value,encEncTypeMessageSecretMessageMixin:f.value,hasEmptyBizMixin:a.success,encEncVersion2OrFutureproofMixinGroup:e.value})}g.parseBotResponseMessageMixin=a}),98);
__d("WASmaxInMessageDeliverEncMediaTypeDeprecatedMixin",["WAResultOrError","WASmaxInMessageDeliverAvatarStickerTypeMixin","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a,"mediatype",d("WASmaxInMessageDeliverEnums").ENUM_AUDIO_AVATARSTICKER_BUTTONSRESPONSE_CATALOGLINK_CONTACT_CONTACTARRAY_DOCUMENT_GIF_HISTORY_IMAGE_LISTRESPONSE_LOCATION_NATIVEFLOWRESPONSE_ORDER_PRODUCT_PRODUCTLINK_PTT_PTV_STICKER_URL_VCARD_VIDEO_XMA);if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a,"native_flow_name",d("WASmaxInMessageDeliverEnums").ENUM_ADDRESSMESSAGE_GALAXYMESSAGE);if(!c.success)return c;a=d("WASmaxInMessageDeliverAvatarStickerTypeMixin").parseAvatarStickerTypeMixin(a);return d("WAResultOrError").makeResult({mediatype:b.value,nativeFlowName:c.value,avatarStickerTypeMixin:a.success?a.value:null})}g.parseEncMediaTypeDeprecatedMixin=a}),98);
__d("WASmaxInMessageDeliverGroupRegularMixin",["WAResultOrError","WASmaxInMessageDeliverEncMediaTypeDeprecatedMixin","WASmaxInMessageDeliverEncTypeIndividualOrSenderKeyMixinGroup","WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"enc");if(!b.success)return b;a=d("WASmaxInMessageDeliverEncMediaTypeDeprecatedMixin").parseEncMediaTypeDeprecatedMixin(b.value);var c=d("WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup").parseEncVersion2Or3OrFutureproofMixinGroup(b.value);if(!c.success)return c;b=d("WASmaxInMessageDeliverEncTypeIndividualOrSenderKeyMixinGroup").parseEncTypeIndividualOrSenderKeyMixinGroup(b.value);return!b.success?b:d("WAResultOrError").makeResult({encEncMediaTypeDeprecatedMixin:a.success?a.value:null,encEncVersion2Or3OrFutureproofMixinGroup:c.value,encEncTypeIndividualOrSenderKeyMixinGroup:b.value})}g.parseGroupRegularMixin=a}),98);
__d("WASmaxInMessageDeliverBypassedMixin",["WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"bypassed");return!b.success?b:d("WASmaxParseUtils").voidSuccess}g.parseBypassedMixin=a}),98);
__d("WASmaxInMessageDeliverGroupRetryMixin",["WAResultOrError","WASmaxInMessageDeliverBypassedMixin","WASmaxInMessageDeliverRetryMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverRetryMixin").parseRetryMixin(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverBypassedMixin").parseBypassedMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{hasBypassedMixin:a.success}))}g.parseGroupRetryMixin=a}),98);
__d("WASmaxInMessageDeliverGroupRetryOrBotResponseMessageOrGroupRegularMixinGroup",["WAResultOrError","WASmaxInMessageDeliverBotResponseMessageMixin","WASmaxInMessageDeliverGroupRegularMixin","WASmaxInMessageDeliverGroupRetryMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverGroupRetryMixin").parseGroupRetryMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"GroupRetry",value:b.value});var c=d("WASmaxInMessageDeliverBotResponseMessageMixin").parseBotResponseMessageMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"BotResponseMessage",value:c.value});var e=d("WASmaxInMessageDeliverGroupRegularMixin").parseGroupRegularMixin(a);return e.success?d("WAResultOrError").makeResult({name:"GroupRegular",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["GroupRetry","BotResponseMessage","GroupRegular"],[b,c,e])}g.parseGroupRetryOrBotResponseMessageOrGroupRegularMixinGroup=a}),98);
__d("WASmaxInMessageDeliverGroupSingleEncMixin",["WAResultOrError","WASmaxInMessageDeliverContentSingleMixins","WASmaxInMessageDeliverGroupRetryOrBotResponseMessageOrGroupRegularMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverContentSingleMixins").parseContentSingleMixins(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverGroupRetryOrBotResponseMessageOrGroupRegularMixinGroup").parseGroupRetryOrBotResponseMessageOrGroupRegularMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({contentSingleMixins:b.value,groupRetryOrBotResponseMessageOrGroupRegularMixinGroup:a.value})}g.parseGroupSingleEncMixin=a}),98);
__d("WASmaxInMessageDeliverGroupDualOrSingleEncMixinGroup",["WAResultOrError","WASmaxInMessageDeliverGroupDualEncMixin","WASmaxInMessageDeliverGroupSingleEncMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverGroupDualEncMixin").parseGroupDualEncMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"GroupDualEnc",value:b.value});var c=d("WASmaxInMessageDeliverGroupSingleEncMixin").parseGroupSingleEncMixin(a);return c.success?d("WAResultOrError").makeResult({name:"GroupSingleEnc",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["GroupDualEnc","GroupSingleEnc"],[b,c])}g.parseGroupDualOrSingleEncMixinGroup=a}),98);
__d("WASmaxInMessageDeliverGroupEphemeralMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"expiration",0,2147483647);return!b.success?b:d("WAResultOrError").makeResult({expiration:b.value})}g.parseGroupEphemeralMixin=a}),98);
__d("WASmaxInMessageDeliverMessagePinMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"edit","2");return!b.success?b:d("WAResultOrError").makeResult({edit:b.value})}g.parseMessagePinMixin=a}),98);
__d("WASmaxInMessageDeliverGroupEditMixins",["WAResultOrError","WASmaxInMessageDeliverAdminRevokeMixin","WASmaxInMessageDeliverGroupEphemeralMixin","WASmaxInMessageDeliverMessageEditMixin","WASmaxInMessageDeliverMessagePinMixin","WASmaxInMessageDeliverRevokeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverMessageEditMixin").parseMessageEditMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"MessageEdit",value:b.value});var c=d("WASmaxInMessageDeliverMessagePinMixin").parseMessagePinMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"MessagePin",value:c.value});var e=d("WASmaxInMessageDeliverRevokeMixin").parseRevokeMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"Revoke",value:e.value});var f=d("WASmaxInMessageDeliverAdminRevokeMixin").parseAdminRevokeMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"AdminRevoke",value:f.value});var g=d("WASmaxInMessageDeliverGroupEphemeralMixin").parseGroupEphemeralMixin(a);return g.success?d("WAResultOrError").makeResult({name:"GroupEphemeral",value:g.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["MessageEdit","MessagePin","Revoke","AdminRevoke","GroupEphemeral"],[b,c,e,f,g])}g.parseGroupEditMixins=a}),98);
__d("WASmaxInMessageDeliverParticipantLIDMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"participant_lid");return!b.success?b:d("WAResultOrError").makeResult({participantLid:b.value})}g.parseParticipantLIDMixin=a}),98);
__d("WASmaxInMessageDeliverThreadMsgMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").attrStanzaId(b.value,"thread_msg_id");if(!a.success)return a;b=d("WASmaxParseJid").attrUserJid(b.value,"thread_msg_sender_jid");return!b.success?b:d("WAResultOrError").makeResult({metaThreadMsgId:a.value,metaThreadMsgSenderJid:b.value})}g.parseThreadMsgMixin=a}),98);
__d("WASmaxInMessageDeliverToProxyAccountMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"actual_to");return!b.success?b:d("WAResultOrError").makeResult({actualTo:b.value})}g.parseToProxyAccountMixin=a}),98);
__d("WASmaxInMessageDeliverGroupMixin",["WAResultOrError","WASmaxInMessageDeliverBotThreadIDMixin","WASmaxInMessageDeliverDisplayNameMixin","WASmaxInMessageDeliverEnums","WASmaxInMessageDeliverFanoutCountMixin","WASmaxInMessageDeliverGroupAddressingModeMixin","WASmaxInMessageDeliverGroupDualOrSingleEncMixinGroup","WASmaxInMessageDeliverGroupEditMixins","WASmaxInMessageDeliverParticipantLIDMixin","WASmaxInMessageDeliverThreadMsgMixin","WASmaxInMessageDeliverToProxyAccountMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseJid").attrGroupJid(a,"from");if(!b.success)return b;var c=d("WASmaxParseJid").attrJidEnum(a,"participant",d("WASmaxInMessageDeliverEnums").DEVICEJID_DEVICEJID);if(!c.success)return c;var e=d("WASmaxInMessageDeliverFanoutCountMixin").parseFanoutCountMixin(a),f=d("WASmaxInMessageDeliverParticipantLIDMixin").parseParticipantLIDMixin(a),g=d("WASmaxInMessageDeliverDisplayNameMixin").parseDisplayNameMixin(a),h=d("WASmaxInMessageDeliverGroupAddressingModeMixin").parseGroupAddressingModeMixin(a),i=d("WASmaxInMessageDeliverToProxyAccountMixin").parseToProxyAccountMixin(a),j=d("WASmaxInMessageDeliverBotThreadIDMixin").parseBotThreadIDMixin(a),k=d("WASmaxInMessageDeliverThreadMsgMixin").parseThreadMsgMixin(a),l=d("WASmaxInMessageDeliverGroupDualOrSingleEncMixinGroup").parseGroupDualOrSingleEncMixinGroup(a);if(!l.success)return l;a=d("WASmaxInMessageDeliverGroupEditMixins").parseGroupEditMixins(a);return d("WAResultOrError").makeResult({from:b.value,participant:c.value,fanoutCountMixin:e.success?e.value:null,participantLIDMixin:f.success?f.value:null,displayNameMixin:g.success?g.value:null,groupAddressingModeMixin:h.success?h.value:null,toProxyAccountMixin:i.success?i.value:null,botThreadIDMixin:j.success?j.value:null,threadMsgMixin:k.success?k.value:null,groupDualOrSingleEncMixinGroup:l.value,groupEditMixins:a.success?a.value:null})}g.parseGroupMixin=a}),98);
__d("WASmaxInMessageDeliverBusinessBotMessageMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"bot");if(!b.success)return b;a=d("WASmaxParseUtils").attrStringEnum(b.value,"biz_bot",d("WASmaxInMessageDeliverEnums").ENUM_1_3);return!a.success?a:d("WAResultOrError").makeResult({botBizBot:a.value})}g.parseBusinessBotMessageMixin=a}),98);
__d("WASmaxInMessageDeliverSingleSelectListMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!b.success)return b;a=d("WASmaxParseUtils").flattenedChildWithTag(b.value,"list");if(!a.success)return a;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a.value,"type","single_select");if(!b.success)return b;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a.value,"v",d("WASmaxInMessageDeliverEnums").ENUM_1_2);return!a.success?a:d("WAResultOrError").makeResult({bizListType:b.value,bizListV:a.value})}g.parseSingleSelectListMixin=a}),98);
__d("WASmaxInMessageDeliverSingleSelectOrProductListMixinGroup",["WAResultOrError","WASmaxInMessageDeliverProductListMixin","WASmaxInMessageDeliverSingleSelectListMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverSingleSelectListMixin").parseSingleSelectListMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"SingleSelectList",value:b.value});var c=d("WASmaxInMessageDeliverProductListMixin").parseProductListMixin(a);return c.success?d("WAResultOrError").makeResult({name:"ProductList",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["SingleSelectList","ProductList"],[b,c])}g.parseSingleSelectOrProductListMixinGroup=a}),98);
__d("WASmaxInMessageDeliverContentTypeListMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeMediaMixin","WASmaxInMessageDeliverEncListMixin","WASmaxInMessageDeliverSingleSelectOrProductListMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"enc");if(!b.success)return b;b=d("WASmaxInMessageDeliverEncListMixin").parseEncListMixin(b.value);if(!b.success)return b;var c=d("WASmaxInMessageDeliverContentTypeMediaMixin").parseContentTypeMediaMixin(a);if(!c.success)return c;a=d("WASmaxInMessageDeliverSingleSelectOrProductListMixinGroup").parseSingleSelectOrProductListMixinGroup(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({encEncListMixin:b.value},c.value,{singleSelectOrProductListMixinGroup:a.success?a.value:null}))}g.parseContentTypeListMixin=a}),98);
__d("WASmaxInMessageDeliverIndividualDeliverPayNodeMixin",["WASmaxInMessageDeliverIndividualRequestPayNodeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"pay");if(!b.success)return b;b=d("WASmaxInMessageDeliverIndividualRequestPayNodeMixin").parseIndividualRequestPayNodeMixin(a);return!b.success?b:b}g.parseIndividualDeliverPayNodeMixin=a}),98);
__d("WASmaxInMessageDeliverIndividualDeliverPayNodeMessageMixin",["WASmaxInMessageDeliverIndividualDeliverPayNodeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"pay");if(!b.success)return b;a=d("WASmaxInMessageDeliverIndividualDeliverPayNodeMixin").parseIndividualDeliverPayNodeMixin(b.value);return!a.success?a:a}g.parseIndividualDeliverPayNodeMessageMixin=a}),98);
__d("WASmaxInMessageDeliverIndividualDeliverPayNodeOrPayTransactionMessageMixinGroup",["WAResultOrError","WASmaxInMessageDeliverIndividualDeliverPayNodeMessageMixin","WASmaxInMessageDeliverPayTransactionMessageMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverIndividualDeliverPayNodeMessageMixin").parseIndividualDeliverPayNodeMessageMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IndividualDeliverPayNodeMessage",value:b.value});var c=d("WASmaxInMessageDeliverPayTransactionMessageMixin").parsePayTransactionMessageMixin(a);return c.success?d("WAResultOrError").makeResult({name:"PayTransactionMessage",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IndividualDeliverPayNodeMessage","PayTransactionMessage"],[b,c])}g.parseIndividualDeliverPayNodeOrPayTransactionMessageMixinGroup=a}),98);
__d("WASmaxInMessageDeliverContentTypePayIndividualMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypePayMixin","WASmaxInMessageDeliverIndividualDeliverPayNodeOrPayTransactionMessageMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverContentTypePayMixin").parseContentTypePayMixin(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverIndividualDeliverPayNodeOrPayTransactionMessageMixinGroup").parseIndividualDeliverPayNodeOrPayTransactionMessageMixinGroup(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{individualDeliverPayNodeOrPayTransactionMessageMixinGroup:a.success?a.value:null}))}g.parseContentTypePayIndividualMixin=a}),98);
__d("WASmaxInMessageDeliverContentAvailableMixins",["WAResultOrError","WASmaxInMessageDeliverContentTypeListMixin","WASmaxInMessageDeliverContentTypeLiveLocationSingleMixin","WASmaxInMessageDeliverContentTypeMediaSingleMixin","WASmaxInMessageDeliverContentTypeMedianotifyMixin","WASmaxInMessageDeliverContentTypePayIndividualMixin","WASmaxInMessageDeliverContentTypePollCreationMixin","WASmaxInMessageDeliverContentTypePollVoteMixin","WASmaxInMessageDeliverContentTypeReactionMixin","WASmaxInMessageDeliverContentTypeTextMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverContentTypeTextMixin").parseContentTypeTextMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"ContentTypeText",value:b.value});var c=d("WASmaxInMessageDeliverContentTypeListMixin").parseContentTypeListMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"ContentTypeList",value:c.value});var e=d("WASmaxInMessageDeliverContentTypeLiveLocationSingleMixin").parseContentTypeLiveLocationSingleMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"ContentTypeLiveLocationSingle",value:e.value});var f=d("WASmaxInMessageDeliverContentTypeMediaSingleMixin").parseContentTypeMediaSingleMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"ContentTypeMediaSingle",value:f.value});var g=d("WASmaxInMessageDeliverContentTypePayIndividualMixin").parseContentTypePayIndividualMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"ContentTypePayIndividual",value:g.value});var h=d("WASmaxInMessageDeliverContentTypeReactionMixin").parseContentTypeReactionMixin(a);if(h.success)return d("WAResultOrError").makeResult({name:"ContentTypeReaction",value:h.value});var i=d("WASmaxInMessageDeliverContentTypePollCreationMixin").parseContentTypePollCreationMixin(a);if(i.success)return d("WAResultOrError").makeResult({name:"ContentTypePollCreation",value:i.value});var j=d("WASmaxInMessageDeliverContentTypePollVoteMixin").parseContentTypePollVoteMixin(a);if(j.success)return d("WAResultOrError").makeResult({name:"ContentTypePollVote",value:j.value});var k=d("WASmaxInMessageDeliverContentTypeMedianotifyMixin").parseContentTypeMedianotifyMixin(a);return k.success?d("WAResultOrError").makeResult({name:"ContentTypeMedianotify",value:k.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["ContentTypeText","ContentTypeList","ContentTypeLiveLocationSingle","ContentTypeMediaSingle","ContentTypePayIndividual","ContentTypeReaction","ContentTypePollCreation","ContentTypePollVote","ContentTypeMedianotify"],[b,c,e,f,g,h,i,j,k])}g.parseContentAvailableMixins=a}),98);
__d("WASmaxInMessageDeliverRetryOrIndividualRegularOrBotResponseMessageMixinGroup",["WAResultOrError","WASmaxInMessageDeliverBotResponseMessageMixin","WASmaxInMessageDeliverIndividualRegularMixin","WASmaxInMessageDeliverRetryMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverRetryMixin").parseRetryMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"Retry",value:b.value});var c=d("WASmaxInMessageDeliverIndividualRegularMixin").parseIndividualRegularMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IndividualRegular",value:c.value});var e=d("WASmaxInMessageDeliverBotResponseMessageMixin").parseBotResponseMessageMixin(a);return e.success?d("WAResultOrError").makeResult({name:"BotResponseMessage",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["Retry","IndividualRegular","BotResponseMessage"],[b,c,e])}g.parseRetryOrIndividualRegularOrBotResponseMessageMixinGroup=a}),98);
__d("WASmaxInMessageDeliverAvailableMixin",["WAResultOrError","WASmaxInMessageDeliverBusinessBotMessageMixin","WASmaxInMessageDeliverContentAvailableMixins","WASmaxInMessageDeliverRetryOrIndividualRegularOrBotResponseMessageMixinGroup","WASmaxInMessageDeliverRevokeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"enc");if(!b.success)return b;b=d("WASmaxInMessageDeliverRevokeMixin").parseRevokeMixin(a);var c=d("WASmaxInMessageDeliverBusinessBotMessageMixin").parseBusinessBotMessageMixin(a),e=d("WASmaxInMessageDeliverRetryOrIndividualRegularOrBotResponseMessageMixinGroup").parseRetryOrIndividualRegularOrBotResponseMessageMixinGroup(a);if(!e.success)return e;a=d("WASmaxInMessageDeliverContentAvailableMixins").parseContentAvailableMixins(a);return!a.success?a:d("WAResultOrError").makeResult({revokeMixin:b.success?b.value:null,businessBotMessageMixin:c.success?c.value:null,retryOrIndividualRegularOrBotResponseMessageMixinGroup:e.value,contentAvailableMixins:a.value})}g.parseAvailableMixin=a}),98);
__d("WASmaxInMessageDeliverContentUnavailableMixins",["WAResultOrError","WASmaxInMessageDeliverContentTypeMediaMixin","WASmaxInMessageDeliverContentTypePayIndividualMixin","WASmaxInMessageDeliverContentTypePollCreationMixin","WASmaxInMessageDeliverContentTypePollVoteMixin","WASmaxInMessageDeliverContentTypeReactionMixin","WASmaxInMessageDeliverContentTypeTextMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverContentTypeTextMixin").parseContentTypeTextMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"ContentTypeText",value:b.value});var c=d("WASmaxInMessageDeliverContentTypeMediaMixin").parseContentTypeMediaMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"ContentTypeMedia",value:c.value});var e=d("WASmaxInMessageDeliverContentTypePayIndividualMixin").parseContentTypePayIndividualMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"ContentTypePayIndividual",value:e.value});var f=d("WASmaxInMessageDeliverContentTypeReactionMixin").parseContentTypeReactionMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"ContentTypeReaction",value:f.value});var g=d("WASmaxInMessageDeliverContentTypePollCreationMixin").parseContentTypePollCreationMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"ContentTypePollCreation",value:g.value});var h=d("WASmaxInMessageDeliverContentTypePollVoteMixin").parseContentTypePollVoteMixin(a);return h.success?d("WAResultOrError").makeResult({name:"ContentTypePollVote",value:h.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["ContentTypeText","ContentTypeMedia","ContentTypePayIndividual","ContentTypeReaction","ContentTypePollCreation","ContentTypePollVote"],[b,c,e,f,g,h])}g.parseContentUnavailableMixins=a}),98);
__d("WASmaxInMessageDeliverUnavailableMixin",["WAResultOrError","WASmaxInMessageDeliverContentUnavailableMixins","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"unavailable");if(!b.success)return b;b=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,b.value,"hosted","true");if(!b.success)return b;var c=d("WASmaxInMessageDeliverContentUnavailableMixins").parseContentUnavailableMixins(a);if(!c.success)return c;a=d("WASmaxParseUtils").countChildrenWithTag(a,"enc",0,Infinity,d("WAResultOrError").makeResult);return!a.success?a:d("WAResultOrError").makeResult({unavailableHosted:b.value,contentUnavailableMixins:c.value,countEnc:a.value})}g.parseUnavailableMixin=a}),98);
__d("WASmaxInMessageDeliverAvailableOrUnavailableMixinGroup",["WAResultOrError","WASmaxInMessageDeliverAvailableMixin","WASmaxInMessageDeliverUnavailableMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverAvailableMixin").parseAvailableMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"Available",value:b.value});var c=d("WASmaxInMessageDeliverUnavailableMixin").parseUnavailableMixin(a);return c.success?d("WAResultOrError").makeResult({name:"Unavailable",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["Available","Unavailable"],[b,c])}g.parseAvailableOrUnavailableMixinGroup=a}),98);
__d("WASmaxInMessageDeliverBotLocaleMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"locale");return!b.success?b:d("WAResultOrError").makeResult({locale:b.value})}g.parseBotLocaleMixin=a}),98);
__d("WASmaxInMessageDeliverGroupInviteTargetMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseJid").attrGroupJid(b.value,"group_invite");return!a.success?a:d("WAResultOrError").makeResult({metaGroupInvite:a.value})}g.parseGroupInviteTargetMixin=a}),98);
__d("WASmaxInMessageDeliverLidChatOriginMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").attrStringEnum(b.value,"origin",d("WASmaxInMessageDeliverEnums").ENUM_CTWA_USERNAME);if(!a.success)return a;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,b.value,"share_pn",d("WASmaxInMessageDeliverEnums").ENUM_FALSE_TRUE);return!b.success?b:d("WAResultOrError").makeResult({metaOrigin:a.value,metaSharePn:b.value})}g.parseLidChatOriginMixin=a}),98);
__d("WASmaxInMessageDeliverMessageEditOrMessagePinOrRevokeMixinGroup",["WAResultOrError","WASmaxInMessageDeliverMessageEditMixin","WASmaxInMessageDeliverMessagePinMixin","WASmaxInMessageDeliverRevokeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverMessageEditMixin").parseMessageEditMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"MessageEdit",value:b.value});var c=d("WASmaxInMessageDeliverMessagePinMixin").parseMessagePinMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"MessagePin",value:c.value});var e=d("WASmaxInMessageDeliverRevokeMixin").parseRevokeMixin(a);return e.success?d("WAResultOrError").makeResult({name:"Revoke",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["MessageEdit","MessagePin","Revoke"],[b,c,e])}g.parseMessageEditOrMessagePinOrRevokeMixinGroup=a}),98);
__d("WASmaxInMessageDeliverRecipientDisplayNameMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"recipient_display_name");return!b.success?b:d("WAResultOrError").makeResult({recipientDisplayName:b.value})}g.parseRecipientDisplayNameMixin=a}),98);
__d("WASmaxInMessageDeliverRecipientLIDMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"recipient_lid");return!b.success?b:d("WAResultOrError").makeResult({recipientLid:b.value})}g.parseRecipientLIDMixin=a}),98);
__d("WASmaxInMessageDeliverRecipientPNMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"recipient_pn");return!b.success?b:d("WAResultOrError").makeResult({recipientPn:b.value})}g.parseRecipientPNMixin=a}),98);
__d("WASmaxInMessageDeliverRecipientUsernameMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"recipient_username");return!b.success?b:d("WAResultOrError").makeResult({recipientUsername:b.value})}g.parseRecipientUsernameMixin=a}),98);
__d("WASmaxInMessageDeliverRecipientLIDOrPNOrDisplayNameOrUsernameMixinGroup",["WAResultOrError","WASmaxInMessageDeliverRecipientDisplayNameMixin","WASmaxInMessageDeliverRecipientLIDMixin","WASmaxInMessageDeliverRecipientPNMixin","WASmaxInMessageDeliverRecipientUsernameMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverRecipientLIDMixin").parseRecipientLIDMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"RecipientLID",value:b.value});var c=d("WASmaxInMessageDeliverRecipientPNMixin").parseRecipientPNMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"RecipientPN",value:c.value});var e=d("WASmaxInMessageDeliverRecipientDisplayNameMixin").parseRecipientDisplayNameMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"RecipientDisplayName",value:e.value});var f=d("WASmaxInMessageDeliverRecipientUsernameMixin").parseRecipientUsernameMixin(a);return f.success?d("WAResultOrError").makeResult({name:"RecipientUsername",value:f.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["RecipientLID","RecipientPN","RecipientDisplayName","RecipientUsername"],[b,c,e,f])}g.parseRecipientLIDOrPNOrDisplayNameOrUsernameMixinGroup=a}),98);
__d("WASmaxInMessageDeliverRecipientMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"recipient");return!b.success?b:d("WAResultOrError").makeResult({recipient:b.value})}g.parseRecipientMixin=a}),98);
__d("WASmaxInMessageDeliverSenderLIDMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"sender_lid");return!b.success?b:d("WAResultOrError").makeResult({senderLid:b.value})}g.parseSenderLIDMixin=a}),98);
__d("WASmaxInMessageDeliverSenderPNMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"sender_pn");return!b.success?b:d("WAResultOrError").makeResult({senderPn:b.value})}g.parseSenderPNMixin=a}),98);
__d("WASmaxInMessageDeliverSenderUsernameMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"username");return!b.success?b:d("WAResultOrError").makeResult({username:b.value})}g.parseSenderUsernameMixin=a}),98);
__d("WASmaxInMessageDeliverSenderPNOrLIDOrUsernameMixinGroup",["WAResultOrError","WASmaxInMessageDeliverSenderLIDMixin","WASmaxInMessageDeliverSenderPNMixin","WASmaxInMessageDeliverSenderUsernameMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverSenderPNMixin").parseSenderPNMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"SenderPN",value:b.value});var c=d("WASmaxInMessageDeliverSenderLIDMixin").parseSenderLIDMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"SenderLID",value:c.value});var e=d("WASmaxInMessageDeliverSenderUsernameMixin").parseSenderUsernameMixin(a);return e.success?d("WAResultOrError").makeResult({name:"SenderUsername",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["SenderPN","SenderLID","SenderUsername"],[b,c,e])}g.parseSenderPNOrLIDOrUsernameMixinGroup=a}),98);
__d("WASmaxInMessageDeliverThreadTypeTagEnumMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"meta");if(!b.success)return b;b=d("WASmaxParseUtils").attrInt(a,"thread_type");return!b.success?b:d("WAResultOrError").makeResult({threadType:b.value})}g.parseThreadTypeTagEnumMixin=a}),98);
__d("WASmaxInMessageDeliverThreadTypeTagLegacyMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"meta");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"thread_type");return!b.success?b:d("WAResultOrError").makeResult({threadType:b.value})}g.parseThreadTypeTagLegacyMixin=a}),98);
__d("WASmaxInMessageDeliverThreadTypeTagEnumOrLegacyMixinGroup",["WAResultOrError","WASmaxInMessageDeliverThreadTypeTagEnumMixin","WASmaxInMessageDeliverThreadTypeTagLegacyMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverThreadTypeTagEnumMixin").parseThreadTypeTagEnumMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"ThreadTypeTagEnum",value:b.value});var c=d("WASmaxInMessageDeliverThreadTypeTagLegacyMixin").parseThreadTypeTagLegacyMixin(a);return c.success?d("WAResultOrError").makeResult({name:"ThreadTypeTagLegacy",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["ThreadTypeTagEnum","ThreadTypeTagLegacy"],[b,c])}g.parseThreadTypeTagEnumOrLegacyMixinGroup=a}),98);
__d("WASmaxInMessageDeliverThreadTypeTagMixin",["WAResultOrError","WASmaxInMessageDeliverThreadTypeTagEnumOrLegacyMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxInMessageDeliverThreadTypeTagEnumOrLegacyMixinGroup").parseThreadTypeTagEnumOrLegacyMixinGroup(b.value);return!a.success?a:d("WAResultOrError").makeResult({metaThreadTypeTagEnumOrLegacyMixinGroup:a.value})}g.parseThreadTypeTagMixin=a}),98);
__d("WASmaxInMessageDeliverIndividualMixin",["WAResultOrError","WASmaxInMessageDeliverAvailableOrUnavailableMixinGroup","WASmaxInMessageDeliverBotLocaleMixin","WASmaxInMessageDeliverBotThreadIDMixin","WASmaxInMessageDeliverDisplayNameMixin","WASmaxInMessageDeliverEnums","WASmaxInMessageDeliverGroupInviteTargetMixin","WASmaxInMessageDeliverLidChatOriginMixin","WASmaxInMessageDeliverMessageEditOrMessagePinOrRevokeMixinGroup","WASmaxInMessageDeliverRecipientLIDOrPNOrDisplayNameOrUsernameMixinGroup","WASmaxInMessageDeliverRecipientMixin","WASmaxInMessageDeliverSenderPNOrLIDOrUsernameMixinGroup","WASmaxInMessageDeliverThreadTypeTagMixin","WASmaxInMessageDeliverToProxyAccountMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseJid").attrJidEnum(a,"from",d("WASmaxInMessageDeliverEnums").DEVICEJID_DEVICEJID);if(!b.success)return b;var c=d("WASmaxInMessageDeliverRecipientMixin").parseRecipientMixin(a),e=d("WASmaxInMessageDeliverDisplayNameMixin").parseDisplayNameMixin(a),f=d("WASmaxInMessageDeliverGroupInviteTargetMixin").parseGroupInviteTargetMixin(a),g=d("WASmaxInMessageDeliverThreadTypeTagMixin").parseThreadTypeTagMixin(a),h=d("WASmaxInMessageDeliverToProxyAccountMixin").parseToProxyAccountMixin(a),i=d("WASmaxInMessageDeliverBotThreadIDMixin").parseBotThreadIDMixin(a),j=d("WASmaxInMessageDeliverLidChatOriginMixin").parseLidChatOriginMixin(a),k=d("WASmaxInMessageDeliverBotLocaleMixin").parseBotLocaleMixin(a),l=d("WASmaxInMessageDeliverMessageEditOrMessagePinOrRevokeMixinGroup").parseMessageEditOrMessagePinOrRevokeMixinGroup(a),m=d("WASmaxInMessageDeliverAvailableOrUnavailableMixinGroup").parseAvailableOrUnavailableMixinGroup(a);if(!m.success)return m;var n=d("WASmaxInMessageDeliverSenderPNOrLIDOrUsernameMixinGroup").parseSenderPNOrLIDOrUsernameMixinGroup(a);a=d("WASmaxInMessageDeliverRecipientLIDOrPNOrDisplayNameOrUsernameMixinGroup").parseRecipientLIDOrPNOrDisplayNameOrUsernameMixinGroup(a);return d("WAResultOrError").makeResult({from:b.value,recipientMixin:c.success?c.value:null,displayNameMixin:e.success?e.value:null,groupInviteTargetMixin:f.success?f.value:null,threadTypeTagMixin:g.success?g.value:null,toProxyAccountMixin:h.success?h.value:null,botThreadIDMixin:i.success?i.value:null,lidChatOriginMixin:j.success?j.value:null,botLocaleMixin:k.success?k.value:null,messageEditOrMessagePinOrRevokeMixinGroup:l.success?l.value:null,availableOrUnavailableMixinGroup:m.value,senderPNOrLIDOrUsernameMixinGroup:n.success?n.value:null,recipientLIDOrPNOrDisplayNameOrUsernameMixinGroup:a.success?a.value:null})}g.parseIndividualMixin=a}),98);
__d("WASmaxInMessageDeliverBroadcastDualEncBroadcastDualEncNonMediaOrBroadcastDualEncMediaMediaMixinGroup",["WAResultOrError","WASmaxInMessageDeliverBroadcastDualEncMediaMixin","WASmaxInMessageDeliverBroadcastDualEncNonMediaMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverBroadcastDualEncNonMediaMixin").parseBroadcastDualEncNonMediaMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"BroadcastDualEncNonMedia",value:b.value});var c=d("WASmaxInMessageDeliverBroadcastDualEncMediaMixin").parseBroadcastDualEncMediaMixin(a);return c.success?d("WAResultOrError").makeResult({name:"BroadcastDualEncMedia",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["BroadcastDualEncNonMedia","BroadcastDualEncMedia"],[b,c])}g.parseBroadcastDualEncBroadcastDualEncNonMediaOrBroadcastDualEncMediaMediaMixinGroup=a}),98);
__d("WASmaxInMessageDeliverStatusDualEncMixin",["WAResultOrError","WASmaxInMessageDeliverBroadcastDualEncBroadcastDualEncNonMediaOrBroadcastDualEncMediaMediaMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverBroadcastDualEncBroadcastDualEncNonMediaOrBroadcastDualEncMediaMediaMixinGroup").parseBroadcastDualEncBroadcastDualEncNonMediaOrBroadcastDualEncMediaMediaMixinGroup(a);return!b.success?b:d("WAResultOrError").makeResult({broadcastDualEncBroadcastDualEncNonMediaOrBroadcastDualEncMediaMediaMixinGroup:b.value})}g.parseStatusDualEncMixin=a}),98);
__d("WASmaxInMessageDeliverStatusSingleEncMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeTextOrMediaSingleMixinGroup","WASmaxInMessageDeliverRetryOrBroadcastRegularMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverContentTypeTextOrMediaSingleMixinGroup").parseContentTypeTextOrMediaSingleMixinGroup(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverRetryOrBroadcastRegularMixinGroup").parseRetryOrBroadcastRegularMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({contentTypeTextOrMediaSingleMixinGroup:b.value,retryOrBroadcastRegularMixinGroup:a.value})}g.parseStatusSingleEncMixin=a}),98);
__d("WASmaxInMessageDeliverStatusDualOrSingleEncMixinGroup",["WAResultOrError","WASmaxInMessageDeliverStatusDualEncMixin","WASmaxInMessageDeliverStatusSingleEncMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverStatusDualEncMixin").parseStatusDualEncMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"StatusDualEnc",value:b.value});var c=d("WASmaxInMessageDeliverStatusSingleEncMixin").parseStatusSingleEncMixin(a);return c.success?d("WAResultOrError").makeResult({name:"StatusSingleEnc",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["StatusDualEnc","StatusSingleEnc"],[b,c])}g.parseStatusDualOrSingleEncMixinGroup=a}),98);
__d("WASmaxInMessageDeliverStatusSettingMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").attrStringEnum(b.value,"status_setting",d("WASmaxInMessageDeliverEnums").ENUM_ALLOWLIST_CONTACTS_DENYLIST);return!a.success?a:d("WAResultOrError").makeResult({metaStatusSetting:a.value})}g.parseStatusSettingMixin=a}),98);
__d("WASmaxInMessageDeliverStatusMixin",["WAResultOrError","WASmaxInMessageDeliverFanoutCountMixin","WASmaxInMessageDeliverRevokeMixin","WASmaxInMessageDeliverStatusDualOrSingleEncMixinGroup","WASmaxInMessageDeliverStatusSettingMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrStatusJid,a,"from","status@broadcast");if(!b.success)return b;var c=d("WASmaxParseJid").attrDeviceJid(a,"participant");if(!c.success)return c;var e=d("WASmaxInMessageDeliverRevokeMixin").parseRevokeMixin(a),f=d("WASmaxInMessageDeliverFanoutCountMixin").parseFanoutCountMixin(a),g=d("WASmaxInMessageDeliverStatusSettingMixin").parseStatusSettingMixin(a);a=d("WASmaxInMessageDeliverStatusDualOrSingleEncMixinGroup").parseStatusDualOrSingleEncMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({from:b.value,participant:c.value,revokeMixin:e.success?e.value:null,fanoutCountMixin:f.success?f.value:null,statusSettingMixin:g.success?g.value:null,statusDualOrSingleEncMixinGroup:a.value})}g.parseStatusMixin=a}),98);
__d("WASmaxInMessageDeliverIndividualOrGroupOrStatusOrBroadcastMixinGroup",["WAResultOrError","WASmaxInMessageDeliverBroadcastMixin","WASmaxInMessageDeliverGroupMixin","WASmaxInMessageDeliverIndividualMixin","WASmaxInMessageDeliverStatusMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverIndividualMixin").parseIndividualMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"Individual",value:b.value});var c=d("WASmaxInMessageDeliverGroupMixin").parseGroupMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"Group",value:c.value});var e=d("WASmaxInMessageDeliverStatusMixin").parseStatusMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"Status",value:e.value});var f=d("WASmaxInMessageDeliverBroadcastMixin").parseBroadcastMixin(a);return f.success?d("WAResultOrError").makeResult({name:"Broadcast",value:f.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["Individual","Group","Status","Broadcast"],[b,c,e,f])}g.parseIndividualOrGroupOrStatusOrBroadcastMixinGroup=a}),98);
__d("WASmaxInMessageDeliverRegularRequest",["WAResultOrError","WASmaxInMessageDeliverBaseMixin","WASmaxInMessageDeliverIndividualOrGroupOrStatusOrBroadcastMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!b.success)return b;var c=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!c.success)return c;var e=d("WASmaxInMessageDeliverBaseMixin").parseBaseMixin(a);if(!e.success)return e;a=d("WASmaxInMessageDeliverIndividualOrGroupOrStatusOrBroadcastMixinGroup").parseIndividualOrGroupOrStatusOrBroadcastMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({id:b.value,t:c.value},e.value,{individualOrGroupOrStatusOrBroadcastMixinGroup:a.value}))}g.parseRegularRequest=a}),98);
__d("WASmaxOutMessageDeliverAckMixin",["WASmaxAttrs","WASmaxInMessageDeliverEnums","WASmaxJsx","WASmaxMixins","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function h(a,b){a=a.ackRecipient;var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrJidEnum,b,["from"],d("WASmaxInMessageDeliverEnums").DEVICEJID_BROADCASTJID_DEVICEJID_GROUPJID_STATUSJID);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);var e=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,b,["id"]);if(!e.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(e.error);var f=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrString,b,["type"]);if(!f.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(f.error);var g=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrJidEnum,b,["participant"],d("WASmaxInMessageDeliverEnums").DEVICEJID_DEVICEJID_DEVICEJID);if(!g.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(g.error);b=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrUserJid,b,["actual_to"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);c=d("WASmaxJsx").smax("ack",{to:d("WAWap").JID(c.value),"class":"message",id:d("WAWap").STANZA_ID(e.value),type:d("WAWap").CUSTOM_STRING(f.value),participant:d("WASmaxAttrs").OPTIONAL(d("WAWap").JID,g.value),recipient:d("WASmaxAttrs").OPTIONAL(d("WAWap").USER_JID,a),actual_from:d("WASmaxAttrs").OPTIONAL(d("WAWap").JID,b.value)});return c}function a(a,b,c){b=h(b,c);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeAckMixin=a}),98);
__d("WASmaxOutMessageDeliverRegularResponseMissingPlaceholder",["WASmaxJsx","WASmaxOutMessageDeliverAckMixin"],(function(a,b,c,d,e,f,g){function a(a,b){a=d("WASmaxOutMessageDeliverAckMixin").mergeAckMixin(d("WASmaxJsx").smax("ack",{error:"404"}),a,b);return a}g.makeRegularResponseMissingPlaceholder=a}),98);
__d("WASmaxOutMessageDeliverRegularResponseSuccess",["WASmaxJsx","WASmaxOutMessageDeliverAckMixin"],(function(a,b,c,d,e,f,g){function a(a,b){a=d("WASmaxOutMessageDeliverAckMixin").mergeAckMixin(d("WASmaxJsx").smax("ack",null),a,b);return a}g.makeRegularResponseSuccess=a}),98);
__d("WASmaxMessageDeliverRegularRPC",["WASmaxInMessageDeliverRegularRequest","WASmaxOutMessageDeliverRegularResponseMissingPlaceholder","WASmaxOutMessageDeliverRegularResponseSuccess","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverRegularRequest").parseRegularRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Regular",{Request:b}));return{parsedRequest:b.value,makeRegularResponseMissingPlaceholder:function(b){return d("WASmaxOutMessageDeliverRegularResponseMissingPlaceholder").makeRegularResponseMissingPlaceholder(b,a)},makeRegularResponseSuccess:function(b){return d("WASmaxOutMessageDeliverRegularResponseSuccess").makeRegularResponseSuccess(b,a)}}}g.receiveRegularRPC=a}),98);
__d("WASmaxInMessageFallbackDeliverEncMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").countChildrenWithTag(a,"enc",1,Infinity,d("WAResultOrError").makeResult);return!b.success?b:d("WAResultOrError").makeResult({countEnc:b.value})}g.parseDeliverEncMixin=a}),98);
__d("WASmaxInMessageFallbackEnums",["WAJids"],(function(a,b,c,d,e,f,g){b={validators:[(a=d("WAJids")).validateBroadcastJid,a.validateCallJid,a.validateDeviceJid,a.validateDomainJid,a.validateGroupJid,a.validateStatusJid,a.validateUserJid],typeName:"BroadcastJid|CallJid|DeviceJid|DomainJid|GroupJid|StatusJid|UserJid"};g.BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID=b}),98);
__d("WASmaxInMessageFallbackDeliverRequest",["WAResultOrError","WASmaxInMessageFallbackDeliverEncMixin","WASmaxInMessageFallbackEnums","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!b.success)return b;var c=d("WASmaxParseJid").attrJidEnum(a,"from",d("WASmaxInMessageFallbackEnums").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"type");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrJidEnum,a,"participant",d("WASmaxInMessageFallbackEnums").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!f.success)return f;a=d("WASmaxInMessageFallbackDeliverEncMixin").parseDeliverEncMixin(a);return d("WAResultOrError").makeResult({id:b.value,from:c.value,type:e.value,participant:f.value,deliverEncMixin:a.success?a.value:null})}g.parseDeliverRequest=a}),98);
__d("WASmaxOutMessageFallbackDeliverResponseBadStanza",["WASmaxAttrs","WASmaxInMessageFallbackEnums","WASmaxJsx","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a,b){a=a.ackError;var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,b,["id"]);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);var e=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrJidEnum,b,["from"],d("WASmaxInMessageFallbackEnums").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!e.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(e.error);var f=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrJidEnum,b,["participant"],d("WASmaxInMessageFallbackEnums").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!f.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(f.error);b=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseUtils").attrString,b,["type"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);c=d("WASmaxJsx").smax("ack",{"class":"message",id:d("WAWap").STANZA_ID(c.value),to:d("WAWap").JID(e.value),participant:d("WASmaxAttrs").OPTIONAL(d("WAWap").JID,f.value),type:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,b.value),error:d("WAWap").INT(a)});return c}g.makeDeliverResponseBadStanza=a}),98);
__d("WASmaxOutMessageFallbackDeliverResponseDelivery",["WASmaxAttrs","WASmaxInMessageFallbackEnums","WASmaxJsx","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrJidEnum,a,["from"],d("WASmaxInMessageFallbackEnums").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);a=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrJidEnum,a,["participant"],d("WASmaxInMessageFallbackEnums").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("receipt",{id:d("WAWap").STANZA_ID(b.value),to:d("WAWap").JID(c.value),participant:d("WASmaxAttrs").OPTIONAL(d("WAWap").JID,a.value)});return b}g.makeDeliverResponseDelivery=a}),98);
__d("WASmaxOutMessageFallbackDeliverResponseNoEnc",["WASmaxAttrs","WASmaxInMessageFallbackEnums","WASmaxJsx","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrJidEnum,a,["from"],d("WASmaxInMessageFallbackEnums").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);var e=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrJidEnum,a,["participant"],d("WASmaxInMessageFallbackEnums").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!e.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(e.error);a=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{"class":"message",id:d("WAWap").STANZA_ID(b.value),from:d("WAWap").JID(c.value),participant:d("WASmaxAttrs").OPTIONAL(d("WAWap").JID,e.value),type:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a.value),error:"406"});return b}g.makeDeliverResponseNoEnc=a}),98);
__d("WASmaxMessageFallbackDeliverRPC",["WASmaxInMessageFallbackDeliverRequest","WASmaxOutMessageFallbackDeliverResponseBadStanza","WASmaxOutMessageFallbackDeliverResponseDelivery","WASmaxOutMessageFallbackDeliverResponseNoEnc","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageFallbackDeliverRequest").parseDeliverRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Deliver",{Request:b}));return{parsedRequest:b.value,makeDeliverResponseNoEnc:function(){return d("WASmaxOutMessageFallbackDeliverResponseNoEnc").makeDeliverResponseNoEnc(a)},makeDeliverResponseDelivery:function(){return d("WASmaxOutMessageFallbackDeliverResponseDelivery").makeDeliverResponseDelivery(a)},makeDeliverResponseBadStanza:function(b){return d("WASmaxOutMessageFallbackDeliverResponseBadStanza").makeDeliverResponseBadStanza(b,a)}}}g.receiveDeliverRPC=a}),98);
__d("WACreateHandleMessage",["Promise","WACommonMessageBase","WACreateHandleGroupMessageBranch","WACreateHandleIndividualMessageBranch","WACreateHandlePeerMessageBranch","WALogger","WAResultOrError","WASmaxMessageDeliverNewsletterRPC","WASmaxMessageDeliverRegularRPC","WASmaxMessageFallbackDeliverRPC","WASmaxParsingFailure"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleMessage receives an invalid stanza. Error: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleMessage receives an invalid stanza: ","."]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Ignore incoming <message /> because no handler is provided"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["DT: handleMessage start"]);l=function(){return a};return a}function a(a){var c=a.individualMessage,e=a.groupMessage,f=a.status,g=a.broadcast,m=d("WACreateHandlePeerMessageBranch").createHandlePeerMessageBranch(a),n=c&&d("WACreateHandleIndividualMessageBranch").createHandleIndividualMessageBranch(c.handleIndividualMessage),o=e&&d("WACreateHandleGroupMessageBranch").createHandleGroupMessageBranch(e.handleGroupMessage);return function(a,c,e){d("WALogger").LOG(l());try{if(((c=a.content)==null?void 0:(c=c[0])==null?void 0:c.tag)==="plaintext"){c=d("WASmaxMessageDeliverNewsletterRPC").receiveNewsletterRPC(a);c=c.makeNewsletterResponseSuccess;return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult(c()))}if(a.attrs.category==="peer")return m(a,{cryptoManager:e});c=d("WASmaxMessageDeliverRegularRPC").receiveRegularRPC(a);var p=c.parsedRequest,q=c.makeRegularResponseSuccess;c=p.individualOrGroupOrStatusOrBroadcastMixinGroup;p=d("WACommonMessageBase").transformMessageParsedRequest(p);switch(c.name){case"Individual":if(n!=null)return n({individualMixin:c.value,makeAck:function(){return q({})},commonMessageBase:p,ctx:{cryptoManager:e}});break;case"Group":if(o!=null)return o({groupMixin:c.value,makeAck:function(){return q({})},commonMessageBase:p,ctx:{cryptoManager:e}});break;case"Broadcast":if(g!=null)return g.handleBroadcastMessage({makeAck:function(){return q({})}}).then(d("WAResultOrError").makeResult);break;default:c.name;if(f!=null)return f.handleStatusMessage({makeAck:function(){return q({})}}).then(d("WAResultOrError").makeResult);break}d("WALogger").LOG(k());p=d("WASmaxMessageFallbackDeliverRPC").receiveDeliverRPC(a);e=p.makeDeliverResponseDelivery;return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult(e()))}catch(e){if(e instanceof d("WASmaxParsingFailure").SmaxParsingFailure){d("WALogger").WARN(j(),a.toString());d("WALogger").ERROR(i(),e);c=d("WASmaxMessageFallbackDeliverRPC").receiveDeliverRPC(a);p=c.makeDeliverResponseBadStanza;return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult(p({ackError:487})))}return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeError({type:"runtime-error",error:e}))}}}g.createHandleMessage=a}),98);
__d("WASmaxInAccountSyncEnums",[],(function(a,b,c,d,e,f){a={block:"block",unblock:"unblock"};f.ENUM_BLOCK_UNBLOCK=a}),66);
__d("WASmaxInAccountSyncNotificationBlocklistMixin",["WAResultOrError","WASmaxInAccountSyncEnums","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"blocklist");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"item");if(!b.success)return b;var c=d("WASmaxParseUtils").attrString(a,"dhash");if(!c.success)return c;a=d("WASmaxParseUtils").attrString(a,"prev_dhash");if(!a.success)return a;var e=d("WASmaxParseUtils").attrStringEnum(b.value,"action",d("WASmaxInAccountSyncEnums").ENUM_BLOCK_UNBLOCK);if(!e.success)return e;b=d("WASmaxParseJid").attrUserJid(b.value,"jid");return!b.success?b:d("WAResultOrError").makeResult({dhash:c.value,prevDhash:a.value,itemAction:e.value,itemJid:b.value})}g.parseNotificationBlocklistMixin=a}),98);
__d("WASmaxInAccountSyncNotificationBlocklistNoPayloadMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"blocklist");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"action","modify");return!b.success?b:d("WAResultOrError").makeResult({action:b.value})}g.parseNotificationBlocklistNoPayloadMixin=a}),98);
__d("WASmaxInAccountSyncBlocklistNotificationType",["WAResultOrError","WASmaxInAccountSyncNotificationBlocklistMixin","WASmaxInAccountSyncNotificationBlocklistNoPayloadMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInAccountSyncNotificationBlocklistMixin").parseNotificationBlocklistMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NotificationBlocklist",value:b.value});var c=d("WASmaxInAccountSyncNotificationBlocklistNoPayloadMixin").parseNotificationBlocklistNoPayloadMixin(a);return c.success?d("WAResultOrError").makeResult({name:"NotificationBlocklistNoPayload",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["Blocklist","BlocklistNoPayload"],[b,c])}g.parseBlocklistNotificationType=a}),98);
__d("WASmaxInAccountSyncNotificationBlocklistNotificationMixin",["WAResultOrError","WASmaxInAccountSyncBlocklistNotificationType","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"blocklist");if(!b.success)return b;a=d("WASmaxInAccountSyncBlocklistNotificationType").parseBlocklistNotificationType(b.value);return!a.success?a:d("WAResultOrError").makeResult({blocklistBlocklistNotificationType:a.value})}g.parseNotificationBlocklistNotificationMixin=a}),98);
__d("WASmaxInAccountSyncNotificationDevicesMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"device");if(!b.success)return b;b=d("WASmaxParseJid").attrDeviceJid(a,"jid");if(!b.success)return b;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"key-index",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({jid:b.value,keyIndex:a.value})}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"key-index-list");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"ts",-1,void 0);if(!b.success)return b;a=d("WASmaxParseUtils").contentBytesRange(a,0,100);return!a.success?a:d("WAResultOrError").makeResult({ts:b.value,elementValue:a.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"devices");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"key-index-list",i);if(!b.success)return b;var c=d("WASmaxParseUtils").attrString(a,"dhash");if(!c.success)return c;a=d("WASmaxParseUtils").mapChildrenWithTag(a,"device",0,1e3,h);return!a.success?a:d("WAResultOrError").makeResult({dhash:c.value,keyIndexList:b.value,device:a.value})}g.parseNotificationDevicesDevice=h;g.parseNotificationDevicesKeyIndexList=i;g.parseNotificationDevicesMixin=a}),98);
__d("WASmaxInAccountSyncNotificationDevicesNoPayloadMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"devices");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"action","modify");return!b.success?b:d("WAResultOrError").makeResult({action:b.value})}g.parseNotificationDevicesNoPayloadMixin=a}),98);
__d("WASmaxInAccountSyncDevicesNotificationType",["WAResultOrError","WASmaxInAccountSyncNotificationDevicesMixin","WASmaxInAccountSyncNotificationDevicesNoPayloadMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInAccountSyncNotificationDevicesMixin").parseNotificationDevicesMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NotificationDevices",value:b.value});var c=d("WASmaxInAccountSyncNotificationDevicesNoPayloadMixin").parseNotificationDevicesNoPayloadMixin(a);return c.success?d("WAResultOrError").makeResult({name:"NotificationDevicesNoPayload",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["Devices","DevicesNoPayload"],[b,c])}g.parseDevicesNotificationType=a}),98);
__d("WASmaxInAccountSyncNotificationDevicesNotificationMixin",["WAResultOrError","WASmaxInAccountSyncDevicesNotificationType","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"devices");if(!b.success)return b;a=d("WASmaxInAccountSyncDevicesNotificationType").parseDevicesNotificationType(b.value);return!a.success?a:d("WAResultOrError").makeResult({devicesDevicesNotificationType:a.value})}g.parseNotificationDevicesNotificationMixin=a}),98);
__d("WASmaxInAccountSyncNotificationDisappearingModeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"disappearing_mode");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"duration",0,void 0);if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({duration:b.value,t:a.value})}g.parseNotificationDisappearingModeMixin=a}),98);
__d("WASmaxInAccountSyncNotificationDisappearingModeNoPayloadMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"disappearing_mode");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"action","modify");return!b.success?b:d("WAResultOrError").makeResult({action:b.value})}g.parseNotificationDisappearingModeNoPayloadMixin=a}),98);
__d("WASmaxInAccountSyncDisappearingModeNotificationType",["WAResultOrError","WASmaxInAccountSyncNotificationDisappearingModeMixin","WASmaxInAccountSyncNotificationDisappearingModeNoPayloadMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInAccountSyncNotificationDisappearingModeMixin").parseNotificationDisappearingModeMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NotificationDisappearingMode",value:b.value});var c=d("WASmaxInAccountSyncNotificationDisappearingModeNoPayloadMixin").parseNotificationDisappearingModeNoPayloadMixin(a);return c.success?d("WAResultOrError").makeResult({name:"NotificationDisappearingModeNoPayload",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["DisappearingMode","DisappearingModeNoPayload"],[b,c])}g.parseDisappearingModeNotificationType=a}),98);
__d("WASmaxInAccountSyncNotificationDisappearingModeNotificationMixin",["WAResultOrError","WASmaxInAccountSyncDisappearingModeNotificationType","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"disappearing_mode");if(!b.success)return b;a=d("WASmaxInAccountSyncDisappearingModeNotificationType").parseDisappearingModeNotificationType(b.value);return!a.success?a:d("WAResultOrError").makeResult({disappearingModeDisappearingModeNotificationType:a.value})}g.parseNotificationDisappearingModeNotificationMixin=a}),98);
__d("WASmaxInAccountSyncNotificationNoticeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notice");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"id",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").attrIntRange(a,"stage",0,1e3);if(!c.success)return c;var e=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!e.success)return e;var f=d("WASmaxParseUtils").attrIntRange(a,"version",1,void 0);if(!f.success)return f;a=d("WASmaxParseUtils").attrIntRange(a,"type",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({id:b.value,stage:c.value,t:e.value,version:f.value,type:a.value})}g.parseNotificationNoticeMixin=a}),98);
__d("WASmaxInAccountSyncNotificationNoticeNoPayloadMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notice");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"action","modify");return!b.success?b:d("WAResultOrError").makeResult({action:b.value})}g.parseNotificationNoticeNoPayloadMixin=a}),98);
__d("WASmaxInAccountSyncNoticeNotificationType",["WAResultOrError","WASmaxInAccountSyncNotificationNoticeMixin","WASmaxInAccountSyncNotificationNoticeNoPayloadMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInAccountSyncNotificationNoticeMixin").parseNotificationNoticeMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NotificationNotice",value:b.value});var c=d("WASmaxInAccountSyncNotificationNoticeNoPayloadMixin").parseNotificationNoticeNoPayloadMixin(a);return c.success?d("WAResultOrError").makeResult({name:"NotificationNoticeNoPayload",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["Notice","NoticeNoPayload"],[b,c])}g.parseNoticeNotificationType=a}),98);
__d("WASmaxInAccountSyncNotificationNoticeNotificationMixin",["WAResultOrError","WASmaxInAccountSyncNoticeNotificationType","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"notice");if(!b.success)return b;a=d("WASmaxInAccountSyncNoticeNotificationType").parseNoticeNotificationType(b.value);return!a.success?a:d("WAResultOrError").makeResult({noticeNoticeNotificationType:a.value})}g.parseNotificationNoticeNotificationMixin=a}),98);
__d("WASmaxInAccountSyncNotificationPictureMixin",["WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"picture");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"delete");return!b.success?b:d("WASmaxParseUtils").voidSuccess}g.parseNotificationPictureMixin=a}),98);
__d("WASmaxInAccountSyncNotificationPictureNoPayloadMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"picture");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"action","modify");return!b.success?b:d("WAResultOrError").makeResult({action:b.value})}g.parseNotificationPictureNoPayloadMixin=a}),98);
__d("WASmaxInAccountSyncPictureNotificationType",["WAResultOrError","WASmaxInAccountSyncNotificationPictureMixin","WASmaxInAccountSyncNotificationPictureNoPayloadMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInAccountSyncNotificationPictureMixin").parseNotificationPictureMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NotificationPicture",value:b.value});var c=d("WASmaxInAccountSyncNotificationPictureNoPayloadMixin").parseNotificationPictureNoPayloadMixin(a);return c.success?d("WAResultOrError").makeResult({name:"NotificationPictureNoPayload",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["Picture","PictureNoPayload"],[b,c])}g.parsePictureNotificationType=a}),98);
__d("WASmaxInAccountSyncNotificationPictureNotificationMixin",["WAResultOrError","WASmaxInAccountSyncPictureNotificationType","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"picture");if(!b.success)return b;a=d("WASmaxInAccountSyncPictureNotificationType").parsePictureNotificationType(b.value);return!a.success?a:d("WAResultOrError").makeResult({picturePictureNotificationType:a.value})}g.parseNotificationPictureNotificationMixin=a}),98);
__d("WASmaxInAccountSyncNotificationContactBlacklistNoAdditionalDataMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"category");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"action","modify");return!b.success?b:d("WAResultOrError").makeResult({action:b.value})}g.parseNotificationContactBlacklistNoAdditionalDataMixin=a}),98);
__d("WASmaxInAccountSyncNotificationContactBlacklistWithAdditionalDataMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"user");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"action");if(!b.success)return b;a=d("WASmaxParseJid").attrUserJid(a,"jid");return!a.success?a:d("WAResultOrError").makeResult({action:b.value,jid:a.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"category");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"dhash");if(!b.success)return b;var c=d("WASmaxParseUtils").attrString(a,"prev_dhash");if(!c.success)return c;a=d("WASmaxParseUtils").mapChildrenWithTag(a,"user",0,1e3,h);return!a.success?a:d("WAResultOrError").makeResult({dhash:b.value,prevDhash:c.value,user:a.value})}g.parseNotificationContactBlacklistWithAdditionalDataUser=h;g.parseNotificationContactBlacklistWithAdditionalDataMixin=a}),98);
__d("WASmaxInAccountSyncContactBlacklistData",["WAResultOrError","WASmaxInAccountSyncNotificationContactBlacklistNoAdditionalDataMixin","WASmaxInAccountSyncNotificationContactBlacklistWithAdditionalDataMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInAccountSyncNotificationContactBlacklistWithAdditionalDataMixin").parseNotificationContactBlacklistWithAdditionalDataMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NotificationContactBlacklistWithAdditionalData",value:b.value});var c=d("WASmaxInAccountSyncNotificationContactBlacklistNoAdditionalDataMixin").parseNotificationContactBlacklistNoAdditionalDataMixin(a);return c.success?d("WAResultOrError").makeResult({name:"NotificationContactBlacklistNoAdditionalData",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["ContactBlacklistWithAdditionalData","ContactBlacklistNoAdditionalData"],[b,c])}g.parseContactBlacklistData=a}),98);
__d("WASmaxInAccountSyncNotificationPrivacyMixin",["WAResultOrError","WASmaxInAccountSyncContactBlacklistData","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"category");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"name");if(!b.success)return b;var c=d("WASmaxParseUtils").attrString(a,"value");if(!c.success)return c;a=d("WASmaxInAccountSyncContactBlacklistData").parseContactBlacklistData(a);return d("WAResultOrError").makeResult({name:b.value,value:c.value,contactBlacklistData:a.success?a.value:null})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"privacy");if(!b.success)return b;b=d("WASmaxParseUtils").mapChildrenWithTag(a,"category",0,1e3,h);return!b.success?b:d("WAResultOrError").makeResult({category:b.value})}g.parseNotificationPrivacyCategory=h;g.parseNotificationPrivacyMixin=a}),98);
__d("WASmaxInAccountSyncNotificationPrivacyNoPayloadMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"privacy");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"action","modify");return!b.success?b:d("WAResultOrError").makeResult({action:b.value})}g.parseNotificationPrivacyNoPayloadMixin=a}),98);
__d("WASmaxInAccountSyncPrivacyNotificationType",["WAResultOrError","WASmaxInAccountSyncNotificationPrivacyMixin","WASmaxInAccountSyncNotificationPrivacyNoPayloadMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInAccountSyncNotificationPrivacyNoPayloadMixin").parseNotificationPrivacyNoPayloadMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NotificationPrivacyNoPayload",value:b.value});var c=d("WASmaxInAccountSyncNotificationPrivacyMixin").parseNotificationPrivacyMixin(a);return c.success?d("WAResultOrError").makeResult({name:"NotificationPrivacy",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["PrivacyNoPayload","Privacy"],[b,c])}g.parsePrivacyNotificationType=a}),98);
__d("WASmaxInAccountSyncNotificationPrivacyNotificationMixin",["WAResultOrError","WASmaxInAccountSyncPrivacyNotificationType","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"privacy");if(!b.success)return b;a=d("WASmaxInAccountSyncPrivacyNotificationType").parsePrivacyNotificationType(b.value);return!a.success?a:d("WAResultOrError").makeResult({privacyPrivacyNotificationType:a.value})}g.parseNotificationPrivacyNotificationMixin=a}),98);
__d("WASmaxInAccountSyncNotificationStatusMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"status");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"dhash");if(!b.success)return b;a=d("WASmaxParseUtils").contentString(a);return!a.success?a:d("WAResultOrError").makeResult({dhash:b.value,elementValue:a.value})}g.parseNotificationStatusMixin=a}),98);
__d("WASmaxInAccountSyncNotificationStatusNoPayloadMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"status");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"action","modify");return!b.success?b:d("WAResultOrError").makeResult({action:b.value})}g.parseNotificationStatusNoPayloadMixin=a}),98);
__d("WASmaxInAccountSyncStatusNotificationType",["WAResultOrError","WASmaxInAccountSyncNotificationStatusMixin","WASmaxInAccountSyncNotificationStatusNoPayloadMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInAccountSyncNotificationStatusMixin").parseNotificationStatusMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NotificationStatus",value:b.value});var c=d("WASmaxInAccountSyncNotificationStatusNoPayloadMixin").parseNotificationStatusNoPayloadMixin(a);return c.success?d("WAResultOrError").makeResult({name:"NotificationStatusNoPayload",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["Status","StatusNoPayload"],[b,c])}g.parseStatusNotificationType=a}),98);
__d("WASmaxInAccountSyncNotificationStatusNotificationMixin",["WAResultOrError","WASmaxInAccountSyncStatusNotificationType","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"status");if(!b.success)return b;a=d("WASmaxInAccountSyncStatusNotificationType").parseStatusNotificationType(b.value);return!a.success?a:d("WAResultOrError").makeResult({statusStatusNotificationType:a.value})}g.parseNotificationStatusNotificationMixin=a}),98);
__d("WASmaxInAccountSyncNotificationTextStatusEmojiMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"emoji");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"content");return!b.success?b:d("WAResultOrError").makeResult({content:b.value})}g.parseNotificationTextStatusEmojiMixin=a}),98);
__d("WASmaxInAccountSyncNotificationTextStatusMixin",["WAResultOrError","WASmaxInAccountSyncNotificationTextStatusEmojiMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"text_status");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"emoji");if(!b.success)return b;var c=d("WASmaxParseUtils").attrString(a,"text");if(!c.success)return c;var e=d("WASmaxParseUtils").attrInt(a,"ephemeral_duration_sec");if(!e.success)return e;a=d("WASmaxParseUtils").attrString(a,"last_update_time");if(!a.success)return a;b=d("WASmaxInAccountSyncNotificationTextStatusEmojiMixin").parseNotificationTextStatusEmojiMixin(b.value);return!b.success?b:d("WAResultOrError").makeResult({text:c.value,ephemeralDurationSec:e.value,lastUpdateTime:a.value,emojiNotificationTextStatusEmojiMixin:b.value})}g.parseNotificationTextStatusMixin=a}),98);
__d("WASmaxInAccountSyncNotificationTextStatusNoPayloadMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"text_status");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"action","modify");return!b.success?b:d("WAResultOrError").makeResult({action:b.value})}g.parseNotificationTextStatusNoPayloadMixin=a}),98);
__d("WASmaxInAccountSyncTextStatusNotificationType",["WAResultOrError","WASmaxInAccountSyncNotificationTextStatusMixin","WASmaxInAccountSyncNotificationTextStatusNoPayloadMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInAccountSyncNotificationTextStatusMixin").parseNotificationTextStatusMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NotificationTextStatus",value:b.value});var c=d("WASmaxInAccountSyncNotificationTextStatusNoPayloadMixin").parseNotificationTextStatusNoPayloadMixin(a);return c.success?d("WAResultOrError").makeResult({name:"NotificationTextStatusNoPayload",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["TextStatus","TextStatusNoPayload"],[b,c])}g.parseTextStatusNotificationType=a}),98);
__d("WASmaxInAccountSyncNotificationTextStatusNotificationMixin",["WAResultOrError","WASmaxInAccountSyncTextStatusNotificationType","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"text_status");if(!b.success)return b;a=d("WASmaxInAccountSyncTextStatusNotificationType").parseTextStatusNotificationType(b.value);return!a.success?a:d("WAResultOrError").makeResult({textStatusTextStatusNotificationType:a.value})}g.parseNotificationTextStatusNotificationMixin=a}),98);
__d("WASmaxInAccountSyncNotificationUsernameChangeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"username");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"username");return!b.success?b:d("WAResultOrError").makeResult({username:b.value})}g.parseNotificationUsernameChangeMixin=a}),98);
__d("WASmaxInAccountSyncNotificationUsernameDeletionMixin",["WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").assertTag(a,"username");return!a.success?a:d("WASmaxParseUtils").voidSuccess}g.parseNotificationUsernameDeletionMixin=a}),98);
__d("WASmaxInAccountSyncNotificationUsernameNoPayloadMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"username");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"action","modify");return!b.success?b:d("WAResultOrError").makeResult({action:b.value})}g.parseNotificationUsernameNoPayloadMixin=a}),98);
__d("WASmaxInAccountSyncUsernameNotificationType",["WAResultOrError","WASmaxInAccountSyncNotificationUsernameChangeMixin","WASmaxInAccountSyncNotificationUsernameDeletionMixin","WASmaxInAccountSyncNotificationUsernameNoPayloadMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInAccountSyncNotificationUsernameNoPayloadMixin").parseNotificationUsernameNoPayloadMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NotificationUsernameNoPayload",value:b.value});var c=d("WASmaxInAccountSyncNotificationUsernameChangeMixin").parseNotificationUsernameChangeMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"NotificationUsernameChange",value:c.value});var e=d("WASmaxInAccountSyncNotificationUsernameDeletionMixin").parseNotificationUsernameDeletionMixin(a);return e.success?d("WAResultOrError").makeResult({name:"NotificationUsernameDeletion",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["UsernameNoPayload","UsernameChange","UsernameDeletion"],[b,c,e])}g.parseUsernameNotificationType=a}),98);
__d("WASmaxInAccountSyncNotificationUsernameNotificationMixin",["WAResultOrError","WASmaxInAccountSyncUsernameNotificationType","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"username");if(!b.success)return b;a=d("WASmaxInAccountSyncUsernameNotificationType").parseUsernameNotificationType(b.value);return!a.success?a:d("WAResultOrError").makeResult({usernameUsernameNotificationType:a.value})}g.parseNotificationUsernameNotificationMixin=a}),98);
__d("WASmaxInAccountSyncNotificationType",["WAResultOrError","WASmaxInAccountSyncNotificationBlocklistNotificationMixin","WASmaxInAccountSyncNotificationDevicesNotificationMixin","WASmaxInAccountSyncNotificationDisappearingModeNotificationMixin","WASmaxInAccountSyncNotificationNoticeNotificationMixin","WASmaxInAccountSyncNotificationPictureNotificationMixin","WASmaxInAccountSyncNotificationPrivacyNotificationMixin","WASmaxInAccountSyncNotificationStatusNotificationMixin","WASmaxInAccountSyncNotificationTextStatusNotificationMixin","WASmaxInAccountSyncNotificationUsernameNotificationMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInAccountSyncNotificationBlocklistNotificationMixin").parseNotificationBlocklistNotificationMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NotificationBlocklistNotification",value:b.value});var c=d("WASmaxInAccountSyncNotificationDevicesNotificationMixin").parseNotificationDevicesNotificationMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"NotificationDevicesNotification",value:c.value});var e=d("WASmaxInAccountSyncNotificationPictureNotificationMixin").parseNotificationPictureNotificationMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"NotificationPictureNotification",value:e.value});var f=d("WASmaxInAccountSyncNotificationPrivacyNotificationMixin").parseNotificationPrivacyNotificationMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"NotificationPrivacyNotification",value:f.value});var g=d("WASmaxInAccountSyncNotificationStatusNotificationMixin").parseNotificationStatusNotificationMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"NotificationStatusNotification",value:g.value});var h=d("WASmaxInAccountSyncNotificationTextStatusNotificationMixin").parseNotificationTextStatusNotificationMixin(a);if(h.success)return d("WAResultOrError").makeResult({name:"NotificationTextStatusNotification",value:h.value});var i=d("WASmaxInAccountSyncNotificationUsernameNotificationMixin").parseNotificationUsernameNotificationMixin(a);if(i.success)return d("WAResultOrError").makeResult({name:"NotificationUsernameNotification",value:i.value});var j=d("WASmaxInAccountSyncNotificationDisappearingModeNotificationMixin").parseNotificationDisappearingModeNotificationMixin(a);if(j.success)return d("WAResultOrError").makeResult({name:"NotificationDisappearingModeNotification",value:j.value});var k=d("WASmaxInAccountSyncNotificationNoticeNotificationMixin").parseNotificationNoticeNotificationMixin(a);return k.success?d("WAResultOrError").makeResult({name:"NotificationNoticeNotification",value:k.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["BlocklistNotification","DevicesNotification","PictureNotification","PrivacyNotification","StatusNotification","TextStatusNotification","UsernameNotification","DisappearingModeNotification","NoticeNotification"],[b,c,e,f,g,h,i,j,k])}g.parseNotificationType=a}),98);
__d("WASmaxInAccountSyncServerNotificationMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"offline",0,1024);return!a.success?a:d("WAResultOrError").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);
__d("WASmaxInAccountSyncNotificationRequest",["WAResultOrError","WASmaxInAccountSyncNotificationType","WASmaxInAccountSyncServerNotificationMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseJid").attrDeviceJid(a,"from");if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","account_sync");if(!c.success)return c;var e=d("WASmaxInAccountSyncServerNotificationMixin").parseServerNotificationMixin(a);if(!e.success)return e;a=d("WASmaxInAccountSyncNotificationType").parseNotificationType(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({from:b.value,type:c.value},e.value,{notificationType:a.value}))}g.parseNotificationRequest=a}),98);
__d("WASmaxOutAccountSyncNotificationClientAckMixin",["WASmaxJsx","WASmaxMixins","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrDeviceJid,a,["from"]);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);a=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{id:d("WAWap").STANZA_ID(b.value),to:d("WAWap").DEVICE_JID(c.value),"class":"notification",type:d("WAWap").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNotificationClientAckMixin=a}),98);
__d("WASmaxOutAccountSyncNotificationResponseAck",["WASmaxJsx","WASmaxOutAccountSyncNotificationClientAckMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutAccountSyncNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",null),a);return a}g.makeNotificationResponseAck=a}),98);
__d("WASmaxAccountSyncNotificationRPC",["WASmaxInAccountSyncNotificationRequest","WASmaxOutAccountSyncNotificationResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInAccountSyncNotificationRequest").parseNotificationRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Notification",{Request:b}));return{parsedRequest:b.value,makeNotificationResponseAck:function(){return d("WASmaxOutAccountSyncNotificationResponseAck").makeNotificationResponseAck(a)}}}g.receiveNotificationRPC=a}),98);
__d("WACreateHandleAccountSyncNotificationBranch",["Promise","WAResultOrError","WASmaxAccountSyncNotificationRPC","WAUnknownStanzaError"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var c=(a=a.accountSync)!=null?a:{};return function(a){a=d("WASmaxAccountSyncNotificationRPC").receiveNotificationRPC(a);var e=a.parsedRequest.notificationType;a=a.makeNotificationResponseAck;switch(e.name){case"NotificationBlocklistNotification":return i(e.value.blocklistBlocklistNotificationType,c.handleBlocklistNotification,a);case"NotificationDevicesNotification":return j(e.value.devicesDevicesNotificationType,c.handleDevicesNotification,a)}return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError)}}function i(a,c,e){if(c==null)return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError);if(a.name==="NotificationBlocklist"){var f=a.value,g=f.dhash,i=f.prevDhash,j=f.itemAction;f=f.itemJid;return c({dhash:g,displayName:null,action:j,jid:f,prevDhash:i,makeAck:e}).then(d("WAResultOrError").makeResult)}else{a.name;return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError)}}function j(a,c,e){if(c==null)return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError);if(a.name==="NotificationDevices"){var f=a.value,g=f.dhash,i=f.device;f=f.keyIndexList;return c({dhash:g,devices:i,keyIndexList:f,makeAck:e}).then(d("WAResultOrError").makeResult)}else{a.name;return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError)}}g.createHandleAccountSyncNotification=a}),98);
__d("WASmaxInUsyncCloudAPIGroupListMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"group");if(!b.success)return b;b=d("WASmaxParseJid").attrGroupJid(a,"jid");return!b.success?b:d("WAResultOrError").makeResult({jid:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"groups");if(!b.success)return b;a=d("WASmaxParseUtils").mapChildrenWithTag(b.value,"group",1,1e4,h);return!a.success?a:d("WAResultOrError").makeResult({groupsGroup:a.value})}g.parseCloudAPIGroupListGroupsGroup=h;g.parseCloudAPIGroupListMixin=a}),98);
__d("WASmaxInUsyncNotificationAddDevicesNotificationMixin",["WAResultOrError","WASmaxInUsyncCloudAPIGroupListMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"device");if(!b.success)return b;b=d("WASmaxParseJid").attrDeviceJid(a,"jid");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrDeviceJid,a,"lid");if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"key-index",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({jid:b.value,lid:c.value,keyIndex:a.value})}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"key-index-list");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"ts",-1,void 0);if(!b.success)return b;a=d("WASmaxParseUtils").contentBytesRange(a,0,100);return!a.success?a:d("WAResultOrError").makeResult({ts:b.value,elementValue:a.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"add");if(!b.success)return b;var c=d("WASmaxParseUtils").optionalChildWithTag(b.value,"key-index-list",i);if(!c.success)return c;var e=d("WASmaxParseUtils").attrString(b.value,"device_hash");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,b.value,"device_lid_hash");if(!f.success)return f;a=d("WASmaxInUsyncCloudAPIGroupListMixin").parseCloudAPIGroupListMixin(a);b=d("WASmaxParseUtils").mapChildrenWithTag(b.value,"device",0,1e3,h);return!b.success?b:d("WAResultOrError").makeResult({addDeviceHash:e.value,addDeviceLidHash:f.value,cloudAPIGroupListMixin:a.success?a.value:null,addKeyIndexList:c.value,addDevice:b.value})}g.parseNotificationAddDevicesNotificationAddDevice=h;g.parseNotificationAddDevicesNotificationAddKeyIndexList=i;g.parseNotificationAddDevicesNotificationMixin=a}),98);
__d("WASmaxInUsyncNotificationRemoveDevicesNotificationMixin",["WAResultOrError","WASmaxInUsyncCloudAPIGroupListMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"device");if(!b.success)return b;b=d("WASmaxParseJid").attrDeviceJid(a,"jid");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrDeviceJid,a,"lid");if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"key-index",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({jid:b.value,lid:c.value,keyIndex:a.value})}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"key-index-list");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"ts",-1,void 0);if(!b.success)return b;a=d("WASmaxParseUtils").contentBytesRange(a,0,100);return!a.success?a:d("WAResultOrError").makeResult({ts:b.value,elementValue:a.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"remove");if(!b.success)return b;var c=d("WASmaxParseUtils").optionalChildWithTag(b.value,"key-index-list",i);if(!c.success)return c;var e=d("WASmaxParseUtils").attrString(b.value,"device_hash");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,b.value,"device_lid_hash");if(!f.success)return f;a=d("WASmaxInUsyncCloudAPIGroupListMixin").parseCloudAPIGroupListMixin(a);b=d("WASmaxParseUtils").mapChildrenWithTag(b.value,"device",0,1e3,h);return!b.success?b:d("WAResultOrError").makeResult({removeDeviceHash:e.value,removeDeviceLidHash:f.value,cloudAPIGroupListMixin:a.success?a.value:null,removeKeyIndexList:c.value,removeDevice:b.value})}g.parseNotificationRemoveDevicesNotificationRemoveDevice=h;g.parseNotificationRemoveDevicesNotificationRemoveKeyIndexList=i;g.parseNotificationRemoveDevicesNotificationMixin=a}),98);
__d("WASmaxInUsyncNotificationUpdateDevicesNotificationMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"update");if(!b.success)return b;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"notify");if(!a.success)return a;b=d("WASmaxParseUtils").attrString(b.value,"hash");return!b.success?b:d("WAResultOrError").makeResult({notify:a.value,updateHash:b.value})}g.parseNotificationUpdateDevicesNotificationMixin=a}),98);
__d("WASmaxInUsyncDevicesNotification",["WAResultOrError","WASmaxInUsyncNotificationAddDevicesNotificationMixin","WASmaxInUsyncNotificationRemoveDevicesNotificationMixin","WASmaxInUsyncNotificationUpdateDevicesNotificationMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInUsyncNotificationAddDevicesNotificationMixin").parseNotificationAddDevicesNotificationMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NotificationAddDevicesNotification",value:b.value});var c=d("WASmaxInUsyncNotificationRemoveDevicesNotificationMixin").parseNotificationRemoveDevicesNotificationMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"NotificationRemoveDevicesNotification",value:c.value});var e=d("WASmaxInUsyncNotificationUpdateDevicesNotificationMixin").parseNotificationUpdateDevicesNotificationMixin(a);return e.success?d("WAResultOrError").makeResult({name:"NotificationUpdateDevicesNotification",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["AddDevicesNotification","RemoveDevicesNotification","UpdateDevicesNotification"],[b,c,e])}g.parseDevicesNotification=a}),98);
__d("WASmaxInUsyncServerNotificationMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"offline",0,1024);return!a.success?a:d("WAResultOrError").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);
__d("WASmaxInUsyncNotificationRequest",["WAResultOrError","WASmaxInUsyncDevicesNotification","WASmaxInUsyncServerNotificationMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"from");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"lid");if(!c.success)return c;var e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","devices");if(!e.success)return e;var f=d("WASmaxInUsyncServerNotificationMixin").parseServerNotificationMixin(a);if(!f.success)return f;a=d("WASmaxInUsyncDevicesNotification").parseDevicesNotification(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({from:b.value,lid:c.value,type:e.value},f.value,{devicesNotification:a.value}))}g.parseNotificationRequest=a}),98);
__d("WASmaxOutUsyncNotificationClientAckMixin",["WASmaxJsx","WASmaxMixins","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrUserJid,a,["from"]);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);a=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{id:d("WAWap").STANZA_ID(b.value),to:d("WAWap").USER_JID(c.value),"class":"notification",type:d("WAWap").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNotificationClientAckMixin=a}),98);
__d("WASmaxOutUsyncNotificationResponseAck",["WASmaxJsx","WASmaxOutUsyncNotificationClientAckMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutUsyncNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",null),a);return a}g.makeNotificationResponseAck=a}),98);
__d("WASmaxUsyncNotificationRPC",["WASmaxInUsyncNotificationRequest","WASmaxOutUsyncNotificationResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInUsyncNotificationRequest").parseNotificationRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Notification",{Request:b}));return{parsedRequest:b.value,makeNotificationResponseAck:function(){return d("WASmaxOutUsyncNotificationResponseAck").makeNotificationResponseAck(a)}}}g.receiveNotificationRPC=a}),98);
__d("WACreateHandleDevicesNotificationBranch",["Promise","WAResultOrError","WASmaxUsyncNotificationRPC","WATimeUtils","WAUnknownStanzaError"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){a=(a=a.usync)!=null?a:{};var c=a.handleAddDeviceNotification,e=a.handleRemoveDeviceNotification,f=a.handleUpdateDeviceNotification;return function(a){a=d("WASmaxUsyncNotificationRPC").receiveNotificationRPC(a);var g=a.parsedRequest,i=g.from,j=g.lid;g=g.devicesNotification;a=a.makeNotificationResponseAck;switch(g.name){case"NotificationAddDevicesNotification":var k=g.value,l=k.addDeviceHash,m=k.addDeviceLidHash,n=k.addDevice;k=k.addKeyIndexList;return(l=c==null?void 0:c({lid:j,from:i,makeAck:a,hash:l,lidHash:m,deviceList:n,keyIndexList:k==null?null:{ts:d("WATimeUtils").castToUnixTime(k.ts),signedADVListBytes:k.elementValue}}).then(d("WAResultOrError").makeResult))!=null?l:(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError);case"NotificationRemoveDevicesNotification":m=g.value;n=m.removeDevice;k=m.removeDeviceHash;l=m.removeDeviceLidHash;m=m.removeKeyIndexList;return(k=e==null?void 0:e({from:i,lid:j,makeAck:a,hash:k,lidHash:l,deviceList:n,keyIndexList:m==null?null:{ts:d("WATimeUtils").castToUnixTime(m.ts),signedADVListBytes:m.elementValue}}).then(d("WAResultOrError").makeResult))!=null?k:(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError);case"NotificationUpdateDevicesNotification":l=g.value.updateHash;return(n=f==null?void 0:f({from:i,lid:j,hash:l,makeAck:a}).then(d("WAResultOrError").makeResult))!=null?n:(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError)}g.name}}g.createHandleDevicesNotification=a}),98);
__d("WASmaxInPreKeysCloudAPIGroupListMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"group");if(!b.success)return b;b=d("WASmaxParseJid").attrGroupJid(a,"jid");return!b.success?b:d("WAResultOrError").makeResult({jid:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"groups");if(!b.success)return b;a=d("WASmaxParseUtils").mapChildrenWithTag(b.value,"group",1,1e4,h);return!a.success?a:d("WAResultOrError").makeResult({groupsGroup:a.value})}g.parseCloudAPIGroupListGroupsGroup=h;g.parseCloudAPIGroupListMixin=a}),98);
__d("WASmaxInPreKeysDisplayNameMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrString(a,"display_name");return!a.success?a:d("WAResultOrError").makeResult({displayName:a.value})}g.parseDisplayNameMixin=a}),98);
__d("WASmaxInPreKeysNotificationContactIDChangedLIDAttrMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseJid").attrDeviceJid(a,"lid");return!b.success?b:d("WAResultOrError").makeResult({lid:b.value})}g.parseNotificationContactIDChangedLIDAttrMixin=a}),98);
__d("WASmaxInPreKeysNotificationContactIDChangedLIDAttrOrDisplayNameMixinGroup",["WAResultOrError","WASmaxInPreKeysDisplayNameMixin","WASmaxInPreKeysNotificationContactIDChangedLIDAttrMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInPreKeysNotificationContactIDChangedLIDAttrMixin").parseNotificationContactIDChangedLIDAttrMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NotificationContactIDChangedLIDAttr",value:b.value});var c=d("WASmaxInPreKeysDisplayNameMixin").parseDisplayNameMixin(a);return c.success?d("WAResultOrError").makeResult({name:"DisplayName",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["LIDAttr","DisplayName"],[b,c])}g.parseNotificationContactIDChangedLIDAttrOrDisplayNameMixinGroup=a}),98);
__d("WASmaxInPreKeysServerNotificationMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"offline",0,1024);return!a.success?a:d("WAResultOrError").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);
__d("WASmaxInPreKeysNotificationContactIDChangedRequest",["WAResultOrError","WASmaxInPreKeysCloudAPIGroupListMixin","WASmaxInPreKeysNotificationContactIDChangedLIDAttrOrDisplayNameMixinGroup","WASmaxInPreKeysServerNotificationMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"identity");if(!b.success)return b;b=d("WASmaxParseJid").attrDeviceJid(a,"from");if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","encrypt");if(!c.success)return c;var e=d("WASmaxInPreKeysServerNotificationMixin").parseServerNotificationMixin(a);if(!e.success)return e;var f=d("WASmaxInPreKeysCloudAPIGroupListMixin").parseCloudAPIGroupListMixin(a);a=d("WASmaxInPreKeysNotificationContactIDChangedLIDAttrOrDisplayNameMixinGroup").parseNotificationContactIDChangedLIDAttrOrDisplayNameMixinGroup(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({from:b.value,type:c.value},e.value,{cloudAPIGroupListMixin:f.success?f.value:null,notificationContactIDChangedLIDAttrOrDisplayNameMixinGroup:a.success?a.value:null}))}g.parseNotificationContactIDChangedRequest=a}),98);
__d("WASmaxOutPreKeysNotificationClientAckMixin",["WASmaxInPreKeysEnums","WASmaxJsx","WASmaxMixins","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrJidEnum,a,["from"],d("WASmaxInPreKeysEnums").DEVICEJID_DOMAINJID);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);a=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{id:d("WAWap").STANZA_ID(b.value),to:d("WAWap").JID(c.value),"class":"notification",type:d("WAWap").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNotificationClientAckMixin=a}),98);
__d("WASmaxOutPreKeysNotificationContactIDChangedResponseAck",["WASmaxJsx","WASmaxOutPreKeysNotificationClientAckMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutPreKeysNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",null),a);return a}g.makeNotificationContactIDChangedResponseAck=a}),98);
__d("WASmaxPreKeysNotificationContactIDChangedRPC",["WASmaxInPreKeysNotificationContactIDChangedRequest","WASmaxOutPreKeysNotificationContactIDChangedResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInPreKeysNotificationContactIDChangedRequest").parseNotificationContactIDChangedRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("NotificationContactIDChanged",{Request:b}));return{parsedRequest:b.value,makeNotificationContactIDChangedResponseAck:function(){return d("WASmaxOutPreKeysNotificationContactIDChangedResponseAck").makeNotificationContactIDChangedResponseAck(a)}}}g.receiveNotificationContactIDChangedRPC=a}),98);
__d("WASmaxInPreKeysNotificationDigestRequest",["WAResultOrError","WASmaxInPreKeysServerNotificationMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"digest");if(!b.success)return b;b=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrDomainJid,a,"from","s.whatsapp.net");if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","encrypt");if(!c.success)return c;a=d("WASmaxInPreKeysServerNotificationMixin").parseServerNotificationMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({from:b.value,type:c.value},a.value))}g.parseNotificationDigestRequest=a}),98);
__d("WASmaxOutPreKeysNotificationDigestResponseAck",["WASmaxJsx","WASmaxOutPreKeysNotificationClientAckMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutPreKeysNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",null),a);return a}g.makeNotificationDigestResponseAck=a}),98);
__d("WASmaxPreKeysNotificationDigestRPC",["WASmaxInPreKeysNotificationDigestRequest","WASmaxOutPreKeysNotificationDigestResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInPreKeysNotificationDigestRequest").parseNotificationDigestRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("NotificationDigest",{Request:b}));return{parsedRequest:b.value,makeNotificationDigestResponseAck:function(){return d("WASmaxOutPreKeysNotificationDigestResponseAck").makeNotificationDigestResponseAck(a)}}}g.receiveNotificationDigestRPC=a}),98);
__d("WASmaxInPreKeysNotificationLowCountRequest",["WAResultOrError","WASmaxInPreKeysServerNotificationMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"count");if(!b.success)return b;var c=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrDomainJid,a,"from","s.whatsapp.net");if(!c.success)return c;var e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","encrypt");if(!e.success)return e;b=d("WASmaxParseUtils").attrIntRange(b.value,"value",0,100);if(!b.success)return b;a=d("WASmaxInPreKeysServerNotificationMixin").parseServerNotificationMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({from:c.value,type:e.value,countValue:b.value},a.value))}g.parseNotificationLowCountRequest=a}),98);
__d("WASmaxOutPreKeysNotificationLowCountResponseAck",["WASmaxJsx","WASmaxOutPreKeysNotificationClientAckMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutPreKeysNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",null),a);return a}g.makeNotificationLowCountResponseAck=a}),98);
__d("WASmaxPreKeysNotificationLowCountRPC",["WASmaxInPreKeysNotificationLowCountRequest","WASmaxOutPreKeysNotificationLowCountResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInPreKeysNotificationLowCountRequest").parseNotificationLowCountRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("NotificationLowCount",{Request:b}));return{parsedRequest:b.value,makeNotificationLowCountResponseAck:function(){return d("WASmaxOutPreKeysNotificationLowCountResponseAck").makeNotificationLowCountResponseAck(a)}}}g.receiveNotificationLowCountRPC=a}),98);
__d("WACreateHandleEncryptNotificationBranch",["Promise","WALogger","WAResultOrError","WASmaxDecisionTreeUtils","WASmaxPreKeysNotificationContactIDChangedRPC","WASmaxPreKeysNotificationDigestRPC","WASmaxPreKeysNotificationLowCountRPC","WATimeUtils","WAUnknownStanzaError"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["parseEncryptNotification notification without children"]);i=function(){return a};return a}function a(a){a=(a=a.prekey)!=null?a:{};var c=a.handlePrekeyLowCountNotification,e=a.handlePrekeyDigestNotification,f=a.handlePrekeyContactIDChangedNotification;return function(a){var g=d("WASmaxDecisionTreeUtils").firstChild(a);if(g.success===!1){d("WALogger").ERROR(i());return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError)}g=g.value.tag;switch(g){case"count":if(c!=null){var j=d("WASmaxPreKeysNotificationLowCountRPC").receiveNotificationLowCountRPC(a),k=j.makeNotificationLowCountResponseAck;j=j.parsedRequest;var l=j.t,m=j.offline;j=j.id;l=d("WATimeUtils").castToUnixTime(l);return c({makeAck:k,id:j,offline:m,serverTs:l,encryptType:g}).then(d("WAResultOrError").makeResult)}break;case"digest":if(e!=null){k=d("WASmaxPreKeysNotificationDigestRPC").receiveNotificationDigestRPC(a);j=k.makeNotificationDigestResponseAck;m=k.parsedRequest;l=m.t;k=m.offline;m=m.id;l=d("WATimeUtils").castToUnixTime(l);return e({makeAck:j,id:m,offline:k,serverTs:l,encryptType:g}).then(d("WAResultOrError").makeResult)}break;case"identity":if(f!=null){j=d("WASmaxPreKeysNotificationContactIDChangedRPC").receiveNotificationContactIDChangedRPC(a);m=j.makeNotificationContactIDChangedResponseAck;k=j.parsedRequest;l=k.t;a=k.offline;j=k.id;k=d("WATimeUtils").castToUnixTime(l);return f({makeAck:m,id:j,offline:a,serverTs:k,encryptType:g}).then(d("WAResultOrError").makeResult)}break}return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError)}}g.createHandleEncryptNotification=a}),98);
__d("WAHandleFbDeviceChangeNotificationProtocol",["WAICDCUtils","WAResultOrError","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a.dhash}function b(a){var b;b=((b=a.iCDCDirtyMixin)==null?void 0:b.dirty)==="true";var c=d("WATimeUtils").castToUnixTime(a.ts),e=a.seq;a=d("WAICDCUtils").decodeICDCInfo(a.elementValue);e=d("WAICDCUtils").validateAndPrepareICDCFromNotification(e,b,c,a);return e==null?d("WAResultOrError").makeError("icdc-validation-failure"):d("WAResultOrError").makeResult(e)}g.parseDhash=a;g.parseICDCFromServer=b}),98);
__d("WASmaxInDevicesDeviceModelInfoMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"platform");if(!b.success)return b;b=d("WASmaxParseUtils").contentString(a);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"model");if(!b.success)return b;b=d("WASmaxParseUtils").contentString(a);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}function a(a){var b=d("WASmaxParseUtils").optionalChildWithTag(a,"platform",h);if(!b.success)return b;a=d("WASmaxParseUtils").optionalChildWithTag(a,"model",i);return!a.success?a:d("WAResultOrError").makeResult({platform:b.value,model:a.value})}g.parseDeviceModelInfoPlatform=h;g.parseDeviceModelInfoModel=i;g.parseDeviceModelInfoMixin=a}),98);
__d("WASmaxInDevicesDhashMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrString(a,"dhash");return!a.success?a:d("WAResultOrError").makeResult({dhash:a.value})}g.parseDhashMixin=a}),98);
__d("WASmaxInDevicesKeyDataMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").contentBytesRange(a,32,32);return!a.success?a:d("WAResultOrError").makeResult({elementValue:a.value})}g.parseKeyDataMixin=a}),98);
__d("WASmaxInDevicesIdentityKeyMixin",["WASmaxInDevicesKeyDataMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"identity");if(!a.success)return a;a=d("WASmaxInDevicesKeyDataMixin").parseKeyDataMixin(a.value);return!a.success?a:a}g.parseIdentityKeyMixin=a}),98);
__d("WASmaxInDevicesDeviceListMixin",["WAResultOrError","WASmaxInDevicesDeviceModelInfoMixin","WASmaxInDevicesDhashMixin","WASmaxInDevicesIdentityKeyMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"device");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"id",1,999);if(!b.success)return b;var c=d("WASmaxInDevicesIdentityKeyMixin").parseIdentityKeyMixin(a);if(!c.success)return c;a=d("WASmaxInDevicesDeviceModelInfoMixin").parseDeviceModelInfoMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({id:b.value},c.value,{deviceModelInfoMixin:a.success?a.value:null}))}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"devices");if(!b.success)return b;b=d("WASmaxInDevicesDhashMixin").parseDhashMixin(a);a=d("WASmaxParseUtils").mapChildrenWithTag(a,"device",0,25,h);return!a.success?a:d("WAResultOrError").makeResult({dhashMixin:b.success?b.value:null,device:a.value})}g.parseDeviceListDevice=h;g.parseDeviceListMixin=a}),98);
__d("WASmaxInDevicesICDCDirtyMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"icdc");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"dirty","true");return!b.success?b:d("WAResultOrError").makeResult({dirty:b.value})}g.parseICDCDirtyMixin=a}),98);
__d("WASmaxInDevicesICDCSeqMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrIntRange(a,"seq",0,2147483647);return!a.success?a:d("WAResultOrError").makeResult({seq:a.value})}g.parseICDCSeqMixin=a}),98);
__d("WASmaxInDevicesICDCSignedListMixin",["WAResultOrError","WASmaxInDevicesICDCSeqMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"icdc");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"ts",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").contentBytesRange(a,1,40072);if(!c.success)return c;a=d("WASmaxInDevicesICDCSeqMixin").parseICDCSeqMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({ts:b.value,elementValue:c.value},a.value))}g.parseICDCSignedListMixin=a}),98);
__d("WASmaxInDevicesICDCFromServerMixin",["WAResultOrError","WASmaxInDevicesICDCDirtyMixin","WASmaxInDevicesICDCSignedListMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"icdc");if(!b.success)return b;b=d("WASmaxInDevicesICDCSignedListMixin").parseICDCSignedListMixin(a);if(!b.success)return b;a=d("WASmaxInDevicesICDCDirtyMixin").parseICDCDirtyMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{iCDCDirtyMixin:a.success?a.value:null}))}g.parseICDCFromServerMixin=a}),98);
__d("WASmaxInDevicesServerNotificationMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"offline",0,1024);return!a.success?a:d("WAResultOrError").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);
__d("WASmaxInDevicesChangeNotificationRequest",["WAResultOrError","WASmaxInDevicesDeviceListMixin","WASmaxInDevicesICDCFromServerMixin","WASmaxInDevicesServerNotificationMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"devices");if(!b.success)return b;b=d("WASmaxInDevicesDeviceListMixin").parseDeviceListMixin(a);return!b.success?b:b}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"icdc");if(!b.success)return b;b=d("WASmaxInDevicesICDCFromServerMixin").parseICDCFromServerMixin(a);return!b.success?b:b}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"devices",h);if(!b.success)return b;var c=d("WASmaxParseUtils").optionalChildWithTag(a,"icdc",i);if(!c.success)return c;var e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","fbid:devices");if(!e.success)return e;var f=d("WASmaxParseJid").attrUserJid(a,"from");if(!f.success)return f;a=d("WASmaxInDevicesServerNotificationMixin").parseServerNotificationMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({type:e.value,from:f.value},a.value,{devices:b.value,icdc:c.value}))}g.parseChangeNotificationRequestDevices=h;g.parseChangeNotificationRequestIcdc=i;g.parseChangeNotificationRequest=a}),98);
__d("WASmaxOutDevicesNotificationClientAckMixin",["WASmaxJsx","WASmaxMixins","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrUserJid,a,["from"]);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);a=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{id:d("WAWap").STANZA_ID(b.value),to:d("WAWap").USER_JID(c.value),"class":"notification",type:d("WAWap").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNotificationClientAckMixin=a}),98);
__d("WASmaxOutDevicesChangeNotificationResponseAck",["WASmaxJsx","WASmaxOutDevicesNotificationClientAckMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutDevicesNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",null),a);return a}g.makeChangeNotificationResponseAck=a}),98);
__d("WASmaxDevicesChangeNotificationRPC",["WASmaxInDevicesChangeNotificationRequest","WASmaxOutDevicesChangeNotificationResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInDevicesChangeNotificationRequest").parseChangeNotificationRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("ChangeNotification",{Request:b}));return{parsedRequest:b.value,makeChangeNotificationResponseAck:function(){return d("WASmaxOutDevicesChangeNotificationResponseAck").makeChangeNotificationResponseAck(a)}}}g.receiveChangeNotificationRPC=a}),98);
__d("WACreateHandleFbDeviceChangeNotificationBranch",["WAHandleFbDeviceChangeNotificationProtocol","WAJids","WAResultOrError","WASignalKeys","WASmaxDevicesChangeNotificationRPC","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return function(b,c){var e;b=d("WASmaxDevicesChangeNotificationRPC").receiveChangeNotificationRPC(b);var f=b.makeChangeNotificationResponseAck;b=b.parsedRequest;var g=b.from,h=b.devices,i=b.t,j=b.id,k=b.icdc;b=b.offline;e=((e=h==null?void 0:h.device)!=null?e:[]).map(function(a){var b;return{device:d("WAJids").toDeviceJid(g,d("WAJids").interpretAsDeviceId(a.id)),identity:d("WASignalKeys").serializeIdentity(a.elementValue),platform:(b=a.deviceModelInfoMixin)==null?void 0:(b=b.platform)==null?void 0:b.elementValue,model:(b=a.deviceModelInfoMixin)==null?void 0:(a=b.model)==null?void 0:a.elementValue}});h=h==null?void 0:h.dhashMixin;k=k==null?null:d("WAHandleFbDeviceChangeNotificationProtocol").parseICDCFromServer(k);return a({devices:e,userJid:g,offline:b,serverTs:d("WATimeUtils").castToUnixTime(i),id:j,dhash:h==null?null:d("WAHandleFbDeviceChangeNotificationProtocol").parseDhash(h),icdcInfo:(k==null?void 0:k.success)?k.value:null,makeAck:f,ctx:{cryptoManager:c}}).then(d("WAResultOrError").makeResult)}}g.createHandleFbDeviceChangeNotification=a}),98);
__d("WACreateHandleFbMultiwayNotificationBranch",["WAResultOrError","WASmaxMultiwaydMultiwayNotificationRPC","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return function(b){b=d("WASmaxMultiwaydMultiwayNotificationRPC").receiveMultiwayNotificationRPC(b);var c=b.makeMultiwayNotificationResponseAck;b=b.parsedRequest;var e=b.from,f=b.multiwayTransactionId,g=b.multiwayBinaryVersion,h=b.multiwayElementValue,i=b.t,j=b.id;b=b.offline;return a({domainJid:e,multiwayTransactionId:f,multiwayBinaryVersion:g,multiwayElementValue:h,offline:b,serverTs:d("WATimeUtils").castToUnixTime(i),id:j,makeAck:c}).then(d("WAResultOrError").makeResult)}}g.createHandleFbMultiwayNotification=a}),98);
__d("WASmaxInMessageRequestConnectedMixin",["WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"thread_actions");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"connected");return!b.success?b:d("WASmaxParseUtils").voidSuccess}g.parseConnectedMixin=a}),98);
__d("WASmaxInMessageRequestFolderIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrInt(a,"folder_id");return!a.success?a:d("WAResultOrError").makeResult({folderId:a.value})}g.parseFolderIDMixin=a}),98);
__d("WASmaxInMessageRequestFolderMixin",["WASmaxInMessageRequestFolderIDMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"thread_actions");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"folder");if(!b.success)return b;a=d("WASmaxInMessageRequestFolderIDMixin").parseFolderIDMixin(b.value);return!a.success?a:a}g.parseFolderMixin=a}),98);
__d("WASmaxInMessageRequestServerNotificationMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"offline",0,1024);return!a.success?a:d("WAResultOrError").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);
__d("WASmaxInMessageRequestThreadNotificationRequest",["WAResultOrError","WASmaxInMessageRequestConnectedMixin","WASmaxInMessageRequestFolderMixin","WASmaxInMessageRequestServerNotificationMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"thread_actions");if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","fbid:thread");if(!c.success)return c;var e=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrDomainJid,a,"from","s.whatsapp.net");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"to");if(!f.success)return f;var g=d("WASmaxParseUtils").attrString(b.value,"thread_id");if(!g.success)return g;var h=d("WASmaxInMessageRequestFolderMixin").parseFolderMixin(b.value);b=d("WASmaxInMessageRequestConnectedMixin").parseConnectedMixin(b.value);a=d("WASmaxInMessageRequestServerNotificationMixin").parseServerNotificationMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({type:c.value,from:e.value,to:f.value,threadActionsThreadId:g.value,threadActionsFolderMixin:h.success?h.value:null,hasThreadActionsConnectedMixin:b.success},a.value))}g.parseThreadNotificationRequest=a}),98);
__d("WASmaxOutMessageRequestNotificationClientAckMixin",["WASmaxJsx","WASmaxMixins","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrDomainJid,a,["from"]);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);a=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{id:d("WAWap").STANZA_ID(b.value),to:d("WAWap").DOMAIN_JID(c.value),"class":"notification",type:d("WAWap").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNotificationClientAckMixin=a}),98);
__d("WASmaxOutMessageRequestThreadNotificationResponseAck",["WASmaxJsx","WASmaxOutMessageRequestNotificationClientAckMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutMessageRequestNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",null),a);return a}g.makeThreadNotificationResponseAck=a}),98);
__d("WASmaxMessageRequestThreadNotificationRPC",["WASmaxInMessageRequestThreadNotificationRequest","WASmaxOutMessageRequestThreadNotificationResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageRequestThreadNotificationRequest").parseThreadNotificationRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("ThreadNotification",{Request:b}));return{parsedRequest:b.value,makeThreadNotificationResponseAck:function(){return d("WASmaxOutMessageRequestThreadNotificationResponseAck").makeThreadNotificationResponseAck(a)}}}g.receiveThreadNotificationRPC=a}),98);
__d("WACreateHandleFbThreadNotificationBranch",["WAGlobals","WAJids","WAResultOrError","WASmaxMessageRequestThreadNotificationRPC","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return function(b){b=d("WASmaxMessageRequestThreadNotificationRPC").receiveThreadNotificationRPC(b);var c=b.makeThreadNotificationResponseAck;b=b.parsedRequest;var e=b.id,f=b.threadActionsThreadId,g=b.t,h=b.threadActionsFolderMixin,i=b.offline;b=b.hasThreadActionsConnectedMixin;var j;f.endsWith("@g.us")?j=d("WAJids").toGroupJid(f):j=d("WAGlobals").getJidUtilsApi().toUserJid(f);return a({id:e,serverTs:d("WATimeUtils").castToUnixTime(g),chatJid:j,offline:i,folderId:h==null?void 0:h.folderId,hasConnected:b,makeAck:c}).then(d("WAResultOrError").makeResult)}}g.createHandleFbThreadNotification=a}),98);
__d("WASmaxInGroupsServerNotificationMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"offline",0,1024);return!a.success?a:d("WAResultOrError").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);
__d("WASmaxInGroupsCommonNotificationMixin",["WAResultOrError","WASmaxInGroupsServerNotificationMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseJid").attrGroupJid(a,"from");if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","w:gp2");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"notify");if(!e.success)return e;a=d("WASmaxInGroupsServerNotificationMixin").parseServerNotificationMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({from:b.value,type:c.value,notify:e.value},a.value))}g.parseCommonNotificationMixin=a}),98);
__d("WASmaxInGroupsParticipantWithJidMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"jid");return!b.success?b:d("WAResultOrError").makeResult({jid:b.value})}g.parseParticipantWithJidMixin=a}),98);
__d("WASmaxInGroupsParticipantWithLidMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"lid");return!b.success?b:d("WAResultOrError").makeResult({lid:b.value})}g.parseParticipantWithLidMixin=a}),98);
__d("WASmaxInGroupsParticipantWithJidAndLidMixin",["WAResultOrError","WASmaxInGroupsParticipantWithJidMixin","WASmaxInGroupsParticipantWithLidMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxInGroupsParticipantWithJidMixin").parseParticipantWithJidMixin(a);if(!b.success)return b;a=d("WASmaxInGroupsParticipantWithLidMixin").parseParticipantWithLidMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,a.value))}g.parseParticipantWithJidAndLidMixin=a}),98);
__d("WASmaxInGroupsParticipantWithJidAndPnMixin",["WAResultOrError","WASmaxInGroupsParticipantWithJidMixin","WASmaxInGroupsPhoneNumberMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxInGroupsParticipantWithJidMixin").parseParticipantWithJidMixin(a);if(!b.success)return b;a=d("WASmaxInGroupsPhoneNumberMixin").parsePhoneNumberMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,a.value))}g.parseParticipantWithJidAndPnMixin=a}),98);
__d("WASmaxInGroupsDisplayNameMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrString(a,"display_name");return!a.success?a:d("WAResultOrError").makeResult({displayName:a.value})}g.parseDisplayNameMixin=a}),98);
__d("WASmaxInGroupsParticipantWithJidContainingLidAndDisplayNameMixin",["WAResultOrError","WASmaxInGroupsDisplayNameMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"jid");if(!b.success)return b;a=d("WASmaxInGroupsDisplayNameMixin").parseDisplayNameMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({jid:b.value},a.value))}g.parseParticipantWithJidContainingLidAndDisplayNameMixin=a}),98);
__d("WASmaxInGroupsParticipantWithJidLidAndDisplayNameMixin",["WAResultOrError","WASmaxInGroupsDisplayNameMixin","WASmaxInGroupsParticipantWithJidAndLidMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxInGroupsParticipantWithJidAndLidMixin").parseParticipantWithJidAndLidMixin(a);if(!b.success)return b;a=d("WASmaxInGroupsDisplayNameMixin").parseDisplayNameMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,a.value))}g.parseParticipantWithJidLidAndDisplayNameMixin=a}),98);
__d("WASmaxInGroupsParticipantMixins",["WAResultOrError","WASmaxInGroupsParticipantWithJidAndLidMixin","WASmaxInGroupsParticipantWithJidAndPnMixin","WASmaxInGroupsParticipantWithJidContainingLidAndDisplayNameMixin","WASmaxInGroupsParticipantWithJidLidAndDisplayNameMixin","WASmaxInGroupsParticipantWithJidMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsParticipantWithJidLidAndDisplayNameMixin").parseParticipantWithJidLidAndDisplayNameMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"ParticipantWithJidLidAndDisplayName",value:b.value});var c=d("WASmaxInGroupsParticipantWithJidContainingLidAndDisplayNameMixin").parseParticipantWithJidContainingLidAndDisplayNameMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"ParticipantWithJidContainingLidAndDisplayName",value:c.value});var e=d("WASmaxInGroupsParticipantWithJidAndLidMixin").parseParticipantWithJidAndLidMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"ParticipantWithJidAndLid",value:e.value});var f=d("WASmaxInGroupsParticipantWithJidAndPnMixin").parseParticipantWithJidAndPnMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"ParticipantWithJidAndPn",value:f.value});var g=d("WASmaxInGroupsParticipantWithJidMixin").parseParticipantWithJidMixin(a);return g.success?d("WAResultOrError").makeResult({name:"ParticipantWithJid",value:g.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["ParticipantWithJidLidAndDisplayName","ParticipantWithJidContainingLidAndDisplayName","ParticipantWithJidAndLid","ParticipantWithJidAndPn","ParticipantWithJid"],[b,c,e,f,g])}g.parseParticipantMixins=a}),98);
__d("WASmaxInGroupsParticipantMixin",["WAResultOrError","WASmaxInGroupsParticipantMixins","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxInGroupsParticipantMixins").parseParticipantMixins(a);return!b.success?b:d("WAResultOrError").makeResult({participantMixins:b.value})}g.parseParticipantMixin=a}),98);
__d("WASmaxInGroupsParticipantPhoneNumberMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"participant");if(!b.success)return b;a=d("WASmaxParseJid").attrUserJid(a,"participant_pn");return!a.success?a:d("WAResultOrError").makeResult({participant:b.value,participantPn:a.value})}g.parseParticipantPhoneNumberMixin=a}),98);
__d("WASmaxInGroupsShadowGroupNotificationIndicatorMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,b.value,"shadow","true");return!a.success?a:d("WAResultOrError").makeResult({metaShadow:a.value})}g.parseShadowGroupNotificationIndicatorMixin=a}),98);
__d("WASmaxInGroupsAddNotificationRequest",["WAResultOrError","WASmaxInGroupsCommonNotificationMixin","WASmaxInGroupsEnums","WASmaxInGroupsGroupAddressingModeMixin","WASmaxInGroupsParticipantMixin","WASmaxInGroupsParticipantNotAddressableMixin","WASmaxInGroupsParticipantPhoneNumberMixin","WASmaxInGroupsShadowGroupNotificationIndicatorMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxInGroupsParticipantMixin").parseParticipantMixin(a);if(!b.success)return b;a=d("WASmaxInGroupsParticipantNotAddressableMixin").parseParticipantNotAddressableMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{participantNotAddressableMixin:a.success?a.value:null}))}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"add");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"participant");if(!c.success)return c;var e=d("WASmaxParseUtils").attrString(b.value,"v_id");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,b.value,"prev_v_id");if(!f.success)return f;var g=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,b.value,"reason",d("WASmaxInGroupsEnums").ENUM_ACCEPT_DEFAULTSUBGROUPPROMOTE_INVITE_INVITEAUTOADD_LINKEDGROUPJOIN);if(!g.success)return g;var i=d("WASmaxInGroupsCommonNotificationMixin").parseCommonNotificationMixin(a);if(!i.success)return i;var j=d("WASmaxInGroupsShadowGroupNotificationIndicatorMixin").parseShadowGroupNotificationIndicatorMixin(a),k=d("WASmaxInGroupsGroupAddressingModeMixin").parseGroupAddressingModeMixin(a);a=d("WASmaxInGroupsParticipantPhoneNumberMixin").parseParticipantPhoneNumberMixin(a);b=d("WASmaxParseUtils").mapChildrenWithTag(b.value,"participant",1,1024,h);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({participant:c.value,addVId:e.value,addPrevVId:f.value,addReason:g.value},i.value,{shadowGroupNotificationIndicatorMixin:j.success?j.value:null,groupAddressingModeMixin:k.success?k.value:null,participantPhoneNumberMixin:a.success?a.value:null,addParticipant:b.value}))}g.parseAddNotificationRequestAddParticipant=h;g.parseAddNotificationRequest=a}),98);
__d("WASmaxOutGroupsNotificationClientAckMixin",["WASmaxInGroupsEnums","WASmaxJsx","WASmaxMixins","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrJidEnum,a,["from"],d("WASmaxInGroupsEnums").DOMAINJID_GROUPJID);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);a=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{id:d("WAWap").STANZA_ID(b.value),to:d("WAWap").JID(c.value),"class":"notification",type:d("WAWap").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNotificationClientAckMixin=a}),98);
__d("WASmaxOutGroupsAddNotificationResponseAck",["WASmaxAttrs","WASmaxJsx","WASmaxOutGroupsNotificationClientAckMixin","WASmaxParseJid","WASmaxParseReference","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrUserJid,a,["participant"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);b=d("WASmaxOutGroupsNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",{participant:d("WASmaxAttrs").OPTIONAL(d("WAWap").USER_JID,b.value)}),a);return b}g.makeAddNotificationResponseAck=a}),98);
__d("WASmaxGroupsAddNotificationRPC",["WASmaxInGroupsAddNotificationRequest","WASmaxOutGroupsAddNotificationResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsAddNotificationRequest").parseAddNotificationRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("AddNotification",{Request:b}));return{parsedRequest:b.value,makeAddNotificationResponseAck:function(){return d("WASmaxOutGroupsAddNotificationResponseAck").makeAddNotificationResponseAck(a)}}}g.receiveAddNotificationRPC=a}),98);
__d("WASmaxInGroupsDeleteNotificationRequest",["WAResultOrError","WASmaxInGroupsCommonNotificationMixin","WASmaxInGroupsEnums","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"delete");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"participant");if(!c.success)return c;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,b.value,"reason",d("WASmaxInGroupsEnums").ENUM_DELETEPARENT_INTEGRITYDELETEPARENT);if(!b.success)return b;a=d("WASmaxInGroupsCommonNotificationMixin").parseCommonNotificationMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({participant:c.value,deleteReason:b.value},a.value))}g.parseDeleteNotificationRequest=a}),98);
__d("WASmaxOutGroupsDeleteNotificationResponseAck",["WASmaxAttrs","WASmaxJsx","WASmaxOutGroupsNotificationClientAckMixin","WASmaxParseJid","WASmaxParseReference","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrUserJid,a,["participant"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);b=d("WASmaxOutGroupsNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",{participant:d("WASmaxAttrs").OPTIONAL(d("WAWap").USER_JID,b.value)}),a);return b}g.makeDeleteNotificationResponseAck=a}),98);
__d("WASmaxGroupsDeleteNotificationRPC",["WASmaxInGroupsDeleteNotificationRequest","WASmaxOutGroupsDeleteNotificationResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsDeleteNotificationRequest").parseDeleteNotificationRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("DeleteNotification",{Request:b}));return{parsedRequest:b.value,makeDeleteNotificationResponseAck:function(){return d("WASmaxOutGroupsDeleteNotificationResponseAck").makeDeleteNotificationResponseAck(a)}}}g.receiveDeleteNotificationRPC=a}),98);
__d("WASmaxInGroupsDemoteNotificationRequest",["WAResultOrError","WASmaxInGroupsCommonNotificationMixin","WASmaxInGroupsGroupAddressingModeMixin","WASmaxInGroupsParticipantMixins","WASmaxInGroupsParticipantPhoneNumberMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxInGroupsParticipantMixins").parseParticipantMixins(a);return!b.success?b:d("WAResultOrError").makeResult({participantMixins:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"demote");if(!b.success)return b;var c=d("WASmaxParseJid").attrUserJid(a,"participant");if(!c.success)return c;var e=d("WASmaxParseUtils").attrString(b.value,"v_id");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,b.value,"prev_v_id");if(!f.success)return f;var g=d("WASmaxInGroupsCommonNotificationMixin").parseCommonNotificationMixin(a);if(!g.success)return g;var i=d("WASmaxInGroupsGroupAddressingModeMixin").parseGroupAddressingModeMixin(a);a=d("WASmaxInGroupsParticipantPhoneNumberMixin").parseParticipantPhoneNumberMixin(a);b=d("WASmaxParseUtils").mapChildrenWithTag(b.value,"participant",1,19999,h);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({participant:c.value,demoteVId:e.value,demotePrevVId:f.value},g.value,{groupAddressingModeMixin:i.success?i.value:null,participantPhoneNumberMixin:a.success?a.value:null,demoteParticipant:b.value}))}g.parseDemoteNotificationRequestDemoteParticipant=h;g.parseDemoteNotificationRequest=a}),98);
__d("WASmaxOutGroupsDemoteNotificationResponseAck",["WASmaxJsx","WASmaxOutGroupsNotificationClientAckMixin","WASmaxParseJid","WASmaxParseReference","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrUserJid,a,["participant"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);b=d("WASmaxOutGroupsNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",{participant:d("WAWap").USER_JID(b.value)}),a);return b}g.makeDemoteNotificationResponseAck=a}),98);
__d("WASmaxGroupsDemoteNotificationRPC",["WASmaxInGroupsDemoteNotificationRequest","WASmaxOutGroupsDemoteNotificationResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsDemoteNotificationRequest").parseDemoteNotificationRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("DemoteNotification",{Request:b}));return{parsedRequest:b.value,makeDemoteNotificationResponseAck:function(){return d("WASmaxOutGroupsDemoteNotificationResponseAck").makeDemoteNotificationResponseAck(a)}}}g.receiveDemoteNotificationRPC=a}),98);
__d("WASmaxInGroupsDedupAttrsMixin",["WAResultOrError","WASmaxInGroupsEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").attrString(a,"key");if(!b.success)return b;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a,"create_ctx",d("WASmaxInGroupsEnums").ENUM_E2EEMIGRATION_REGULAR_RTC);return!a.success?a:d("WAResultOrError").makeResult({key:b.value,createCtx:a.value})}g.parseDedupAttrsMixin=a}),98);
__d("WASmaxInGroupsNamedSubjectMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrString(a,"subject");return!a.success?a:d("WAResultOrError").makeResult({subject:a.value})}g.parseNamedSubjectMixin=a}),98);
__d("WASmaxInGroupsUnnamedSubjectFallbackMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"subject");return!a.success?a:d("WAResultOrError").makeResult({subject:a.value})}g.parseUnnamedSubjectFallbackMixin=a}),98);
__d("WASmaxInGroupsNamedSubjectOrUnnamedSubjectFallbackMixinGroup",["WAResultOrError","WASmaxInGroupsNamedSubjectMixin","WASmaxInGroupsUnnamedSubjectFallbackMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsNamedSubjectMixin").parseNamedSubjectMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NamedSubject",value:b.value});var c=d("WASmaxInGroupsUnnamedSubjectFallbackMixin").parseUnnamedSubjectFallbackMixin(a);return c.success?d("WAResultOrError").makeResult({name:"UnnamedSubjectFallback",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["NamedSubject","UnnamedSubjectFallback"],[b,c])}g.parseNamedSubjectOrUnnamedSubjectFallbackMixinGroup=a}),98);
__d("WASmaxInGroupsGroupInfoAttributesMixin",["WAResultOrError","WASmaxInGroupsGroupAddressingModeMixin","WASmaxInGroupsNamedSubjectOrUnnamedSubjectFallbackMixinGroup","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"group");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"id");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"creator");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"creator_pn");if(!e.success)return e;var f=d("WASmaxParseUtils").attrIntRange(a,"creation",0,void 0);if(!f.success)return f;var g=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"p_v_id");if(!g.success)return g;var h=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"a_v_id");if(!h.success)return h;var i=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"s_t",0,void 0);if(!i.success)return i;var j=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"s_o");if(!j.success)return j;var k=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"s_o_pn");if(!k.success)return k;var l=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"open_thread_id");if(!l.success)return l;var m=d("WASmaxInGroupsGroupAddressingModeMixin").parseGroupAddressingModeMixin(a);a=d("WASmaxInGroupsNamedSubjectOrUnnamedSubjectFallbackMixinGroup").parseNamedSubjectOrUnnamedSubjectFallbackMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({id:b.value,creator:c.value,creatorPn:e.value,creation:f.value,pVId:g.value,aVId:h.value,sT:i.value,sO:j.value,sOPn:k.value,openThreadId:l.value,groupAddressingModeMixin:m.success?m.value:null,namedSubjectOrUnnamedSubjectFallbackMixinGroup:a.value})}g.parseGroupInfoAttributesMixin=a}),98);
__d("WASmaxInGroupsGroupInfoDescriptionMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"description");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"body");if(!b.success)return b;var c=d("WASmaxParseUtils").attrString(a,"id");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"participant");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"participant_pn");if(!f.success)return f;a=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!a.success)return a;b=d("WASmaxParseUtils").contentString(b.value);return!b.success?b:d("WAResultOrError").makeResult({id:c.value,participant:e.value,participantPn:f.value,t:a.value,bodyElementValue:b.value})}g.parseGroupInfoDescriptionMixin=a}),98);
__d("WASmaxInGroupsGroupInfoParticipantAdminMixins",["WAResultOrError","WASmaxInGroupsParticipantWithJidAndLidMixin","WASmaxInGroupsParticipantWithJidAndPnMixin","WASmaxInGroupsParticipantWithJidLidAndDisplayNameMixin","WASmaxInGroupsParticipantWithJidMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsParticipantWithJidLidAndDisplayNameMixin").parseParticipantWithJidLidAndDisplayNameMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"ParticipantWithJidLidAndDisplayName",value:b.value});var c=d("WASmaxInGroupsParticipantWithJidAndLidMixin").parseParticipantWithJidAndLidMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"ParticipantWithJidAndLid",value:c.value});var e=d("WASmaxInGroupsParticipantWithJidAndPnMixin").parseParticipantWithJidAndPnMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"ParticipantWithJidAndPn",value:e.value});var f=d("WASmaxInGroupsParticipantWithJidMixin").parseParticipantWithJidMixin(a);return f.success?d("WAResultOrError").makeResult({name:"ParticipantWithJid",value:f.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["ParticipantWithJidLidAndDisplayName","ParticipantWithJidAndLid","ParticipantWithJidAndPn","ParticipantWithJid"],[b,c,e,f])}g.parseGroupInfoParticipantAdminMixins=a}),98);
__d("WASmaxInGroupsGroupInfoParticipantAdminMixin",["WAResultOrError","WASmaxInGroupsEnums","WASmaxInGroupsGroupInfoParticipantAdminMixins","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxParseUtils").attrStringEnum(a,"type",d("WASmaxInGroupsEnums").ENUM_ADMIN_SUPERADMIN);if(!b.success)return b;a=d("WASmaxInGroupsGroupInfoParticipantAdminMixins").parseGroupInfoParticipantAdminMixins(a);return!a.success?a:d("WAResultOrError").makeResult({type:b.value,groupInfoParticipantAdminMixins:a.value})}g.parseGroupInfoParticipantAdminMixin=a}),98);
__d("WASmaxInGroupsGroupInfoParticipantNonAdminMixin",["WASmaxInGroupsParticipantMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxInGroupsParticipantMixin").parseParticipantMixin(a);return!b.success?b:b}g.parseGroupInfoParticipantNonAdminMixin=a}),98);
__d("WASmaxInGroupsGroupInfoParticipantMixins",["WAResultOrError","WASmaxInGroupsGroupInfoParticipantAdminMixin","WASmaxInGroupsGroupInfoParticipantNonAdminMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsGroupInfoParticipantAdminMixin").parseGroupInfoParticipantAdminMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"GroupInfoParticipantAdmin",value:b.value});var c=d("WASmaxInGroupsGroupInfoParticipantNonAdminMixin").parseGroupInfoParticipantNonAdminMixin(a);return c.success?d("WAResultOrError").makeResult({name:"GroupInfoParticipantNonAdmin",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["GroupInfoParticipantAdmin","GroupInfoParticipantNonAdmin"],[b,c])}g.parseGroupInfoParticipantMixins=a}),98);
__d("WASmaxInGroupsGroupInfoParticipantMixin",["WAResultOrError","WASmaxInGroupsGroupInfoParticipantMixins","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxInGroupsGroupInfoParticipantMixins").parseGroupInfoParticipantMixins(a);return!b.success?b:d("WAResultOrError").makeResult({groupInfoParticipantMixins:b.value})}g.parseGroupInfoParticipantMixin=a}),98);
__d("WASmaxInGroupsAdminAddModeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"member_add_mode");if(!b.success)return b;b=d("WASmaxParseUtils").literalContent(d("WASmaxParseUtils").contentString,a,"admin_add");return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}g.parseAdminAddModeMixin=a}),98);
__d("WASmaxInGroupsAllMembersAddModeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"member_add_mode");if(!b.success)return b;b=d("WASmaxParseUtils").literalContent(d("WASmaxParseUtils").contentString,a,"all_member_add");return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}g.parseAllMembersAddModeMixin=a}),98);
__d("WASmaxInGroupsUnknownAddModeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"member_add_mode");if(!b.success)return b;b=d("WASmaxParseUtils").contentString(a);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}g.parseUnknownAddModeMixin=a}),98);
__d("WASmaxInGroupsAdminOrAllMembersOrUnknownAddModeMixinGroup",["WAResultOrError","WASmaxInGroupsAdminAddModeMixin","WASmaxInGroupsAllMembersAddModeMixin","WASmaxInGroupsUnknownAddModeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsAdminAddModeMixin").parseAdminAddModeMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"AdminAddMode",value:b.value});var c=d("WASmaxInGroupsAllMembersAddModeMixin").parseAllMembersAddModeMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"AllMembersAddMode",value:c.value});var e=d("WASmaxInGroupsUnknownAddModeMixin").parseUnknownAddModeMixin(a);return e.success?d("WAResultOrError").makeResult({name:"UnknownAddMode",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["AdminAddMode","AllMembersAddMode","UnknownAddMode"],[b,c,e])}g.parseAdminOrAllMembersOrUnknownAddModeMixinGroup=a}),98);
__d("WASmaxInGroupsGroupMemberAddModeMixin",["WAResultOrError","WASmaxInGroupsAdminOrAllMembersOrUnknownAddModeMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"member_add_mode");if(!a.success)return a;a=d("WASmaxInGroupsAdminOrAllMembersOrUnknownAddModeMixinGroup").parseAdminOrAllMembersOrUnknownAddModeMixinGroup(a.value);return!a.success?a:d("WAResultOrError").makeResult({memberAddModeAdminOrAllMembersOrUnknownAddModeMixinGroup:a.value})}g.parseGroupMemberAddModeMixin=a}),98);
__d("WASmaxInGroupsGroupJoinMembershipApprovalModeEnabledMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"group_join");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"state","on");return!b.success?b:d("WAResultOrError").makeResult({state:b.value})}g.parseGroupJoinMembershipApprovalModeEnabledMixin=a}),98);
__d("WASmaxInGroupsMembershipApprovalGroupJoinModeEnabledMixin",["WASmaxInGroupsGroupJoinMembershipApprovalModeEnabledMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"membership_approval_mode");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"group_join");if(!b.success)return b;a=d("WASmaxInGroupsGroupJoinMembershipApprovalModeEnabledMixin").parseGroupJoinMembershipApprovalModeEnabledMixin(b.value);return!a.success?a:a}g.parseMembershipApprovalGroupJoinModeEnabledMixin=a}),98);
__d("WASmaxInGroupsParentGroupDefaultMembershipApprovalModeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"parent");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"default_membership_approval_mode","request_required");return!b.success?b:d("WAResultOrError").makeResult({defaultMembershipApprovalMode:b.value})}g.parseParentGroupDefaultMembershipApprovalModeMixin=a}),98);
__d("WASmaxInGroupsGroupInfoMixin",["WAResultOrError","WASmaxInGroupsEnums","WASmaxInGroupsGroupInfoAttributesMixin","WASmaxInGroupsGroupInfoDescriptionMixin","WASmaxInGroupsGroupInfoParticipantMixin","WASmaxInGroupsGroupMemberAddModeMixin","WASmaxInGroupsMembershipApprovalGroupJoinModeEnabledMixin","WASmaxInGroupsParentGroupDefaultMembershipApprovalModeMixin","WASmaxInGroupsParticipantNotAddressableMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxInGroupsGroupInfoParticipantMixin").parseGroupInfoParticipantMixin(a);if(!b.success)return b;a=d("WASmaxInGroupsParticipantNotAddressableMixin").parseParticipantNotAddressableMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{participantNotAddressableMixin:a.success?a.value:null}))}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"description");if(!b.success)return b;b=d("WASmaxInGroupsGroupInfoDescriptionMixin").parseGroupInfoDescriptionMixin(a);return d("WAResultOrError").makeResult({groupInfoDescriptionMixin:b.success?b.value:null})}function j(a){var b=d("WASmaxParseUtils").assertTag(a,"parent");if(!b.success)return b;b=d("WASmaxInGroupsParentGroupDefaultMembershipApprovalModeMixin").parseParentGroupDefaultMembershipApprovalModeMixin(a);return d("WAResultOrError").makeResult({parentGroupDefaultMembershipApprovalModeMixin:b.success?b.value:null})}function k(a){var b=d("WASmaxParseUtils").assertTag(a,"ephemeral");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"expiration",0,2147483647);if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a,"trigger",d("WASmaxInGroupsEnums").ENUM_ACCOUNTSETTING_BULKCHANGE_CHATSETTING);if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a,"initiated_by_me",d("WASmaxInGroupsEnums").ENUM_FALSE_TRUE);return!a.success?a:d("WAResultOrError").makeResult({expiration:b.value,trigger:c.value,initiatedByMe:a.value})}function l(a){var b=d("WASmaxParseUtils").assertTag(a,"growth_locked");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","invite");if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(a,"expiration",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({type:b.value,expiration:a.value})}function m(a){var b=d("WASmaxParseUtils").assertTag(a,"membership_approval_mode");if(!b.success)return b;b=d("WASmaxInGroupsMembershipApprovalGroupJoinModeEnabledMixin").parseMembershipApprovalGroupJoinModeEnabledMixin(a);return d("WAResultOrError").makeResult({membershipApprovalGroupJoinModeEnabledMixin:b.success?b.value:null})}function n(a){var b=d("WASmaxParseUtils").assertTag(a,"linked_parent");if(!b.success)return b;b=d("WASmaxParseJid").attrGroupJid(a,"jid");return!b.success?b:d("WAResultOrError").makeResult({jid:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"group");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"description",i);if(!b.success)return b;var c=d("WASmaxParseUtils").optionalChild(a,"locked");if(!c.success)return c;var e=d("WASmaxParseUtils").optionalChild(a,"announcement");if(!e.success)return e;var f=d("WASmaxParseUtils").optionalChildWithTag(a,"parent",j);if(!f.success)return f;var g=d("WASmaxParseUtils").optionalChild(a,"no_frequently_forwarded");if(!g.success)return g;var o=d("WASmaxParseUtils").optionalChild(a,"support");if(!o.success)return o;var p=d("WASmaxParseUtils").optionalChildWithTag(a,"ephemeral",k);if(!p.success)return p;var q=d("WASmaxParseUtils").optionalChild(a,"suspended");if(!q.success)return q;var r=d("WASmaxParseUtils").optionalChildWithTag(a,"growth_locked",l);if(!r.success)return r;var s=d("WASmaxParseUtils").optionalChild(a,"default_sub_group");if(!s.success)return s;var t=d("WASmaxParseUtils").optionalChild(a,"shadow");if(!t.success)return t;var u=d("WASmaxParseUtils").optionalChildWithTag(a,"membership_approval_mode",m);if(!u.success)return u;var v=d("WASmaxParseUtils").optionalChild(a,"incognito");if(!v.success)return v;var w=d("WASmaxParseUtils").optionalChild(a,"allow_admin_reports");if(!w.success)return w;var x=d("WASmaxParseUtils").optionalChild(a,"allow_non_admin_sub_group_creation");if(!x.success)return x;var y=d("WASmaxParseUtils").optionalChild(a,"general_chat");if(!y.success)return y;var z=d("WASmaxParseUtils").optionalChild(a,"auto_add_disabled");if(!z.success)return z;var A=d("WASmaxParseUtils").optionalChild(a,"group_history");if(!A.success)return A;var B=d("WASmaxParseUtils").optionalChildWithTag(a,"linked_parent",n);if(!B.success)return B;var C=d("WASmaxParseUtils").optionalChild(a,"capi");if(!C.success)return C;var D=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,a,"ack","false");if(!D.success)return D;var E=d("WASmaxInGroupsGroupInfoAttributesMixin").parseGroupInfoAttributesMixin(a);if(!E.success)return E;var F=d("WASmaxInGroupsGroupMemberAddModeMixin").parseGroupMemberAddModeMixin(a);a=d("WASmaxParseUtils").mapChildrenWithTag(a,"participant",0,19999,h);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({ack:D.value},E.value,{groupMemberAddModeMixin:F.success?F.value:null,description:b.value,hasLocked:c.value!=null,hasAnnouncement:e.value!=null,parent:f.value,hasNoFrequentlyForwarded:g.value!=null,hasSupport:o.value!=null,ephemeral:p.value,hasSuspended:q.value!=null,growthLocked:r.value,hasDefaultSubGroup:s.value!=null,hasShadow:t.value!=null,membershipApprovalMode:u.value,hasIncognito:v.value!=null,hasAllowAdminReports:w.value!=null,hasAllowNonAdminSubGroupCreation:x.value!=null,hasGeneralChat:y.value!=null,hasAutoAddDisabled:z.value!=null,hasGroupHistory:A.value!=null,linkedParent:B.value,hasCapi:C.value!=null,participant:a.value}))}g.parseGroupInfoParticipant=h;g.parseGroupInfoDescription=i;g.parseGroupInfoParent=j;g.parseGroupInfoEphemeral=k;g.parseGroupInfoGrowthLocked=l;g.parseGroupInfoMembershipApprovalMode=m;g.parseGroupInfoLinkedParent=n;g.parseGroupInfoMixin=a}),98);
__d("WASmaxInGroupsOptionalContextGroupMixin",["WAResultOrError","WASmaxParseJid"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseJid").attrGroupJid(a,"context_group_jid");return!a.success?a:d("WAResultOrError").makeResult({contextGroupJid:a.value})}g.parseOptionalContextGroupMixin=a}),98);
__d("WASmaxInGroupsJoinNotificationRequest",["WAResultOrError","WASmaxInGroupsCommonNotificationMixin","WASmaxInGroupsDedupAttrsMixin","WASmaxInGroupsEnums","WASmaxInGroupsGroupAddressingModeMixin","WASmaxInGroupsGroupInfoMixin","WASmaxInGroupsOptionalContextGroupMixin","WASmaxInGroupsParticipantPhoneNumberMixin","WASmaxInGroupsShadowGroupNotificationIndicatorMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"create");if(!b.success)return b;var c=d("WASmaxParseUtils").flattenedChildWithTag(b.value,"group");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"participant");if(!e.success)return e;var f=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,b.value,"type","new");if(!f.success)return f;var g=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,b.value,"reason",d("WASmaxInGroupsEnums").ENUM_ACCEPT_AUTOADD_DEFAULTSUBGROUPADMINADD_GENERALCHATAUTOADD_INVITE_INVITEAUTOADD_LINKEDGROUPJOIN_SUBGROUPSUGGESTIONAPPROVED);if(!g.success)return g;var h=d("WASmaxParseUtils").attrIntRange(c.value,"size",1,19999);if(!h.success)return h;c=d("WASmaxInGroupsGroupInfoMixin").parseGroupInfoMixin(c.value);if(!c.success)return c;var i=d("WASmaxInGroupsOptionalContextGroupMixin").parseOptionalContextGroupMixin(b.value);b=d("WASmaxInGroupsDedupAttrsMixin").parseDedupAttrsMixin(b.value);var j=d("WASmaxInGroupsCommonNotificationMixin").parseCommonNotificationMixin(a);if(!j.success)return j;var k=d("WASmaxInGroupsShadowGroupNotificationIndicatorMixin").parseShadowGroupNotificationIndicatorMixin(a),l=d("WASmaxInGroupsGroupAddressingModeMixin").parseGroupAddressingModeMixin(a);a=d("WASmaxInGroupsParticipantPhoneNumberMixin").parseParticipantPhoneNumberMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({participant:e.value,createType:f.value,createReason:g.value,createGroupSize:h.value,createGroupGroupInfoMixin:c.value,createOptionalContextGroupMixin:i.success?i.value:null,createDedupAttrsMixin:b.success?b.value:null},j.value,{shadowGroupNotificationIndicatorMixin:k.success?k.value:null,groupAddressingModeMixin:l.success?l.value:null,participantPhoneNumberMixin:a.success?a.value:null}))}g.parseJoinNotificationRequest=a}),98);
__d("WASmaxOutGroupsJoinNotificationResponseAck",["WASmaxAttrs","WASmaxJsx","WASmaxOutGroupsNotificationClientAckMixin","WASmaxParseJid","WASmaxParseReference","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrUserJid,a,["participant"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);b=d("WASmaxOutGroupsNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",{participant:d("WASmaxAttrs").OPTIONAL(d("WAWap").USER_JID,b.value)}),a);return b}g.makeJoinNotificationResponseAck=a}),98);
__d("WASmaxGroupsJoinNotificationRPC",["WASmaxInGroupsJoinNotificationRequest","WASmaxOutGroupsJoinNotificationResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsJoinNotificationRequest").parseJoinNotificationRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("JoinNotification",{Request:b}));return{parsedRequest:b.value,makeJoinNotificationResponseAck:function(){return d("WASmaxOutGroupsJoinNotificationResponseAck").makeJoinNotificationResponseAck(a)}}}g.receiveJoinNotificationRPC=a}),98);
__d("WASmaxInGroupsMemberAddModeChangeNotificationRequest",["WAResultOrError","WASmaxInGroupsCommonNotificationMixin","WASmaxInGroupsGroupAddressingModeMixin","WASmaxInGroupsGroupMemberAddModeMixin","WASmaxInGroupsParticipantPhoneNumberMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"participant");if(!b.success)return b;var c=d("WASmaxInGroupsCommonNotificationMixin").parseCommonNotificationMixin(a);if(!c.success)return c;var e=d("WASmaxInGroupsGroupMemberAddModeMixin").parseGroupMemberAddModeMixin(a);if(!e.success)return e;var f=d("WASmaxInGroupsGroupAddressingModeMixin").parseGroupAddressingModeMixin(a);a=d("WASmaxInGroupsParticipantPhoneNumberMixin").parseParticipantPhoneNumberMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({participant:b.value},c.value,e.value,{groupAddressingModeMixin:f.success?f.value:null,participantPhoneNumberMixin:a.success?a.value:null}))}g.parseMemberAddModeChangeNotificationRequest=a}),98);
__d("WASmaxOutGroupsMemberAddModeChangeNotificationResponseAck",["WASmaxAttrs","WASmaxJsx","WASmaxOutGroupsNotificationClientAckMixin","WASmaxParseJid","WASmaxParseReference","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrUserJid,a,["participant"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);b=d("WASmaxOutGroupsNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",{participant:d("WASmaxAttrs").OPTIONAL(d("WAWap").USER_JID,b.value)}),a);return b}g.makeMemberAddModeChangeNotificationResponseAck=a}),98);
__d("WASmaxGroupsMemberAddModeChangeNotificationRPC",["WASmaxInGroupsMemberAddModeChangeNotificationRequest","WASmaxOutGroupsMemberAddModeChangeNotificationResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsMemberAddModeChangeNotificationRequest").parseMemberAddModeChangeNotificationRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("MemberAddModeChangeNotification",{Request:b}));return{parsedRequest:b.value,makeMemberAddModeChangeNotificationResponseAck:function(){return d("WASmaxOutGroupsMemberAddModeChangeNotificationResponseAck").makeMemberAddModeChangeNotificationResponseAck(a)}}}g.receiveMemberAddModeChangeNotificationRPC=a}),98);
__d("WASmaxInGroupsPromoteNotificationRequest",["WAResultOrError","WASmaxInGroupsCommonNotificationMixin","WASmaxInGroupsGroupAddressingModeMixin","WASmaxInGroupsParticipantMixins","WASmaxInGroupsParticipantPhoneNumberMixin","WASmaxInGroupsShadowGroupNotificationIndicatorMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxInGroupsParticipantMixins").parseParticipantMixins(a);return!b.success?b:d("WAResultOrError").makeResult({participantMixins:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"promote");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"participant");if(!c.success)return c;var e=d("WASmaxParseUtils").attrString(b.value,"v_id");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,b.value,"prev_v_id");if(!f.success)return f;var g=d("WASmaxInGroupsCommonNotificationMixin").parseCommonNotificationMixin(a);if(!g.success)return g;var i=d("WASmaxInGroupsShadowGroupNotificationIndicatorMixin").parseShadowGroupNotificationIndicatorMixin(a),j=d("WASmaxInGroupsGroupAddressingModeMixin").parseGroupAddressingModeMixin(a);a=d("WASmaxInGroupsParticipantPhoneNumberMixin").parseParticipantPhoneNumberMixin(a);b=d("WASmaxParseUtils").mapChildrenWithTag(b.value,"participant",1,19999,h);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({participant:c.value,promoteVId:e.value,promotePrevVId:f.value},g.value,{shadowGroupNotificationIndicatorMixin:i.success?i.value:null,groupAddressingModeMixin:j.success?j.value:null,participantPhoneNumberMixin:a.success?a.value:null,promoteParticipant:b.value}))}g.parsePromoteNotificationRequestPromoteParticipant=h;g.parsePromoteNotificationRequest=a}),98);
__d("WASmaxOutGroupsPromoteNotificationResponseAck",["WASmaxAttrs","WASmaxJsx","WASmaxOutGroupsNotificationClientAckMixin","WASmaxParseJid","WASmaxParseReference","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrUserJid,a,["participant"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);b=d("WASmaxOutGroupsNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",{participant:d("WASmaxAttrs").OPTIONAL(d("WAWap").USER_JID,b.value)}),a);return b}g.makePromoteNotificationResponseAck=a}),98);
__d("WASmaxGroupsPromoteNotificationRPC",["WASmaxInGroupsPromoteNotificationRequest","WASmaxOutGroupsPromoteNotificationResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsPromoteNotificationRequest").parsePromoteNotificationRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("PromoteNotification",{Request:b}));return{parsedRequest:b.value,makePromoteNotificationResponseAck:function(){return d("WASmaxOutGroupsPromoteNotificationResponseAck").makePromoteNotificationResponseAck(a)}}}g.receivePromoteNotificationRPC=a}),98);
__d("WASmaxInGroupsRemoveNotificationMemberMixin",["WAResultOrError","WASmaxInGroupsParticipantMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxInGroupsParticipantMixin").parseParticipantMixin(a);return!b.success?b:b}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"remove");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"v_id");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"prev_v_id");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"subject");if(!e.success)return e;var f=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,a,"reason","default_sub_group_demote");if(!f.success)return f;a=d("WASmaxParseUtils").mapChildrenWithTag(a,"participant",1,1024,h);return!a.success?a:d("WAResultOrError").makeResult({vId:b.value,prevVId:c.value,subject:e.value,reason:f.value,participant:a.value})}g.parseRemoveNotificationMemberParticipant=h;g.parseRemoveNotificationMemberMixin=a}),98);
__d("WASmaxInGroupsRemoveNotificationNonMemberMixin",["WAResultOrError","WASmaxInGroupsParticipantMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"remove");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"participant");if(!b.success)return b;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"subject");if(!a.success)return a;b=d("WASmaxInGroupsParticipantMixin").parseParticipantMixin(b.value);return!b.success?b:d("WAResultOrError").makeResult({subject:a.value,participantParticipantMixin:b.value})}g.parseRemoveNotificationNonMemberMixin=a}),98);
__d("WASmaxInGroupsRemoveNotificationOrRemoveNotificationNonMemberMixinGroup",["WAResultOrError","WASmaxInGroupsRemoveNotificationMemberMixin","WASmaxInGroupsRemoveNotificationNonMemberMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsRemoveNotificationMemberMixin").parseRemoveNotificationMemberMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"RemoveNotificationMember",value:b.value});var c=d("WASmaxInGroupsRemoveNotificationNonMemberMixin").parseRemoveNotificationNonMemberMixin(a);return c.success?d("WAResultOrError").makeResult({name:"RemoveNotificationNonMember",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["Member","NonMember"],[b,c])}g.parseRemoveNotificationOrRemoveNotificationNonMemberMixinGroup=a}),98);
__d("WASmaxInGroupsRemoveNotificationRequest",["WAResultOrError","WASmaxInGroupsCommonNotificationMixin","WASmaxInGroupsGroupAddressingModeMixin","WASmaxInGroupsParticipantPhoneNumberMixin","WASmaxInGroupsRemoveNotificationOrRemoveNotificationNonMemberMixinGroup","WASmaxInGroupsShadowGroupNotificationIndicatorMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"remove");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"participant");if(!c.success)return c;var e=d("WASmaxInGroupsCommonNotificationMixin").parseCommonNotificationMixin(a);if(!e.success)return e;var f=d("WASmaxInGroupsShadowGroupNotificationIndicatorMixin").parseShadowGroupNotificationIndicatorMixin(a),g=d("WASmaxInGroupsGroupAddressingModeMixin").parseGroupAddressingModeMixin(a);a=d("WASmaxInGroupsParticipantPhoneNumberMixin").parseParticipantPhoneNumberMixin(a);b=d("WASmaxInGroupsRemoveNotificationOrRemoveNotificationNonMemberMixinGroup").parseRemoveNotificationOrRemoveNotificationNonMemberMixinGroup(b.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({participant:c.value},e.value,{shadowGroupNotificationIndicatorMixin:f.success?f.value:null,groupAddressingModeMixin:g.success?g.value:null,participantPhoneNumberMixin:a.success?a.value:null,removeRemoveNotificationOrRemoveNotificationNonMemberMixinGroup:b.value}))}g.parseRemoveNotificationRequest=a}),98);
__d("WASmaxOutGroupsRemoveNotificationResponseAck",["WASmaxAttrs","WASmaxJsx","WASmaxOutGroupsNotificationClientAckMixin","WASmaxParseJid","WASmaxParseReference","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrUserJid,a,["participant"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);b=d("WASmaxOutGroupsNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",{participant:d("WASmaxAttrs").OPTIONAL(d("WAWap").USER_JID,b.value)}),a);return b}g.makeRemoveNotificationResponseAck=a}),98);
__d("WASmaxGroupsRemoveNotificationRPC",["WASmaxInGroupsRemoveNotificationRequest","WASmaxOutGroupsRemoveNotificationResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsRemoveNotificationRequest").parseRemoveNotificationRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("RemoveNotification",{Request:b}));return{parsedRequest:b.value,makeRemoveNotificationResponseAck:function(){return d("WASmaxOutGroupsRemoveNotificationResponseAck").makeRemoveNotificationResponseAck(a)}}}g.receiveRemoveNotificationRPC=a}),98);
__d("WASmaxInGroupsSubjectChangeNotificationRequest",["WAResultOrError","WASmaxInGroupsCommonNotificationMixin","WASmaxInGroupsGroupAddressingModeMixin","WASmaxInGroupsNamedSubjectOrUnnamedSubjectFallbackMixinGroup","WASmaxInGroupsParticipantPhoneNumberMixin","WASmaxInGroupsShadowGroupNotificationIndicatorMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"subject");if(!b.success)return b;var c=d("WASmaxParseJid").attrUserJid(a,"participant");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,b.value,"s_o");if(!e.success)return e;var f=d("WASmaxParseUtils").attrIntRange(b.value,"s_t",0,void 0);if(!f.success)return f;var g=d("WASmaxInGroupsCommonNotificationMixin").parseCommonNotificationMixin(a);if(!g.success)return g;var h=d("WASmaxInGroupsShadowGroupNotificationIndicatorMixin").parseShadowGroupNotificationIndicatorMixin(a),i=d("WASmaxInGroupsGroupAddressingModeMixin").parseGroupAddressingModeMixin(a);a=d("WASmaxInGroupsParticipantPhoneNumberMixin").parseParticipantPhoneNumberMixin(a);b=d("WASmaxInGroupsNamedSubjectOrUnnamedSubjectFallbackMixinGroup").parseNamedSubjectOrUnnamedSubjectFallbackMixinGroup(b.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({participant:c.value,subjectSO:e.value,subjectST:f.value},g.value,{shadowGroupNotificationIndicatorMixin:h.success?h.value:null,groupAddressingModeMixin:i.success?i.value:null,participantPhoneNumberMixin:a.success?a.value:null,subjectNamedSubjectOrUnnamedSubjectFallbackMixinGroup:b.value}))}g.parseSubjectChangeNotificationRequest=a}),98);
__d("WASmaxOutGroupsSubjectChangeNotificationResponseAck",["WASmaxJsx","WASmaxOutGroupsNotificationClientAckMixin","WASmaxParseJid","WASmaxParseReference","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrUserJid,a,["participant"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);b=d("WASmaxOutGroupsNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",{participant:d("WAWap").USER_JID(b.value)}),a);return b}g.makeSubjectChangeNotificationResponseAck=a}),98);
__d("WASmaxGroupsSubjectChangeNotificationRPC",["WASmaxInGroupsSubjectChangeNotificationRequest","WASmaxOutGroupsSubjectChangeNotificationResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsSubjectChangeNotificationRequest").parseSubjectChangeNotificationRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("SubjectChangeNotification",{Request:b}));return{parsedRequest:b.value,makeSubjectChangeNotificationResponseAck:function(){return d("WASmaxOutGroupsSubjectChangeNotificationResponseAck").makeSubjectChangeNotificationResponseAck(a)}}}g.receiveSubjectChangeNotificationRPC=a}),98);
__d("WASmaxInNotificationFallbackEnums",["WAJids"],(function(a,b,c,d,e,f,g){b={validators:[(a=d("WAJids")).validateBroadcastJid,a.validateCallJid,a.validateDeviceJid,a.validateDomainJid,a.validateGroupJid,a.validateStatusJid,a.validateUserJid],typeName:"BroadcastJid|CallJid|DeviceJid|DomainJid|GroupJid|StatusJid|UserJid"};g.BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID=b}),98);
__d("WASmaxInNotificationFallbackGenericNotificationRequest",["WAResultOrError","WASmaxInNotificationFallbackEnums","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrJidEnum,a,"from",d("WASmaxInNotificationFallbackEnums").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrJidEnum,a,"participant",d("WASmaxInNotificationFallbackEnums").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!e.success)return e;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"type");return!a.success?a:d("WAResultOrError").makeResult({id:b.value,from:c.value,participant:e.value,type:a.value})}g.parseGenericNotificationRequest=a}),98);
__d("WASmaxOutNotificationFallbackGenericNotificationResponseAck",["WASmaxAttrs","WASmaxInNotificationFallbackEnums","WASmaxJsx","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrJidEnum,a,["from"],d("WASmaxInNotificationFallbackEnums").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);var e=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrJidEnum,a,["participant"],d("WASmaxInNotificationFallbackEnums").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!e.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(e.error);a=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{id:d("WAWap").STANZA_ID(b.value),to:d("WASmaxAttrs").OPTIONAL(d("WAWap").JID,c.value),participant:d("WASmaxAttrs").OPTIONAL(d("WAWap").JID,e.value),"class":"notification",type:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a.value)});return b}g.makeGenericNotificationResponseAck=a}),98);
__d("WASmaxOutNotificationFallbackGenericNotificationResponseBadStanza",["WASmaxAttrs","WASmaxInNotificationFallbackEnums","WASmaxJsx","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a,b){a=a.ackError;var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,b,["id"]);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);var e=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrJidEnum,b,["from"],d("WASmaxInNotificationFallbackEnums").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!e.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(e.error);var f=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrJidEnum,b,["participant"],d("WASmaxInNotificationFallbackEnums").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!f.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(f.error);b=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseUtils").attrString,b,["type"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);c=d("WASmaxJsx").smax("ack",{id:d("WAWap").STANZA_ID(c.value),to:d("WASmaxAttrs").OPTIONAL(d("WAWap").JID,e.value),participant:d("WASmaxAttrs").OPTIONAL(d("WAWap").JID,f.value),"class":"notification",type:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,b.value),error:d("WAWap").INT(a)});return c}g.makeGenericNotificationResponseBadStanza=a}),98);
__d("WASmaxNotificationFallbackGenericNotificationRPC",["WASmaxInNotificationFallbackGenericNotificationRequest","WASmaxOutNotificationFallbackGenericNotificationResponseAck","WASmaxOutNotificationFallbackGenericNotificationResponseBadStanza","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInNotificationFallbackGenericNotificationRequest").parseGenericNotificationRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("GenericNotification",{Request:b}));return{parsedRequest:b.value,makeGenericNotificationResponseBadStanza:function(b){return d("WASmaxOutNotificationFallbackGenericNotificationResponseBadStanza").makeGenericNotificationResponseBadStanza(b,a)},makeGenericNotificationResponseAck:function(){return d("WASmaxOutNotificationFallbackGenericNotificationResponseAck").makeGenericNotificationResponseAck(a)}}}g.receiveGenericNotificationRPC=a}),98);
__d("WAParseGroupNotifications",["WAJids","WALogger","WAResultOrError","WASmaxDecisionTreeUtils","WASmaxGroupsAddNotificationRPC","WASmaxGroupsDeleteNotificationRPC","WASmaxGroupsDemoteNotificationRPC","WASmaxGroupsJoinNotificationRPC","WASmaxGroupsMemberAddModeChangeNotificationRPC","WASmaxGroupsPromoteNotificationRPC","WASmaxGroupsRemoveNotificationRPC","WASmaxGroupsSubjectChangeNotificationRPC","WASmaxInGroupsShadowGroupNotificationIndicatorMixin","WASmaxNotificationFallbackGenericNotificationRPC","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["parseMemberAddModeNotification: Unexpected memberAddMode ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["parseGroupNotification: Unknown notification ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["parseGroupNotification: Received group-dual-send notification"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["parseGroupNotification: Received node with no children"]);k=function(){return a};return a}function a(a){var b=d("WASmaxDecisionTreeUtils").firstChild(a);if(!b.success){d("WALogger").ERROR(k());var c=d("WASmaxNotificationFallbackGenericNotificationRPC").receiveGenericNotificationRPC(a),e=c.makeGenericNotificationResponseBadStanza;c=c.parsedRequest.id;return{action:{type:"unknown"},id:c,ack:function(){return e({ackError:487})}}}c=d("WASmaxInGroupsShadowGroupNotificationIndicatorMixin").parseShadowGroupNotificationIndicatorMixin(a);if(c.success){d("WALogger").WARN(j());c=d("WASmaxNotificationFallbackGenericNotificationRPC").receiveGenericNotificationRPC(a);var f=c.makeGenericNotificationResponseBadStanza;c=c.parsedRequest.id;return{action:{type:"unknown"},id:c,ack:function(){return f({ackError:487})}}}c=b.value.tag;switch(c){case"create":return l(a);case"add":return n(a);case"remove":return o(a);case"delete":b=d("WASmaxGroupsDeleteNotificationRPC").receiveDeleteNotificationRPC(a);var g=b.parsedRequest,h=g.participant,m=g.from,s=g.offline,u=g.t;g=g.id;b=b.makeDeleteNotificationResponseAck;return{action:{type:"delete",participant:h,groupJid:m},ack:b,offline:s,serverTs:d("WATimeUtils").castToUnixTime(u),id:g};case"promote":return p(a);case"demote":return q(a);case"subject":return r(a);case"member_add_mode":h=t(a);if(h!=null)return h;break;default:d("WALogger").ERROR(i(),c)}m=d("WASmaxNotificationFallbackGenericNotificationRPC").receiveGenericNotificationRPC(a);var v=m.makeGenericNotificationResponseBadStanza;b=m.parsedRequest.id;return{action:{type:"unknown"},id:b,ack:function(){return v({ackError:487})}}}function l(a){a=d("WASmaxGroupsJoinNotificationRPC").receiveJoinNotificationRPC(a);var b=a.parsedRequest,c=b.from,e=b.createGroupGroupInfoMixin,f=e.id,g=e.creator,h=e.creation,i=e.participant,j=e.namedSubjectOrUnnamedSubjectFallbackMixinGroup,k=e.sO,l=e.sT,m=e.pVId,n=e.description;e=e.groupMemberAddModeMixin;var o=b.createDedupAttrsMixin,p=b.createType,q=b.participant,r=b.t,t=b.offline;b=b.id;a=a.makeJoinNotificationResponseAck;n=n==null?void 0:n.groupInfoDescriptionMixin;k={jid:d("WAJids").toGroupJid(f),creator:(f=g)!=null?f:void 0,creationTs:d("WATimeUtils").castToUnixTime(h),participants:i.map(function(a){var b=a.groupInfoParticipantMixins;a=a.participantNotAddressableMixin;return d("WAResultOrError").makeResult({addressable:(a==null?void 0:a.addressable)!=="false",type:b.name==="GroupInfoParticipantAdmin"?b.value.type:"participant",user:b.name==="GroupInfoParticipantAdmin"?b.value.groupInfoParticipantAdminMixins.value.jid:b.value.participantMixins.value.jid})}),subject:{content:j.value.subject,user:(g=k)!=null?g:void 0,ts:l==null?void 0:d("WATimeUtils").castToUnixTime(l)},description:n==null?void 0:{id:n.id,content:n.bodyElementValue,user:n.participant,ts:d("WATimeUtils").castToUnixTime(n.t)},participantVersion:(f=m)!=null?f:void 0,inviter:(h=q)!=null?h:void 0,memberAddMode:s(e==null?void 0:(i=e.memberAddModeAdminOrAllMembersOrUnknownAddModeMixinGroup)==null?void 0:(j=i.value)==null?void 0:j.elementValue)};g=d("WATimeUtils").castToUnixTime(r);return{action:{type:"join",isNew:p==="new",isE2EEMigration:(o==null?void 0:o.createCtx)==="e2ee_migration",key:o==null?void 0:o.key,serverTs:d("WATimeUtils").castToUnixTime(r),groupJid:c,group:k},serverTs:g,offline:t,ack:a,id:b}}function m(a){if(a===null)return;return a==="invite"?"invite":"accept"}function n(a){a=d("WASmaxGroupsAddNotificationRPC").receiveAddNotificationRPC(a);var b=a.parsedRequest,c=b.from,e=b.participant,f=b.addVId,g=b.addPrevVId,h=b.addReason,i=b.addParticipant,j=b.offline,k=b.t;b=b.id;a=a.makeAddNotificationResponseAck;return{action:{type:"add",versionId:f,previousVersionId:g,reason:m(h),participants:i.map(function(a){return{user:a.participantMixins.value.jid,type:"participant",addressable:((a=a.participantNotAddressableMixin)==null?void 0:a.addressable)!=="false"}}),groupJid:c,participant:e},serverTs:d("WATimeUtils").castToUnixTime(k),offline:j,ack:a,id:b}}function o(a){a=d("WASmaxGroupsRemoveNotificationRPC").receiveRemoveNotificationRPC(a);var b=a.parsedRequest,c=b.offline,e=b.from,f=b.participant,g=b.t,h=b.id;b=b.removeRemoveNotificationOrRemoveNotificationNonMemberMixinGroup;a=a.makeRemoveNotificationResponseAck;var i=b.name==="RemoveNotificationMember"?b.value.participant.map(function(a){return{user:a.participantMixins.value.jid,type:"nonparticipant",addressable:!0}}):[{user:b.value.participantParticipantMixin.participantMixins.value.jid,type:"nonparticipant",addressable:!0}];return{action:{type:"remove",versionId:b.value.vId,previousVersionId:b.value.prevVId,participants:i,groupJid:e,participant:f},serverTs:d("WATimeUtils").castToUnixTime(g),ack:a,offline:c,id:h}}function p(a){a=d("WASmaxGroupsPromoteNotificationRPC").receivePromoteNotificationRPC(a);var b=a.parsedRequest,c=b.promoteVId,e=b.promotePrevVId,f=b.promoteParticipant,g=b.from,h=b.participant,i=b.offline,j=b.t;b=b.id;a=a.makePromoteNotificationResponseAck;return{action:{type:"promote",versionId:c,previousVersionId:e,participants:f.map(function(a){a=a.participantMixins.value.jid;return{user:a,type:"admin",addressable:!0}}),groupJid:g,participant:h},serverTs:d("WATimeUtils").castToUnixTime(j),offline:i,ack:a,id:b}}function q(a){a=d("WASmaxGroupsDemoteNotificationRPC").receiveDemoteNotificationRPC(a);var b=a.parsedRequest,c=b.demoteVId,e=b.demotePrevVId,f=b.demoteParticipant,g=b.from,h=b.participant,i=b.offline,j=b.t;b=b.id;a=a.makeDemoteNotificationResponseAck;return{action:{type:"demote",versionId:c,previousVersionId:e,participants:f.map(function(a){a=a.participantMixins.value.jid;return{user:a,type:"participant",addressable:!0}}),groupJid:g,participant:h},serverTs:d("WATimeUtils").castToUnixTime(j),offline:i,ack:a,id:b}}function r(a){a=d("WASmaxGroupsSubjectChangeNotificationRPC").receiveSubjectChangeNotificationRPC(a);var b=a.parsedRequest,c=b.subjectNamedSubjectOrUnnamedSubjectFallbackMixinGroup,e=b.subjectST,f=b.from,g=b.participant,h=b.offline,i=b.t;b=b.id;a=a.makeSubjectChangeNotificationResponseAck;return{action:{type:"subject",subject:c.name==="NamedSubject"?c.value.subject:null,ts:d("WATimeUtils").castToUnixTime(e),groupJid:f,participant:g},serverTs:d("WATimeUtils").castToUnixTime(i),ack:a,offline:h,id:b}}function s(a){if(a==="admin_add"||a==="all_member_add")return a}function t(a){a=d("WASmaxGroupsMemberAddModeChangeNotificationRPC").receiveMemberAddModeChangeNotificationRPC(a);var b=a.parsedRequest,c=b.memberAddModeAdminOrAllMembersOrUnknownAddModeMixinGroup,e=b.from,f=b.offline,g=b.participant,i=b.t;b=b.id;a=a.makeMemberAddModeChangeNotificationResponseAck;var j=s(c.value.elementValue);if(j==null){d("WALogger").ERROR(h(),c.value.elementValue);return}return{action:{type:"memberAddMode",memberAddMode:j,groupJid:e,participant:g},serverTs:d("WATimeUtils").castToUnixTime(i),ack:a,offline:f,id:b}}g.parseGroupNotification=a}),98);
__d("WACreateHandleGroupNotificationBranch",["Promise","WAParseGroupNotifications","WAResultOrError","WATagsLogger","WAUnknownStanzaError"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["start handling"]);i=function(){return a};return a}var j=d("WATagsLogger").TAGS(["decision tree","handleGroupNotification"]);function a(a){a=(a=a.groupMessage)!=null?a:{};var c=a.handleGroupNotification;return function(a){j.LOG(i());if(c!=null){a=d("WAParseGroupNotifications").parseGroupNotification(a);var e=a.action,f=a.ack,g=a.offline,k=a.serverTs;a=a.id;if(e.type!=="unknown")return c({makeAck:f,action:e,offline:g,serverTs:k,id:a}).then(d("WAResultOrError").makeResult)}return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError)}}g.createHandleGroupNotification=a}),98);
__d("WASmaxInAbPropsServerNotificationMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"offline",0,1024);return!a.success?a:d("WAResultOrError").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);
__d("WASmaxInAbPropsRefreshRequest",["WAResultOrError","WASmaxInAbPropsServerNotificationMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"abprops");if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","server");if(!c.success)return c;var e=d("WASmaxParseJid").attrDeviceJid(a,"from");if(!e.success)return e;b=d("WASmaxParseUtils").attrIntRange(b.value,"protocol",1,10);if(!b.success)return b;a=d("WASmaxInAbPropsServerNotificationMixin").parseServerNotificationMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({type:c.value,from:e.value,abpropsProtocol:b.value},a.value))}g.parseRefreshRequest=a}),98);
__d("WASmaxOutAbPropsNotificationClientAckMixin",["WASmaxJsx","WASmaxMixins","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrDeviceJid,a,["from"]);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);a=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{id:d("WAWap").STANZA_ID(b.value),to:d("WAWap").DEVICE_JID(c.value),"class":"notification",type:d("WAWap").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNotificationClientAckMixin=a}),98);
__d("WASmaxOutAbPropsRefreshResponseAck",["WASmaxJsx","WASmaxOutAbPropsNotificationClientAckMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutAbPropsNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",null),a);return a}g.makeRefreshResponseAck=a}),98);
__d("WASmaxAbPropsRefreshRPC",["WASmaxInAbPropsRefreshRequest","WASmaxOutAbPropsRefreshResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInAbPropsRefreshRequest").parseRefreshRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Refresh",{Request:b}));return{parsedRequest:b.value,makeRefreshResponseAck:function(){return d("WASmaxOutAbPropsRefreshResponseAck").makeRefreshResponseAck(a)}}}g.receiveRefreshRPC=a}),98);
__d("WASmaxInClientLogServerNotificationMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"offline",0,1024);return!a.success?a:d("WAResultOrError").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);
__d("WASmaxInClientLogLogRequest",["WAResultOrError","WASmaxInClientLogServerNotificationMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"log");if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","server");if(!c.success)return c;var e=d("WASmaxParseJid").attrDeviceJid(a,"from");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,b.value,"start_t");if(!f.success)return f;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,b.value,"end_t");if(!b.success)return b;a=d("WASmaxInClientLogServerNotificationMixin").parseServerNotificationMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({type:c.value,from:e.value,logStartT:f.value,logEndT:b.value},a.value))}g.parseLogRequest=a}),98);
__d("WASmaxOutClientLogNotificationClientAckMixin",["WASmaxJsx","WASmaxMixins","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrDeviceJid,a,["from"]);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);a=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{id:d("WAWap").STANZA_ID(b.value),to:d("WAWap").DEVICE_JID(c.value),"class":"notification",type:d("WAWap").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNotificationClientAckMixin=a}),98);
__d("WASmaxOutClientLogLogResponseAck",["WASmaxJsx","WASmaxOutClientLogNotificationClientAckMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutClientLogNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",null),a);return a}g.makeLogResponseAck=a}),98);
__d("WASmaxClientLogLogRPC",["WASmaxInClientLogLogRequest","WASmaxOutClientLogLogResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInClientLogLogRequest").parseLogRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Log",{Request:b}));return{parsedRequest:b.value,makeLogResponseAck:function(){return d("WASmaxOutClientLogLogResponseAck").makeLogResponseAck(a)}}}g.receiveLogRPC=a}),98);
__d("WASmaxInServerPropsServerNotificationMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"offline",0,1024);return!a.success?a:d("WAResultOrError").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);
__d("WASmaxInServerPropsTriggerRefreshDeviceFromMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseJid").attrDeviceJid(a,"from");return!b.success?b:d("WAResultOrError").makeResult({from:b.value})}g.parseTriggerRefreshDeviceFromMixin=a}),98);
__d("WASmaxInServerPropsTriggerRefreshServerFromMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrDomainJid,a,"from","s.whatsapp.net");return!b.success?b:d("WAResultOrError").makeResult({from:b.value})}g.parseTriggerRefreshServerFromMixin=a}),98);
__d("WASmaxInServerPropsTriggerRefreshUserFromDeprecatedMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"from");return!b.success?b:d("WAResultOrError").makeResult({from:b.value})}g.parseTriggerRefreshUserFromDeprecatedMixin=a}),98);
__d("WASmaxInServerPropsTriggerRefreshServerFromOrTriggerRefreshDeviceFromOrTriggerRefreshUserFromDeprecatedMixinGroup",["WAResultOrError","WASmaxInServerPropsTriggerRefreshDeviceFromMixin","WASmaxInServerPropsTriggerRefreshServerFromMixin","WASmaxInServerPropsTriggerRefreshUserFromDeprecatedMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInServerPropsTriggerRefreshServerFromMixin").parseTriggerRefreshServerFromMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"TriggerRefreshServerFrom",value:b.value});var c=d("WASmaxInServerPropsTriggerRefreshDeviceFromMixin").parseTriggerRefreshDeviceFromMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"TriggerRefreshDeviceFrom",value:c.value});var e=d("WASmaxInServerPropsTriggerRefreshUserFromDeprecatedMixin").parseTriggerRefreshUserFromDeprecatedMixin(a);return e.success?d("WAResultOrError").makeResult({name:"TriggerRefreshUserFromDeprecated",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["ServerFrom","DeviceFrom","UserFromDeprecated"],[b,c,e])}g.parseTriggerRefreshServerFromOrTriggerRefreshDeviceFromOrTriggerRefreshUserFromDeprecatedMixinGroup=a}),98);
__d("WASmaxInServerPropsTriggerRefreshRequest",["WAResultOrError","WASmaxInServerPropsServerNotificationMixin","WASmaxInServerPropsTriggerRefreshServerFromOrTriggerRefreshDeviceFromOrTriggerRefreshUserFromDeprecatedMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"props");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","server");if(!b.success)return b;var c=d("WASmaxInServerPropsServerNotificationMixin").parseServerNotificationMixin(a);if(!c.success)return c;a=d("WASmaxInServerPropsTriggerRefreshServerFromOrTriggerRefreshDeviceFromOrTriggerRefreshUserFromDeprecatedMixinGroup").parseTriggerRefreshServerFromOrTriggerRefreshDeviceFromOrTriggerRefreshUserFromDeprecatedMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({type:b.value},c.value,{triggerRefreshServerFromOrTriggerRefreshDeviceFromOrTriggerRefreshUserFromDeprecatedMixinGroup:a.value}))}g.parseTriggerRefreshRequest=a}),98);
__d("WASmaxInServerPropsEnums",["WAJids"],(function(a,b,c,d,e,f,g){a={validators:[d("WAJids").validateDeviceJid,d("WAJids").validateDomainJid,d("WAJids").validateUserJid],typeName:"DeviceJid|DomainJid|UserJid"};g.DEVICEJID_DOMAINJID_USERJID=a}),98);
__d("WASmaxOutServerPropsNotificationClientAckMixin",["WASmaxInServerPropsEnums","WASmaxJsx","WASmaxMixins","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrJidEnum,a,["from"],d("WASmaxInServerPropsEnums").DEVICEJID_DOMAINJID_USERJID);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);a=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{id:d("WAWap").STANZA_ID(b.value),to:d("WAWap").JID(c.value),"class":"notification",type:d("WAWap").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNotificationClientAckMixin=a}),98);
__d("WASmaxOutServerPropsTriggerRefreshResponseAck",["WASmaxJsx","WASmaxOutServerPropsNotificationClientAckMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutServerPropsNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",null),a);return a}g.makeTriggerRefreshResponseAck=a}),98);
__d("WASmaxServerPropsTriggerRefreshRPC",["WASmaxInServerPropsTriggerRefreshRequest","WASmaxOutServerPropsTriggerRefreshResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInServerPropsTriggerRefreshRequest").parseTriggerRefreshRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("TriggerRefresh",{Request:b}));return{parsedRequest:b.value,makeTriggerRefreshResponseAck:function(){return d("WASmaxOutServerPropsTriggerRefreshResponseAck").makeTriggerRefreshResponseAck(a)}}}g.receiveTriggerRefreshRPC=a}),98);
__d("WACreateHandleServerNotificationBranch",["Promise","WALogger","WAResultOrError","WASmaxAbPropsRefreshRPC","WASmaxClientLogLogRPC","WASmaxDecisionTreeUtils","WASmaxServerPropsTriggerRefreshRPC","WATimeUtils","WAUnknownStanzaError"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["parseServerNotification notification without children"]);i=function(){return a};return a}function a(a){var c,e=(c=a.abprops)==null?void 0:c.handleAbPropsRefreshNotification,f=(c=a.clientLog)==null?void 0:c.handleClientLogNotification,g=(c=a.serverProps)==null?void 0:c.handleServerPropsRefreshNotification;return function(a){var c=d("WASmaxDecisionTreeUtils").firstChild(a);if(c.success===!1){d("WALogger").ERROR(i());return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError)}c=c.value.tag;switch(c){case"abprops":if(e!=null){c=d("WASmaxAbPropsRefreshRPC").receiveRefreshRPC(a);var j=c.parsedRequest;c=c.makeRefreshResponseAck;return e({serverTs:d("WATimeUtils").castToUnixTime(j.t),id:j.id,offline:j.offline,makeAck:c}).then(d("WAResultOrError").makeResult)}break;case"props":if(g!=null){j=d("WASmaxServerPropsTriggerRefreshRPC").receiveTriggerRefreshRPC(a);c=j.parsedRequest;j=j.makeTriggerRefreshResponseAck;return g({serverTs:d("WATimeUtils").castToUnixTime(c.t),id:c.id,offline:c.offline,makeAck:j}).then(d("WAResultOrError").makeResult)}break;case"log":if(f!=null){c=d("WASmaxClientLogLogRPC").receiveLogRPC(a);j=c.parsedRequest;a=c.makeLogResponseAck;return f({serverTs:d("WATimeUtils").castToUnixTime(j.t),id:j.id,offline:j.offline,makeAck:a}).then(d("WAResultOrError").makeResult)}break}return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError)}}g.createHandleServerNotification=a}),98);
__d("WASmaxInSyncdServerNotificationMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"offline",0,1024);return!a.success?a:d("WAResultOrError").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);
__d("WASmaxInSyncdNewPatchRequest",["WAResultOrError","WASmaxInSyncdServerNotificationMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"collection");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"name");if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(a,"version",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({name:b.value,version:a.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrDomainJid,a,"from","s.whatsapp.net");if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","server_sync");if(!c.success)return c;var e=d("WASmaxInSyncdServerNotificationMixin").parseServerNotificationMixin(a);if(!e.success)return e;a=d("WASmaxParseUtils").mapChildrenWithTag(a,"collection",1,20,h);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({from:b.value,type:c.value},e.value,{collection:a.value}))}g.parseNewPatchRequestCollection=h;g.parseNewPatchRequest=a}),98);
__d("WASmaxOutSyncdNewPatchResponseClientAck",["WASmaxJsx","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrDomainJid,a,["from"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);a=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{"class":"notification",type:"server_sync",to:d("WAWap").DOMAIN_JID(b.value),id:d("WAWap").STANZA_ID(a.value)});return b}g.makeNewPatchResponseClientAck=a}),98);
__d("WASmaxSyncdNewPatchRPC",["WASmaxInSyncdNewPatchRequest","WASmaxOutSyncdNewPatchResponseClientAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInSyncdNewPatchRequest").parseNewPatchRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("NewPatch",{Request:b}));return{parsedRequest:b.value,makeNewPatchResponseClientAck:function(){return d("WASmaxOutSyncdNewPatchResponseClientAck").makeNewPatchResponseClientAck(a)}}}g.receiveNewPatchRPC=a}),98);
__d("WACreateHandleServerSyncNotificationBranch",["Promise","WALogger","WAResultOrError","WASmaxSyncdNewPatchRPC","WASyncdConst","WATimeUtils","WAUnknownStanzaError"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleServerSyncNotification: Incorrect collection notification"]);i=function(){return a};return a}function a(a){var c=(a=a.syncd)==null?void 0:a.handleSyncdNewPatchNotification;return function(a){if(c==null)return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError);a=d("WASmaxSyncdNewPatchRPC").receiveNewPatchRPC(a);var e=a.parsedRequest,f=e.collection,g=e.offline,j=e.t;e=e.id;a=a.makeNewPatchResponseClientAck;f=new Map(f.map(function(a){var b=a.name;a=a.version;b=d("WASyncdConst").CollectionName.cast(b);if(b==null)d("WALogger").ERROR(i());else return[b,a]}).filter(Boolean));return c({makeAck:a,collections:f,offline:g,id:e,serverTs:d("WATimeUtils").castToUnixTime(j)}).then(d("WAResultOrError").makeResult)}}g.createHandleServerSyncNotification=a}),98);
__d("WARuntimeError",["WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return d("WAResultOrError").makeError({type:"runtime-error",error:a})}g.runtimeError=a}),98);
__d("WACreateHandleNotification",["Promise","WACreateHandleAccountSyncNotificationBranch","WACreateHandleDevicesNotificationBranch","WACreateHandleEncryptNotificationBranch","WACreateHandleFbDeviceChangeNotificationBranch","WACreateHandleFbMultiwayNotificationBranch","WACreateHandleFbThreadNotificationBranch","WACreateHandleGroupNotificationBranch","WACreateHandleServerNotificationBranch","WACreateHandleServerSyncNotificationBranch","WAResultOrError","WARuntimeError","WASmaxNotificationFallbackGenericNotificationRPC","WASmaxParseUtils","WASmaxParsingFailure","WATagsLogger","WAUnknownStanzaError"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["runtime-error: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["runtime-error: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["received unknown notifcation: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["start handling"]);l=function(){return a};return a}var m={encrypt:"encrypt","w:gp2":"w:gp2",server:"server",server_sync:"server_sync","fbid:devices":"fbid:devices","fbid:thread":"fbid:thread","fb:multiway":"fb:multiway",mediaretry:"mediaretry",picture:"picture",business:"business",contacts:"contacts",devices:"devices",disappearing_mode:"disappearing_mode",status:"status",account_sync:"account_sync",pay:"pay",psa:"psa",privacy_token:"privacy_token",link_code_companion_reg:"link_code_companion_reg"},n=d("WATagsLogger").TAGS(["decision tree","handleNotification"]);function a(a){var c=d("WACreateHandleEncryptNotificationBranch").createHandleEncryptNotification(a),e=d("WACreateHandleServerNotificationBranch").createHandleServerNotification(a),f=d("WACreateHandleServerSyncNotificationBranch").createHandleServerSyncNotification(a),g=d("WACreateHandleGroupNotificationBranch").createHandleGroupNotification(a),o=d("WACreateHandleAccountSyncNotificationBranch").createHandleAccountSyncNotification(a),p=d("WACreateHandleDevicesNotificationBranch").createHandleDevicesNotification(a);return function(q,r,s){n.DEV(l());var t=d("WASmaxParseUtils").attrStringEnum(q,"type",m);return(h||(h=b("Promise"))).resolve().then(function(){if(!t.success)return d("WAUnknownStanzaError").unknownStanzaError;var b=t.value;switch(b){case"fbid:devices":var h;h=(h=a.fb)==null?void 0:h.handleFbDeviceChangeNotification;if(h)return d("WACreateHandleFbDeviceChangeNotificationBranch").createHandleFbDeviceChangeNotification(h)(q,s);break;case"fbid:thread":h=(h=a.fb)==null?void 0:h.handleFbThreadNotification;if(h)return d("WACreateHandleFbThreadNotificationBranch").createHandleFbThreadNotification(h)(q);break;case"fb:multiway":h=(h=a.fb)==null?void 0:h.handleFbMultiwayNotification;if(h)return d("WACreateHandleFbMultiwayNotificationBranch").createHandleFbMultiwayNotification(h)(q);break;case"encrypt":return c(q);case"server":return e(q);case"server_sync":return f(q);case"w:gp2":return g(q);case"devices":return p(q);case"account_sync":return o(q);case"mediaretry":break;case"picture":break;case"business":break;case"contacts":break;case"disappearing_mode":break;case"status":break;case"pay":break;case"psa":break;case"privacy_token":break;case"link_code_companion_reg":break;default:b}return d("WAUnknownStanzaError").unknownStanzaError})["catch"](function(a){return a instanceof d("WASmaxParsingFailure").SmaxParsingFailure?d("WAUnknownStanzaError").unknownStanzaError:d("WARuntimeError").runtimeError(a)}).then(function(a){if(a.success)return a;var b=d("WASmaxNotificationFallbackGenericNotificationRPC").receiveGenericNotificationRPC(q),c=b.makeGenericNotificationResponseAck;b=b.makeGenericNotificationResponseBadStanza;if(a.error.type==="unknown-stanza"){n.WARN(k(),q.toString());return d("WAResultOrError").makeResult(b({ackError:487}))}else{a.error.type;n.WARN(j(),a.error.error.message);n.ERROR(i(),a.error.error);return d("WAResultOrError").makeResult(c())}})}}g.createHandleNotification=a}),98);
__d("WAMapMixinNameToReceiptType",[],(function(a,b,c,d,e,f){"use strict";var g={SenderType:"sender",ReadType:"read",InactiveType:"inactive",ReadSelfType:"read-self"};function a(a){return g[a]}f.mapMixinNameToReceiptType=a}),66);
__d("WAParseKeyBundleMixing",["WAParsableXmlNode","WASignalKeys"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return{regId:a,identity:d("WASignalKeys").serializeIdentity(b.keysIdentityKeyMixin.elementValue),signedKey:{id:d("WAParsableXmlNode").convertBytesToUint(b.keysSignedPreKeyMixin.skeyIdKeyIDMixin.elementValue,3),publicKey:d("WASignalKeys").serializeIdentity(b.keysSignedPreKeyMixin.skeyValueKeyDataMixin.elementValue),signature:b.keysSignedPreKeyMixin.skeySignatureElementValue},oneTimeKey:null}}g.parseKeyBundleMixin=a}),98);
__d("WATransformToRetryReceipt",["WAParseKeyBundleMixing","WASignalOther","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){var b=a.aggregate,c=a.retryMixin,e=a.recipient;a=a.offline;var f=c.keyBundleMixin,g=c.registrationElementValue,h=c.retryCount,i=c.retryId,j=c.retryT;c.retryV;c.type;c=d("WASignalOther").castRegistrationIdFromBytes(g);return{stanzaId:b.stanzaId,retryStanzaId:i,receiptSender:b.receiptSender,retryCount:h,regId:c,offline:a,timestamp:d("WATimeUtils").castToUnixTime(j),keys:f?d("WAParseKeyBundleMixing").parseKeyBundleMixin(c,f):null,recipient:e}};g.transformToRetryReceipt=a}),98);
__d("WACreateHandleGroupReceiptBranch",["Promise","WAMapMixinNameToReceiptType","WAResultOrError","WATagsLogger","WATransformToRetryReceipt"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleGroupReceipt: receipt type "," is not handled yet"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["retry receipt not supported for aggregated messages"]);j=function(){return a};return a}var k=d("WATagsLogger").TAGS(["decision tree","handleGroupReceiptBranch"]);function a(a){var c=a.handleGroupReceipt,e=a.handleGroupRetryReceipt;return function(a){var f=a.from,g=a.aggregate,l=a.receiptType,m=a.makeAck,n=a.offline,o=a.serverTs,p=a.recipient;a=a.socketId;f=f;n=(n=n)!=null?n:null;if(l==null){var q=p==null?"@me":p;if(c!=null)return c(babelHelpers["extends"]({makeAck:m,author:q,chat:f,offline:n,serverTs:o},g,{receiptType:"delivered"})).then(d("WAResultOrError").makeResult)}else{q=p==null?"@me":l.name==="SenderType"||l.name==="ReadSelfType"?"@me":p;switch(l.name){case"ReadType":case"SenderType":case"InactiveType":case"ReadSelfType":if(c!=null)return c(babelHelpers["extends"]({makeAck:m,author:q,chat:f,offline:n,serverTs:o},g,{receiptType:d("WAMapMixinNameToReceiptType").mapMixinNameToReceiptType(l.name)})).then(d("WAResultOrError").makeResult);break;case"Retry":if(g.aggregatedType!=="none"){k.ERROR(j());return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult(m()))}if(e!=null){g=d("WATransformToRetryReceipt").transformToRetryReceipt({aggregate:g,retryMixin:l.value,recipient:p,offline:n});return e({receiptType:"retry",retryReceipt:g,makeAck:m,author:q,chat:f,offline:n,serverTs:o,socketId:a}).then(d("WAResultOrError").makeResult)}break;case"PlayedType":case"DeliverBizType":case"PlayedSelfType":case"ServerErrorType":case"DeliverLIDFeatureIncapableType":case"EngagedType":case"DeliverMdDowngradeType":case"ViewType":case"DeprecatedDeliveryType":case"UnknownType":k.ERROR(i(),l.name);break;default:l.name}}return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult(m()))}}g.createHandleGroupReceiptBranch=a}),98);
__d("WACreateHandleIndividualReceiptBranch",["Promise","WAJids","WAMapMixinNameToReceiptType","WAResultOrError","WATagsLogger","WATransformToRetryReceipt"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleIndividualReceipt: receipt type "," is not handled yet"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["retry receipt not supported for aggregated messages"]);j=function(){return a};return a}var k=d("WATagsLogger").TAGS(["decision tree","handleIndividualMessageBranch"]);function a(a){var c=a.handleIndividualReceipt,e=a.handleIndividualRetryReceipt;return function(a){var f=a.aggregate,g=a.receiptType,l=a.makeAck,m=a.offline,n=a.serverTs,o=a.recipient;a=a.socketId;m=(m=m)!=null?m:null;var p=f.receiptSender;p=o==null?d("WAJids").extractUserJid(p):o;if(g==null){var q=o==null?"@me":o;if(c!=null)return c(babelHelpers["extends"]({makeAck:l,author:q,chat:p,offline:m,serverTs:n},f,{receiptType:"delivered"})).then(d("WAResultOrError").makeResult)}else{q=o==null?"@me":g.name==="SenderType"||g.name==="ReadSelfType"?"@me":o;switch(g.name){case"ReadType":case"SenderType":case"InactiveType":case"ReadSelfType":if(c!=null)return c(babelHelpers["extends"]({makeAck:l,author:q,chat:p,offline:m,serverTs:n},f,{receiptType:d("WAMapMixinNameToReceiptType").mapMixinNameToReceiptType(g.name)})).then(d("WAResultOrError").makeResult);break;case"Retry":if(f.aggregatedType!=="none"){k.ERROR(j());return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult(l()))}if(e!=null){f=d("WATransformToRetryReceipt").transformToRetryReceipt({aggregate:f,retryMixin:g.value,recipient:o,offline:m});return e({receiptType:"retry",retryReceipt:f,makeAck:l,author:q,chat:p,offline:m,serverTs:n,socketId:a}).then(d("WAResultOrError").makeResult)}break;case"PlayedType":case"DeliverBizType":case"PlayedSelfType":case"ServerErrorType":case"DeliverLIDFeatureIncapableType":case"EngagedType":case"DeliverMdDowngradeType":case"ViewType":case"DeprecatedDeliveryType":case"UnknownType":k.ERROR(i(),g.name);break;default:g.name}}return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult(l()))}}g.createHandleIndividualReceiptBranch=a}),98);
__d("WASmaxInReceiptAppDataPeerCategoryMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"category","peer_appdata");return!b.success?b:d("WAResultOrError").makeResult({category:b.value})}g.parseAppDataPeerCategoryMixin=a}),98);
__d("WASmaxInReceiptDeliverAppDataPeerPeerDeliveryMixin",["WASmaxInReceiptAppDataPeerCategoryMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptAppDataPeerCategoryMixin").parseAppDataPeerCategoryMixin(a);return!b.success?b:b}g.parseDeliverAppDataPeerPeerDeliveryMixin=a}),98);
__d("WASmaxInReceiptRetryTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"retry");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","retry");if(!a.success)return a;var c=d("WASmaxParseUtils").attrStanzaId(b.value,"id");if(!c.success)return c;var e=d("WASmaxParseUtils").attrIntRange(b.value,"count",1,256);if(!e.success)return e;var f=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,b.value,"v","1");if(!f.success)return f;var g=d("WASmaxParseUtils").attrIntRange(b.value,"t",0,void 0);if(!g.success)return g;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,b.value,"error",0,1024);return!b.success?b:d("WAResultOrError").makeResult({type:a.value,retryId:c.value,retryCount:e.value,retryV:f.value,retryT:g.value,retryError:b.value})}g.parseRetryTypeMixin=a}),98);
__d("WASmaxInReceiptAppDataPeerRetryTypeMixin",["WAResultOrError","WASmaxInReceiptAppDataPeerCategoryMixin","WASmaxInReceiptRetryTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptRetryTypeMixin").parseRetryTypeMixin(a);if(!b.success)return b;a=d("WASmaxInReceiptAppDataPeerCategoryMixin").parseAppDataPeerCategoryMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,a.value))}g.parseAppDataPeerRetryTypeMixin=a}),98);
__d("WASmaxInReceiptDeviceIdentityMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"device-identity");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytes(a.value);return!a.success?a:d("WAResultOrError").makeResult({deviceIdentityElementValue:a.value})}g.parseDeviceIdentityMixin=a}),98);
__d("WASmaxInReceiptKeyDataMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").contentBytesRange(a,32,32);return!a.success?a:d("WAResultOrError").makeResult({elementValue:a.value})}g.parseKeyDataMixin=a}),98);
__d("WASmaxInReceiptIdentityKeyMixin",["WASmaxInReceiptKeyDataMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"identity");if(!a.success)return a;a=d("WASmaxInReceiptKeyDataMixin").parseKeyDataMixin(a.value);return!a.success?a:a}g.parseIdentityKeyMixin=a}),98);
__d("WASmaxInReceiptKeyTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"type");if(!a.success)return a;a=d("WASmaxParseUtils").contentLiteralBytes(a.value,new Uint8Array([5]));return!a.success?a:d("WAResultOrError").makeResult({typeElementValue:a.value})}g.parseKeyTypeMixin=a}),98);
__d("WASmaxInReceiptKeyIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"id");if(!b.success)return b;b=d("WASmaxParseUtils").contentBytesRange(a,3,3);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}g.parseKeyIDMixin=a}),98);
__d("WASmaxInReceiptPreKeyMixin",["WAResultOrError","WASmaxInReceiptKeyDataMixin","WASmaxInReceiptKeyIDMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"key");if(!a.success)return a;var b=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"id");if(!b.success)return b;a=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"value");if(!a.success)return a;b=d("WASmaxInReceiptKeyIDMixin").parseKeyIDMixin(b.value);if(!b.success)return b;a=d("WASmaxInReceiptKeyDataMixin").parseKeyDataMixin(a.value);return!a.success?a:d("WAResultOrError").makeResult({keyIdKeyIDMixin:b.value,keyValueKeyDataMixin:a.value})}g.parsePreKeyMixin=a}),98);
__d("WASmaxInReceiptSignedPreKeyMixin",["WAResultOrError","WASmaxInReceiptKeyDataMixin","WASmaxInReceiptKeyIDMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"skey");if(!a.success)return a;var b=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"id");if(!b.success)return b;var c=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"value");if(!c.success)return c;a=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"signature");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytesRange(a.value,64,64);if(!a.success)return a;b=d("WASmaxInReceiptKeyIDMixin").parseKeyIDMixin(b.value);if(!b.success)return b;c=d("WASmaxInReceiptKeyDataMixin").parseKeyDataMixin(c.value);return!c.success?c:d("WAResultOrError").makeResult({skeySignatureElementValue:a.value,skeyIdKeyIDMixin:b.value,skeyValueKeyDataMixin:c.value})}g.parseSignedPreKeyMixin=a}),98);
__d("WASmaxInReceiptKeyBundleMixin",["WAResultOrError","WASmaxInReceiptDeviceIdentityMixin","WASmaxInReceiptIdentityKeyMixin","WASmaxInReceiptKeyTypeMixin","WASmaxInReceiptPreKeyMixin","WASmaxInReceiptSignedPreKeyMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"keys");if(!b.success)return b;a=d("WASmaxInReceiptKeyTypeMixin").parseKeyTypeMixin(b.value);if(!a.success)return a;var c=d("WASmaxInReceiptIdentityKeyMixin").parseIdentityKeyMixin(b.value);if(!c.success)return c;var e=d("WASmaxInReceiptSignedPreKeyMixin").parseSignedPreKeyMixin(b.value);if(!e.success)return e;var f=d("WASmaxInReceiptPreKeyMixin").parsePreKeyMixin(b.value);if(!f.success)return f;b=d("WASmaxInReceiptDeviceIdentityMixin").parseDeviceIdentityMixin(b.value);return d("WAResultOrError").makeResult({keysKeyTypeMixin:a.value,keysIdentityKeyMixin:c.value,keysSignedPreKeyMixin:e.value,keysPreKeyMixin:f.value,keysDeviceIdentityMixin:b.success?b.value:null})}g.parseKeyBundleMixin=a}),98);
__d("WASmaxInReceiptRegistrationIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"registration");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytesRange(a.value,4,4);return!a.success?a:d("WAResultOrError").makeResult({registrationElementValue:a.value})}g.parseRegistrationIDMixin=a}),98);
__d("WASmaxInReceiptDeliverAppDataPeerPeerRetryMixin",["WAResultOrError","WASmaxInReceiptAppDataPeerRetryTypeMixin","WASmaxInReceiptKeyBundleMixin","WASmaxInReceiptRegistrationIDMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptAppDataPeerRetryTypeMixin").parseAppDataPeerRetryTypeMixin(a);if(!b.success)return b;var c=d("WASmaxInReceiptRegistrationIDMixin").parseRegistrationIDMixin(a);if(!c.success)return c;a=d("WASmaxInReceiptKeyBundleMixin").parseKeyBundleMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,c.value,{keyBundleMixin:a.success?a.value:null}))}g.parseDeliverAppDataPeerPeerRetryMixin=a}),98);
__d("WASmaxInReceiptPeerDeliverAppDataPeerRetryOrDeliverAppDataPeerDeliveryMixinGroup",["WAResultOrError","WASmaxInReceiptDeliverAppDataPeerPeerDeliveryMixin","WASmaxInReceiptDeliverAppDataPeerPeerRetryMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInReceiptDeliverAppDataPeerPeerRetryMixin").parseDeliverAppDataPeerPeerRetryMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"DeliverAppDataPeerPeerRetry",value:b.value});var c=d("WASmaxInReceiptDeliverAppDataPeerPeerDeliveryMixin").parseDeliverAppDataPeerPeerDeliveryMixin(a);return c.success?d("WAResultOrError").makeResult({name:"DeliverAppDataPeerPeerDelivery",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["PeerRetry","PeerDelivery"],[b,c])}g.parsePeerDeliverAppDataPeerRetryOrDeliverAppDataPeerDeliveryMixinGroup=a}),98);
__d("WASmaxInReceiptDeliverAppDataPeerRequest",["WAResultOrError","WASmaxInReceiptPeerDeliverAppDataPeerRetryOrDeliverAppDataPeerDeliveryMixinGroup","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!b.success)return b;var c=d("WASmaxParseJid").attrDeviceJid(a,"from");if(!c.success)return c;a=d("WASmaxInReceiptPeerDeliverAppDataPeerRetryOrDeliverAppDataPeerDeliveryMixinGroup").parsePeerDeliverAppDataPeerRetryOrDeliverAppDataPeerDeliveryMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({id:b.value,from:c.value,peerDeliverAppDataPeerRetryOrDeliverAppDataPeerDeliveryMixinGroup:a.value})}g.parseDeliverAppDataPeerRequest=a}),98);
__d("WASmaxOutReceiptDeliverAppDataPeerResponseSuccess",["WASmaxAttrs","WASmaxJsx","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrDeviceJid,a,["from"]);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);a=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{id:d("WAWap").STANZA_ID(b.value),"class":"receipt",to:d("WAWap").DEVICE_JID(c.value),type:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a.value)});return b}g.makeDeliverAppDataPeerResponseSuccess=a}),98);
__d("WASmaxReceiptDeliverAppDataPeerRPC",["WASmaxInReceiptDeliverAppDataPeerRequest","WASmaxOutReceiptDeliverAppDataPeerResponseSuccess","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInReceiptDeliverAppDataPeerRequest").parseDeliverAppDataPeerRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("DeliverAppDataPeer",{Request:b}));return{parsedRequest:b.value,makeDeliverAppDataPeerResponseSuccess:function(){return d("WASmaxOutReceiptDeliverAppDataPeerResponseSuccess").makeDeliverAppDataPeerResponseSuccess(a)}}}g.receiveDeliverAppDataPeerRPC=a}),98);
__d("WACreateHandlePeerAppdataReceiptBranch",["Promise","WAParseKeyBundleMixing","WAResultOrError","WASignalOther","WASmaxReceiptDeliverAppDataPeerRPC","WATagsLogger","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Peer appdata receipt is not handled."]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["start..."]);j=function(){return a};return a}var k=d("WATagsLogger").TAGS(["decision tree","handlePeerAppdataReceiptBranch"]);function a(a){var c=a.handlePeerAppdataReceipt,e=a.handlePeerAppdataRetryReceipt;return function(a,f){k.DEV(j());a=d("WASmaxReceiptDeliverAppDataPeerRPC").receiveDeliverAppDataPeerRPC(a);var g=a.parsedRequest,l=g.id,m=g.from;g=g.peerDeliverAppDataPeerRetryOrDeliverAppDataPeerDeliveryMixinGroup;a=a.makeDeliverAppDataPeerResponseSuccess;switch(g.name){case"DeliverAppDataPeerPeerDelivery":if(c!=null)return c({receiptType:"delivered",stanzaId:l,receiptSender:m,makeAck:a}).then(d("WAResultOrError").makeResult);break;case"DeliverAppDataPeerPeerRetry":if(e!=null){var n=g.value,o=n.keyBundleMixin,p=n.registrationElementValue,q=n.retryCount,r=n.retryId,s=n.retryT;n=n.category;p=d("WASignalOther").castRegistrationIdFromBytes(p);return e({receiptType:"retry",category:n,retryReceipt:{stanzaId:l,retryStanzaId:r,receiptSender:m,retryCount:q,regId:p,timestamp:d("WATimeUtils").castToUnixTime(s),keys:o?d("WAParseKeyBundleMixing").parseKeyBundleMixin(p,o):null},makeAck:a,socketId:f}).then(d("WAResultOrError").makeResult)}break;default:g.name}k.WARN(i());return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult(a()))}}g.createHandlePeerAppdataReceiptBranch=a}),98);
__d("WASmaxInReceiptPeerMessageTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","peer_msg");return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parsePeerMessageTypeMixin=a}),98);
__d("WASmaxInReceiptSingleMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").attrStanzaId(a,"id");return!b.success?b:d("WAResultOrError").makeResult({id:b.value})}g.parseSingleMixin=a}),98);
__d("WASmaxInReceiptDeliverPeerDeliveryMixin",["WAResultOrError","WASmaxInReceiptPeerMessageTypeMixin","WASmaxInReceiptSingleMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptSingleMixin").parseSingleMixin(a);if(!b.success)return b;a=d("WASmaxInReceiptPeerMessageTypeMixin").parsePeerMessageTypeMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,a.value))}g.parseDeliverPeerDeliveryMixin=a}),98);
__d("WASmaxInReceiptHSMErrorTypeMixin",["WAResultOrError","WASmaxInReceiptEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","error");if(!a.success)return a;var c=d("WASmaxParseUtils").attrStringEnum(b.value,"type",d("WASmaxInReceiptEnums").ENUM_HSMENVELOPEMISMATCH_STRUCTUREUNAVAILABLE);if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,b.value,"reason",d("WASmaxInReceiptEnums").ENUM_1002_1007_1008);if(!e.success)return e;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,b.value,"sub_type",d("WASmaxInReceiptEnums").ENUM_CONTENT_TITLE);return!b.success?b:d("WAResultOrError").makeResult({type:a.value,errorType:c.value,errorReason:e.value,errorSubType:b.value})}g.parseHSMErrorTypeMixin=a}),98);
__d("WASmaxInReceiptDeliverPeerErrorMixin",["WAResultOrError","WASmaxInReceiptHSMErrorTypeMixin","WASmaxInReceiptSingleMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptSingleMixin").parseSingleMixin(a);if(!b.success)return b;a=d("WASmaxInReceiptHSMErrorTypeMixin").parseHSMErrorTypeMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,a.value))}g.parseDeliverPeerErrorMixin=a}),98);
__d("WASmaxInReceiptPeerCategoryMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"category","peer");return!b.success?b:d("WAResultOrError").makeResult({category:b.value})}g.parsePeerCategoryMixin=a}),98);
__d("WASmaxInReceiptPeerRetryTypeMixin",["WAResultOrError","WASmaxInReceiptPeerCategoryMixin","WASmaxInReceiptRetryTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptRetryTypeMixin").parseRetryTypeMixin(a);if(!b.success)return b;a=d("WASmaxInReceiptPeerCategoryMixin").parsePeerCategoryMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,a.value))}g.parsePeerRetryTypeMixin=a}),98);
__d("WASmaxInReceiptDeliverPeerPeerRetryMixin",["WAResultOrError","WASmaxInReceiptKeyBundleMixin","WASmaxInReceiptPeerRetryTypeMixin","WASmaxInReceiptRegistrationIDMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptPeerRetryTypeMixin").parsePeerRetryTypeMixin(a);if(!b.success)return b;var c=d("WASmaxInReceiptRegistrationIDMixin").parseRegistrationIDMixin(a);if(!c.success)return c;a=d("WASmaxInReceiptKeyBundleMixin").parseKeyBundleMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,c.value,{keyBundleMixin:a.success?a.value:null}))}g.parseDeliverPeerPeerRetryMixin=a}),98);
__d("WASmaxInReceiptHistorySyncTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","hist_sync");return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parseHistorySyncTypeMixin=a}),98);
__d("WASmaxInReceiptOfflineMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrIntRange(a,"offline",0,12);return!a.success?a:d("WAResultOrError").makeResult({offline:a.value})}g.parseOfflineMixin=a}),98);
__d("WASmaxInReceiptDeliverPeerReadMixin",["WAResultOrError","WASmaxInReceiptHistorySyncTypeMixin","WASmaxInReceiptOfflineMixin","WASmaxInReceiptSingleMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptSingleMixin").parseSingleMixin(a);if(!b.success)return b;var c=d("WASmaxInReceiptHistorySyncTypeMixin").parseHistorySyncTypeMixin(a);if(!c.success)return c;a=d("WASmaxInReceiptOfflineMixin").parseOfflineMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,c.value,{offlineMixin:a.success?a.value:null}))}g.parseDeliverPeerReadMixin=a}),98);
__d("WASmaxInReceiptEncryptMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"encrypt");if(!b.success)return b;a=d("WASmaxParseUtils").flattenedChildWithTag(b.value,"enc_p");if(!a.success)return a;b=d("WASmaxParseUtils").flattenedChildWithTag(b.value,"enc_iv");if(!b.success)return b;a=d("WASmaxParseUtils").contentBytesRange(a.value,1,600);if(!a.success)return a;b=d("WASmaxParseUtils").contentBytesRange(b.value,12,12);return!b.success?b:d("WAResultOrError").makeResult({encryptEncPElementValue:a.value,encryptEncIvElementValue:b.value})}g.parseEncryptMixin=a}),98);
__d("WASmaxInReceiptRmrBroadcastDeprecatedMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"rmr");if(!b.success)return b;b=d("WASmaxParseJid").attrBroadcastJid(a,"jid");return!b.success?b:d("WAResultOrError").makeResult({jid:b.value})}g.parseRmrBroadcastDeprecatedMixin=a}),98);
__d("WASmaxInReceiptRmrBroadcastMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"rmr");if(!b.success)return b;b=d("WASmaxParseJid").attrBroadcastJid(a,"jid");if(!b.success)return b;a=d("WASmaxParseJid").attrUserJid(a,"participant");return!a.success?a:d("WAResultOrError").makeResult({jid:b.value,participant:a.value})}g.parseRmrBroadcastMixin=a}),98);
__d("WASmaxInReceiptRmrGroupDeprecatedMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"rmr");if(!b.success)return b;b=d("WASmaxParseJid").attrGroupJid(a,"jid");return!b.success?b:d("WAResultOrError").makeResult({jid:b.value})}g.parseRmrGroupDeprecatedMixin=a}),98);
__d("WASmaxInReceiptRmrGroupMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"rmr");if(!b.success)return b;b=d("WASmaxParseJid").attrGroupJid(a,"jid");if(!b.success)return b;a=d("WASmaxParseJid").attrUserJid(a,"participant");return!a.success?a:d("WAResultOrError").makeResult({jid:b.value,participant:a.value})}g.parseRmrGroupMixin=a}),98);
__d("WASmaxInReceiptRmrIndividualDeprecatedMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"rmr");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"jid");if(!b.success)return b;a=d("WASmaxParseJid").attrUserJid(a,"participant");return!a.success?a:d("WAResultOrError").makeResult({jid:b.value,participant:a.value})}g.parseRmrIndividualDeprecatedMixin=a}),98);
__d("WASmaxInReceiptRmrIndividualMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"rmr");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"jid");return!b.success?b:d("WAResultOrError").makeResult({jid:b.value})}g.parseRmrIndividualMixin=a}),98);
__d("WASmaxInReceiptServerErrorRmrTypes",["WAResultOrError","WASmaxInReceiptRmrBroadcastDeprecatedMixin","WASmaxInReceiptRmrBroadcastMixin","WASmaxInReceiptRmrGroupDeprecatedMixin","WASmaxInReceiptRmrGroupMixin","WASmaxInReceiptRmrIndividualDeprecatedMixin","WASmaxInReceiptRmrIndividualMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInReceiptRmrBroadcastMixin").parseRmrBroadcastMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"RmrBroadcast",value:b.value});var c=d("WASmaxInReceiptRmrGroupMixin").parseRmrGroupMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"RmrGroup",value:c.value});var e=d("WASmaxInReceiptRmrIndividualDeprecatedMixin").parseRmrIndividualDeprecatedMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"RmrIndividualDeprecated",value:e.value});var f=d("WASmaxInReceiptRmrIndividualMixin").parseRmrIndividualMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"RmrIndividual",value:f.value});var g=d("WASmaxInReceiptRmrGroupDeprecatedMixin").parseRmrGroupDeprecatedMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"RmrGroupDeprecated",value:g.value});var h=d("WASmaxInReceiptRmrBroadcastDeprecatedMixin").parseRmrBroadcastDeprecatedMixin(a);return h.success?d("WAResultOrError").makeResult({name:"RmrBroadcastDeprecated",value:h.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["RmrBroadcast","RmrGroup","RmrIndividualDeprecated","RmrIndividual","RmrGroupDeprecated","RmrBroadcastDeprecated"],[b,c,e,f,g,h])}g.parseServerErrorRmrTypes=a}),98);
__d("WASmaxInReceiptServerErrorTypeMixin",["WAResultOrError","WASmaxInReceiptEncryptMixin","WASmaxInReceiptEnums","WASmaxInReceiptServerErrorRmrTypes","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"rmr");if(!b.success)return b;b=d("WASmaxParseUtils").attrStringEnum(a,"from_me",d("WASmaxInReceiptEnums").ENUM_FALSE_TRUE);if(!b.success)return b;a=d("WASmaxInReceiptServerErrorRmrTypes").parseServerErrorRmrTypes(a);return!a.success?a:d("WAResultOrError").makeResult({fromMe:b.value,serverErrorRmrTypes:a.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"rmr",h);if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","server-error");if(!c.success)return c;a=d("WASmaxInReceiptEncryptMixin").parseEncryptMixin(a);return d("WAResultOrError").makeResult({type:c.value,encryptMixin:a.success?a.value:null,rmr:b.value})}g.parseServerErrorTypeRmr=h;g.parseServerErrorTypeMixin=a}),98);
__d("WASmaxInReceiptPeerServerErrorTypeMixin",["WAResultOrError","WASmaxInReceiptPeerCategoryMixin","WASmaxInReceiptServerErrorTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptServerErrorTypeMixin").parseServerErrorTypeMixin(a);if(!b.success)return b;a=d("WASmaxInReceiptPeerCategoryMixin").parsePeerCategoryMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,a.value))}g.parsePeerServerErrorTypeMixin=a}),98);
__d("WASmaxInReceiptDeliverPeerServerErrorMixin",["WAResultOrError","WASmaxInReceiptPeerServerErrorTypeMixin","WASmaxInReceiptSingleMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptSingleMixin").parseSingleMixin(a);if(!b.success)return b;a=d("WASmaxInReceiptPeerServerErrorTypeMixin").parsePeerServerErrorTypeMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,a.value))}g.parseDeliverPeerServerErrorMixin=a}),98);
__d("WASmaxInReceiptDeliverPeerReceiptType",["WAResultOrError","WASmaxInReceiptDeliverPeerDeliveryMixin","WASmaxInReceiptDeliverPeerErrorMixin","WASmaxInReceiptDeliverPeerPeerRetryMixin","WASmaxInReceiptDeliverPeerReadMixin","WASmaxInReceiptDeliverPeerServerErrorMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInReceiptDeliverPeerPeerRetryMixin").parseDeliverPeerPeerRetryMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"DeliverPeerPeerRetry",value:b.value});var c=d("WASmaxInReceiptDeliverPeerReadMixin").parseDeliverPeerReadMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"DeliverPeerRead",value:c.value});var e=d("WASmaxInReceiptDeliverPeerServerErrorMixin").parseDeliverPeerServerErrorMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"DeliverPeerServerError",value:e.value});var f=d("WASmaxInReceiptDeliverPeerErrorMixin").parseDeliverPeerErrorMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"DeliverPeerError",value:f.value});var g=d("WASmaxInReceiptDeliverPeerDeliveryMixin").parseDeliverPeerDeliveryMixin(a);return g.success?d("WAResultOrError").makeResult({name:"DeliverPeerDelivery",value:g.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["PeerRetry","Read","ServerError","Error","Delivery"],[b,c,e,f,g])}g.parseDeliverPeerReceiptType=a}),98);
__d("WASmaxInReceiptDeliverPeerRequest",["WAResultOrError","WASmaxInReceiptDeliverPeerReceiptType","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!b.success)return b;var c=d("WASmaxParseJid").attrDeviceJid(a,"from");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"t",0,void 0);if(!e.success)return e;a=d("WASmaxInReceiptDeliverPeerReceiptType").parseDeliverPeerReceiptType(a);return!a.success?a:d("WAResultOrError").makeResult({id:b.value,from:c.value,t:e.value,deliverPeerReceiptType:a.value})}g.parseDeliverPeerRequest=a}),98);
__d("WASmaxOutReceiptDeliverPeerResponseSuccess",["WASmaxJsx","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrDeviceJid,a,["from"]);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);a=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{id:d("WAWap").STANZA_ID(b.value),"class":"receipt",to:d("WAWap").DEVICE_JID(c.value),type:d("WAWap").CUSTOM_STRING(a.value)});return b}g.makeDeliverPeerResponseSuccess=a}),98);
__d("WASmaxReceiptDeliverPeerRPC",["WASmaxInReceiptDeliverPeerRequest","WASmaxOutReceiptDeliverPeerResponseSuccess","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInReceiptDeliverPeerRequest").parseDeliverPeerRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("DeliverPeer",{Request:b}));return{parsedRequest:b.value,makeDeliverPeerResponseSuccess:function(){return d("WASmaxOutReceiptDeliverPeerResponseSuccess").makeDeliverPeerResponseSuccess(a)}}}g.receiveDeliverPeerRPC=a}),98);
__d("WASmaxInReceiptMessageAggregatedMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"user");if(!b.success)return b;b=d("WASmaxParseJid").attrDeviceJid(a,"jid");if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({jid:b.value,t:a.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"participants");if(!b.success)return b;a=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!a.success)return a;var c=d("WASmaxParseUtils").attrStanzaId(b.value,"key");if(!c.success)return c;b=d("WASmaxParseUtils").mapChildrenWithTag(b.value,"user",1,1024,h);return!b.success?b:d("WAResultOrError").makeResult({id:a.value,participantsKey:c.value,participantsUser:b.value})}g.parseMessageAggregatedParticipantsUser=h;g.parseMessageAggregatedMixin=a}),98);
__d("WASmaxInReceiptInactiveTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","inactive");return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parseInactiveTypeMixin=a}),98);
__d("WASmaxInReceiptPlayedSelfTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","played-self");return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parsePlayedSelfTypeMixin=a}),98);
__d("WASmaxInReceiptPlayedTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","played");return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parsePlayedTypeMixin=a}),98);
__d("WASmaxInReceiptReadSelfTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","read-self");return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parseReadSelfTypeMixin=a}),98);
__d("WASmaxInReceiptReadTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","read");return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parseReadTypeMixin=a}),98);
__d("WASmaxInReceiptSenderTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","sender");return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parseSenderTypeMixin=a}),98);
__d("WASmaxInReceiptUnknownTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"type");return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parseUnknownTypeMixin=a}),98);
__d("WASmaxInReceiptMessageAggregatedStyleReceiptType",["WAResultOrError","WASmaxInReceiptInactiveTypeMixin","WASmaxInReceiptPlayedSelfTypeMixin","WASmaxInReceiptPlayedTypeMixin","WASmaxInReceiptReadSelfTypeMixin","WASmaxInReceiptReadTypeMixin","WASmaxInReceiptSenderTypeMixin","WASmaxInReceiptUnknownTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInReceiptSenderTypeMixin").parseSenderTypeMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"SenderType",value:b.value});var c=d("WASmaxInReceiptInactiveTypeMixin").parseInactiveTypeMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"InactiveType",value:c.value});var e=d("WASmaxInReceiptReadTypeMixin").parseReadTypeMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"ReadType",value:e.value});var f=d("WASmaxInReceiptReadSelfTypeMixin").parseReadSelfTypeMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"ReadSelfType",value:f.value});var g=d("WASmaxInReceiptPlayedTypeMixin").parsePlayedTypeMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"PlayedType",value:g.value});var h=d("WASmaxInReceiptPlayedSelfTypeMixin").parsePlayedSelfTypeMixin(a);if(h.success)return d("WAResultOrError").makeResult({name:"PlayedSelfType",value:h.value});var i=d("WASmaxInReceiptUnknownTypeMixin").parseUnknownTypeMixin(a);return i.success?d("WAResultOrError").makeResult({name:"UnknownType",value:i.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["SenderType","InactiveType","ReadType","ReadSelfType","PlayedType","PlayedSelfType","UnknownType"],[b,c,e,f,g,h,i])}g.parseMessageAggregatedStyleReceiptType=a}),98);
__d("WASmaxInReceiptRecipientMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"recipient");return!b.success?b:d("WAResultOrError").makeResult({recipient:b.value})}g.parseRecipientMixin=a}),98);
__d("WASmaxInReceiptDeliverMessageAggregatedStyleMixin",["WAResultOrError","WASmaxInReceiptEnums","WASmaxInReceiptMessageAggregatedMixin","WASmaxInReceiptMessageAggregatedStyleReceiptType","WASmaxInReceiptRecipientMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseJid").attrJidEnum(a,"from",d("WASmaxInReceiptEnums").BROADCASTJID_GROUPJID_NEWSLETTERJID_STATUSJID);if(!b.success)return b;var c=d("WASmaxInReceiptRecipientMixin").parseRecipientMixin(a),e=d("WASmaxInReceiptMessageAggregatedMixin").parseMessageAggregatedMixin(a);if(!e.success)return e;a=d("WASmaxInReceiptMessageAggregatedStyleReceiptType").parseMessageAggregatedStyleReceiptType(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({from:b.value,recipientMixin:c.success?c.value:null},e.value,{messageAggregatedStyleReceiptType:a.success?a.value:null}))}g.parseDeliverMessageAggregatedStyleMixin=a}),98);
__d("WASmaxInReceiptDeliverBizRolesMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(b.value,"actual_actors",0,100);if(!a.success)return a;var c=d("WASmaxParseUtils").attrIntRange(b.value,"host_storage",0,100);if(!c.success)return c;b=d("WASmaxParseUtils").attrIntRange(b.value,"privacy_mode_ts",0,void 0);return!b.success?b:d("WAResultOrError").makeResult({bizActualActors:a.value,bizHostStorage:c.value,bizPrivacyModeTs:b.value})}g.parseDeliverBizRolesMixin=a}),98);
__d("WASmaxInReceiptDeliverPaidConversationAggregatedMixin",["WAResultOrError","WASmaxInReceiptEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"delivery_context");if(!b.success)return b;b=d("WASmaxParseUtils").attrStringEnum(a,"optimization_goal",d("WASmaxInReceiptEnums").ENUM_DELIVERY_NOOPTIMIZATION);return!b.success?b:d("WAResultOrError").makeResult({optimizationGoal:b.value})}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"source_url");if(!b.success)return b;b=d("WASmaxParseUtils").contentString(a);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}function j(a){var b=d("WASmaxParseUtils").assertTag(a,"referral");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"source_url",i);if(!b.success)return b;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"source_type");return!a.success?a:d("WAResultOrError").makeResult({sourceType:a.value,sourceUrl:b.value})}function k(a){var b=d("WASmaxParseUtils").assertTag(a,"origin");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"referral",j);if(!b.success)return b;a=d("WASmaxParseUtils").attrString(a,"type");return!a.success?a:d("WAResultOrError").makeResult({type:a.value,referral:b.value})}function l(a){var b=d("WASmaxParseUtils").assertTag(a,"item");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"delivery_context",h);if(!b.success)return b;var c=d("WASmaxParseUtils").optionalChildWithTag(a,"origin",k);if(!c.success)return c;var e=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!e.success)return e;var f=d("WASmaxParseUtils").attrString(a,"paid_convo_id");if(!f.success)return f;var g=d("WASmaxParseUtils").attrStringEnum(a,"pricing_model",d("WASmaxInReceiptEnums").ENUM_CBP_NBP);if(!g.success)return g;var i=d("WASmaxParseUtils").attrStringEnum(a,"billable",d("WASmaxInReceiptEnums").ENUM_FALSE_TRUE);if(!i.success)return i;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"pricing_category");return!a.success?a:d("WAResultOrError").makeResult({id:e.value,paidConvoId:f.value,pricingModel:g.value,billable:i.value,pricingCategory:a.value,deliveryContext:b.value,origin:c.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!b.success)return b;a=d("WASmaxParseUtils").flattenedChildWithTag(b.value,"paid_messaging");if(!a.success)return a;b=d("WASmaxParseUtils").mapChildrenWithTag(a.value,"item",0,128e3,l);return!b.success?b:d("WAResultOrError").makeResult({bizPaidMessagingItem:b.value})}g.parseDeliverPaidConversationAggregatedBizPaidMessagingItemDeliveryContext=h;g.parseDeliverPaidConversationAggregatedBizPaidMessagingItemOriginReferralSourceUrl=i;g.parseDeliverPaidConversationAggregatedBizPaidMessagingItemOriginReferral=j;g.parseDeliverPaidConversationAggregatedBizPaidMessagingItemOrigin=k;g.parseDeliverPaidConversationAggregatedBizPaidMessagingItem=l;g.parseDeliverPaidConversationAggregatedMixin=a}),98);
__d("WASmaxInReceiptDeliverSenderPNMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"sender_pn");return!b.success?b:d("WAResultOrError").makeResult({senderPn:b.value})}g.parseDeliverSenderPNMixin=a}),98);
__d("WASmaxInReceiptBroadcastMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseJid").attrBroadcastJid(a,"from");if(!b.success)return b;a=d("WASmaxParseJid").attrDeviceJid(a,"participant");return!a.success?a:d("WAResultOrError").makeResult({from:b.value,participant:a.value})}g.parseBroadcastMixin=a}),98);
__d("WASmaxInReceiptDeliverStatusMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseJid").attrStatusJid(a,"from");if(!b.success)return b;a=d("WASmaxParseJid").attrDeviceJid(a,"participant");return!a.success?a:d("WAResultOrError").makeResult({from:b.value,participant:a.value})}g.parseDeliverStatusMixin=a}),98);
__d("WASmaxInReceiptGroupMixin",["WAResultOrError","WASmaxInReceiptEnums","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseJid").attrGroupJid(a,"from");if(!b.success)return b;a=d("WASmaxParseJid").attrJidEnum(a,"participant",d("WASmaxInReceiptEnums").DEVICEJID_DEVICEJID);return!a.success?a:d("WAResultOrError").makeResult({from:b.value,participant:a.value})}g.parseGroupMixin=a}),98);
__d("WASmaxInReceiptIndividualMixin",["WAResultOrError","WASmaxInReceiptEnums","WASmaxInReceiptRecipientMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseJid").attrJidEnum(a,"from",d("WASmaxInReceiptEnums").DEVICEJID_DEVICEJID);if(!b.success)return b;a=d("WASmaxInReceiptRecipientMixin").parseRecipientMixin(a);return d("WAResultOrError").makeResult({from:b.value,recipientMixin:a.success?a.value:null})}g.parseIndividualMixin=a}),98);
__d("WASmaxInReceiptIndividualOrGroupOrDeliverStatusOrBroadcastMixinGroup",["WAResultOrError","WASmaxInReceiptBroadcastMixin","WASmaxInReceiptDeliverStatusMixin","WASmaxInReceiptGroupMixin","WASmaxInReceiptIndividualMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInReceiptIndividualMixin").parseIndividualMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"Individual",value:b.value});var c=d("WASmaxInReceiptGroupMixin").parseGroupMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"Group",value:c.value});var e=d("WASmaxInReceiptDeliverStatusMixin").parseDeliverStatusMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"DeliverStatus",value:e.value});var f=d("WASmaxInReceiptBroadcastMixin").parseBroadcastMixin(a);return f.success?d("WAResultOrError").makeResult({name:"Broadcast",value:f.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["Individual","Group","Status","Broadcast"],[b,c,e,f])}g.parseIndividualOrGroupOrDeliverStatusOrBroadcastMixinGroup=a}),98);
__d("WASmaxInReceiptSenderAggregatedDeliverMixin",["WAResultOrError","WASmaxInReceiptDeprecatedEditMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"item");if(!b.success)return b;b=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!b.success)return b;a=d("WASmaxInReceiptDeprecatedEditMixin").parseDeprecatedEditMixin(a);return d("WAResultOrError").makeResult({id:b.value,deprecatedEditMixin:a.success?a.value:null})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"list");if(!b.success)return b;a=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!a.success)return a;b=d("WASmaxParseUtils").mapChildrenWithTag(b.value,"item",0,128e3,h);return!b.success?b:d("WAResultOrError").makeResult({id:a.value,listItem:b.value})}g.parseSenderAggregatedDeliverListItem=h;g.parseSenderAggregatedDeliverMixin=a}),98);
__d("WASmaxInReceiptDeprecatedDeliveryTypeMixin",["WAResultOrError","WASmaxInReceiptEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").attrStringEnum(a,"type",d("WASmaxInReceiptEnums").ENUM_DELIVER_DELIVERY);return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parseDeprecatedDeliveryTypeMixin=a}),98);
__d("WASmaxInReceiptViewTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","view");return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parseViewTypeMixin=a}),98);
__d("WASmaxInReceiptSenderAggregatedStyleReceiptType",["WAResultOrError","WASmaxInReceiptDeprecatedDeliveryTypeMixin","WASmaxInReceiptInactiveTypeMixin","WASmaxInReceiptPlayedSelfTypeMixin","WASmaxInReceiptPlayedTypeMixin","WASmaxInReceiptReadSelfTypeMixin","WASmaxInReceiptReadTypeMixin","WASmaxInReceiptUnknownTypeMixin","WASmaxInReceiptViewTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInReceiptInactiveTypeMixin").parseInactiveTypeMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"InactiveType",value:b.value});var c=d("WASmaxInReceiptReadTypeMixin").parseReadTypeMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"ReadType",value:c.value});var e=d("WASmaxInReceiptReadSelfTypeMixin").parseReadSelfTypeMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"ReadSelfType",value:e.value});var f=d("WASmaxInReceiptPlayedTypeMixin").parsePlayedTypeMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"PlayedType",value:f.value});var g=d("WASmaxInReceiptPlayedSelfTypeMixin").parsePlayedSelfTypeMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"PlayedSelfType",value:g.value});var h=d("WASmaxInReceiptViewTypeMixin").parseViewTypeMixin(a);if(h.success)return d("WAResultOrError").makeResult({name:"ViewType",value:h.value});var i=d("WASmaxInReceiptDeprecatedDeliveryTypeMixin").parseDeprecatedDeliveryTypeMixin(a);if(i.success)return d("WAResultOrError").makeResult({name:"DeprecatedDeliveryType",value:i.value});var j=d("WASmaxInReceiptUnknownTypeMixin").parseUnknownTypeMixin(a);return j.success?d("WAResultOrError").makeResult({name:"UnknownType",value:j.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["InactiveType","ReadType","ReadSelfType","PlayedType","PlayedSelfType","ViewType","DeprecatedDeliveryType","UnknownType"],[b,c,e,f,g,h,i,j])}g.parseSenderAggregatedStyleReceiptType=a}),98);
__d("WASmaxInReceiptDeliverSenderAggregatedStyleMixin",["WAResultOrError","WASmaxInReceiptDeliverBizRolesMixin","WASmaxInReceiptDeliverPaidConversationAggregatedMixin","WASmaxInReceiptDeliverSenderPNMixin","WASmaxInReceiptIndividualOrGroupOrDeliverStatusOrBroadcastMixinGroup","WASmaxInReceiptRecipientMixin","WASmaxInReceiptSenderAggregatedDeliverMixin","WASmaxInReceiptSenderAggregatedStyleReceiptType","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptRecipientMixin").parseRecipientMixin(a);var c=d("WASmaxInReceiptSenderAggregatedDeliverMixin").parseSenderAggregatedDeliverMixin(a);if(!c.success)return c;var e=d("WASmaxInReceiptDeliverPaidConversationAggregatedMixin").parseDeliverPaidConversationAggregatedMixin(a),f=d("WASmaxInReceiptDeliverBizRolesMixin").parseDeliverBizRolesMixin(a),g=d("WASmaxInReceiptDeliverSenderPNMixin").parseDeliverSenderPNMixin(a),h=d("WASmaxInReceiptIndividualOrGroupOrDeliverStatusOrBroadcastMixinGroup").parseIndividualOrGroupOrDeliverStatusOrBroadcastMixinGroup(a);if(!h.success)return h;a=d("WASmaxInReceiptSenderAggregatedStyleReceiptType").parseSenderAggregatedStyleReceiptType(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({recipientMixin:b.success?b.value:null},c.value,{deliverPaidConversationAggregatedMixin:e.success?e.value:null,deliverBizRolesMixin:f.success?f.value:null,deliverSenderPNMixin:g.success?g.value:null,individualOrGroupOrDeliverStatusOrBroadcastMixinGroup:h.value,senderAggregatedStyleReceiptType:a.success?a.value:null}))}g.parseDeliverSenderAggregatedStyleMixin=a}),98);
__d("WASmaxInReceiptIndividualWithRecipientMixin",["WAResultOrError","WASmaxInReceiptRecipientMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseJid").attrDeviceJid(a,"from");if(!b.success)return b;a=d("WASmaxInReceiptRecipientMixin").parseRecipientMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({from:b.value},a.value))}g.parseIndividualWithRecipientMixin=a}),98);
__d("WASmaxInReceiptIndividualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup",["WAResultOrError","WASmaxInReceiptBroadcastMixin","WASmaxInReceiptDeliverStatusMixin","WASmaxInReceiptGroupMixin","WASmaxInReceiptIndividualWithRecipientMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInReceiptIndividualWithRecipientMixin").parseIndividualWithRecipientMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IndividualWithRecipient",value:b.value});var c=d("WASmaxInReceiptGroupMixin").parseGroupMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"Group",value:c.value});var e=d("WASmaxInReceiptDeliverStatusMixin").parseDeliverStatusMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"DeliverStatus",value:e.value});var f=d("WASmaxInReceiptBroadcastMixin").parseBroadcastMixin(a);return f.success?d("WAResultOrError").makeResult({name:"Broadcast",value:f.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IndividualWithRecipient","Group","Status","Broadcast"],[b,c,e,f])}g.parseIndividualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup=a}),98);
__d("WASmaxInReceiptDeliverSenderAggregatedStyleSenderTypeMixin",["WAResultOrError","WASmaxInReceiptIndividualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup","WASmaxInReceiptSenderAggregatedDeliverMixin","WASmaxInReceiptSenderTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptSenderAggregatedDeliverMixin").parseSenderAggregatedDeliverMixin(a);if(!b.success)return b;var c=d("WASmaxInReceiptSenderTypeMixin").parseSenderTypeMixin(a);if(!c.success)return c;a=d("WASmaxInReceiptIndividualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup").parseIndividualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,c.value,{individualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup:a.value}))}g.parseDeliverSenderAggregatedStyleSenderTypeMixin=a}),98);
__d("WASmaxInReceiptNewsletterDeliverMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseJid").attrNewsletterJid(a,"from");if(!b.success)return b;a=d("WASmaxParseJid").attrDeviceJid(a,"participant");return!a.success?a:d("WAResultOrError").makeResult({from:b.value,participant:a.value})}g.parseNewsletterDeliverMixin=a}),98);
__d("WASmaxInReceiptSenderAggregatedDeliverServerIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"item");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"server_id",99,2147476647);return!b.success?b:d("WAResultOrError").makeResult({serverId:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"list");if(!b.success)return b;a=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!a.success)return a;b=d("WASmaxParseUtils").mapChildrenWithTag(b.value,"item",0,128e3,h);return!b.success?b:d("WAResultOrError").makeResult({id:a.value,listItem:b.value})}g.parseSenderAggregatedDeliverServerIDListItem=h;g.parseSenderAggregatedDeliverServerIDMixin=a}),98);
__d("WASmaxInReceiptDeliverSenderAggregatedStyleViewTypeMixin",["WAResultOrError","WASmaxInReceiptNewsletterDeliverMixin","WASmaxInReceiptSenderAggregatedDeliverServerIDMixin","WASmaxInReceiptViewTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptNewsletterDeliverMixin").parseNewsletterDeliverMixin(a);if(!b.success)return b;var c=d("WASmaxInReceiptSenderAggregatedDeliverServerIDMixin").parseSenderAggregatedDeliverServerIDMixin(a);if(!c.success)return c;a=d("WASmaxInReceiptViewTypeMixin").parseViewTypeMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,c.value,a.value))}g.parseDeliverSenderAggregatedStyleViewTypeMixin=a}),98);
__d("WASmaxInReceiptSingleStyleChatType",["WAResultOrError","WASmaxInReceiptBroadcastMixin","WASmaxInReceiptDeliverStatusMixin","WASmaxInReceiptGroupMixin","WASmaxInReceiptIndividualMixin","WASmaxInReceiptNewsletterDeliverMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInReceiptIndividualMixin").parseIndividualMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"Individual",value:b.value});var c=d("WASmaxInReceiptGroupMixin").parseGroupMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"Group",value:c.value});var e=d("WASmaxInReceiptDeliverStatusMixin").parseDeliverStatusMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"DeliverStatus",value:e.value});var f=d("WASmaxInReceiptBroadcastMixin").parseBroadcastMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"Broadcast",value:f.value});var g=d("WASmaxInReceiptNewsletterDeliverMixin").parseNewsletterDeliverMixin(a);return g.success?d("WAResultOrError").makeResult({name:"NewsletterDeliver",value:g.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["Individual","Group","Status","Broadcast","NewsletterDeliver"],[b,c,e,f,g])}g.parseSingleStyleChatType=a}),98);
__d("WASmaxInReceiptDeliverFeatureIncapableErrorTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","error");if(!a.success)return a;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,b.value,"type","feature-incapable");return!b.success?b:d("WAResultOrError").makeResult({type:a.value,errorType:b.value})}g.parseDeliverFeatureIncapableErrorTypeMixin=a}),98);
__d("WASmaxInReceiptDeliverBizFeatureIncapableTypeWithReasonMixin",["WAResultOrError","WASmaxInReceiptDeliverFeatureIncapableErrorTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(b.value,"reason");if(!b.success)return b;a=d("WASmaxInReceiptDeliverFeatureIncapableErrorTypeMixin").parseDeliverFeatureIncapableErrorTypeMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({bizReason:b.value},a.value))}g.parseDeliverBizFeatureIncapableTypeWithReasonMixin=a}),98);
__d("WASmaxInReceiptOrderStatusErrorTypeMixin",["WAResultOrError","WASmaxInReceiptEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!b.success)return b;var c=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!c.success)return c;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","error");if(!a.success)return a;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,b.value,"type","order-status-update-failed");if(!b.success)return b;c=d("WASmaxParseUtils").attrStringEnum(c.value,"reason",d("WASmaxInReceiptEnums").ENUM_CANCELLATIONFAILED_INVALIDTRANSITION);return!c.success?c:d("WAResultOrError").makeResult({type:a.value,errorType:b.value,bizReason:c.value})}g.parseOrderStatusErrorTypeMixin=a}),98);
__d("WASmaxInReceiptBizErrorType",["WAResultOrError","WASmaxInReceiptDeliverBizFeatureIncapableTypeWithReasonMixin","WASmaxInReceiptDeliverFeatureIncapableErrorTypeMixin","WASmaxInReceiptHSMErrorTypeMixin","WASmaxInReceiptOrderStatusErrorTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInReceiptDeliverBizFeatureIncapableTypeWithReasonMixin").parseDeliverBizFeatureIncapableTypeWithReasonMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"DeliverBizFeatureIncapableTypeWithReason",value:b.value});var c=d("WASmaxInReceiptDeliverFeatureIncapableErrorTypeMixin").parseDeliverFeatureIncapableErrorTypeMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"DeliverFeatureIncapableErrorType",value:c.value});var e=d("WASmaxInReceiptHSMErrorTypeMixin").parseHSMErrorTypeMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"HSMErrorType",value:e.value});var f=d("WASmaxInReceiptOrderStatusErrorTypeMixin").parseOrderStatusErrorTypeMixin(a);return f.success?d("WAResultOrError").makeResult({name:"OrderStatusErrorType",value:f.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["BizFeatureIncapableTypeWithReason","FeatureIncapableErrorType","HSMErrorType","OrderStatusErrorType"],[b,c,e,f])}g.parseBizErrorType=a}),98);
__d("WASmaxInReceiptDeliverBizTypeMixin",["WAResultOrError","WASmaxInReceiptBizErrorType","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptBizErrorType").parseBizErrorType(a);return!b.success?b:d("WAResultOrError").makeResult({bizErrorType:b.value})}g.parseDeliverBizTypeMixin=a}),98);
__d("WASmaxInReceiptDeliverLIDFeatureIncapableTypeMixin",["WAResultOrError","WASmaxInReceiptDeliverFeatureIncapableErrorTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,b.value,"type","feature-incapable");if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,b.value,"reason","lid");if(!b.success)return b;a=d("WASmaxInReceiptDeliverFeatureIncapableErrorTypeMixin").parseDeliverFeatureIncapableErrorTypeMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({errorType:c.value,errorReason:b.value},a.value))}g.parseDeliverLIDFeatureIncapableTypeMixin=a}),98);
__d("WASmaxInReceiptRoiTemplateSourceMixin",["WAResultOrError","WASmaxInReceiptEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"biz");if(!b.success)return b;b=d("WASmaxParseUtils").attrStringEnum(a,"source",d("WASmaxInReceiptEnums").ENUM_BODYLINK_CTACALL_CTAURL_MEDIADOC_MEDIAIMAGE_MEDIAVIDEO_QUICKREPLY);return!b.success?b:d("WAResultOrError").makeResult({source:b.value})}g.parseRoiTemplateSourceMixin=a}),98);
__d("WASmaxInReceiptEngagedTypeMixin",["WAResultOrError","WASmaxInReceiptRoiTemplateSourceMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","engaged");if(!a.success)return a;var c=d("WASmaxParseUtils").attrString(b.value,"value");if(!c.success)return c;b=d("WASmaxInReceiptRoiTemplateSourceMixin").parseRoiTemplateSourceMixin(b.value);return!b.success?b:d("WAResultOrError").makeResult({type:a.value,bizValue:c.value,bizRoiTemplateSourceMixin:b.value})}g.parseEngagedTypeMixin=a}),98);
__d("WASmaxInReceiptRetryMixin",["WAResultOrError","WASmaxInReceiptKeyBundleMixin","WASmaxInReceiptRegistrationIDMixin","WASmaxInReceiptRetryTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptRetryTypeMixin").parseRetryTypeMixin(a);if(!b.success)return b;var c=d("WASmaxInReceiptRegistrationIDMixin").parseRegistrationIDMixin(a);if(!c.success)return c;a=d("WASmaxInReceiptKeyBundleMixin").parseKeyBundleMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,c.value,{keyBundleMixin:a.success?a.value:null}))}g.parseRetryMixin=a}),98);
__d("WASmaxInReceiptSingleStyleReceiptType",["WAResultOrError","WASmaxInReceiptDeliverBizTypeMixin","WASmaxInReceiptDeliverLIDFeatureIncapableTypeMixin","WASmaxInReceiptEngagedTypeMixin","WASmaxInReceiptInactiveTypeMixin","WASmaxInReceiptPlayedSelfTypeMixin","WASmaxInReceiptPlayedTypeMixin","WASmaxInReceiptReadSelfTypeMixin","WASmaxInReceiptReadTypeMixin","WASmaxInReceiptRetryMixin","WASmaxInReceiptServerErrorTypeMixin","WASmaxInReceiptUnknownTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInReceiptServerErrorTypeMixin").parseServerErrorTypeMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"ServerErrorType",value:b.value});var c=d("WASmaxInReceiptInactiveTypeMixin").parseInactiveTypeMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"InactiveType",value:c.value});var e=d("WASmaxInReceiptReadTypeMixin").parseReadTypeMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"ReadType",value:e.value});var f=d("WASmaxInReceiptReadSelfTypeMixin").parseReadSelfTypeMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"ReadSelfType",value:f.value});var g=d("WASmaxInReceiptPlayedTypeMixin").parsePlayedTypeMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"PlayedType",value:g.value});var h=d("WASmaxInReceiptPlayedSelfTypeMixin").parsePlayedSelfTypeMixin(a);if(h.success)return d("WAResultOrError").makeResult({name:"PlayedSelfType",value:h.value});var i=d("WASmaxInReceiptRetryMixin").parseRetryMixin(a);if(i.success)return d("WAResultOrError").makeResult({name:"Retry",value:i.value});var j=d("WASmaxInReceiptDeliverLIDFeatureIncapableTypeMixin").parseDeliverLIDFeatureIncapableTypeMixin(a);if(j.success)return d("WAResultOrError").makeResult({name:"DeliverLIDFeatureIncapableType",value:j.value});var k=d("WASmaxInReceiptDeliverBizTypeMixin").parseDeliverBizTypeMixin(a);if(k.success)return d("WAResultOrError").makeResult({name:"DeliverBizType",value:k.value});var l=d("WASmaxInReceiptEngagedTypeMixin").parseEngagedTypeMixin(a);if(l.success)return d("WAResultOrError").makeResult({name:"EngagedType",value:l.value});var m=d("WASmaxInReceiptUnknownTypeMixin").parseUnknownTypeMixin(a);return m.success?d("WAResultOrError").makeResult({name:"UnknownType",value:m.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["ServerErrorType","InactiveType","ReadType","ReadSelfType","PlayedType","PlayedSelfType","Retry","LIDFeatureIncapableType","BizType","EngagedType","UnknownType"],[b,c,e,f,g,h,i,j,k,l,m])}g.parseSingleStyleReceiptType=a}),98);
__d("WASmaxInReceiptDeliverSingleStyleMixin",["WAResultOrError","WASmaxInReceiptDeliverBizRolesMixin","WASmaxInReceiptDeliverPaidConversationAggregatedMixin","WASmaxInReceiptDeliverSenderPNMixin","WASmaxInReceiptRecipientMixin","WASmaxInReceiptSingleMixin","WASmaxInReceiptSingleStyleChatType","WASmaxInReceiptSingleStyleReceiptType","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptRecipientMixin").parseRecipientMixin(a);var c=d("WASmaxInReceiptSingleMixin").parseSingleMixin(a);if(!c.success)return c;var e=d("WASmaxInReceiptDeliverPaidConversationAggregatedMixin").parseDeliverPaidConversationAggregatedMixin(a),f=d("WASmaxInReceiptDeliverBizRolesMixin").parseDeliverBizRolesMixin(a),g=d("WASmaxInReceiptDeliverSenderPNMixin").parseDeliverSenderPNMixin(a),h=d("WASmaxInReceiptSingleStyleChatType").parseSingleStyleChatType(a);if(!h.success)return h;a=d("WASmaxInReceiptSingleStyleReceiptType").parseSingleStyleReceiptType(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({recipientMixin:b.success?b.value:null},c.value,{deliverPaidConversationAggregatedMixin:e.success?e.value:null,deliverBizRolesMixin:f.success?f.value:null,deliverSenderPNMixin:g.success?g.value:null,singleStyleChatType:h.value,singleStyleReceiptType:a.success?a.value:null}))}g.parseDeliverSingleStyleMixin=a}),98);
__d("WASmaxInReceiptDeliverMdDowngradeTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","md-downgrade");return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parseDeliverMdDowngradeTypeMixin=a}),98);
__d("WASmaxInReceiptSenderTypeOrDeliverMdDowngradeTypeOrRetryMixinGroup",["WAResultOrError","WASmaxInReceiptDeliverMdDowngradeTypeMixin","WASmaxInReceiptRetryMixin","WASmaxInReceiptSenderTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInReceiptSenderTypeMixin").parseSenderTypeMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"SenderType",value:b.value});var c=d("WASmaxInReceiptDeliverMdDowngradeTypeMixin").parseDeliverMdDowngradeTypeMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"DeliverMdDowngradeType",value:c.value});var e=d("WASmaxInReceiptRetryMixin").parseRetryMixin(a);return e.success?d("WAResultOrError").makeResult({name:"Retry",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["SenderType","MdDowngradeType","Retry"],[b,c,e])}g.parseSenderTypeOrDeliverMdDowngradeTypeOrRetryMixinGroup=a}),98);
__d("WASmaxInReceiptDeliverSingleStyleWithRecipientMixin",["WAResultOrError","WASmaxInReceiptDeliverSenderPNMixin","WASmaxInReceiptIndividualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup","WASmaxInReceiptSenderTypeOrDeliverMdDowngradeTypeOrRetryMixinGroup","WASmaxInReceiptSingleMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptSingleMixin").parseSingleMixin(a);if(!b.success)return b;var c=d("WASmaxInReceiptDeliverSenderPNMixin").parseDeliverSenderPNMixin(a),e=d("WASmaxInReceiptIndividualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup").parseIndividualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup(a);if(!e.success)return e;a=d("WASmaxInReceiptSenderTypeOrDeliverMdDowngradeTypeOrRetryMixinGroup").parseSenderTypeOrDeliverMdDowngradeTypeOrRetryMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{deliverSenderPNMixin:c.success?c.value:null,individualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup:e.value,senderTypeOrDeliverMdDowngradeTypeOrRetryMixinGroup:a.value}))}g.parseDeliverSingleStyleWithRecipientMixin=a}),98);
__d("WASmaxInReceiptReceiptStyles",["WAResultOrError","WASmaxInReceiptDeliverMessageAggregatedStyleMixin","WASmaxInReceiptDeliverSenderAggregatedStyleMixin","WASmaxInReceiptDeliverSenderAggregatedStyleSenderTypeMixin","WASmaxInReceiptDeliverSenderAggregatedStyleViewTypeMixin","WASmaxInReceiptDeliverSingleStyleMixin","WASmaxInReceiptDeliverSingleStyleWithRecipientMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInReceiptDeliverMessageAggregatedStyleMixin").parseDeliverMessageAggregatedStyleMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"DeliverMessageAggregatedStyle",value:b.value});var c=d("WASmaxInReceiptDeliverSenderAggregatedStyleSenderTypeMixin").parseDeliverSenderAggregatedStyleSenderTypeMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"DeliverSenderAggregatedStyleSenderType",value:c.value});var e=d("WASmaxInReceiptDeliverSenderAggregatedStyleViewTypeMixin").parseDeliverSenderAggregatedStyleViewTypeMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"DeliverSenderAggregatedStyleViewType",value:e.value});var f=d("WASmaxInReceiptDeliverSenderAggregatedStyleMixin").parseDeliverSenderAggregatedStyleMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"DeliverSenderAggregatedStyle",value:f.value});var g=d("WASmaxInReceiptDeliverSingleStyleWithRecipientMixin").parseDeliverSingleStyleWithRecipientMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"DeliverSingleStyleWithRecipient",value:g.value});var h=d("WASmaxInReceiptDeliverSingleStyleMixin").parseDeliverSingleStyleMixin(a);return h.success?d("WAResultOrError").makeResult({name:"DeliverSingleStyle",value:h.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["MessageAggregatedStyle","SenderAggregatedStyleSenderType","SenderAggregatedStyleViewType","SenderAggregatedStyle","SingleStyleWithRecipient","SingleStyle"],[b,c,e,f,g,h])}g.parseReceiptStyles=a}),98);
__d("WASmaxInReceiptToAgentParticipantMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"participant");return!b.success?b:d("WAResultOrError").makeResult({participant:b.value})}g.parseToAgentParticipantMixin=a}),98);
__d("WASmaxInReceiptToProxyAccountMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"actual_to");return!b.success?b:d("WAResultOrError").makeResult({actualTo:b.value})}g.parseToProxyAccountMixin=a}),98);
__d("WASmaxInReceiptDeliverRequest",["WAResultOrError","WASmaxInReceiptDeprecatedEditMixin","WASmaxInReceiptOfflineMixin","WASmaxInReceiptReceiptStyles","WASmaxInReceiptToAgentParticipantMixin","WASmaxInReceiptToProxyAccountMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!b.success)return b;var c=d("WASmaxInReceiptOfflineMixin").parseOfflineMixin(a),e=d("WASmaxInReceiptDeprecatedEditMixin").parseDeprecatedEditMixin(a),f=d("WASmaxInReceiptToProxyAccountMixin").parseToProxyAccountMixin(a),g=d("WASmaxInReceiptToAgentParticipantMixin").parseToAgentParticipantMixin(a);a=d("WASmaxInReceiptReceiptStyles").parseReceiptStyles(a);return!a.success?a:d("WAResultOrError").makeResult({t:b.value,offlineMixin:c.success?c.value:null,deprecatedEditMixin:e.success?e.value:null,toProxyAccountMixin:f.success?f.value:null,toAgentParticipantMixin:g.success?g.value:null,receiptStyles:a.value})}g.parseDeliverRequest=a}),98);
__d("WASmaxOutReceiptDeliverResponseSuccess",["WASmaxAttrs","WASmaxInReceiptEnums","WASmaxJsx","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrJidEnum,a,["from"],d("WASmaxInReceiptEnums").DEVICEJID_BROADCASTJID_DEVICEJID_GROUPJID_NEWSLETTERJID_STATUSJID);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);var e=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!e.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(e.error);var f=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrJidEnum,a,["participant"],d("WASmaxInReceiptEnums").DEVICEJID_USERJID_DEVICEJID);if(!f.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(f.error);a=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrUserJid,a,["recipient"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{id:d("WAWap").STANZA_ID(b.value),"class":"receipt",to:d("WAWap").JID(c.value),type:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,e.value),participant:d("WASmaxAttrs").OPTIONAL(d("WAWap").JID,f.value),recipient:d("WASmaxAttrs").OPTIONAL(d("WAWap").USER_JID,a.value)});return b}g.makeDeliverResponseSuccess=a}),98);
__d("WASmaxReceiptDeliverRPC",["WASmaxInReceiptDeliverRequest","WASmaxOutReceiptDeliverResponseSuccess","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInReceiptDeliverRequest").parseDeliverRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Deliver",{Request:b}));return{parsedRequest:b.value,makeDeliverResponseSuccess:function(){return d("WASmaxOutReceiptDeliverResponseSuccess").makeDeliverResponseSuccess(a)}}}g.receiveDeliverRPC=a}),98);
__d("WACreateHandleReceipt",["Promise","WACreateHandleGroupReceiptBranch","WACreateHandleIndividualReceiptBranch","WACreateHandlePeerAppdataReceiptBranch","WAJids","WAResultOrError","WASmaxReceiptDeliverPeerRPC","WASmaxReceiptDeliverRPC","WATagsLogger","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([""," server aggregated receipt is not supported"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(['<receipt category="peer"> is not supported yet.']);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["start handling..."]);k=function(){return a};return a}var l=d("WATagsLogger").TAGS(["decision tree","handleReceipt"]);function a(a){var c,e=d("WACreateHandleIndividualReceiptBranch").createHandleIndividualReceiptBranch({handleIndividualReceipt:(c=a.individualMessage)==null?void 0:c.handleIndividualReceipt,handleIndividualRetryReceipt:(c=a.individualMessage)==null?void 0:c.handleIndividualRetryReceipt}),f=d("WACreateHandleGroupReceiptBranch").createHandleGroupReceiptBranch({handleGroupReceipt:(c=a.groupMessage)==null?void 0:c.handleGroupReceipt,handleGroupRetryReceipt:(c=a.groupMessage)==null?void 0:c.handleGroupRetryReceipt}),g=d("WACreateHandlePeerAppdataReceiptBranch").createHandlePeerAppdataReceiptBranch({handlePeerAppdataReceipt:(c=a.appdataMessage)==null?void 0:c.handlePeerAppdataReceipt,handlePeerAppdataRetryReceipt:(c=a.appdataMessage)==null?void 0:c.handlePeerAppdataRetryReceipt});function m(a){var c=a.singleReceiptMixin,g=a.makeAck,i=a.offline,j=a.serverTs;a=a.socketId;var k=c.singleStyleChatType,l=c.singleStyleReceiptType,m=c.id,n=c.recipientMixin;c.deliverBizRolesMixin;c.deliverPaidConversationAggregatedMixin;switch(k.name){case"Individual":return e({aggregate:{aggregatedType:"none",stanzaId:m,receiptSender:k.value.from},receiptType:l,makeAck:g,offline:i,serverTs:j,recipient:n==null?void 0:n.recipient,socketId:a});case"Group":return f({from:k.value.from,aggregate:{aggregatedType:"none",stanzaId:m,receiptSender:k.value.participant},receiptType:l,makeAck:g,offline:i,serverTs:j,recipient:n==null?void 0:n.recipient,socketId:a});case"DeliverStatus":break;case"Broadcast":break;case"NewsletterDeliver":break;default:k.name}return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult(g()))}function n(a){var c=a.aggregateReceiptMixin,g=a.makeAck,i=a.offline,j=a.serverTs;a=a.socketId;var k=c.recipientMixin,l=c.id,m=c.listItem,n=c.individualOrGroupOrDeliverStatusOrBroadcastMixinGroup,o=c.senderAggregatedStyleReceiptType;c.deliverBizRolesMixin;c.deliverPaidConversationAggregatedMixin;c=[l].concat(m.map(function(a){return a.id}));switch(n.name){case"Individual":return e({aggregate:{aggregatedType:"sender",receiptSender:n.value.from,stanzaIds:c},receiptType:o,makeAck:g,offline:i,serverTs:j,recipient:k==null?void 0:k.recipient,socketId:a});case"Group":return f({from:n.value.from,aggregate:{aggregatedType:"sender",stanzaIds:c,receiptSender:n.value.participant},receiptType:o,makeAck:g,offline:i,serverTs:j,recipient:k==null?void 0:k.recipient,socketId:a});case"DeliverStatus":break;case"Broadcast":break}return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult(g()))}return function(a,c){l.DEV(k());if(a.attrs.category==="peer"){l.ERROR(j());var o=d("WASmaxReceiptDeliverPeerRPC").receiveDeliverPeerRPC(a);o=o.makeDeliverPeerResponseSuccess;return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult(o()))}if(a.attrs.category==="peer_appdata")return g(a,c);o=d("WASmaxReceiptDeliverRPC").receiveDeliverRPC(a);a=o.parsedRequest;var p=a.t,q=a.receiptStyles;a=a.offlineMixin;o=o.makeDeliverResponseSuccess;p=d("WATimeUtils").castToUnixTime(p);a=a==null?void 0:a.offline;switch(q.name){case"DeliverMessageAggregatedStyle":var r=q.value,s=r.from,t=r.recipientMixin,u=r.id,v=r.participantsUser;r=r.messageAggregatedStyleReceiptType;var w=d("WAJids").validateGroupJid(s);if(w==null){l.ERROR(i(),s);break}return f({aggregate:{aggregatedType:"server",stanzaId:u,receiptSenders:v.map(function(a){var b=a.jid;a=a.t;return{device:b,ts:d("WATimeUtils").castToUnixTime(a)}})},from:w,receiptType:r,makeAck:o,offline:a,serverTs:p,recipient:t==null?void 0:t.recipient,socketId:c});case"DeliverSenderAggregatedStyleSenderType":s=q.value;u=s.individualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup;v=s.id;w=s.type;r=s.listItem;w;t={value:{type:w},name:"SenderType"};s=[v].concat(r.map(function(a){return a.id}));switch(u.name){case"Group":return f({aggregate:{aggregatedType:"sender",stanzaIds:s,receiptSender:u.value.participant},from:u.value.from,receiptType:t,makeAck:o,offline:a,serverTs:p,recipient:null,socketId:c});case"Broadcast":break;case"DeliverStatus":break;case"IndividualWithRecipient":return e({aggregate:{aggregatedType:"sender",receiptSender:u.value.from,stanzaIds:s},receiptType:t,makeAck:o,offline:a,serverTs:p,recipient:u.value.recipient,socketId:c})}break;case"DeliverSenderAggregatedStyle":return n({aggregateReceiptMixin:q.value,makeAck:o,serverTs:p,offline:a,socketId:c});case"DeliverSingleStyleWithRecipient":w=q.value;v=w.id;r=w.senderTypeOrDeliverMdDowngradeTypeOrRetryMixinGroup;s=w.individualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup;switch(s.name){case"IndividualWithRecipient":return e({aggregate:{aggregatedType:"none",receiptSender:s.value.from,stanzaId:v},receiptType:r,makeAck:o,offline:a,serverTs:p,recipient:s.value.recipient,socketId:c});case"Group":return f({from:s.value.from,aggregate:{aggregatedType:"none",stanzaId:v,receiptSender:s.value.participant},receiptType:r,makeAck:o,offline:a,serverTs:p,recipient:null,socketId:c});case"DeliverStatus":break;case"Broadcast":break;default:s.name}break;case"DeliverSingleStyle":return m({singleReceiptMixin:q.value,makeAck:o,serverTs:p,offline:a,socketId:c})}return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult(o()))}}g.createHandleReceipt=a}),98);
__d("WASmaxInStreamErrorEnums",[],(function(a,b,c,d,e,f){a={appdata:"appdata",call:"call",message:"message",notification:"notification",receipt:"receipt"};f.ENUM_APPDATA_CALL_MESSAGE_NOTIFICATION_RECEIPT=a}),66);
__d("WASmaxInStreamErrorAckKickRequest",["WAResultOrError","WASmaxInStreamErrorEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"stream:error");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"ack");if(!b.success)return b;a=d("WASmaxParseUtils").attrStringEnum(b.value,"class",d("WASmaxInStreamErrorEnums").ENUM_APPDATA_CALL_MESSAGE_NOTIFICATION_RECEIPT);if(!a.success)return a;var c=d("WASmaxParseUtils").attrString(b.value,"type");if(!c.success)return c;b=d("WASmaxParseUtils").attrStanzaId(b.value,"id");return!b.success?b:d("WAResultOrError").makeResult({ackClass:a.value,ackType:c.value,ackId:b.value})}g.parseAckKickRequest=a}),98);
__d("WASmaxStreamErrorAckKickRPC",["WASmaxInStreamErrorAckKickRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInStreamErrorAckKickRequest").parseAckKickRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("AckKick",{Request:a}));return{parsedRequest:a.value}}g.receiveAckKickRPC=a}),98);
__d("WASmaxInStreamErrorBadMacRequest",["WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"stream:error");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"bad-mac");return!b.success?b:d("WASmaxParseUtils").voidSuccess}g.parseBadMacRequest=a}),98);
__d("WASmaxStreamErrorBadMacRPC",["WASmaxInStreamErrorBadMacRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInStreamErrorBadMacRequest").parseBadMacRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("BadMac",{Request:a}));return{parsedRequest:a.value}}g.receiveBadMacRPC=a}),98);
__d("WASmaxInStreamErrorCodeRequest",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"stream:error");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"code");return!b.success?b:d("WAResultOrError").makeResult({code:b.value})}g.parseCodeRequest=a}),98);
__d("WASmaxStreamErrorCodeRPC",["WASmaxInStreamErrorCodeRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInStreamErrorCodeRequest").parseCodeRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Code",{Request:a}));return{parsedRequest:a.value}}g.receiveCodeRPC=a}),98);
__d("WASmaxInStreamErrorConflictRequest",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"stream:error");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"conflict");if(!b.success)return b;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"code");if(!a.success)return a;var c=d("WASmaxParseUtils").attrString(b.value,"type");if(!c.success)return c;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,b.value,"reason");return!b.success?b:d("WAResultOrError").makeResult({code:a.value,conflictType:c.value,conflictReason:b.value})}g.parseConflictRequest=a}),98);
__d("WASmaxStreamErrorConflictRPC",["WASmaxInStreamErrorConflictRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInStreamErrorConflictRequest").parseConflictRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Conflict",{Request:a}));return{parsedRequest:a.value}}g.receiveConflictRPC=a}),98);
__d("WASmaxInStreamErrorPingKickRequest",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"stream:error");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"ping");if(!b.success)return b;a=d("WASmaxParseUtils").attrStanzaId(b.value,"id");return!a.success?a:d("WAResultOrError").makeResult({pingId:a.value})}g.parsePingKickRequest=a}),98);
__d("WASmaxStreamErrorPingKickRPC",["WASmaxInStreamErrorPingKickRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInStreamErrorPingKickRequest").parsePingKickRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("PingKick",{Request:a}));return{parsedRequest:a.value}}g.receivePingKickRPC=a}),98);
__d("WASmaxInStreamErrorXMLNotWellFormedRequest",["WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"stream:error");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"xml-not-well-formed");return!b.success?b:d("WASmaxParseUtils").voidSuccess}g.parseXMLNotWellFormedRequest=a}),98);
__d("WASmaxStreamErrorXMLNotWellFormedRPC",["WASmaxInStreamErrorXMLNotWellFormedRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInStreamErrorXMLNotWellFormedRequest").parseXMLNotWellFormedRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("XMLNotWellFormed",{Request:a}));return{parsedRequest:a.value}}g.receiveXMLNotWellFormedRPC=a}),98);
__d("WACreateHandleStreamError",["Promise","WAResultOrError","WASmaxDecisionTreeUtils","WASmaxStreamErrorAckKickRPC","WASmaxStreamErrorBadMacRPC","WASmaxStreamErrorCodeRPC","WASmaxStreamErrorConflictRPC","WASmaxStreamErrorPingKickRPC","WASmaxStreamErrorXMLNotWellFormedRPC","WAUnknownStanzaError"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var c=a.md,e=a.streamError;return function(a){var f=d("WASmaxDecisionTreeUtils").firstChild(a);if(f.success){f=f.value;switch(f.tag){case"ack":f=d("WASmaxStreamErrorAckKickRPC").receiveAckKickRPC(a);f=f.parsedRequest;return e.handleAckKick(f).then(d("WAResultOrError").makeResult);case"ping":f=d("WASmaxStreamErrorPingKickRPC").receivePingKickRPC(a);f=f.parsedRequest;return e.handlePingKick(f).then(d("WAResultOrError").makeResult);case"xml-not-well-formed":d("WASmaxStreamErrorXMLNotWellFormedRPC").receiveXMLNotWellFormedRPC(a);return e.handleXmlNotWellFormed().then(d("WAResultOrError").makeResult);case"bad-mac":d("WASmaxStreamErrorBadMacRPC").receiveBadMacRPC(a);return e.handleBadMac().then(d("WAResultOrError").makeResult);case"conflict":f=d("WASmaxStreamErrorConflictRPC").receiveConflictRPC(a);f=f.parsedRequest;return e.handleConflict(f).then(d("WAResultOrError").makeResult);default:return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError)}}else{f=d("WASmaxStreamErrorCodeRPC").receiveCodeRPC(a);a=f.parsedRequest;f=a.code;switch(f){case"515":a=c==null?void 0:c.handleRegistrateCompanionSuccess;if(a!=null)return a().then(d("WAResultOrError").makeResult);break;case"516":a=c==null?void 0:c.handleRegistrateCompanionFailure;if(a!=null)return a().then(d("WAResultOrError").makeResult);break;default:return e.handleStreamErrorCode({code:f}).then(d("WAResultOrError").makeResult)}return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError)}}}g.createHandleStreamError=a}),98);
__d("WASmaxInLoginDisplayNameMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrString(a,"display_name");return!a.success?a:d("WAResultOrError").makeResult({displayName:a.value})}g.parseDisplayNameMixin=a}),98);
__d("WASmaxInLoginSuccessRequest",["WAResultOrError","WASmaxInLoginDisplayNameMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"success");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").attrIntRange(a,"props",0,void 0);if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"abprops",0,void 0);if(!e.success)return e;var f=d("WASmaxParseUtils").attrString(a,"location");if(!f.success)return f;var g=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"shard_count",0,4095);if(!g.success)return g;var h=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"creation",0,void 0);if(!h.success)return h;var i=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"companion_enc_static");if(!i.success)return i;var j=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrDeviceJid,a,"lid");if(!j.success)return j;a=d("WASmaxInLoginDisplayNameMixin").parseDisplayNameMixin(a);return d("WAResultOrError").makeResult({t:b.value,props:c.value,abprops:e.value,location:f.value,shardCount:g.value,creation:h.value,companionEncStatic:i.value,lid:j.value,displayNameMixin:a.success?a.value:null})}g.parseSuccessRequest=a}),98);
__d("WASmaxLoginSuccessRPC",["WASmaxInLoginSuccessRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInLoginSuccessRequest").parseSuccessRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Success",{Request:a}));return{parsedRequest:a.value}}g.receiveSuccessRPC=a}),98);
__d("WACreateHandleSuccess",["Promise","WAResultOrError","WASmaxLoginSuccessRPC","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var c=(a=a.login)==null?void 0:a.handleLoginSuccess;return function(a){if(c!=null){a=d("WASmaxLoginSuccessRPC").receiveSuccessRPC(a);a=a.parsedRequest;var e=a.t,f=a.props,g=a.abprops,i=a.location,j=a.shardCount,k=a.creation,l=a.companionEncStatic,m=a.lid;a=a.displayNameMixin;return c({timestamp:d("WATimeUtils").castToUnixTime(e),props:f,abprops:g,location:i,shardCount:j,creation:k,companionEncStatic:l,lid:m,displayName:a==null?void 0:a.displayName}).then(d("WAResultOrError").makeResult)}return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult("NO_ACK"))}}g.createHandleSuccess=a}),98);
__d("WAHandleDecisionTreeResult",["WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] unexpected-runtime-error: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] runtime-error ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["unrecognized stanza: ",""]);j=function(){return a};return a}function a(a,b){var c=d("WATagsLogger").TAGS(["decision tree"]);return b.then(function(b){if(b.success)return b.value;else if(b.error.type==="unknown-stanza"){c.ERROR(j(),a);return"NO_ACK"}else{b.error.type;c.ERROR(i(),a.tag,b.error.error);return"NO_ACK"}})["catch"](function(b){c.ERROR(h(),a.tag,b);return"NO_ACK"})}g.handleDecisionTreeResult=a}),98);
__d("WAOneQueueHandler",["WAGlobals","WAHandleDecisionTreeResult","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return function(b,c){var e={offline:b.attrs.offline?parseInt(b.attrs.offline,10):null,serverTs:b.attrs.t?d("WATimeUtils").castToUnixTime(parseInt(b.attrs.t,10)):null,tag:b.tag};return d("WAGlobals").getWaOneQueue().handleStanza(function(e){return d("WAHandleDecisionTreeResult").handleDecisionTreeResult(b,a(b,c,e))},e)}}g.handleWithOneQueue=a}),98);
__d("WAServerRPC",["Promise","WACreateHandleAppdata","WACreateHandleChatState","WACreateHandleErrorStanza","WACreateHandleFailure","WACreateHandleInfoBulletin","WACreateHandleIq","WACreateHandleMessage","WACreateHandleNotification","WACreateHandleReceipt","WACreateHandleStreamError","WACreateHandleSuccess","WAHandleDecisionTreeResult","WAOneQueueHandler","WAServerRPCLogger","WAStanzaRootTag"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Received unsupported stanza: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unsupported stanza: ",""]);j=function(){return a};return a}function a(a){var c=d("WACreateHandleInfoBulletin").createHandleInfoBulletin(a),e=d("WACreateHandleStreamError").createHandleStreamError(a),f=d("WACreateHandleFailure").createHandleFailure(a),g=d("WACreateHandleSuccess").createHandleSuccess(a),k=d("WACreateHandleMessage").createHandleMessage(a),l=d("WACreateHandleIq").createHandleIq(a),m=d("WACreateHandleChatState").createHandleChatState(a),n=d("WACreateHandleErrorStanza").createHandleErrorStanza(a),o=d("WACreateHandleNotification").createHandleNotification(a),p=d("WACreateHandleAppdata").createHandleAppdata(a),q=d("WACreateHandleReceipt").createHandleReceipt(a);a=function(a,r){switch(a.tag){case d("WAStanzaRootTag").STANZA_ROOT_TAG.MESSAGE:return d("WAOneQueueHandler").handleWithOneQueue(k)(a,r);case d("WAStanzaRootTag").STANZA_ROOT_TAG.NOTIFICATION:return d("WAOneQueueHandler").handleWithOneQueue(o)(a,r);case d("WAStanzaRootTag").STANZA_ROOT_TAG.RECEIPT:return d("WAOneQueueHandler").handleWithOneQueue(q)(a,r);case d("WAStanzaRootTag").STANZA_ROOT_TAG.CHATSTATE:return d("WAHandleDecisionTreeResult").handleDecisionTreeResult(a,m(a));case d("WAStanzaRootTag").STANZA_ROOT_TAG.APPDATA:return d("WAOneQueueHandler").handleWithOneQueue(p)(a,r);case d("WAStanzaRootTag").STANZA_ROOT_TAG.FAILURE:return d("WAHandleDecisionTreeResult").handleDecisionTreeResult(a,f(a));case d("WAStanzaRootTag").STANZA_ROOT_TAG.STREAM_ERROR:return d("WAHandleDecisionTreeResult").handleDecisionTreeResult(a,e(a));case d("WAStanzaRootTag").STANZA_ROOT_TAG.IQ:return d("WAHandleDecisionTreeResult").handleDecisionTreeResult(a,l(a));case d("WAStanzaRootTag").STANZA_ROOT_TAG.IB:return d("WAHandleDecisionTreeResult").handleDecisionTreeResult(a,c(a));case d("WAStanzaRootTag").STANZA_ROOT_TAG.ERROR:return d("WAHandleDecisionTreeResult").handleDecisionTreeResult(a,n(a));case d("WAStanzaRootTag").STANZA_ROOT_TAG.SUCCESS:return d("WAHandleDecisionTreeResult").handleDecisionTreeResult(a,g(a));case d("WAStanzaRootTag").STANZA_ROOT_TAG.XML_STREAM_END:return(h||(h=b("Promise"))).resolve("NO_ACK");default:d("WAServerRPCLogger").logger.WARN(j(),a);d("WAServerRPCLogger").logger.ERROR(i(),a.tag);return(h||(h=b("Promise"))).resolve("NO_ACK")}};return{handleStanza:a}}g.makeServerRPC=a}),98);
/**
 * License: https://www.facebook.com/legal/license/MDzNl_j9yvg/
 */
__d("fflate-0.6.10",[],(function(a,b,c,d,e,f){"use strict";var g={},h={exports:g};function i(){var a,b="";try{a={}.Worker}catch(a){}g["default"]=a?function(c,d,e,f,g){var h=!1,i=new a(c+b,{eval:!0}).on("error",function(a){return g(a,null)}).on("message",function(a){return g(null,a)}).on("exit",function(a){a&&!h&&g(new Error("exited with code "+a),null)});i.postMessage(e,f);i.terminate=function(){h=!0;return a.prototype.terminate.call(i)};return i}:function(a,b,c,d,e){setImmediate(function(){return e(new Error("async operations unsupported - update to Node 12+ (or Node 10-11 with the --experimental-worker CLI flag)"),null)});a=function(){};return{terminate:a,postMessage:a}}}var j=!1;function k(){j||(j=!0,i());return h.exports}var l={},m={exports:l};function n(){var a=k(),b=Uint8Array,c=Uint16Array,d=Uint32Array,e=new b([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),f=new b([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),g=new b([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),h=function(a,b){var e=new c(31);for(var f=0;f<31;++f)e[f]=b+=1<<a[f-1];a=new d(e[30]);for(var f=1;f<30;++f)for(b=e[f];b<e[f+1];++b)a[b]=b-e[f]<<5|f;return[e,a]},i=h(e,2),j=i[0],m=i[1];j[28]=258,m[258]=28;i=h(f,0);var n=i[0],o=i[1],p=new c(32768);for(h=0;h<32768;++h){i=(h&43690)>>>1|(h&21845)<<1;i=(i&52428)>>>2|(i&13107)<<2;i=(i&61680)>>>4|(i&3855)<<4;p[h]=((i&65280)>>>8|(i&255)<<8)>>>1}var q=function(a,b,d){var e=a.length,f=0,g=new c(b);for(;f<e;++f)++g[a[f]-1];var h=new c(b);for(f=0;f<b;++f)h[f]=h[f-1]+g[f-1]<<1;if(d){g=new c(1<<b);d=15-b;for(f=0;f<e;++f)if(a[f]){var i=f<<4|a[f],j=b-a[f],k=h[a[f]-1]++<<j;for(j=k|(1<<j)-1;k<=j;++k)g[p[k]>>>d]=i}}else{g=new c(e);for(f=0;f<e;++f)a[f]&&(g[f]=p[h[a[f]-1]++]>>>15-a[f])}return g},r=new b(288);for(h=0;h<144;++h)r[h]=8;for(h=144;h<256;++h)r[h]=9;for(h=256;h<280;++h)r[h]=7;for(h=280;h<288;++h)r[h]=8;var s=new b(32);for(h=0;h<32;++h)s[h]=5;var t=q(r,9,0),u=q(r,9,1),v=q(s,5,0),w=q(s,5,1),x=function(a){var b=a[0];for(var c=1;c<a.length;++c)a[c]>b&&(b=a[c]);return b},y=function(a,b,c){var d=b/8|0;return(a[d]|a[d+1]<<8)>>(b&7)&c},z=function(a,b){var c=b/8|0;return(a[c]|a[c+1]<<8|a[c+2]<<16)>>(b&7)},aa=function(a){return(a/8|0)+(a&7&&1)},A=function(a,e,f){(e==null||e<0)&&(e=0);(f==null||f>a.length)&&(f=a.length);var g=new(a instanceof c?c:a instanceof d?d:b)(f-e);g.set(a.subarray(e,f));return g},B=function(a,c,d){var h=a.length;if(!h||d&&!d.l&&h<5)return c||new b(0);var i=!c||d,k=!d||d.i;d||(d={});c||(c=new b(h*3));var l=function(a){var d=c.length;if(a>d){d=new b(Math.max(d*2,a));d.set(c);c=d}},m=d.f||0,o=d.p||0,p=d.b||0,r=d.l,s=d.d,t=d.m,v=d.n,B=h*8;do{if(!r){d.f=m=y(a,o,1);var C=y(a,o+1,3);o+=3;if(!C){var D=aa(o)+4,E=a[D-4]|a[D-3]<<8,F=D+E;if(F>h){if(k)throw"unexpected EOF";break}i&&l(p+E);c.set(a.subarray(D,F),p);d.b=p+=E,d.p=o=F*8;continue}else if(C==1)r=u,s=w,t=9,v=5;else if(C==2){E=y(a,o,31)+257;F=y(a,o+10,15)+4;C=E+y(a,o+5,31)+1;o+=14;var G=new b(C),H=new b(19);for(var I=0;I<F;++I)H[g[I]]=y(a,o+I*3,7);o+=F*3;F=x(H);var J=(1<<F)-1;H=q(H,F,1);for(var I=0;I<C;){F=H[y(a,o,J)];o+=F&15;var D=F>>>4;if(D<16)G[I++]=D;else{F=0;var K=0;D==16?(K=3+y(a,o,3),o+=2,F=G[I-1]):D==17?(K=3+y(a,o,7),o+=3):D==18&&(K=11+y(a,o,127),o+=7);while(K--)G[I++]=F}}D=G.subarray(0,E);K=G.subarray(E);t=x(D);v=x(K);r=q(D,t,1);s=q(K,v,1)}else throw"invalid block type";if(o>B){if(k)throw"unexpected EOF";break}}i&&l(p+131072);J=(1<<t)-1;H=(1<<v)-1;C=o;for(;;C=o){F=r[z(a,o)&J];G=F>>>4;o+=F&15;if(o>B){if(k)throw"unexpected EOF";break}if(!F)throw"invalid length/literal";if(G<256)c[p++]=G;else if(G==256){C=o,r=null;break}else{E=G-254;if(G>264){var I=G-257;D=e[I];E=y(a,o,(1<<D)-1)+j[I];o+=D}F=s[z(a,o)&H];G=F>>>4;if(!F)throw"invalid distance";o+=F&15;K=n[G];if(G>3){D=f[G];K+=z(a,o)&(1<<D)-1,o+=D}if(o>B){if(k)throw"unexpected EOF";break}i&&l(p+131072);F=p+E;for(;p<F;p+=4)c[p]=c[p-K],c[p+1]=c[p+1-K],c[p+2]=c[p+2-K],c[p+3]=c[p+3-K];p=F}}d.l=r,d.p=C,d.b=p;r&&(m=1,d.m=t,d.d=s,d.n=v)}while(!m);return p==c.length?c:A(c,0,p)},C=function(a,b,c){c<<=b&7;b=b/8|0;a[b]|=c;a[b+1]|=c>>>8},D=function(a,b,c){c<<=b&7;b=b/8|0;a[b]|=c;a[b+1]|=c>>>8;a[b+2]|=c>>>16},E=function(a,d){var e=[];for(var f=0;f<a.length;++f)a[f]&&e.push({s:f,f:a[f]});a=e.length;var g=e.slice();if(!a)return[L,0];if(a==1){var h=new b(e[0].s+1);h[e[0].s]=1;return[h,1]}e.sort(function(a,b){return a.f-b.f});e.push({s:-1,f:25001});h=e[0];var i=e[1],j=0,k=1,l=2;e[0]={s:-1,f:h.f+i.f,l:h,r:i};while(k!=a-1)h=e[e[j].f<e[l].f?j++:l++],i=e[j!=k&&e[j].f<e[l].f?j++:l++],e[k++]={s:-1,f:h.f+i.f,l:h,r:i};h=g[0].s;for(var f=1;f<a;++f)g[f].s>h&&(h=g[f].s);var m=new c(h+1);i=F(e[k-1],m,0);if(i>d){var f=0;j=0;l=i-d;h=1<<l;g.sort(function(a,b){return m[b.s]-m[a.s]||a.f-b.f});for(;f<a;++f){e=g[f].s;if(m[e]>d)j+=h-(1<<i-m[e]),m[e]=d;else break}j>>>=l;while(j>0){k=g[f].s;m[k]<d?j-=1<<d-m[k]++-1:++f}for(;f>=0&&j;--f){e=g[f].s;m[e]==d&&(--m[e],++j)}i=d}return[new b(m),i]},F=function(a,b,c){return a.s==-1?Math.max(F(a.l,b,c+1),F(a.r,b,c+1)):b[a.s]=c},G=function(a){var b=a.length;while(b&&!a[--b]);var d=new c(++b),e=0,f=a[0],g=1,h=function(a){d[e++]=a};for(var i=1;i<=b;++i)if(a[i]==f&&i!=b)++g;else{if(!f&&g>2){for(;g>138;g-=138)h(32754);g>2&&(h(g>10?g-11<<5|28690:g-3<<5|12305),g=0)}else if(g>3){h(f),--g;for(;g>6;g-=6)h(8304);g>2&&(h(g-3<<5|8208),g=0)}while(g--)h(f);g=1;f=a[i]}return[d.subarray(0,e),b]},H=function(a,b){var c=0;for(var d=0;d<b.length;++d)c+=a[d]*b[d];return c},I=function(a,b,c){var d=c.length;b=aa(b+2);a[b]=d&255;a[b+1]=d>>>8;a[b+2]=a[b]^255;a[b+3]=a[b+1]^255;for(var e=0;e<d;++e)a[b+e+4]=c[e];return(b+4+d)*8},J=function(a,b,d,h,i,j,k,l,m,n,o){C(b,o++,d);++i[256];d=E(i,15);var p=d[0];d=d[1];var u=E(j,15),w=u[0];u=u[1];var x=G(p),y=x[0];x=x[1];var z=G(w),aa=z[0];z=z[1];var A=new c(19);for(var B=0;B<y.length;++B)A[y[B]&31]++;for(var B=0;B<aa.length;++B)A[aa[B]&31]++;var F=E(A,7),J=F[0];F=F[1];var K=19;for(;K>4&&!J[g[K-1]];--K);var L=n+5<<3,M=H(i,r)+H(j,s)+k;i=H(i,p)+H(j,w)+k+14+3*K+H(A,J)+(2*A[16]+3*A[17]+7*A[18]);if(L<=M&&L<=i)return I(b,o,a.subarray(m,m+n));C(b,o,1+(i<M)),o+=2;if(i<M){j=q(p,d,0),k=p,A=q(w,u,0),L=w;a=q(J,F,0);C(b,o,x-257);C(b,o+5,z-1);C(b,o+10,K-4);o+=14;for(var B=0;B<K;++B)C(b,o+3*B,J[g[B]]);o+=3*K;m=[y,aa];for(n=0;n<2;++n){i=m[n];for(var B=0;B<i.length;++B){M=i[B]&31;C(b,o,a[M]),o+=J[M];M>15&&(C(b,o,i[B]>>>5&127),o+=i[B]>>>12)}}}else j=t,k=r,A=v,L=s;for(var B=0;B<l;++B)if(h[B]>255){M=h[B]>>>18&31;D(b,o,j[M+257]),o+=k[M+257];M>7&&(C(b,o,h[B]>>>23&31),o+=e[M]);d=h[B]&31;D(b,o,A[d]),o+=L[d];d>3&&(D(b,o,h[B]>>>5&8191),o+=f[d])}else D(b,o,j[h[B]]),o+=k[h[B]];D(b,o,j[256]);return o+k[256]},K=new d([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),L=new b(0),M=function(a,g,h,i,j,k){var l=a.length,n=new b(i+l+5*(1+Math.ceil(l/7e3))+j),p=n.subarray(i,n.length-j),q=0;if(!g||l<8)for(var r=0;r<=l;r+=65535){var s=r+65535;s<l?q=I(p,q,a.subarray(r,s)):(p[r]=k,q=I(p,q,a.subarray(r,l)))}else{s=K[g-1];g=s>>>13;s=s&8191;var t=(1<<h)-1,u=new c(32768),v=new c(t+1),w=Math.ceil(h/3),x=2*w;h=function(b){return(a[b]^a[b+1]<<w^a[b+2]<<x)&t};var y=new d(25e3),z=new c(288),B=new c(32),C=0,D=0,r=0,E=0,F=0,G=0;for(;r<l;++r){var H=h(r),M=r&32767,N=v[H];u[M]=N;v[H]=M;if(F<=r){var O=l-r;if((C>7e3||E>24576)&&O>423){q=J(a,p,0,y,z,B,D,E,G,r-G,q);E=C=D=0,G=r;for(var P=0;P<286;++P)z[P]=0;for(var P=0;P<30;++P)B[P]=0}var Q=2,R=0,ba=s,S=M-N&32767;if(O>2&&H==h(r-S)){H=Math.min(g,O)-1;var ca=Math.min(32767,r);O=Math.min(258,O);while(S<=ca&&--ba&&M!=N){if(a[r+Q]==a[r+Q-S]){var T=0;for(;T<O&&a[r+T]==a[r+T-S];++T);if(T>Q){Q=T,R=S;if(T>H)break;T=Math.min(S,T-2);var da=0;for(var P=0;P<T;++P){var U=r-S+P+32768&32767,V=u[U];V=U-V+32768&32767;V>da&&(da=V,N=U)}}}M=N,N=u[M];S+=M-N+32768&32767}}if(R){y[E++]=268435456|m[Q]<<18|o[R];V=m[Q]&31;U=o[R]&31;D+=e[V]+f[U];++z[257+V];++B[U];F=r+Q;++C}else y[E++]=a[r],++z[a[r]]}}q=J(a,p,k,y,z,B,D,E,G,r-G,q);!k&&q&7&&(q=I(p,q+1,L))}return A(n,0,i+aa(q)+j)},N=function(){var a=new Int32Array(256);for(var b=0;b<256;++b){var c=b,d=9;while(--d)c=(c&1&&-306674912)^c>>>1;a[b]=c}return a}(),O=function(){var a=-1;return{p:function(b){var c=a;for(var d=0;d<b.length;++d)c=N[c&255^b[d]]^c>>>8;a=c},d:function(){return~a}}},P=function(){var a=1,b=0;return{p:function(c){var d=a,e=b,f=c.length;for(var g=0;g!=f;){var h=Math.min(g+2655,f);for(;g<h;++g)e+=d+=c[g];d=(d&65535)+15*(d>>16),e=(e&65535)+15*(e>>16)}a=d,b=e},d:function(){a%=65521,b%=65521;return(a&255)<<24|a>>>8<<16|(b&255)<<8|b>>>8}}},Q=function(a,b,c,d,e){return M(a,b.level==null?6:b.level,b.mem==null?Math.ceil(Math.max(8,Math.min(13,Math.log(a.length)))*1.5):12+b.mem,c,d,!e)},R=function(a,b){var c={};for(var d in a)c[d]=a[d];for(var d in b)c[d]=b[d];return c},ba=function(b,c,a){var d=b();b=b.toString();b=b.slice(b.indexOf("[")+1,b.lastIndexOf("]")).replace(/ /g,"").split(",");for(var e=0;e<d.length;++e){var f=d[e],g=b[e];if(typeof f=="function"){c+=";"+g+"=";var h=f.toString();if(f.prototype)if(h.indexOf("[native code]")!=-1){var i=h.indexOf(" ",8)+1;c+=h.slice(i,h.indexOf("(",i))}else{c+=h;for(i in f.prototype)c+=";"+g+".prototype."+i+"="+f.prototype[i].toString()}else c+=h}else a[g]=f}return[c,a]},S=[],ca=function(a){var e=[];for(var f in a)(a[f]instanceof b||a[f]instanceof c||a[f]instanceof d)&&e.push((a[f]=new a[f].constructor(a[f])).buffer);return e},T=function(c,d,e,f){var b;if(!S[e]){var g="",h={},i=c.length-1;for(var j=0;j<i;++j)b=ba(c[j],g,h),g=b[0],h=b[1];S[e]=ba(c[i],g,h)}b=R({},S[e][1]);return a["default"](S[e][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+d.toString()+"}",e,b,ca(b),f)},da=function(){return[b,c,d,e,f,g,j,n,u,w,p,q,x,y,z,aa,A,B,za,ha,ia]},U=function(){return[b,c,d,e,f,g,m,o,t,r,v,s,p,K,L,q,C,D,E,F,G,H,I,J,aa,A,M,Q,wa,ha]},V=function(){return[ma,pa,Z,O,N]},ea=function(){return[na,oa]},fa=function(){return[qa,Z,P]},ga=function(){return[ra]},ha=function(a){return postMessage(a,[a.buffer])},ia=function(a){return a&&a.size&&new b(a.size)},ja=function(a,b,c,d,e,f){var g=T(c,d,e,function(b,a){g.terminate(),f(b,a)});g.postMessage([a,b],b.consume?[a.buffer]:[]);return function(){g.terminate()}},W=function(a){a.ondata=function(a,b){return postMessage([a,b],[a.buffer])};return function(b){return a.push(b.data[0],b.data[1])}},ka=function(a,b,c,d,e){var f,g=T(a,d,e,function(a,c){a?(g.terminate(),b.ondata.call(b,a)):(c[1]&&g.terminate(),b.ondata.call(b,a,c[0],c[1]))});g.postMessage(c);b.push=function(a,c){if(f)throw"stream finished";if(!b.ondata)throw"no stream handler";g.postMessage([a,f=c],[a.buffer])};b.terminate=function(){g.terminate()}},X=function(a,b){return a[b]|a[b+1]<<8},Y=function(a,b){return(a[b]|a[b+1]<<8|a[b+2]<<16|a[b+3]<<24)>>>0},la=function(a,b){return Y(a,b)+Y(a,b+4)*4294967296},Z=function(a,b,c){for(;c;++b)a[b]=c,c>>>=8},ma=function(a,b){var c=b.filename;a[0]=31,a[1]=139,a[2]=8,a[8]=b.level<2?4:b.level==9?2:0,a[9]=3;b.mtime!=0&&Z(a,4,Math.floor(new Date(b.mtime||Date.now())/1e3));if(c){a[3]=8;for(b=0;b<=c.length;++b)a[b+10]=c.charCodeAt(b)}},na=function(a){if(a[0]!=31||a[1]!=139||a[2]!=8)throw"invalid gzip data";var b=a[3],c=10;b&4&&(c+=a[10]|(a[11]<<8)+2);for(var d=(b>>3&1)+(b>>4&1);d>0;d-=!a[c++]);return c+(b&2)},oa=function(a){var b=a.length;return(a[b-4]|a[b-3]<<8|a[b-2]<<16|a[b-1]<<24)>>>0},pa=function(a){return 10+(a.filename&&a.filename.length+1||0)},qa=function(a,b){b=b.level;b=b==0?0:b<6?1:b==9?3:2;a[0]=120,a[1]=b<<6|(b?32-2*b:1)},ra=function(a){if((a[0]&15)!=8||a[0]>>>4>7||(a[0]<<8|a[1])%31)throw"invalid zlib data";if(a[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function sa(a,b){!b&&typeof a=="function"&&(b=a,a={});this.ondata=b;return a}var ta=function(){function a(a,b){!b&&typeof a=="function"&&(b=a,a={}),this.ondata=b,this.o=a||{}}a.prototype.p=function(a,b){this.ondata(Q(a,this.o,0,0,!b),b)};a.prototype.push=function(a,b){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";this.d=b;this.p(a,b||!1)};return a}();l.Deflate=ta;var ua=function(){function a(a,b){ka([U,function(){return[W,ta]}],this,sa.call(this,a,b),function(a){a=new ta(a.data);onmessage=W(a)},6)}return a}();l.AsyncDeflate=ua;function va(a,b,c){c||(c=b,b={});if(typeof c!="function")throw"no callback";return ja(a,b,[U],function(a){return ha(wa(a.data[0],a.data[1]))},0,c)}l.deflate=va;function wa(a,b){return Q(a,b||{},0,0)}l.deflateSync=wa;var $=function(){function a(a){this.s={},this.p=new b(0),this.ondata=a}a.prototype.e=function(a){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";var c=this.p.length,d=new b(c+a.length);d.set(this.p),d.set(a,c),this.p=d};a.prototype.c=function(a){this.d=this.s.i=a||!1;a=this.s.b;var b=B(this.p,this.o,this.s);this.ondata(A(b,a,this.s.b),this.d);this.o=A(b,this.s.b-32768),this.s.b=this.o.length;this.p=A(this.p,this.s.p/8|0),this.s.p&=7};a.prototype.push=function(a,b){this.e(a),this.c(b)};return a}();l.Inflate=$;var xa=function(){function a(a){this.ondata=a,ka([da,function(){return[W,$]}],this,0,function(){var a=new $();onmessage=W(a)},7)}return a}();l.AsyncInflate=xa;function ya(a,b,c){c||(c=b,b={});if(typeof c!="function")throw"no callback";return ja(a,b,[da],function(a){return ha(za(a.data[0],ia(a.data[1])))},1,c)}l.inflate=ya;function za(a,b){return B(a,b)}l.inflateSync=za;var Aa=function(){function a(a,b){this.c=O(),this.l=0,this.v=1,ta.call(this,a,b)}a.prototype.push=function(a,b){ta.prototype.push.call(this,a,b)};a.prototype.p=function(a,b){this.c.p(a);this.l+=a.length;a=Q(a,this.o,this.v&&pa(this.o),b&&8,!b);this.v&&(ma(a,this.o),this.v=0);b&&(Z(a,a.length-8,this.c.d()),Z(a,a.length-4,this.l));this.ondata(a,b)};return a}();l.Gzip=Aa;l.Compress=Aa;i=function(){function a(a,b){ka([U,V,function(){return[W,ta,Aa]}],this,sa.call(this,a,b),function(a){a=new Aa(a.data);onmessage=W(a)},8)}return a}();l.AsyncGzip=i;l.AsyncCompress=i;function Ba(a,b,c){c||(c=b,b={});if(typeof c!="function")throw"no callback";return ja(a,b,[U,V,function(){return[Ca]}],function(a){return ha(Ca(a.data[0],a.data[1]))},2,c)}l.gzip=Ba;l.compress=Ba;function Ca(a,b){b||(b={});var c=O(),d=a.length;c.p(a);a=Q(a,b,pa(b),8);var e=a.length;return ma(a,b),Z(a,e-8,c.d()),Z(a,e-4,d),a}l.gzipSync=Ca;l.compressSync=Ca;var Da=function(){function a(a){this.v=1,$.call(this,a)}a.prototype.push=function(a,b){$.prototype.e.call(this,a);if(this.v){a=this.p.length>3?na(this.p):4;if(a>=this.p.length&&!b)return;this.p=this.p.subarray(a),this.v=0}if(b){if(this.p.length<8)throw"invalid gzip stream";this.p=this.p.subarray(0,-8)}$.prototype.c.call(this,b)};return a}();l.Gunzip=Da;var Ea=function(){function a(a){this.ondata=a,ka([da,ea,function(){return[W,$,Da]}],this,0,function(){var a=new Da();onmessage=W(a)},9)}return a}();l.AsyncGunzip=Ea;function Fa(a,b,c){c||(c=b,b={});if(typeof c!="function")throw"no callback";return ja(a,b,[da,ea,function(){return[Ga]}],function(a){return ha(Ga(a.data[0]))},3,c)}l.gunzip=Fa;function Ga(a,c){return B(a.subarray(na(a),-8),c||new b(oa(a)))}l.gunzipSync=Ga;var Ha=function(){function a(a,b){this.c=P(),this.v=1,ta.call(this,a,b)}a.prototype.push=function(a,b){ta.prototype.push.call(this,a,b)};a.prototype.p=function(a,b){this.c.p(a);a=Q(a,this.o,this.v&&2,b&&4,!b);this.v&&(qa(a,this.o),this.v=0);b&&Z(a,a.length-4,this.c.d());this.ondata(a,b)};return a}();l.Zlib=Ha;h=function(){function a(a,b){ka([U,fa,function(){return[W,ta,Ha]}],this,sa.call(this,a,b),function(a){a=new Ha(a.data);onmessage=W(a)},10)}return a}();l.AsyncZlib=h;function Ia(a,b,c){c||(c=b,b={});if(typeof c!="function")throw"no callback";return ja(a,b,[U,fa,function(){return[Ja]}],function(a){return ha(Ja(a.data[0],a.data[1]))},4,c)}l.zlib=Ia;function Ja(a,b){b||(b={});var c=P();c.p(a);a=Q(a,b,2,4);return qa(a,b),Z(a,a.length-4,c.d()),a}l.zlibSync=Ja;var Ka=function(){function a(a){this.v=1,$.call(this,a)}a.prototype.push=function(a,b){$.prototype.e.call(this,a);if(this.v){if(this.p.length<2&&!b)return;this.p=this.p.subarray(2),this.v=0}if(b){if(this.p.length<4)throw"invalid zlib stream";this.p=this.p.subarray(0,-4)}$.prototype.c.call(this,b)};return a}();l.Unzlib=Ka;var La=function(){function a(a){this.ondata=a,ka([da,ga,function(){return[W,$,Ka]}],this,0,function(){var a=new Ka();onmessage=W(a)},11)}return a}();l.AsyncUnzlib=La;function Ma(a,b,c){c||(c=b,b={});if(typeof c!="function")throw"no callback";return ja(a,b,[da,ga,function(){return[Na]}],function(a){return ha(Na(a.data[0],ia(a.data[1])))},5,c)}l.unzlib=Ma;function Na(a,b){return B((ra(a),a.subarray(2,-4)),b)}l.unzlibSync=Na;var Oa=function(){function a(a){this.G=Da,this.I=$,this.Z=Ka,this.ondata=a}a.prototype.push=function(a,c){if(!this.ondata)throw"no stream handler";if(!this.s){if(this.p&&this.p.length){var d=new b(this.p.length+a.length);d.set(this.p),d.set(a,this.p.length)}else this.p=a;if(this.p.length>2){var e=this;d=function(){e.ondata.apply(e,arguments)};this.s=this.p[0]==31&&this.p[1]==139&&this.p[2]==8?new this.G(d):(this.p[0]&15)!=8||this.p[0]>>4>7||(this.p[0]<<8|this.p[1])%31?new this.I(d):new this.Z(d);this.s.push(this.p,c);this.p=null}}else this.s.push(a,c)};return a}();l.Decompress=Oa;i=function(){function a(a){this.G=Ea,this.I=xa,this.Z=La,this.ondata=a}a.prototype.push=function(a,b){Oa.prototype.push.call(this,a,b)};return a}();l.AsyncDecompress=i;function Pa(a,b,c){c||(c=b,b={});if(typeof c!="function")throw"no callback";return a[0]==31&&a[1]==139&&a[2]==8?Fa(a,b,c):(a[0]&15)!=8||a[0]>>4>7||(a[0]<<8|a[1])%31?ya(a,b,c):Ma(a,b,c)}l.decompress=Pa;function Qa(a,b){return a[0]==31&&a[1]==139&&a[2]==8?Ga(a,b):(a[0]&15)!=8||a[0]>>4>7||(a[0]<<8|a[1])%31?za(a,b):Na(a,b)}l.decompressSync=Qa;var Ra=function(a,c,d,e){for(var f in a){var g=a[f],h=c+f;g instanceof b?d[h]=[g,e]:Array.isArray(g)?d[h]=[g[0],R(e,g[1])]:Ra(g,h+"/",d,e)}},Sa=typeof TextEncoder!="undefined"&&new TextEncoder(),Ta=typeof TextDecoder!="undefined"&&new TextDecoder(),Ua=0;try{Ta.decode(L,{stream:!0}),Ua=1}catch(a){}var Va=function(a){for(var b="",c=0;;){var d=a[c++],e=(d>127)+(d>223)+(d>239);if(c+e>a.length)return[b,A(a,c-1)];!e?b+=String.fromCharCode(d):e==3?(d=((d&15)<<18|(a[c++]&63)<<12|(a[c++]&63)<<6|a[c++]&63)-65536,b+=String.fromCharCode(55296|d>>10,56320|d&1023)):e&1?b+=String.fromCharCode((d&31)<<6|a[c++]&63):b+=String.fromCharCode((d&15)<<12|(a[c++]&63)<<6|a[c++]&63)}};Ba=function(){function a(a){this.ondata=a,Ua?this.t=new TextDecoder():this.p=L}a.prototype.push=function(a,c){if(!this.ondata)throw"no callback";c=!!c;if(this.t){this.ondata(this.t.decode(a,{stream:!0}),c);if(c){if(this.t.decode().length)throw"invalid utf-8 data";this.t=null}return}if(!this.p)throw"stream finished";var d=new b(this.p.length+a.length);d.set(this.p);d.set(a,this.p.length);a=Va(d);d=a[0];a=a[1];if(c){if(a.length)throw"invalid utf-8 data";this.p=null}else this.p=a;this.ondata(d,c)};return a}();l.DecodeUTF8=Ba;h=function(){function a(a){this.ondata=a}a.prototype.push=function(a,b){if(!this.ondata)throw"no callback";if(this.d)throw"stream finished";this.ondata(Wa(a),this.d=b||!1)};return a}();l.EncodeUTF8=h;function Wa(a,c){if(c){var d=new b(a.length);for(var e=0;e<a.length;++e)d[e]=a.charCodeAt(e);return d}if(Sa)return Sa.encode(a);d=a.length;var f=new b(a.length+(a.length>>1)),g=0,h=function(a){f[g++]=a};for(var e=0;e<d;++e){if(g+5>f.length){var i=new b(g+8+(d-e<<1));i.set(f);f=i}i=a.charCodeAt(e);i<128||c?h(i):i<2048?(h(192|i>>6),h(128|i&63)):i>55295&&i<57344?(i=65536+(i&1023<<10)|a.charCodeAt(++e)&1023,h(240|i>>18),h(128|i>>12&63),h(128|i>>6&63),h(128|i&63)):(h(224|i>>12),h(128|i>>6&63),h(128|i&63))}return A(f,0,g)}l.strToU8=Wa;function Xa(a,b){if(b){b="";for(var c=0;c<a.length;c+=16384)b+=String.fromCharCode.apply(null,a.subarray(c,c+16384));return b}else if(Ta)return Ta.decode(a);else{c=Va(a);b=c[0];a=c[1];if(a.length)throw"invalid utf-8 data";return b}}l.strFromU8=Xa;var Ya=function(a){return a==1?3:a<6?2:a==9?1:0},Za=function(a,b){return b+30+X(a,b+26)+X(a,b+28)},$a=function(a,b,c){var d=X(a,b+28),e=Xa(a.subarray(b+46,b+46+d),!(X(a,b+8)&2048));d=b+46+d;var f=Y(a,b+20);c=c&&f==4294967295?ab(a,d):[f,Y(a,b+24),Y(a,b+42)];f=c[0];var g=c[1];c=c[2];return[X(a,b+10),f,g,e,d+X(a,b+30)+X(a,b+32),c]},ab=function(a,b){for(;X(a,b)!=1;b+=4+X(a,b+2));return[la(a,b+12),la(a,b+4),la(a,b+20)]},bb=function(a){var b=0;if(a)for(var c in a){var d=a[c].length;if(d>65535)throw"extra field too long";b+=d+4}return b},cb=function(b,c,d,e,f,g,h,i){var a=e.length,j=d.extra,k=i&&i.length,l=bb(j);Z(b,c,h!=null?33639248:67324752),c+=4;h!=null&&(b[c++]=20,b[c++]=d.os);b[c]=20,c+=2;b[c++]=d.flag<<1|(g==null&&8),b[c++]=f&&8;b[c++]=d.compression&255,b[c++]=d.compression>>8;f=new Date(d.mtime==null?Date.now():d.mtime);var m=f.getFullYear()-1980;if(m<0||m>119)throw"date not in range 1980-2099";Z(b,c,m<<25|f.getMonth()+1<<21|f.getDate()<<16|f.getHours()<<11|f.getMinutes()<<5|f.getSeconds()>>>1),c+=4;g!=null&&(Z(b,c,d.crc),Z(b,c+4,g),Z(b,c+8,d.size));Z(b,c+12,a);Z(b,c+14,l),c+=16;h!=null&&(Z(b,c,k),Z(b,c+6,d.attrs),(Z(b,c+10,h),c+=14));b.set(e,c);c+=a;if(l)for(m in j){f=j[m];g=f.length;Z(b,c,+m);Z(b,c+2,g);b.set(f,c+4),c+=4+g}k&&(b.set(i,c),c+=k);return c},db=function(a,b,c,d,e){Z(a,b,101010256),Z(a,b+8,c),Z(a,b+10,c),Z(a,b+12,d),Z(a,b+16,e)},eb=function(){function a(a){this.filename=a,this.c=O(),this.size=0,this.compression=0}a.prototype.process=function(a,b){this.ondata(null,a,b)};a.prototype.push=function(a,b){if(!this.ondata)throw"no callback - add to ZIP archive before pushing";this.c.p(a);this.size+=a.length;b&&(this.crc=this.c.d());this.process(a,b||!1)};return a}();l.ZipPassThrough=eb;Ia=function(){function a(a,b){var c=this;b||(b={});eb.call(this,a);this.d=new ta(b,function(a,b){c.ondata(null,a,b)});this.compression=8;this.flag=Ya(b.level)}a.prototype.process=function(a,b){try{this.d.push(a,b)}catch(a){this.ondata(a,null,b)}};a.prototype.push=function(a,b){eb.prototype.push.call(this,a,b)};return a}();l.ZipDeflate=Ia;i=function(){function a(a,b){var c=this;b||(b={});eb.call(this,a);this.d=new ua(b,function(a,b,d){c.ondata(a,b,d)});this.compression=8;this.flag=Ya(b.level);this.terminate=this.d.terminate}a.prototype.process=function(a,b){this.d.push(a,b)};a.prototype.push=function(a,b){eb.prototype.push.call(this,a,b)};return a}();l.AsyncZipDeflate=i;Pa=function(){function a(a){this.ondata=a,this.u=[],this.d=1}a.prototype.add=function(c){var d=this;if(this.d&2)throw"stream finished";var e=Wa(c.filename),a=e.length,f=c.comment,g=f&&Wa(f);f=a!=c.filename.length||g&&f.length!=g.length;var h=a+bb(c.extra)+30;if(a>65535)throw"filename too long";a=new b(h);cb(a,0,c,e,f);var i=[a],j=function(){for(var a=0,b=i;a<b.length;a++){var c=b[a];d.ondata(null,c,!1)}i=[]},k=this.d;this.d=0;var l=this.u.length,m=R(c,{f:e,u:f,o:g,t:function(){c.terminate&&c.terminate()},r:function(){j();if(k){var a=d.u[l+1];a?a.r():d.d=1}k=1}}),n=0;c.ondata=function(a,e,f){if(a)d.ondata(a,e,f),d.terminate();else{n+=e.length;i.push(e);if(f){a=new b(16);Z(a,0,134695760);Z(a,4,c.crc);Z(a,8,n);Z(a,12,c.size);i.push(a);m.c=n,m.b=h+n+16,m.crc=c.crc,m.size=c.size;k&&m.r();k=1}else k&&j()}};this.u.push(m)};a.prototype.end=function(){var a=this;if(this.d&2){if(this.d&1)throw"stream finishing";throw"stream finished"}this.d?this.e():this.u.push({r:function(){if(!(a.d&1))return;a.u.splice(-1,1);a.e()},t:function(){}});this.d=3};a.prototype.e=function(){var c=0,d=0,e=0;for(var f=0,a=this.u;f<a.length;f++){var g=a[f];e+=46+g.f.length+bb(g.extra)+(g.o?g.o.length:0)}a=new b(e+22);for(var f=0,h=this.u;f<h.length;f++){var g=h[f];cb(a,c,g,g.f,g.u,g.c,d,g.o);c+=46+g.f.length+bb(g.extra)+(g.o?g.o.length:0),d+=g.b}db(a,c,this.u.length,e,d);this.ondata(null,a,!0);this.d=2};a.prototype.terminate=function(){for(var b=0,a=this.u;b<a.length;b++){var c=a[b];c.t()}this.d=2};return a}();l.Zip=Pa;function fb(a,c,d){d||(d=c,c={});if(typeof d!="function")throw"no callback";var e={};Ra(a,"",e,c);var f=Object.keys(e),g=f.length,h=0,i=0,j=g,k=new Array(g),l=[],m=function(){for(var a=0;a<l.length;++a)l[a]()},n=function(){var a=new b(i+22),c=h,e=i-h;i=0;for(var f=0;f<j;++f){var g=k[f];try{var l=g.c.length;cb(a,i,g,g.f,g.u,l);var m=30+g.f.length+bb(g.extra),n=i+m;a.set(g.c,n);cb(a,h,g,g.f,g.u,l,i,g.m),h+=16+m+(g.m?g.m.length:0),i=n+l}catch(a){return d(a,null)}}db(a,h,k.length,e,c);d(null,a)};g||n();a=function(b){var c=f[b],a=e[c],j=a[0],o=a[1],p=O(),q=j.length;p.p(j);var r=Wa(c),s=r.length,t=o.comment,u=t&&Wa(t),v=u&&u.length,w=bb(o.extra),x=o.level==0?0:8;a=function(a,e){if(a)m(),d(a,null);else{a=e.length;k[b]=R(o,{size:q,crc:p.d(),c:e,f:r,m:u,u:s!=c.length||u&&t.length!=v,compression:x});h+=30+s+w+a;i+=76+2*(s+w)+(v||0)+a;--g||n()}};s>65535&&a("filename too long",null);if(!x)a(null,j);else if(q<16e4)try{a(null,wa(j,o))}catch(b){a(b,null)}else l.push(va(j,o,a))};for(c=0;c<j;++c)a(c);return m}l.zip=fb;function gb(c,d){d||(d={});var e={},f=[];Ra(c,"",e,d);c=0;d=0;for(var g in e){var a=e[g],h=a[0];a=a[1];var i=a.level==0?0:8,j=Wa(g),k=j.length,l=a.comment,m=l&&Wa(l),n=m&&m.length,o=bb(a.extra);if(k>65535)throw"filename too long";var p=i?wa(h,a):h,q=p.length,r=O();r.p(h);f.push(R(a,{size:h.length,crc:r.d(),c:p,f:j,m:m,u:k!=g.length||m&&l.length!=n,o:c,compression:i}));c+=30+k+o+q;d+=76+2*(k+o)+(n||0)+q}a=new b(d+22);h=c;r=d-c;for(p=0;p<f.length;++p){var j=f[p];cb(a,j.o,j,j.f,j.u,j.c.length);m=30+j.f.length+bb(j.extra);a.set(j.c,j.o+m);cb(a,c,j,j.f,j.u,j.c.length,j.o,j.m),c+=16+m+(j.m?j.m.length:0)}db(a,c,f.length,r,h);return a}l.zipSync=gb;var hb=function(){function a(){}a.prototype.push=function(a,b){this.ondata(null,a,b)};a.compression=0;return a}();l.UnzipPassThrough=hb;Qa=function(){function a(){var a=this;this.i=new $(function(b,c){a.ondata(null,b,c)})}a.prototype.push=function(a,b){try{this.i.push(a,b)}catch(c){this.ondata(c,a,b)}};a.compression=8;return a}();l.UnzipInflate=Qa;Ba=function(){function a(a,b){var c=this;b<32e4?this.i=new $(function(a,b){c.ondata(null,a,b)}):(this.i=new xa(function(a,b,d){c.ondata(a,b,d)}),this.terminate=this.i.terminate)}a.prototype.push=function(a,b){this.i.terminate&&(a=A(a,0)),this.i.push(a,b)};a.compression=8;return a}();l.AsyncUnzipInflate=Ba;h=function(){function a(a){this.onfile=a,this.k=[],this.o={0:hb},this.p=L}a.prototype.push=function(a,c){var d=this;if(!this.onfile)throw"no callback";if(!this.p)throw"stream finished";if(this.c>0){var e=Math.min(this.c,a.length),f=a.subarray(0,e);this.c-=e;this.d?this.d.push(f,!this.c):this.k[0].push(f);a=a.subarray(e);if(a.length)return this.push(a,c)}else{f=0;var g=0;e=void 0;var h=void 0;!this.p.length?h=a:!a.length?h=this.p:(h=new b(this.p.length+a.length),(h.set(this.p),h.set(a,this.p.length)));var i=h.length,j=this.c;a=j&&this.d;var k=function(){var a=Y(h,g);if(a==67324752){f=1,e=g;l.d=null;l.c=0;var b=X(h,g+6),c=X(h,g+8),k=b&2048;b=b&8;var m=X(h,g+26),n=X(h,g+28);if(i>g+30+m+n){var o=[];l.k.unshift(o);f=2;var p=Y(h,g+18),q=Y(h,g+22),r=Xa(h.subarray(g+30,g+=30+m),!k);p==4294967295?(m=b?[-2]:ab(h,g),p=m[0],q=m[1]):b&&(p=-1);g+=n;l.c=p;var s,t={name:r,compression:c,start:function(){if(!t.ondata)throw"no callback";if(!p)t.ondata(null,L,!0);else{var a=d.o[c];if(!a)throw"unknown compression type "+c;s=p<0?new a(r):new a(r,p,q);s.ondata=function(c,b,a){t.ondata(c,b,a)};for(var a=0,b=o;a<b.length;a++){var e=b[a];s.push(e,!1)}d.k[0]==o&&d.c?d.d=s:s.push(L,!0)}},terminate:function(){s&&s.terminate&&s.terminate()}};p>=0&&(t.size=p,t.originalSize=q);l.onfile(t)}return"break"}else if(j)if(a==134695760){e=g+=12+(j==-2&&8),f=3,l.c=0;return"break"}else if(a==33639248){e=g-=4,f=3,l.c=0;return"break"}},l=this;for(;g<i-4;++g){var m=k();if(m==="break")break}this.p=L;if(j<0){m=f?h.subarray(0,e-12-(j==-2&&8)-(Y(h,e-16)==134695760&&4)):h.subarray(0,g);a?a.push(m,!!f):this.k[+(f==2)].push(m)}if(f&2)return this.push(h.subarray(g),c);this.p=h.subarray(g)}if(c){if(this.c)throw"invalid zip file";this.p=null}};a.prototype.register=function(a){this.o[a.compression]=a};return a}();l.Unzip=h;function ib(a,c){if(typeof c!="function")throw"no callback";var d=[],e=function(){for(var a=0;a<d.length;++a)d[a]()},f={},g=a.length-22;for(;Y(a,g)!=101010256;--g)if(!g||a.length-g>65558){c("invalid zip file",null);return}var h=X(a,g+8);h||c(null,{});var i=h,j=Y(a,g+16),k=j==4294967295;if(k){g=Y(a,g-12);if(Y(a,g)!=101075792){c("invalid zip file",null);return}i=h=Y(a,g+32);j=Y(a,g+48)}g=function(g){g=$a(a,j,k);var i=g[0],l=g[1],m=g[2],n=g[3],o=g[4];g=g[5];g=Za(a,g);j=o;o=function(a,b){a?(e(),c(a,null)):(f[n]=b,--h||c(null,f))};if(!i)o(null,A(a,g,g+l));else if(i==8){g=a.subarray(g,g+l);if(l<32e4)try{o(null,za(g,new b(m)))}catch(a){o(a,null)}else d.push(ya(g,{size:m},o))}else o("unknown compression type "+i,null)};for(var l=0;l<i;++l)g(l);return e}l.unzip=ib;function jb(c){var d={},e=c.length-22;for(;Y(c,e)!=101010256;--e)if(!e||c.length-e>65558)throw"invalid zip file";var f=X(c,e+8);if(!f)return{};var g=Y(c,e+16),h=g==4294967295;if(h){e=Y(c,e-12);if(Y(c,e)!=101075792)throw"invalid zip file";f=Y(c,e+32);g=Y(c,e+48)}for(e=0;e<f;++e){var a=$a(c,g,h),i=a[0],j=a[1],k=a[2],l=a[3],m=a[4];a=a[5];a=Za(c,a);g=m;if(!i)d[l]=A(c,a,a+j);else if(i==8)d[l]=za(c.subarray(a,a+j),new b(k));else throw"unknown compression type "+i}return d}l.unzipSync=jb}var o=!1;function p(){o||(o=!0,n());return m.exports}function a(a){switch(a){case void 0:return p()}}e.exports=a}),null);
__d("fflate",["fflate-0.6.10"],(function(a,b,c,d,e,f){e.exports=b("fflate-0.6.10")()}),null);
__d("WAGzip",["Promise","WAErr","fflate"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(b){babelHelpers.inheritsLoose(a,b);function a(a){var c;c=b.call(this,a)||this;c.$GzipWrapper2=[];c.ondata=function(a,b){c.$GzipWrapper2.push(a);if(!b)return;var d=0;c.$GzipWrapper2.forEach(function(a){d+=a.length});var e=new Uint8Array(d),f=0;c.$GzipWrapper2.forEach(function(a){e.set(a,f),f+=a.length});c.$GzipWrapper1=e};return c}var e=a.prototype;e.push=function(a,e){if(this.$GzipWrapper1!=null)throw c("WAErr")("Tried to push chunk to compressor after final block");a instanceof Uint8Array?b.prototype.push.call(this,a,e):a instanceof ArrayBuffer?b.prototype.push.call(this,new Uint8Array(a),e):b.prototype.push.call(this,d("fflate").strToU8(a),e)};e.result=function(){if(this.$GzipWrapper1==null)throw c("WAErr")("Tried to access result before adding final block");return this.$GzipWrapper1};return a}(d("fflate").Gzip);function a(a){a===void 0&&(a={});return new i(a)}function j(a){return d("fflate").decompressSync(a)}function e(a){return(h||(h=b("Promise"))).resolve(j(a))}g.GzipWrapper=i;g.createDeflate=a;g.inflate=j;g.gzipInflate=e}),98);
__d("MAWComms",["MAWCommsConfig","MAWMockServerShell","MAWODSProxy","MAWQplProxy","MAWServerRPC","WAComms","WAGzip","WAInitAndGetAuthKeyPair","WAOdsEnums","WAResolvable","WASendPresenceStatusProtocol","WATagsLogger","asyncToGeneratorRuntime","promiseDone","qpl"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["openChatSocket retried"]);h=function(){return a};return a}function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=!1,f=new(d("WAResolvable").Resolvable)();void d("MAWQplProxy").measurePerfInQPL(c("qpl")._(1056839232,"112"),"wai_connection",function(){return f.promise});a=(yield d("WAInitAndGetAuthKeyPair").initAndGetAuthKeyPair(a));a=(yield d("MAWCommsConfig").getCommsConfig({authKeyPair:a,handleConnectionChange:function(a){a==="in_handshake"?e===!1?(e=!0,d("MAWQplProxy").sendQplPointThroughBridge(c("qpl")._(1056839232,"112"),"wai_in_handshake")):d("WATagsLogger").TAGS(["backend"]).LOG(h()):a==="connected"?(void b.newConnection(),f.resolve(),d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.WA_CONNECTIVITY,key:"success"}),e=!1):a==="disconnected"&&(void b.connectionDropped(),d("MAWQplProxy").sendQPLBoolAnnotationThroughBridge(c("qpl")._(1056839232,"112"),"didWAIConnectionDisconnect",!0),e=!1,d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.WA_CONNECTIVITY,key:"disconnected"}))},handleOptimisticConnectionChange:function(a){a==="connected"?c("promiseDone")(d("WASendPresenceStatusProtocol").sendPresenceStatusProtocol({status:"available"})):a==="disconnected"&&c("promiseDone")(d("WASendPresenceStatusProtocol").sendPresenceStatusProtocol({status:"unavailable"}))}}));d("WAComms").startComms(d("MAWServerRPC").makeServerRPC().handleStanza,a,d("WAGzip").gzipInflate,!d("MAWMockServerShell").isMockServerMode);d("MAWMockServerShell").isMockServerMode&&(void b.newConnection(),f.resolve())});return i.apply(this,arguments)}g.startComms=a}),98);
__d("MAWCompareIdentity",["MAWDbIdentityTxns","MAWODSProxy","MAWQplProxy","SignalDbTypes","WABase64","WACryptoUtils","WAJids","WALogger","WAOdsEnums","WASignalKeys","gkx","qpl"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Got identity mismatch ",", "," in compare identity"]);h=function(){return a};return a}function a(a){return a.meta.bulkGet([d("SignalDbTypes").MetaKeysEnum.fbid,d("SignalDbTypes").MetaKeysEnum.deviceId,d("SignalDbTypes").MetaKeysEnum.identityKeyPair]).then(function(b){var e=b[0],f=b[1];b=b[2];e=e==null?void 0:e.value.fbid;f=f==null?void 0:f.value.deviceId;var g=b==null?void 0:b.value.identityKeyPair;if(e!=null&&f!=null){b=d("WAJids").toDeviceJid(d("WAJids").toMsgrUserJid(e),f);return d("MAWDbIdentityTxns").bulkGetIdentities(a,[b]).then(function(a){if(!(a.length===0)){a=a[0];if((g==null?void 0:g.publicKey)==null)return!0;if(!d("WACryptoUtils").serializedPubKeysEqual(a.identity,d("WASignalKeys").serializePubKey(g))){var b=d("MAWQplProxy").startQplUserFlow(c("qpl")._(741087294,"2028"));b.endSuccess();d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.COMPARE_IDENTITY,key:"meta_identity_mismatch"});c("gkx")("23915")&&c("gkx")("23916")&&d("WALogger").ERROR(h(),d("WABase64").encodeB64(a.identity),d("WABase64").encodeB64(d("WASignalKeys").serializePubKey(g)));return!1}}return!0})}return!0})}g.compareIdentityDexie=a}),98);
__d("MAWConvertXMATargetTypeToExtendedContentTargetType",["EchoMessageXMAFieldUtils","WAArmadilloXMA.pb","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Not a valid xmaTargetType: ",""]);h=function(){return a};return a}function a(a){switch(a){case d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_PHOTO_MENTION:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_MENTION;case d("EchoMessageXMAFieldUtils").XMAContentType.IG_SINGLE_IMAGE_POST_SHARE:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SINGLE_IMAGE_POST_SHARE;case d("EchoMessageXMAFieldUtils").XMAContentType.IG_MULTIPOST_SHARE:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_MULTIPOST_SHARE;case d("EchoMessageXMAFieldUtils").XMAContentType.IG_SINGLE_VIDEO_POST_SHARE:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SINGLE_VIDEO_POST_SHARE;case d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_PHOTO_SHARE:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_SHARE;case d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_VIDEO_SHARE:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_SHARE;case d("EchoMessageXMAFieldUtils").XMAContentType.IG_CLIPS_SHARE:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_CLIPS_SHARE;case d("EchoMessageXMAFieldUtils").XMAContentType.IG_IGTV_SHARE:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_IGTV_SHARE;case d("EchoMessageXMAFieldUtils").XMAContentType.IG_SHOP_SHARE:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SHOP_SHARE;case d("EchoMessageXMAFieldUtils").XMAContentType.IG_PROFILE_SHARE:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_PROFILE_SHARE;case d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_PHOTO_HIGHLIGHT_SHARE:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_HIGHLIGHT_SHARE;case d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_VIDEO_HIGHLIGHT_SHARE:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_HIGHLIGHT_SHARE;case d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_REPLY:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_REPLY;case d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_REACTION:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_REACTION;case d("EchoMessageXMAFieldUtils").XMAContentType.FB_FEED_SHARE:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE;case d("EchoMessageXMAFieldUtils").XMAContentType.FB_STORY_REPLY:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_REPLY;case d("EchoMessageXMAFieldUtils").XMAContentType.FB_STORY_SHARE:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_SHARE;case d("EchoMessageXMAFieldUtils").XMAContentType.FB_STORY_MENTION:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_MENTION;case d("EchoMessageXMAFieldUtils").XMAContentType.FB_FEED_VIDEO_SHARE:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_VIDEO_SHARE;case d("EchoMessageXMAFieldUtils").XMAContentType.FB_GAMING_CUSTOM_UPDATE:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_GAMING_CUSTOM_UPDATE;case d("EchoMessageXMAFieldUtils").XMAContentType.FB_PRODUCER_STORY_REPLY:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_PRODUCER_STORY_REPLY;case d("EchoMessageXMAFieldUtils").XMAContentType.MSG_EXTERNAL_LINK_SHARE:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_EXTERNAL_LINK_SHARE;case d("EchoMessageXMAFieldUtils").XMAContentType.RTC_AUDIO_CALL:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_AUDIO_CALL;case d("EchoMessageXMAFieldUtils").XMAContentType.RTC_VIDEO_CALL:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_VIDEO_CALL;case d("EchoMessageXMAFieldUtils").XMAContentType.RTC_MISSED_AUDIO_CALL:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_AUDIO_CALL;case d("EchoMessageXMAFieldUtils").XMAContentType.RTC_MISSED_VIDEO_CALL:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_VIDEO_CALL;case d("EchoMessageXMAFieldUtils").XMAContentType.RTC_GROUP_AUDIO_CALL:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_AUDIO_CALL;case d("EchoMessageXMAFieldUtils").XMAContentType.RTC_GROUP_VIDEO_CALL:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_VIDEO_CALL;case d("EchoMessageXMAFieldUtils").XMAContentType.FB_EVENT:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_EVENT;default:d("WALogger").ERROR(h(),a);return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_EXTERNAL_LINK_SHARE}}g.convertXMATargetTypeToExtendedContentTargetType=a}),98);
__d("MAWMediaPreviewDownloadManager",["WAResolvable"],(function(a,b,c,d,e,f,g){"use strict";var h=1e4,i=[],j=new Map();function a(a){if(j.has(a))return;k();var b=new(d("WAResolvable").Resolvable)();j.set(a,b);i.push(a)}function b(a){return j.get(a)}function c(a){j["delete"](a)}function k(){if(i.length>=h){var a=i.shift();j["delete"](a)}}function e(){i=[],j.clear()}g.markMediaPreviewAsDownloading=a;g.getMediaPreviewDownloadingResolvable=b;g.removeMediaPreviewDownloadingResolvable=c;g.clear=e}),98);
__d("MAWHandleMediaPreviewBeforeDownloadApi",["MAWMediaPreviewDownloadManager","Promise"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(a){d("MAWMediaPreviewDownloadManager").markMediaPreviewAsDownloading(a);return(h||(h=b("Promise"))).resolve()};g.handleMediaPreviewBeforeDownload=a}),98);
__d("WAMediaHkdfInfo",["WAErr"],(function(a,b,c,d,e,f,g){"use strict";function a(a){switch(a){case"document":return"WhatsApp Document Keys";case"image":case"sticker":case"xma-image":return"WhatsApp Image Keys";case"video":case"gif":return"WhatsApp Video Keys";case"audio":case"ptt":return"WhatsApp Audio Keys";case"md-app-state":return"WhatsApp App State Keys";case"md-msg-hist":return"WhatsApp History Keys";default:throw c("WAErr")("getMediaHkdfInfo: unexpected media type "+a)}}function b(){return"Messenger Preview Keys"}g.getMediaHkdfInfo=a;g.getPreviewMediaHkdfInfo=b}),98);
__d("WAMediaCrypto",["Promise","WABase64","WABinary","WACryptoAesCbc","WACryptoDependencies","WACryptoHkdf","WACryptoHmac","WACryptoSha256","WACryptoUtils","WACustomError","WAErr","WALogger","WAMediaCryptoSidecar","WAMediaHkdfInfo","WAMediaUtils","WAPREList","WAPREMetrics","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["WAMediaCrypto::downloadAndDecrypt"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Processing scan ",""]);j=function(){return a};return a}var k=d("WACustomError").customError("HmacValidationError",!1);function l(a,b){return d("WACryptoHkdf").extractAndExpand(new Uint8Array(a),b,112).then(function(a){return{iv:new Uint8Array(a,0,16),cipherKey:new Uint8Array(a,16,32),hmacKey:new Uint8Array(a,48,32),refKey:new Uint8Array(a,80,32)}})}function m(a,b){b=d("WAMediaHkdfInfo").getMediaHkdfInfo(b);return l(a,b)}function n(a){var b=d("WAMediaHkdfInfo").getPreviewMediaHkdfInfo();return l(a,b)}function a(a){var c,d,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:c=new Map();f.next=3;return b("regeneratorRuntime").awrap(n(a));case 3:d=f.sent;c.set("preview",d);e=["document","image","video","audio","md-app-state","md-msg-hist"];f.next=8;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all(e.map(function(b){return m(a,b).then(function(a){c.set(b,a)})})));case 8:return f.abrupt("return",c);case 9:case"end":return f.stop()}},null,this)}function e(a){switch(a){case"image":case"video":return a;default:throw c("WAErr")("Unsupported PreviewMediaType: "+a)}}var o=16,p=16,q=10,r=64*1024;function s(a,c,e,f,g){var i,j,k,l,m,n,s,t,u,v,w,x,y,z,A;return b("regeneratorRuntime").async(function(B){while(1)switch(B.prev=B.next){case 0:i=new(d("WABinary").Binary)(),i.ensureCapacity(p+f.size+o+q),i.writeByteArray(c),j=new(d("WACryptoAesCbc").AesCbcStream)(i,"encrypt",a,c),k=0,l=k+r;case 6:if(!(l<f.size)){B.next=17;break}m=f.slice(k,l);B.next=10;return b("regeneratorRuntime").awrap(d("WAMediaUtils").blobToArrayBuffer(m));case 10:n=B.sent;B.next=13;return b("regeneratorRuntime").awrap(j.append(new Uint8Array(n)));case 13:k=l;l+=r;B.next=6;break;case 17:B.next=19;return b("regeneratorRuntime").awrap(d("WAMediaUtils").blobToArrayBuffer(f.slice(k)));case 19:s=B.sent;B.next=22;return b("regeneratorRuntime").awrap(j.finalize(new Uint8Array(s)));case 22:t=i.peek(function(a){return a.readByteArray()});B.next=25;return b("regeneratorRuntime").awrap(d("WACryptoHmac").encodeKeySha256(e));case 25:u=B.sent;B.next=28;return b("regeneratorRuntime").awrap(d("WACryptoHmac").sign(u,t));case 28:v=B.sent;i.writeByteArray(new Uint8Array(v,0,q));w=i.readByteArray();x=w.subarray(p);B.next=34;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all([d("WACryptoDependencies").getCrypto().subtle.digest("SHA-256",x),d("WAMediaCryptoSidecar").shouldHaveStreamingSidecar(g)?d("WAMediaCryptoSidecar").calculateStreamingSidecar(u,w):void 0]));case 34:y=B.sent;z=y[0];A=y[1];return B.abrupt("return",{ciphertext:x,ciphertextHash:z,sidecar:A,ivCiphertext:t});case 38:case"end":return B.stop()}},null,this)}function f(a,c,e){var f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:h.next=2;return b("regeneratorRuntime").awrap(d("WACryptoHmac").encodeKeySha256(a));case 2:f=h.sent;g=d("WABinary").Binary.build(c,e).readByteArray();return h.abrupt("return",d("WACryptoHmac").sign(f,g));case 5:case"end":return h.stop()}},null,this)}function t(a,c,e,f,g){var h,i,j,l,m;return b("regeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:if(10<=g.length&&g.length<=32){n.next=2;break}throw new k("Bad hmac size "+g.length);case 2:h=d("WABinary").Binary.build(c,e).readByteArray();n.next=5;return b("regeneratorRuntime").awrap(d("WACryptoHmac").hmacSha256(f,h).then(function(a){return new Uint8Array(a)}));case 5:i=n.sent;j=i.slice(0,g.length);if(w(j,g)){n.next=9;break}throw new k("hmacAndDecrypt hmac mismatch");case 9:n.next=11;return b("regeneratorRuntime").awrap(d("WACryptoAesCbc").aesCbcDecrypt(a,c,e));case 11:l=n.sent;n.next=14;return b("regeneratorRuntime").awrap(d("WACryptoDependencies").getCrypto().subtle.digest("SHA-256",l));case 14:m=n.sent;return n.abrupt("return",{plaintextHash:d("WABase64").encodeB64UrlSafe(new Uint8Array(m)),plaintext:l});case 16:case"end":return n.stop()}},null,this)}function u(a,b,c,e,f){if(!(10<=f.length&&f.length<=32))throw new k("Bad hmac size "+f.length);var g=c.subarray(0,c.byteLength-o);g=d("WABinary").Binary.build(b,g).readByteArray();e=d("WACryptoHmac").hmacSha256(e,g).then(function(a){return new Uint8Array(a)});return e.then(function(a){a=a.slice(0,f.length);if(!d("WACryptoUtils").uint8ArraysEqual(a,f))throw new k("hmacAndDecrypt hmac mismatch")}).then(function(){return d("WACryptoAesCbc").aesCbcDecrypt(a,b,c)}).then(function(a){return new Uint8Array(a)}).then(function(a){var b=a.subarray(0,a.byteLength-2);return d("WACryptoSha256").sha256(b).then(function(a){return{plaintext:b,plaintextHash:d("WABase64").encodeB64UrlSafe(new Uint8Array(a))}})})}function v(a,c,e,f,g,h){var i,k,l,m,n,p,q,r,t,v,w,x,y,z,A,B,C,D;return b("regeneratorRuntime").async(function(E){while(1)switch(E.prev=E.next){case 0:i=new(d("WABinary").Binary)();k=[];for(l=0;l<g;l++)k.push(new Uint8Array(h.sidecar.slice(l*10,(l+1)*10)));m=0;n=c;p=0;q=0;case 7:if(!(q<g)){E.next=30;break}d("WALogger").DEV(j(),q);r=h.alignedScanLengths[q];t=m+r;v=e.slice(m,t);w=new Uint8Array(v.slice(r-o,r));E.next=15;return b("regeneratorRuntime").awrap(s(a,w,f,new Blob([2,2]),"image"));case 15:x=E.sent;y=new(d("WABinary").Binary)(v);y.writeByteArray(x.ciphertext.slice(0,o));z=y.readByteArray();E.next=21;return b("regeneratorRuntime").awrap(u(a,n,z,f,k[q]));case 21:A=E.sent,B=A.plaintext,i.write(B),m+=r,n=w,p+=h.scanLengths[q];case 27:q++;E.next=7;break;case 30:C=i.readBuffer(p);E.next=33;return b("regeneratorRuntime").awrap(d("WACryptoSha256").sha256(C));case 33:D=E.sent;return E.abrupt("return",{plaintextHash:d("WABase64").encodeB64UrlSafe(new Uint8Array(D)),plaintext:C});case 35:case"end":return E.stop()}},null,this)}function w(a,b){if(a.length!==b.length)return!1;var c=1,d=a.length;for(var e=0;e<d;e++)c&=a[e]===b[e]?1:0;return c!==0}function x(a,e,f,g,j,k,l){var m,n,o,p,q,r,s,u,v,w,x;return b("regeneratorRuntime").async(function(y){while(1)switch(y.prev=y.next){case 0:d("WALogger").DEV(i());m=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.DOWNLOAD_AND_DECRYPT);y.prev=2;m.addPoint("download_start");y.next=6;return b("regeneratorRuntime").awrap(fetch(a));case 6:n=y.sent;m.addPoint("download_end");y.next=15;break;case 10:y.prev=10;y.t0=y["catch"](2);m.addPoint("download_end");m.endFail("download_error");throw c("WAErr")("download_error");case 15:if(!(n.status!==200)){y.next=18;break}m.endFail("http_status_"+n.status);throw c("WAErr")("http_status="+n.status);case 18:m.endSuccess();y.next=21;return b("regeneratorRuntime").awrap(n.arrayBuffer());case 21:o=y.sent;if(!(o.byteLength<j+k)){y.next=25;break}m.endFail("bad_ciphertext_size");throw c("WAErr")("bad_ciphertext_size");case 25:p=o.byteLength-k;q=new Uint8Array(o,p);r=q.slice(0,k);s=new Uint8Array(o,0,p);y.next=31;return b("regeneratorRuntime").awrap(t(f,e,s,g,q));case 31:u=y.sent;v=u.plaintext;w=u.plaintextHash;l(new Uint8Array(v));x=new Uint8Array(d("WABase64").decodeB64UrlSafe(w));return y.abrupt("return",(h||(h=b("Promise"))).resolve({tail:r,plaintextHash:x,hmac:q}));case 37:case"end":return y.stop()}},null,this,[[2,10]])}g.HmacValidationError=k;g.computeMediaKeys=m;g.computeMediaKeysForPreview=n;g.deprecated_getAllCommonComputedMediaKeys=a;g.convertServerMediaTypeToPreviewMediaType=e;g.IV_LENGTH=p;g.HMAC_LENGTH=q;g.encryptAndHmac=s;g.hmacCiphertext=f;g.hmacAndDecrypt=t;g.decryptPartialChunks=v;g.downloadAndDecrypt=x}),98);
__d("WAAlignChunkLengthsToMultipleOfAesBlockSize",[],(function(a,b,c,d,e,f){"use strict";function g(a){return parseInt((a+15)/16,10)*16}function a(a,b){var c=[],d=0,e=0,f=0;for(var h=0;h<a.length;++h){d+=a[h];if(h===a.length-1&&b!=null){d>e?c.push(b-e):(c.pop(),c.push(b-f));break}else if(d>e){var i=g(d-e);f=e;c.push(i);e+=i}}return c}f.alignChunkSizeToMultipleAesBlockSize=g;f.alignChunkLengthsToMultipleOfAesBlockSize=a}),66);
__d("WAProgressiveJpegAlignScanLengths",["WAAlignChunkLengthsToMultipleOfAesBlockSize"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return d("WAAlignChunkLengthsToMultipleOfAesBlockSize").alignChunkLengthsToMultipleOfAesBlockSize(a.map(function(a){return a}),b).map(function(a){return a})}function b(a){return a}g.progressiveJpegAlignChunkLengthsToMultipleOfAesBlockSize=a;g.toProgressiveJpegAlignedScanLength=b}),98);
__d("WAProgressiveJpegGetPJpegDetails",["WAMediaCrypto","WAProgressiveJpegAlignScanLengths","WAProgressiveJpegGetScanLengths","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,c,e){var f,g,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:f=c.byteLength-d("WAMediaCrypto").IV_LENGTH;g=d("WAProgressiveJpegGetScanLengths").getProgressiveJpegScanLengths(a);i=d("WAProgressiveJpegAlignScanLengths").progressiveJpegAlignChunkLengthsToMultipleOfAesBlockSize(g,f);k.next=5;return b("regeneratorRuntime").awrap(h(i,c,e));case 5:j=k.sent;return k.abrupt("return",{scanLengths:g,sidecar:j});case 7:case"end":return k.stop()}},null,this)}function h(a,c,e){var f,g,h,i,j,k,l,m,n;return b("regeneratorRuntime").async(function(o){while(1)switch(o.prev=o.next){case 0:f=new Uint8Array(a.length*10),g=0,h=0,i=c.slice(0,16),j=c.slice(16),k=0;case 6:if(!(k<a.length)){o.next=19;break}l=a[k];h=g+l;m=j.subarray(g,h);o.next=12;return b("regeneratorRuntime").awrap(d("WAMediaCrypto").hmacCiphertext(e,i,m));case 12:n=o.sent.slice(0,10),f.set(new Uint8Array(n),k*10),i=m.slice(m.length-16,m.length),g=h;case 16:k++;o.next=6;break;case 19:return o.abrupt("return",f.buffer);case 20:case"end":return o.stop()}},null,this)}function i(a){if(a.scanLengths.length===0)return!1;return a.scanLengths.length*10!==a.sidecar.byteLength?!1:!0}function c(a,b){var c=0;if(b===0)return 0;for(var d=0;d<b;d++){var e=a[d];e!=null&&(c+=e)}return c}function e(a){if(a.progressiveJpegDetails==null)return null;return!i(a.progressiveJpegDetails)?null:{scanLengths:a.progressiveJpegDetails.scanLengths,sidecar:a.progressiveJpegDetails.sidecar}}g.getProgressiveJpegDetails=a;g.isValidProgressiveJpegDetails=i;g.getTotalByteSizeForScan=c;g.maybeGetProgressiveJpegDetailsUsingMediaEntry=e}),98);
__d("MAWDownloadDownloadablePreview",["MAWDownloadMedia","MAWExternalId","MAWGlobals","MAWHandleMediaPreviewBeforeDownloadApi","MAWLoggerUtils","WAJids","WAMediaCrypto","WAPREList","WAPREMetrics","WAProgressiveJpegGetPJpegDetails","WebStorageEstimator","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["finished downloading"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["failed to download media. Reason: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["media: mediaPreview - unsupported preview media type "," - ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["media: mediaPreview - mediaEntryData "," is incomplete for media preview"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["DownloadableThumbnail exists. Attempting to download."]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["No downloadableThumbnail. Skipping..."]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["thumbnail_available: ",""]);n=function(){return a};return a}var o=d("MAWDownloadMedia").mediaDownloadLogger.TAGS([d("MAWLoggerUtils").Tag.MediaPreview]);function a(a,b,c,d){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){var f=e.downloadableThumbnail,g=f==null?void 0:f.directPath,p=g!=null;o.LOG(n(),p);if(f==null||g==null){o.LOG(m());return null}o.LOG(l());p=f.fileEncSha256;var q=f.fileSha256,r=f.mediaKey;f=f.objectId;if(g==null||p==null||q==null||r==null){o.ERROR(k(),e);return}var s=d("WAJids").switchOnMsgrChatJidType(a.chat,{group:function(){return"group"},user:function(){return"user"}}),t=d("WAProgressiveJpegGetPJpegDetails").maybeGetProgressiveJpegDetailsUsingMediaEntry(e),u=(yield d("WebStorageEstimator").estimateStorage());t=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.MEDIA_DOWNLOAD,{bool:{duplicateDirectPath:g===e.directPath,isMediaFallbackToAlternativeHmacSaltsEnabled:d("MAWGlobals").getConfig().isMediaFallbackToAlternativeHmacSaltsEnabled(),isPreview:!0,isProgressiveJpeg:t!=null},"int":{storageQuota:(u==null?void 0:u.quota)||0,storageUsage:(u==null?void 0:u.usage)||0},string:{chat_type:s,downloadEntry:"downloadable-preview",e2eePlatform:d("MAWExternalId").getPlatform(a.externalId),jid:a.chat,mediaType:e.serverMediaType}});var v;try{v=d("WAMediaCrypto").convertServerMediaTypeToPreviewMediaType(c)}catch(a){o.ERROR(j(),c,a);t.endFail("preview-unsupported-type");return}yield d("MAWHandleMediaPreviewBeforeDownloadApi").handleMediaPreviewBeforeDownload(b);u=(yield d("MAWDownloadMedia").downloadMediaImpl(a,b,t,{messageType:v,type:"preview"},g,p,q,r,f,null,e));if(u.success===!1)o.ERROR(i(),u.error),t.endFail(u.error);else{o.LOG(h());t.endSuccess();return u.value}});return p.apply(this,arguments)}g.maybeDownloadDownloadablePreview=a}),98);
__d("MAWGetMediaPlaintextApi",["MAWIndexedDb","MAWMediaUtils","MAWOptimisticUploadManager","MAWTransactionMode","Promise","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Media blob does not exist for the given hashedPlaintextHash"]);i=function(){return a};return a}a=function(a){var c=d("MAWOptimisticUploadManager").getOptimisticUploadManager();c=c.get(a);if(c==null)return j(a);else return(h||(h=b("Promise"))).resolve(c.file)};function j(a){return d("MAWIndexedDb").makeMsgrTransactor({chunk:d("MAWTransactionMode").READONLY},"getMediaPlaintextFromDb",function(a){return function(b){b=d("MAWMediaUtils").genHMACPlaintextHash(b);return a.chunk.where("hashedPlaintextHash").equals(b).first().then(function(a){if(!a){d("WALogger").WARN(i());return null}return new Blob([a.blobData],{type:a.mimetype})})}})(a)}g.getMediaPlaintext=a}),98);
__d("WADecryptMedia",["WAGlobals","WAMediaCrypto","WAResultOrError","WATagsLogger","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Download Plaintext Success"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Download Plaintext Error ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Using default plaintext verifier"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([""," is not a working hmac salt."]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Found a working hmac salt using ","."]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Trying "," as an alternative hmac salt."]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Encountered enc-hash-mismatch - looking for a potential working hmac salt"]);n=function(){return a};return a}var o=d("WATagsLogger").TAGS(["WADecryptMedia"]);function p(a,c,e,f){var g,h,i,j,p,q,r,s,t,u,v;return b("regeneratorRuntime").async(function(w){while(1)switch(w.prev=w.next){case 0:o.WARN(n());g=e.type==="preview"?"preview":e.mediaType;w.next=4;return b("regeneratorRuntime").awrap(d("WAMediaCrypto").deprecated_getAllCommonComputedMediaKeys(f));case 4:h=w.sent,(j=h,p=Array.isArray(j),q=0,j=p?j:j[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 6:if(!p){w.next=12;break}if(!(q>=j.length)){w.next=9;break}return w.abrupt("break",39);case 9:r=j[q++];w.next=16;break;case 12:q=j.next();if(!q.done){w.next=15;break}return w.abrupt("break",39);case 15:r=q.value;case 16:s=r;t=s[0];u=s[1];w.prev=19;if(!(t===g)){w.next=22;break}return w.abrupt("continue",37);case 22:o.LOG(m(),t);w.t0=d("WAResultOrError").makeResult;w.next=26;return b("regeneratorRuntime").awrap(d("WAMediaCrypto").hmacAndDecrypt(u.cipherKey,u.iv,a,u.hmacKey,c));case 26:w.t1=w.sent;v=w.t0(w.t1);i={hmacAndDecryptResult:v,alternativeHmacSaltUsed:t};o.LOG(l(),t);return w.abrupt("return",i);case 33:w.prev=33;w.t2=w["catch"](19);o.LOG(k(),t);return w.abrupt("continue",37);case 37:w.next=6;break;case 39:return w.abrupt("return",{hmacAndDecryptResult:d("WAResultOrError").makeError("enc-hash-mismatch")});case 40:case"end":return w.stop()}},null,this,[[19,33]])}function a(a){var c,e,f,g,k,l,m,n,q,r,s,t,u,v;return b("regeneratorRuntime").async(function(w){while(1)switch(w.prev=w.next){case 0:c=a.ciphertextHmac,e=a.mediaKey,f=a.mediaTypeDetails,g=a.plaintextHash;o.LOG(j());k=c.byteLength-d("WAMediaCrypto").HMAC_LENGTH;l=new Uint8Array(c,k);m=new Uint8Array(c,0,k);f.type==="preview"?n=d("WAMediaCrypto").computeMediaKeysForPreview(e):n=d("WAMediaCrypto").computeMediaKeys(e,f.mediaType);r=null;w.next=9;return b("regeneratorRuntime").awrap(n.then(function(a){var b=a.iv,c=a.cipherKey;a=a.hmacKey;return d("WAMediaCrypto").hmacAndDecrypt(c,b,m,a,l)}).then(d("WAResultOrError").makeResult)["catch"](function(a){o.ERROR(i(),a);if(a instanceof d("WAMediaCrypto").HmacValidationError)return d("WAResultOrError").makeError("enc-hash-mismatch");else return d("WAResultOrError").makeError("decryption-error")}));case 9:q=w.sent;if(!(d("WAGlobals").getConfig().isMediaFallbackToAlternativeHmacSaltsEnabled()===!0&&q.success===!1&&q.error==="enc-hash-mismatch")){w.next=16;break}w.next=13;return b("regeneratorRuntime").awrap(p(m,l,f,e));case 13:s=w.sent,q=s.hmacAndDecryptResult,r=s.alternativeHmacSaltUsed;case 16:if(q.success){w.next=18;break}return w.abrupt("return",q);case 18:t=q.value,u=t.plaintext,v=t.plaintextHash;if(!(g!==v)){w.next=21;break}return w.abrupt("return",d("WAResultOrError").makeError("hash-mismatch"));case 21:o.LOG(h());return w.abrupt("return",d("WAResultOrError").makeResult({plaintext:u,alternativeHmacSaltUsed:r}));case 23:case"end":return w.stop()}},null,this)}g.decryptMedia=a}),98);
__d("WADecimalStringMod",["WAErr","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(['"','" is over 64 bits']);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(['"','" is not a valid decimal string']);i=function(){return a};return a}function a(a,b){if(!/^\d+$/.test(a)){d("WALogger").ERROR(i(),a);throw c("WAErr")("decimalStringMod is given an invalid decimal string")}var e=a.length;if(e<16||e===16&&a<="9007199254740991")return Number(a)%b;if(e>20||e===20&&a>"18446744073709551615"){d("WALogger").ERROR(h(),a);throw c("WAErr")("decimalStringMod is given value over 64 bits")}e=0;for(var f=0;f<a.length;f++){var g=Number(a[f]);e=(e*10+g)%b}return e}g.decimalStringMod=a}),98);
__d("WACreateGetVcaEnabledBucket",["WAArrayBufferUtils","WADecimalStringMod","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["mediaRouteSelection: can't get fbId from mediaDirectPath"]);h=function(){return a};return a}function a(a,b){return function(){return b==null?null:d("WAArrayBufferUtils").arrayBufferMod(a,b)+100}}function b(a,b){return function(){if(b==null)return null;var c=a.split("/");c=c[c.length-1];c=c.split("_")[1];if(!/^\d+$/.test(c))return null;if(c==null){d("WALogger").ERROR(h());return null}else return d("WADecimalStringMod").decimalStringMod(c,b)+100}}g.createGetVcaEnabledBucket=a;g.msgrCreateGetVcaEnabledBucket=b}),98);
__d("WAExtractNcHotTimestamp",["WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){if(a==null)return null;a=h(a);if(a.has("_nc_hot")){a=parseInt(a.get("_nc_hot"),10);return Number.isInteger(a)?d("WATimeUtils").castToUnixTime(a):null}else return null}function h(a){a=a.split("?");return new URLSearchParams(a.length===2?a[1]:"")}g.extractNcHotTimestamp=a}),98);
__d("WAMediaConnParser",["WADeprecatedWapParser","WAServerMediaType"],(function(a,b,c,d,e,f,g){"use strict";a=new(c("WADeprecatedWapParser"))("mediaConnParser",function(a){a=a.child("media_conn");var b=j(a);return{hosts:b,authToken:a.attrString("auth"),authTokenExpiryTs:a.attrFutureTime("auth_ttl"),routesExpiryTs:a.attrFutureTime("ttl"),maxBuckets:a.attrInt("max_buckets"),maxManualRetry:(b=a.maybeAttrInt("max_manual_retry",0,4))!=null?b:3,maxAutoDownloadRetry:(b=a.maybeAttrInt("max_auto_download_retry",0,4))!=null?b:3}});function h(a){var b;return!a.hasAttr("fallback_hostname")?void 0:{domain:a.attrString("fallback_hostname"),"class":a.maybeAttrString("fallback_class"),ip4:(b=a.maybeAttrString("fallback_ip4"))!=null?b:void 0,ip6:(b=a.maybeAttrString("fallback_ip6"))!=null?b:void 0}}function i(a){var b;return{domain:a.attrString("hostname"),fallback:h(a),uploadable:k(a,"upload"),downloadable:k(a,"download"),isFallback:a.maybeAttrString("type")==="fallback",downloadBuckets:(b=(b=a.maybeChild("download_buckets"))==null?void 0:b.mapChildren(function(a){return parseInt(a.tag(),10)}))!=null?b:[],"class":a.maybeAttrString("class"),ip4:(b=a.maybeAttrString("ip4"))!=null?b:void 0,ip6:(b=a.maybeAttrString("ip6"))!=null?b:void 0}}function j(a){return a.mapChildrenWithTag("host",i)}function k(a,b){if(a.hasChild(b))return a.child(b).mapChildren(function(a){a=a.tag();return d("WAServerMediaType").castToServerMediaType(a)}).filter(Boolean);else return d("WAServerMediaType").SERVER_MEDIA}g.mediaConnParser=a}),98);
__d("WAGatherMediaInfo",["WADeprecatedSendIq","WAErrors","WALogger","WAMediaConnParser","WAPromiseManagement","WAPromiseRetryLoop","WAResultOrError","WAWap"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["gatherMediaInfo error ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["gatherMediaInfo got "," hosts"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["gatherMediaInfo got client error: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["gatherMediaInfo got "," seconds backoff"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["gatherMediaInfo failure ",""]);l=function(){return a};return a}var m=507;b=d("WAPromiseManagement").cacheWhilePending(function(){return"gatherMediaInfo"},a);function a(){var a=new(d("WAPromiseRetryLoop").PromiseRetryLoop)({name:"gatherMediaInfo",timer:{jitter:.25,max:987e3,algo:{type:"fibonacci",first:6e3,second:12e3},relativeDelay:!0},code:o});a.start();return a.promise()}var n=60;function o(a){var b;b=(b=d("WAWap")).wap("iq",{to:b.S_WHATSAPP_NET,xmlns:"w:m",type:"set",id:b.generateId()},b.wap("media_conn",null));return d("WADeprecatedSendIq").deprecatedSendIqIfConnectedWithin(b,d("WAMediaConnParser").mediaConnParser,n).then(function(b){if(!b.success){d("WALogger").LOG(l(),b);if(b.errorCode===m){var c=b.errorBackoff;d("WALogger").LOG(k(),c);a(d("WAResultOrError").makeError({type:"backoff",backoffMs:c*1e3}))}else b.errorCode<500&&(d("WALogger").LOG(j(),b.errorCode),a(d("WAResultOrError").makeError({type:"client-error",code:b.errorCode,text:b.errorText})))}else d("WALogger").LOG(i(),b.result.hosts.length),a(d("WAResultOrError").makeResult(b.result))})["catch"](function(b){b instanceof d("WAErrors").Disconnected?a(d("WAResultOrError").makeError("disconnected")):d("WALogger").ERROR(h(),b)})}g.gatherMediaInfo=b}),98);
__d("WAMediaRouteSelection",["WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=null,c=null,e=null,f=a.hosts,g=a.operation,h=a.mediaType;if(a.operation==="download"){var i=a.catHotTimespan,j=a.ncHot;a=a.getVcaEnabledBucket;var k=new Map();f.forEach(function(a){a.downloadBuckets.forEach(function(b){k.set(b,a)})});var l=k.get(0);i>0&&j!=null&&d("WATimeUtils").happenedWithin(d("WATimeUtils").castToUnixTime(j),i)?b=1:a&&(b=a());j=null;b!=null&&(j=k.get(b));((i=j)==null?void 0:i.downloadable.includes(h))?c=j:(l==null?void 0:l.downloadable.includes(h))&&(c=l)}for(a=0;a<f.length;a++){i=f[a];g==="upload"&&i.uploadable.includes(h)?c==null?c=i:i.isFallback&&e==null&&(e=i):g==="download"&&i.downloadable.includes(h)&&(c==null?c=i:i.isFallback&&e==null&&(e=i));if(c!=null&&e!=null)break}return{selectedHost:c,fallbackHost:e,bucket:b}}g.mediaRouteSelection=a}),98);
__d("WAGetMediaRoute",["$InternalEnum","Promise","WACreateGetVcaEnabledBucket","WAExtractNcHotTimestamp","WAGatherMediaInfo","WAMediaRouteSelection","WAPromiseManagement","WAResultOrError","WATagsLogger","WATimeUtils","WAWorkerGlobalScope","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error occurred on gather after backoff expiry: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Can not get mediaAccess: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["mediaAccess has gone, gather a new one"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["mediaAccess has gone, but we are still locked by backoff"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error occurred during authTTL automatic refresh: ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["AuthTTL approaching expiry, refreshing MediaAccess routes"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error: no media host"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to get mediaAccess: ",""]);p=function(){return a};return a}var q=d("WATagsLogger").TAGS(["GetMediaRoute"]),r=!0,s=86400,t=b("$InternalEnum")({Fresh:"fresh",Cached:"cached",Stale:"stale"}),u=null,v=!1,w=null;function a(a,c){var e,f,g,h,i,j,k,l,m;return b("regeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:n.next=2;return b("regeneratorRuntime").awrap(A());case 2:e=n.sent;if(e.success){n.next=7;break}q.ERROR(p(),e.error);c==null?void 0:c.addPoint("get_media_access_failed",{string:{mediaAccessStatus:e.error}});return n.abrupt("return",e);case 7:c==null?void 0:c.addAnnotations({string:{mediaAccessStatus:e.value.state}});f=e.value.mediaAccess,g=f.authToken,h=f.hosts,i=f.maxBuckets;j=a.operation==="upload"?d("WAMediaRouteSelection").mediaRouteSelection({operation:"upload",mediaType:a.serverMediaType,hosts:h}):d("WAMediaRouteSelection").mediaRouteSelection({operation:"download",mediaType:a.serverMediaType,hosts:h,catHotTimespan:s,ncHot:d("WAExtractNcHotTimestamp").extractNcHotTimestamp(a.directPath),getVcaEnabledBucket:r?d("WACreateGetVcaEnabledBucket").msgrCreateGetVcaEnabledBucket(a.directPath,i):void 0}),k=j.selectedHost,l=j.fallbackHost,m=j.bucket;if(!(k==null)){n.next=13;break}q.ERROR(o());return n.abrupt("return",d("WAResultOrError").makeError("no-host"));case 13:return n.abrupt("return",d("WAResultOrError").makeResult({authToken:g,selectedHost:k,fallbackHost:l,bucket:m}));case 14:case"end":return n.stop()}},null,this)}function x(){var a=w;a!=null&&(d("WAWorkerGlobalScope").workerGlobalScope.clearTimeout(a),w=null)}function y(a){x();var b=Math.max(a.authTokenExpiryTs-d("WATimeUtils").unixTime(),0);if(b<=5*60)return;var c=d("WATimeUtils").pastUnixTime(5*60,a.authTokenExpiryTs);b=d("WATimeUtils").pastUnixTime(Math.floor(b*.2),a.authTokenExpiryTs);a=c<b?c:b;c=d("WATimeUtils").cappedMillisecondsUntil(a);b=Math.floor(Math.random()*d("WATimeUtils").MINUTE_MILLISECONDS);a=d("WAWorkerGlobalScope").workerGlobalScope.setTimeout(function(){q.LOG(n()),z()["catch"](function(a){q.ERROR(m(),a)})},c+b);w=a}var z=d("WAPromiseManagement").cacheWhilePending(function(){return"all"},function(){var a,c,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:if(!v){f.next=3;break}q.LOG(l());return f.abrupt("return",d("WAResultOrError").makeError("backoff"));case 3:q.LOG(k());x();f.next=7;return b("regeneratorRuntime").awrap(d("WAGatherMediaInfo").gatherMediaInfo());case 7:a=f.sent;if(!a.success){f.next=14;break}u=a.value;y(a.value);return f.abrupt("return",d("WAResultOrError").makeResult({mediaAccess:a.value,state:t.Fresh}));case 14:c=a.error;e=c==="disconnected"?"disconnected":c.type;q.WARN(j(),e);if(!(c==="disconnected"||c.type==="client-error")){f.next=21;break}return f.abrupt("return",d("WAResultOrError").makeError("disconnected"));case 21:c.type;v=!0;d("WAWorkerGlobalScope").workerGlobalScope.setTimeout(function(){v=!1,z()["catch"](function(a){q.ERROR(i(),a)})},c.backoffMs);return f.abrupt("return",d("WAResultOrError").makeError("backoff"));case 25:case"end":return f.stop()}},null,this)}),A=function(){var a=u;if(a==null)return z();if(d("WATimeUtils").isInFuture(a.routesExpiryTs))return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult({mediaAccess:a,state:t.Cached}));var c=z();return d("WATimeUtils").isInFuture(a.authTokenExpiryTs)?(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult({mediaAccess:a,state:t.Stale})):c};function c(){u=null,v=!1,x()}g.getMediaRoute=a;g.clearCachedMediaAccessForTest=c}),98);
__d("WASmaxInMmsdIQErrorResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","error");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQErrorResponseMixin=a}),98);
__d("WASmaxInMmsdEnums",[],(function(a,b,c,d,e,f){a={0:"0",1:"1"};b={400:"400",401:"401",404:"404",408:"408",409:"409",415:"415",426:"426",429:"429"};c={500:"500",501:"501",502:"502",503:"503",507:"507"};d={fallback:"fallback",primary:"primary"};e={"false":"false","true":"true"};var g={fna:"fna",pop:"pop"};f.ENUM_0_1=a;f.ENUM_400_401_404_408_409_415_426_429=b;f.ENUM_500_501_502_503_507=c;f.ENUM_FALLBACK_PRIMARY=d;f.ENUM_FALSE_TRUE=e;f.ENUM_FNA_POP=g}),66);
__d("WASmaxInMmsdRequestErrorMixin",["WAResultOrError","WASmaxInMmsdEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"text");if(!b.success)return b;var c=d("WASmaxParseUtils").attrStringEnum(a,"code",d("WASmaxInMmsdEnums").ENUM_400_401_404_408_409_415_426_429);if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"backoff",0,10800);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:c.value,backoff:a.value})}g.parseRequestErrorMixin=a}),98);
__d("WASmaxInMmsdResignCdnUrlResponseClientError",["WAResultOrError","WASmaxInMmsdIQErrorResponseMixin","WASmaxInMmsdRequestErrorMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;c=d("WASmaxInMmsdRequestErrorMixin").parseRequestErrorMixin(c.value);if(!c.success)return c;a=d("WASmaxInMmsdIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({errorRequestErrorMixin:c.value},a.value))}g.parseResignCdnUrlResponseClientError=a}),98);
__d("WASmaxInMmsdServerErrorMixin",["WAResultOrError","WASmaxInMmsdEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"text");if(!b.success)return b;var c=d("WASmaxParseUtils").attrStringEnum(a,"code",d("WASmaxInMmsdEnums").ENUM_500_501_502_503_507);if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"backoff",0,10800);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:c.value,backoff:a.value})}g.parseServerErrorMixin=a}),98);
__d("WASmaxInMmsdResignCdnUrlResponseServerError",["WAResultOrError","WASmaxInMmsdIQErrorResponseMixin","WASmaxInMmsdServerErrorMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;c=d("WASmaxInMmsdServerErrorMixin").parseServerErrorMixin(c.value);if(!c.success)return c;a=d("WASmaxInMmsdIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({errorServerErrorMixin:c.value},a.value))}g.parseResignCdnUrlResponseServerError=a}),98);
__d("WASmaxInMmsdIQResultResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQResultResponseMixin=a}),98);
__d("WASmaxInMmsdResignCdnUrlResponseSuccess",["WAResultOrError","WASmaxInMmsdIQResultResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"cdn_url_resign");if(!c.success)return c;c=d("WASmaxParseUtils").attrString(c.value,"direct_path");if(!c.success)return c;a=d("WASmaxInMmsdIQResultResponseMixin").parseIQResultResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({cdnUrlResignDirectPath:c.value},a.value))}g.parseResignCdnUrlResponseSuccess=a}),98);
__d("WASmaxOutMmsdBaseIQGetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("iq",{id:d("WAWap").generateId(),type:"get"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBaseIQGetRequestMixin=a}),98);
__d("WASmaxOutMmsdIQRequestCommonMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("iq",{xmlns:"w:m",to:d("WAWap").S_WHATSAPP_NET});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIQRequestCommonMixin=a}),98);
__d("WASmaxOutMmsdResignCdnUrlResignWithHandleParamsMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.cdnUrlResignHandle;a=d("WASmaxJsx").smax("cdn_url_resign",{handle:d("WAWap").CUSTOM_STRING(a),use_case_hint:"wa_stickers"});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeResignCdnUrlResignWithHandleParamsMixin=a}),98);
__d("WASmaxOutMmsdResignCdnUrlResignWithObjectIdAndFBIdParamsMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.cdnUrlResignFbid;a=a.cdnUrlResignObjectId;b=d("WASmaxJsx").smax("cdn_url_resign",{fbid:d("WAWap").CUSTOM_STRING(b),object_id:d("WAWap").CUSTOM_STRING(a),use_case_hint:"fb_encrypted_backup"});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeResignCdnUrlResignWithObjectIdAndFBIdParamsMixin=a}),98);
__d("WASmaxOutMmsdResignWithResignCdnUrlObjectIdAndFBIdOrResignCdnUrlHandleParamsMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMmsdResignCdnUrlResignWithHandleParamsMixin","WASmaxOutMmsdResignCdnUrlResignWithObjectIdAndFBIdParamsMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.resignCdnUrlResignWithObjectIdAndFBIdParams)return d("WASmaxOutMmsdResignCdnUrlResignWithObjectIdAndFBIdParamsMixin").mergeResignCdnUrlResignWithObjectIdAndFBIdParamsMixin(a,b.resignCdnUrlResignWithObjectIdAndFBIdParams);if(b.resignCdnUrlResignWithHandleParams)return d("WASmaxOutMmsdResignCdnUrlResignWithHandleParamsMixin").mergeResignCdnUrlResignWithHandleParamsMixin(a,b.resignCdnUrlResignWithHandleParams);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeResignWithResignCdnUrlObjectIdAndFBIdOrResignCdnUrlHandleParamsMixinGroup=a}),98);
__d("WASmaxOutMmsdResignCdnUrlResignParamsMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMmsdResignWithResignCdnUrlObjectIdAndFBIdOrResignCdnUrlHandleParamsMixinGroup"],(function(a,b,c,d,e,f,g){function h(a){a=a.resignWithResignCdnUrlObjectIdAndFBIdOrResignCdnUrlHandleParamsMixinGroupArgs;a=d("WASmaxOutMmsdResignWithResignCdnUrlObjectIdAndFBIdOrResignCdnUrlHandleParamsMixinGroup").mergeResignWithResignCdnUrlObjectIdAndFBIdOrResignCdnUrlHandleParamsMixinGroup(d("WASmaxJsx").smax("cdn_url_resign",null),a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeResignCdnUrlResignParamsMixin=a}),98);
__d("WASmaxOutMmsdResignCdnUrlRequest",["WASmaxJsx","WASmaxOutMmsdBaseIQGetRequestMixin","WASmaxOutMmsdIQRequestCommonMixin","WASmaxOutMmsdResignCdnUrlResignParamsMixin","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=a.cdnUrlResignSignDuration;a=a.resignCdnUrlResignParamsMixinArgs;b=d("WASmaxOutMmsdIQRequestCommonMixin").mergeIQRequestCommonMixin(d("WASmaxOutMmsdBaseIQGetRequestMixin").mergeBaseIQGetRequestMixin(d("WASmaxJsx").smax("iq",null,d("WASmaxOutMmsdResignCdnUrlResignParamsMixin").mergeResignCdnUrlResignParamsMixin(d("WASmaxJsx").smax("cdn_url_resign",{sign_duration:d("WAWap").INT(b)}),a))));return b}g.makeResignCdnUrlRequest=a}),98);
__d("WASmaxMmsdResignCdnUrlRPC",["WAComms","WASmaxInMmsdResignCdnUrlResponseClientError","WASmaxInMmsdResignCdnUrlResponseServerError","WASmaxInMmsdResignCdnUrlResponseSuccess","WASmaxOutMmsdResignCdnUrlRequest","WASmaxParsingFailure","WASmaxRpcUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:e=d("WASmaxOutMmsdResignCdnUrlRequest").makeResignCdnUrlRequest(a);j.next=3;return b("regeneratorRuntime").awrap(d("WAComms").sendSmaxStanza(e,c));case 3:f=j.sent;g=d("WASmaxInMmsdResignCdnUrlResponseSuccess").parseResignCdnUrlResponseSuccess(f,e);if(!g.success){j.next=7;break}return j.abrupt("return",{name:"ResignCdnUrlResponseSuccess",value:g.value});case 7:h=d("WASmaxInMmsdResignCdnUrlResponseClientError").parseResignCdnUrlResponseClientError(f,e);if(!h.success){j.next=10;break}return j.abrupt("return",{name:"ResignCdnUrlResponseClientError",value:h.value});case 10:i=d("WASmaxInMmsdResignCdnUrlResponseServerError").parseResignCdnUrlResponseServerError(f,e);if(!i.success){j.next=13;break}return j.abrupt("return",{name:"ResignCdnUrlResponseServerError",value:i.value});case 13:throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("ResignCdnUrl",{Success:g,ClientError:h,ServerError:i}));case 14:case"end":return j.stop()}},null,this)}g.sendResignCdnUrlRPC=a}),98);
__d("WAGetResignedCdnUrl",["WAAssertUnreachable","WAErrorMessage","WALogger","WAPromiseRetryLoop","WAResultOrError","WASmaxMmsdResignCdnUrlRPC","WASmaxParsingFailure"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["requestCdnResignedUrl - Unknown Error ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["requestCdnResignedUrl - Error thrown whilst parsing SMAX response - ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Direct path signature expired. objectId: ",", fbid: ","."]);j=function(){return a};return a}var k="507",l=259200;function a(a){var b=a.objectId;a=a.fbid;b=new(d("WAPromiseRetryLoop").PromiseRetryLoop)({name:"requestCdnResignedUrl",timer:{jitter:.25,max:987e3,algo:{type:"fibonacci",first:6e3,second:12e3},relativeDelay:!0},code:m({objectId:b,fbid:a})});b.start();return b.promise()}function m(a){var b=a.objectId,e=a.fbid;return function(a){d("WALogger").LOG(j(),b,e);return d("WASmaxMmsdResignCdnUrlRPC").sendResignCdnUrlRPC({cdnUrlResignSignDuration:l,resignCdnUrlResignParamsMixinArgs:{resignWithResignCdnUrlObjectIdAndFBIdOrResignCdnUrlHandleParamsMixinGroupArgs:{resignCdnUrlResignWithObjectIdAndFBIdParams:{cdnUrlResignFbid:e,cdnUrlResignObjectId:b}}}}).then(function(b){switch(b.name){case"ResignCdnUrlResponseSuccess":return a(d("WAResultOrError").makeResult({directPath:b.value.cdnUrlResignDirectPath}));case"ResignCdnUrlResponseClientError":return a(d("WAResultOrError").makeError({type:"client-error",text:b.value.errorRequestErrorMixin.text}));case"ResignCdnUrlResponseServerError":if(b.value.errorServerErrorMixin.code!==k)return;return a(d("WAResultOrError").makeError({type:"server-error",text:b.value.errorServerErrorMixin.text,backoff:b.value.errorServerErrorMixin.backoff}));default:throw c("WAAssertUnreachable")(b.name)}})["catch"](function(b){var c=d("WAErrorMessage").maybeGetMessageFromError(b);if(b instanceof d("WASmaxParsingFailure").SmaxParsingFailure){d("WALogger").ERROR(i(),c);return a(d("WAResultOrError").makeError({type:"smax-parsing-error"}))}else{d("WALogger").ERROR(h(),c);return}})}}g.getCdnResignedUrl=a}),98);
__d("WAMediaQplHelper",[],(function(a,b,c,d,e,f){"use strict";function a(a){if(a==null||a<0||a>100*1024*1024)return"invalid_size";else if(a<=1*1024)return"size lower than 1 KB";else if(a<=100*1024)return"size between 1 KB and 100 KB";else if(a<=1*1024*1024)return"size between 100 KB and 1 MB";else if(a<=10*1024*1024)return"size between 1 and 10 MB";else if(a<=50*1024*1024)return"size between 10 and 50 MB";else return"size above 50 MB"}f.convertIntegerSizeToStringBucket=a}),66);
__d("WAHttpDownloadMedia",["WAErrorMessage","WALogger","WAMediaQplHelper","WAResultOrError","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Download Media Error: can not resume from offset"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["HttpDownloadMedia: fail to parse request body: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["HttpDownloadMedia: fail to parse request body ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Fetch Media HTTP status ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["HttpDownloadMedia: fail to initiate fetch: ",", message: ",""]);l=function(){return a};return a}var m="URL signature expired";function a(a,c){var e,f,g,n,o;return b("regeneratorRuntime").async(function(p){while(1)switch(p.prev=p.next){case 0:p.prev=0;p.next=3;return b("regeneratorRuntime").awrap(fetch(a,{method:"GET",mode:"cors",cache:"no-store"}));case 3:e=p.sent;p.next=12;break;case 6:p.prev=6;p.t0=p["catch"](0);f=d("WAErrorMessage").maybeGetMessageFromError(p.t0);d("WALogger").WARN(l(),p.t0,f);c==null?void 0:c.addAnnotations({bool:{threwFetchError:!0}});throw p.t0;case 12:g=e.headers.get("content-length");n=e,o=n.status;d("WALogger").LOG(k(),o);c==null?void 0:c.addAnnotations({string:{ciphertextMediaSizeBucket:g!=null?d("WAMediaQplHelper").convertIntegerSizeToStringBucket(Number(g)):null},"int":{httpStatus:o}});p.t1=o;p.next=p.t1===200?19:p.t1===206?19:p.t1===401?20:p.t1===403?21:p.t1===404?22:p.t1===410?22:p.t1===408?23:p.t1===416?24:p.t1===429?26:p.t1===507?26:27;break;case 19:return p.abrupt("return",e.arrayBuffer().then(function(a){return d("WAResultOrError").makeResult(a)})["catch"](function(a){c==null?void 0:c.addPoint("response_array_buffer_error");d("WALogger").ERROR(j(),a);return d("WAResultOrError").makeError("body-network-error")}));case 20:return p.abrupt("return",d("WAResultOrError").makeError("access-expired"));case 21:return p.abrupt("return",e.text().then(function(a){return a===m?d("WAResultOrError").makeError("signature-expired"):d("WAResultOrError").makeError("access-expired")})["catch"](function(a){d("WALogger").ERROR(i(),a);return d("WAResultOrError").makeError("access-expired")}));case 22:return p.abrupt("return",d("WAResultOrError").makeError("media-not-found"));case 23:return p.abrupt("return",d("WAResultOrError").makeError("server-timeout"));case 24:d("WALogger").ERROR(h());return p.abrupt("return",d("WAResultOrError").makeError("request-error"));case 26:return p.abrupt("return",d("WAResultOrError").makeError("download-throttled"));case 27:if(!(o>=400&&o<500)){p.next=29;break}return p.abrupt("return",d("WAResultOrError").makeError("request-error"));case 29:return p.abrupt("return",d("WAResultOrError").makeError("unspecified-http-error"));case 30:case"end":return p.stop()}},null,this,[[0,6]])}g.httpDownloadMedia=a}),98);
__d("WAMediaOperationsRetrier",["WALogger","WAPromiseBackoffs","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["MediaOperationsRetrier:"," wait for internet, attempt = ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Running retrier"]);i=function(){return a};return a}var j=4,k={algo:{type:"constant",delay:1e3},jitter:0};a=function(){function a(a,b,c){this.$1=a,this.routesInfo=b,this.$2=d("WAPromiseBackoffs").createPromiseTimer(k),this.$3=0,this.$4=!1,this.$5=c}var c=a.prototype;c.run=function(a,c){var e,f,g,k;return b("regeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:if(!(this.$3<j)){l.next=29;break}d("WALogger").DEV(i());l.next=4;return b("regeneratorRuntime").awrap(this.$2());case 4:e=void 0;if(!(this.$3>0)){l.next=12;break}e=this.$3>=j-2&&!this.$4;d("WALogger").LOG(h(),this.$1,this.$3);l.next=10;return b("regeneratorRuntime").awrap(this.$5==null?void 0:this.$5());case 10:l.next=13;break;case 12:e=!1;case 13:f=this.routesInfo;if(f){l.next=16;break}return l.abrupt("return",null);case 16:g=f.host;e&&f.fallbackHost&&(g=f.fallbackHost);l.next=20;return b("regeneratorRuntime").awrap(a(g,f.authToken,this.$3,c));case 20:k=l.sent;if(!k.success){l.next=25;break}return l.abrupt("return",k.value);case 25:++this.$3,this.$4=k.error.progressMade;case 27:l.next=0;break;case 29:return l.abrupt("return",null);case 30:case"end":return l.stop()}},null,this)};return a}();g.MAX_ATTEMPTS=j;g.BACKOFF_OPTIONS=k;g.MediaOperationsRetrier=a}),98);
__d("WAHttpUtils",["WAErr"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,d){if(!/^https:\/\/[-\w.]+\.\w+$/.test(a))throw c("WAErr")('buildUrl given invalid host "'+a+'"');if(!b.startsWith("/"))throw c("WAErr")('buildUrl given invalid path "'+b+'"');var e=d;d=""+a+b;if(!e)return d;a=Object.keys(e).map(function(a){var b=e[a];b instanceof ArrayBuffer&&(b=new Uint8Array(b));b=b instanceof Uint8Array?Array.prototype.slice.call(b).map(function(a){return"%"+a.toString(16)}).join(""):encodeURIComponent(b.toString());return encodeURIComponent(a)+"="+b});if(a.length>0){b=a.join("&");return d.includes("?")?d+"&"+b:d+"?"+b}else return d}g.buildUrl=a}),98);
__d("WAMediaUrl",["WABase64","WAGlobals","WAHttpUtils"],(function(a,b,c,d,e,f,g){"use strict";var h=1;function a(a,b,c,e,f,g,i){var j=d("WAGlobals").getConfig().mediaUploadRoot();c=d("WABase64").encodeB64UrlSafe(c);b=d("WABase64").encodeB64UrlSafe(b);f={auth:f,token:b};g&&(f.resume=h);i!=null&&i>0&&(f.bytestart=i);return d("WAHttpUtils").buildUrl("https://"+e,j+"/"+a+"/"+c,f)}function b(a,b,c,e,f,g,h){b=d("WABase64").encodeB64UrlSafe(b);b={hash:b,mode:e};f!=null&&(b._nc_cat=f);g!=null&&g>=0&&(b.bytestart=g);h!=null&&h>0&&(b.byteend=h);return d("WAHttpUtils").buildUrl("https://"+c,a,b)}g.RESUME_PARAM=h;g.buildUploadUrl=a;g.buildDownloadUrl=b}),98);
__d("WADownloadCiphertext",["WAAssertUnreachable","WABase64","WAComms","WACryptoSha256","WACryptoUtils","WAGetMediaRoute","WAGetResignedCdnUrl","WAGlobals","WAHttpDownloadMedia","WALogger","WAMediaOperationsRetrier","WAMediaUrl","WAPromiseDelays","WAPromiseManagement","WAResultOrError","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Download Plaintext failed: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["downloadMedia given up"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["downloadCiphertext http download exception: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["result to generate a new cdn url was throttled (507)"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Cannot generate a new cdn url: missing objectId or fbid"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Download Media Error: ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Downloading ciphertext for hash: ",""]);n=function(){return a};return a}function a(a){var e,f,g,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G;return b("regeneratorRuntime").async(function(H){while(1)switch(H.prev=H.next){case 0:e=a.mediaTypeDetails,f=a.fileEncSha256,g=a.directPath,p=a.plaintextHash,q=a.objectId,r=a.fbid,s=a.pathRedirected,t=a.eventFlow,u=a.fromBytes,v=a.toBytes;d("WALogger").LOG(n(),p);w=e.type==="regular"?e.mediaType:"preview";t==null?void 0:t.addPoint("get_media_route_start");H.next=6;return b("regeneratorRuntime").awrap(d("WAGetMediaRoute").getMediaRoute({operation:"download",serverMediaType:w,fileEncSha256:f,directPath:g},t));case 6:x=H.sent;t==null?void 0:t.addPoint("get_media_route_finish");if(x.success){H.next=10;break}return H.abrupt("return",x);case 10:y=x.value,z=y.selectedHost,A=y.fallbackHost,B=y.authToken,C=y.bucket;D=new(d("WAMediaOperationsRetrier").MediaOperationsRetrier)("download",{host:{domain:z.domain,"class":z["class"]},fallbackHost:A&&{domain:A.domain,"class":A["class"]},authToken:B,timeElapsed:null},d("WAGlobals").getConfig().isMediaWaitForConnectionOnRetryEnabled()===!0?d("WAComms").waitForConnection:void 0);H.next=14;return b("regeneratorRuntime").awrap(D.run(function(a){a=a.domain;a=d("WAMediaUrl").buildDownloadUrl(g,f,a,"manual",C,u,v);return d("WAHttpDownloadMedia").httpDownloadMedia(a,t).then(function(c){var a,e,f,g,h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:if(!c.success){i.next=4;break}return i.abrupt("return",d("WAResultOrError").makeResult(c));case 4:a=c.error;d("WALogger").LOG(m(),a);i.t0=a;i.next=i.t0==="signature-expired"?9:i.t0==="server-timeout"?37:i.t0==="unspecified-http-error"?37:38;break;case 9:if(!(q==null||r==null)){i.next=12;break}d("WALogger").LOG(l());return i.abrupt("return",d("WAResultOrError").makeResult(d("WAResultOrError").makeError("signature-expired-and-resign-failed-no-ids")));case 12:i.next=14;return b("regeneratorRuntime").awrap(d("WAGetResignedCdnUrl").getCdnResignedUrl({objectId:q,fbid:r}));case 14:e=i.sent;if(e.success){i.next=30;break}t==null?void 0:t.addPoint("resign_cdn_url_fail",{string:{resignCdnErrorType:e.error.type,resignCdnError:e.error.text}});f=d("WAResultOrError").makeResult(d("WAResultOrError").makeError("signature-expired-and-resign-failed-cdn-url"));i.t1=e.error.type;i.next=i.t1==="client-error"?21:i.t1==="server-error"?22:28;break;case 21:return i.abrupt("return",f);case 22:if(!(e.error.backoff!=null)){i.next=27;break}g=e.error.backoff;t==null?void 0:t.addPoint("resign_cdn_url_backoff");d("WALogger").LOG(k());return i.abrupt("return",d("WAPromiseDelays").delayMs(g).then(function(){return d("WAResultOrError").makeResult(d("WAResultOrError").makeError("signature-expired"))}));case 27:return i.abrupt("return",f);case 28:e.error.type;return i.abrupt("return",f);case 30:e.success;t==null?void 0:t.addPoint("resign_cdn_url_success");h=e.value.directPath;if(!(s!=null)){i.next=36;break}i.next=36;return b("regeneratorRuntime").awrap(s(h));case 36:return i.abrupt("return",d("WAResultOrError").makeResult(d("WAResultOrError").makeError("signature-expired")));case 37:return i.abrupt("return",d("WAResultOrError").makeError({progressMade:!0}));case 38:return i.abrupt("return",d("WAResultOrError").makeResult(d("WAResultOrError").makeError(a)));case 39:case"end":return i.stop()}},null,this)})["catch"](function(a){d("WALogger").WARN(j(),a);return d("WAResultOrError").makeError({progressMade:!1})})}));case 14:E=H.sent;if(!(E==null)){H.next=18;break}d("WALogger").WARN(i());return H.abrupt("return",d("WAResultOrError").makeError("max-attempts-exceeded"));case 18:if(!(E.success===!1)){H.next=31;break}F=E.error;d("WALogger").WARN(h(),F);H.t0=F;H.next=H.t0==="signature-expired"?24:H.t0==="signature-expired-and-resign-failed-cdn-url"?24:H.t0==="signature-expired-and-resign-failed-no-ids"?24:H.t0==="media-not-found"?24:H.t0==="download-throttled"?24:H.t0==="request-error"?24:H.t0==="access-expired"?25:H.t0==="body-network-error"?26:27;break;case 24:return H.abrupt("return",d("WAResultOrError").makeError(F));case 25:return H.abrupt("return",d("WAResultOrError").makeError("disconnected"));case 26:return H.abrupt("return",d("WAResultOrError").makeError("request-error"));case 27:F;throw c("WAAssertUnreachable")(F);case 29:H.next=44;break;case 31:G=E.value;H.t1=!o(u,v);if(!H.t1){H.next=40;break}H.t2=d("WACryptoUtils").arrayBuffersEqual;H.next=37;return b("regeneratorRuntime").awrap(d("WACryptoSha256").sha256(G));case 37:H.t3=H.sent,H.t4=f,H.t1=!H.t2(H.t3,H.t4);case 40:if(!H.t1){H.next=42;break}return H.abrupt("return",d("WAResultOrError").makeError("ciphertext-hash-mismatch"));case 42:t==null?void 0:t.addPoint("download_finish",{"int":{byteLength:G.byteLength},bool:{isPartialDownload:o(u,v)}});return H.abrupt("return",d("WAResultOrError").makeResult(G));case 44:case"end":return H.stop()}},null,this)}e=d("WAPromiseManagement").cacheWhilePending(function(a){var b=a.fileEncSha256,c=a.fromBytes;a=a.toBytes;return d("WABase64").encodeB64UrlSafe(b)+"-"+((b=c)!=null?b:"X")+"-"+((c=a)!=null?c:"X")},a);function o(a,b){return a!=null&&a>0?!0:b!=null}g.cachedDownloadCiphertext=e}),98);
__d("WADownloadAndDecryptMedia",["WADecryptMedia","WADownloadCiphertext","WAResultOrError","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var c,e,f,g,h,i,j,k,l,m,n;return b("regeneratorRuntime").async(function(o){while(1)switch(o.prev=o.next){case 0:c=a.mediaTypeDetails,e=a.fileEncSha256,f=a.directPath,g=a.mediaKey,h=a.plaintextHash,i=a.objectId,j=a.fbid,k=a.pathRedirected,l=a.eventFlow;o.next=3;return b("regeneratorRuntime").awrap(d("WADownloadCiphertext").cachedDownloadCiphertext({mediaTypeDetails:c,fileEncSha256:e,directPath:f,objectId:i,fbid:j,pathRedirected:k,eventFlow:l,plaintextHash:h}));case 3:m=o.sent;if(!(m.success!==!0)){o.next=6;break}return o.abrupt("return",m);case 6:o.next=8;return b("regeneratorRuntime").awrap(d("WADecryptMedia").decryptMedia({mediaKey:g,mediaTypeDetails:c,plaintextHash:h,ciphertextHmac:m.value}));case 8:n=o.sent;if(!(n.success!==!0)){o.next=11;break}return o.abrupt("return",n);case 11:n.value.alternativeHmacSaltUsed!=null&&(l==null?void 0:l.addAnnotations({string:{alternativeHmacSaltUsed:n.value.alternativeHmacSaltUsed}}));return o.abrupt("return",d("WAResultOrError").makeResult(n.value.plaintext));case 13:case"end":return o.stop()}},null,this)}g.downloadAndDecryptMedia=a}),98);
__d("WAParseWav",["WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=new DataView(a);if(b.getUint32(0)!==1380533830||b.getUint32(8)!==1463899717)return d("WAResultOrError").makeError("invalid-wav");if(a.byteLength<44)return d("WAResultOrError").makeError("invalid-wav");a=b.getUint16(22,!0);b=b.getUint32(24,!0);return d("WAResultOrError").makeResult({numChannels:a,sampleRate:b})}g.parseWav=a}),98);
__d("MAWDownloadMedia",["MAWDownloadDownloadablePreview","MAWDownloadProgressiveJpegPreview","MAWGetMediaPlaintextApi","MAWGlobals","MAWLoggerUtils","MAWUpdateMediaEntryForMsgApi","Promise","WADownloadAndDecryptMedia","WAErrorMessage","WAJids","WAMediaCrypto","WAMediaQplHelper","WAMediaUtils","WAParseWav","WAProgressiveJpegGetPJpegDetails","WAResultOrError","WATagsLogger","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["ptt is not wav format"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["downloadMedia: enc-hash-mismatch"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["downloadMedia: enc-hash-mismatch. chatType: ",", mediaTypeDetailsType: ",", mediaTypeDetailsValue: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["media already exists in db, skipping download"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["mediaPreviewPromise state: ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["media: mediaPreview - unsupported preview media type "," - ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["mediaEntry is incomplete"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose([""," is not downloaded"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media due to runtime-error: ",""]);q=function(){return a};return a}var r=d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.MediaDownload,d("MAWLoggerUtils").Tag.MessageReceive]),s=function(a,c,e,f){return t(a,c,e,f)["catch"](function(a){a=d("WAErrorMessage").maybeGetMessageFromError(a);r.ERROR(q(),a);return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeError("runtime-error"))})},t=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){var f,g=c.directPath,h=c.fbid,i=c.fileEncSha256,j=c.fileSha256,k=c.mediaKey,l=c.objectId,q=c.serverMediaType;e==null?void 0:e.addPoint("downloading_media",{string:{mediaType:q}});if(g==null||i==null||j==null||k==null||q==null){r.WARN(p(),c);r.ERROR(o());return d("WAResultOrError").makeError("media-entry-invalid")}if((c==null?void 0:(f=c.downloadableThumbnail)==null?void 0:f.directPath)!=null){e==null?void 0:e.addAnnotations({bool:{duplicateDirectPath:(c==null?void 0:(f=c.downloadableThumbnail)==null?void 0:f.directPath)===g,hasDownloadableThumbnail:!0}})}f=d("WAProgressiveJpegGetPJpegDetails").maybeGetProgressiveJpegDetailsUsingMediaEntry(c);e==null?void 0:e.addAnnotations({bool:{isProgressiveJpeg:f!=null}});f=w({hash:b,mediaEntry:c,progressiveJpegDetails:f,protocolMsgId:a,serverMediaType:q});void f.then(function(c){if(c!=null){var e;try{e=d("WAMediaCrypto").convertServerMediaTypeToPreviewMediaType(q)}catch(a){r.ERROR(n(),q,a);return}return d("MAWGlobals").getDbImpls().handleMediaPreviewDownload(b,c,e,a)}});g=(yield u(a,b,e,{mediaType:q,type:"regular"},g,i,j,k,l,h,c));i=(yield x(f));r.LOG(m(),i);(c==null?void 0:(j=c.downloadableThumbnail)==null?void 0:j.directPath)!=null&&(e==null?void 0:e.addAnnotations({string:{mediaPreviewPromiseState:i}}));return g.success?d("WAResultOrError").makeResult({mimeType:d("WAMediaUtils").getMimeTypeFromServerMediaType(q),plaintext:g.value}):g});return function(b,c,d,e){return a.apply(this,arguments)}}();function u(a,b,c,d,e,f,g,h,i,j,k){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,h,m,n,o,p,q,t){var u=d("WAMediaUtils").toPlaintextHash(n);if(c("gkx")("33150")){n=(yield d("MAWGetMediaPlaintextApi").getMediaPlaintext(u));if(n!=null){r.LOG(l());f==null?void 0:f.addAnnotations({bool:{downloadSkipped:!0}});n=(yield d("WAMediaUtils").blobToArrayBuffer(n));return d("WAResultOrError").makeResult(n)}}f==null?void 0:f.addAnnotations({bool:{downloadSkipped:!1}});n=(yield d("WADownloadAndDecryptMedia").downloadAndDecryptMedia({directPath:h,eventFlow:f,fbid:q,fileEncSha256:m,mediaKey:o,mediaTypeDetails:g,objectId:p,pathRedirected:function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var c=function(){return d("WAMediaUtils").encodeMediaEntryWithUpdatedPath(t,b)};yield d("MAWUpdateMediaEntryForMsgApi").updateMediaEntryForMsg(u,a,c,p,t.serverMediaType)});function e(a){return c.apply(this,arguments)}return e}(),plaintextHash:u}));if(n.success===!1){h=n.error;switch(h){case"signature-expired":return c("gkx")("378")&&g.type==="preview"?d("WAResultOrError").makeError(h):s(a,e,t,f).then(function(a){return a.success?d("WAResultOrError").makeResult(a.value.plaintext):a});case"signature-expired-and-resign-failed-cdn-url":case"signature-expired-and-resign-failed-no-ids":case"media-not-found":return d("WAResultOrError").makeError(h);case"enc-hash-mismatch":q=d("WAJids").switchOnMsgrChatJidType(a.chat,{group:function(a){return"group"},user:function(a){return"user"}});r.WARN(k(),q,g.type,g.type==="regular"?g.mediaType:g.messageType);r.ERROR(j());return d("WAResultOrError").makeError(h);default:h;return d("WAResultOrError").makeError(h)}}else{m=n.value;if(g.type==="regular"&&g.mediaType==="ptt"){o=d("WAParseWav").parseWav(m);!o.success?r.DEV(i()):f==null?void 0:f.addAnnotations({"int":{pttNumChannels:o.value.numChannels,pttSampleRate:o.value.sampleRate}})}f==null?void 0:f.addPoint("download_media_success",{string:{media_size:d("WAMediaQplHelper").convertIntegerSizeToStringBucket(m.byteLength)}});return d("WAResultOrError").makeResult(m)}});return v.apply(this,arguments)}function w(a){var b=a.hash,c=a.mediaEntry,e=a.progressiveJpegDetails,f=a.protocolMsgId,g=a.serverMediaType;return e==null||!d("MAWGlobals").getConfig().isProgressiveJpegSendReceiveEnabled()?d("MAWDownloadDownloadablePreview").maybeDownloadDownloadablePreview(f,b,g,c):d("MAWDownloadProgressiveJpegPreview").maybeDownloadProgressiveJpegPreview(f,b,g,c,e).then(function(a){return a.success!==!0?d("MAWDownloadDownloadablePreview").maybeDownloadDownloadablePreview(f,b,g,c):a.value})}function x(a){var c={};return(h||(h=b("Promise"))).race([a,c]).then(function(a){return a===c?"pending":"fulfilled"},function(){return"rejected"})}g.mediaDownloadLogger=r;g.downloadMedia=s;g.downloadMediaImpl=u}),98);
__d("WADownloadProgressiveJpegPlaintext",["WABinary","WADownloadCiphertext","WAMediaCrypto","WAProgressiveJpegAlignScanLengths","WAProgressiveJpegGetPJpegDetails","WAResultOrError","WATagsLogger","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Partial Download Plaintext Success"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Download Plaintext Error ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Using progressiveJpeg decryptAndVerify"]);j=function(){return a};return a}var k=d("WATagsLogger").TAGS(["DownloadProgressiveJpeg"]);function a(a){var c,e,f,g,h,i,j,k,m,n,o,p,q,r;return b("regeneratorRuntime").async(function(s){while(1)switch(s.prev=s.next){case 0:c=a.mediaTypeDetails,e=a.fileEncSha256,f=a.directPath,g=a.mediaKey,h=a.eventFlow,i=a.pathRedirected,j=a.pjpegDetails,k=a.targetScan,m=a.plaintextHash;n=d("WAProgressiveJpegAlignScanLengths").progressiveJpegAlignChunkLengthsToMultipleOfAesBlockSize(j.scanLengths);o=babelHelpers["extends"]({},j,{alignedScanLengths:n});p=l(g,c,k,o);q=d("WAProgressiveJpegGetPJpegDetails").getTotalByteSizeForScan(n,k);s.next=7;return b("regeneratorRuntime").awrap(d("WADownloadCiphertext").cachedDownloadCiphertext({mediaTypeDetails:c,fileEncSha256:e,directPath:f,pathRedirected:i,fromBytes:0,toBytes:q-1,eventFlow:h,plaintextHash:m}));case 7:r=s.sent;if(!(r.success!==!0)){s.next=10;break}return s.abrupt("return",r);case 10:return s.abrupt("return",p(r.value));case 11:case"end":return s.stop()}},null,this)}function l(a,c,e,f){return function(g,l){var n,o,p;return b("regeneratorRuntime").async(function(q){while(1)switch(q.prev=q.next){case 0:k.LOG(j());n=new Uint8Array(g);c.type==="preview"?l=d("WAMediaCrypto").computeMediaKeysForPreview(a):l=d("WAMediaCrypto").computeMediaKeys(a,c.mediaType);q.next=5;return b("regeneratorRuntime").awrap(l.then(function(a){var b=a.iv,c=a.cipherKey;a=a.hmacKey;return d("WAMediaCrypto").decryptPartialChunks(c,b,n,a,e,f)}).then(d("WAResultOrError").makeResult)["catch"](function(a){k.ERROR(i(),a);if(a instanceof d("WAMediaCrypto").HmacValidationError)return d("WAResultOrError").makeError("enc-hash-mismatch");else return d("WAResultOrError").makeError("decryption-error")}));case 5:o=q.sent;if(o.success){q.next=8;break}return q.abrupt("return",o);case 8:k.LOG(h());p=m(o.value.plaintext);return q.abrupt("return",d("WAResultOrError").makeResult(p));case 11:case"end":return q.stop()}},null,this)}}function m(a){a=new(d("WABinary").Binary)(a);a.writeBytes(255,217);return a.readBuffer()}g.downloadProgressiveJpegPlaintext=a}),98);
__d("MAWDownloadProgressiveJpegPreview",["MAWDownloadMedia","MAWExternalId","MAWHandleMediaPreviewBeforeDownloadApi","MAWLoggerUtils","WADownloadProgressiveJpegPlaintext","WAGlobals","WAJids","WAPREList","WAPREMetrics","WAResultOrError","WebStorageEstimator","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Finished progressiveJpeg preview download"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Starting progressiveJpeg preview download"]);i=function(){return a};return a}var j=d("MAWDownloadMedia").mediaDownloadLogger.TAGS([d("MAWLoggerUtils").Tag.MediaPreview]),k=3;function a(a,b,c,d,e){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f){var g=e.directPath,l=e.fileEncSha256,m=e.mediaKey;if(g==null||l==null||m==null)return d("WAResultOrError").makeError("pjpeg-failed");yield d("MAWHandleMediaPreviewBeforeDownloadApi").handleMediaPreviewBeforeDownload(b);var n=d("WAJids").switchOnMsgrChatJidType(a.chat,{group:function(){return"group"},user:function(){return"user"}}),o=(yield d("WebStorageEstimator").estimateStorage());o=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.MEDIA_DOWNLOAD,{bool:{isMediaFallbackToAlternativeHmacSaltsEnabled:d("WAGlobals").getConfig().isMediaFallbackToAlternativeHmacSaltsEnabled(),isPreview:!0,isProgressiveJpeg:!0},"int":{storageQuota:(o==null?void 0:o.quota)||0,storageUsage:(o==null?void 0:o.usage)||0},string:{chat_type:n,downloadEntry:"progressiveJpeg-preview",e2eePlatform:d("MAWExternalId").getPlatform(a.externalId),jid:a.chat,mediaType:e.serverMediaType}},void 0);j.LOG(i());n=(yield d("WADownloadProgressiveJpegPlaintext").downloadProgressiveJpegPlaintext({directPath:g,eventFlow:o,fileEncSha256:l,mediaKey:m,mediaTypeDetails:{mediaType:c,type:"regular"},pjpegDetails:f,plaintextHash:b,targetScan:k}));if(!n.success){o.endFail(n.error);return d("WAResultOrError").makeError("pjpeg-failed")}a=n.value;j.LOG(h());o.endSuccess();return d("WAResultOrError").makeResult(a)});return l.apply(this,arguments)}g.maybeDownloadProgressiveJpegPreview=a}),98);
__d("MAWDownloadManager",[],(function(a,b,c,d,e,f){"use strict";var g=1e4;a=function(){function a(){this.$1=[],this.$2=new Map()}var b=a.prototype;b.setToDownloadManager=function(a,b){this.$3(),this.$2.set(a,b),this.$1.push(a)};b.getFromDownloadManager=function(a){return this.$2.get(a)};b.removeFromMediaDownloadManager=function(a){this.$2["delete"](a);var b=this.$1.filter(function(b){return b!==a});this.setDownloadManagerQueue(b)};b.setDownloadManagerQueue=function(a){this.$1=a};b.$3=function(){if(this.$1.length>=g){var a=this.$1.shift();this.$2["delete"](a)}};return a}();f.DownloadManager=a}),66);
__d("MAWMediaDownloadManager",["MAWDownloadManager"],(function(a,b,c,d,e,f,g){"use strict";var h=new(d("MAWDownloadManager").DownloadManager)();function a(a,b){h.setToDownloadManager(a,b)}function b(a){return h.getFromDownloadManager(a)}function c(a){h.removeFromMediaDownloadManager(a)}g.setToMediaDownloadManager=a;g.getFromMediaDownloadManager=b;g.removeFromMediaDownloadManager=c}),98);
__d("MAWHandleMediaDownloadApi",["MAWBridgeTypesCreators","MAWDbChunkTxns","MAWDbMediaTxns","MAWDbMsg","MAWDbMsgTxns","MAWDexieTable","MAWIndexedDb","MAWLoggerUtils","MAWMediaDownloadManager","MAWMediaUtils","MAWMsgType","MAWTransactionMode","Promise","WAArmadilloXMA.pb","WAResultOrError","WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Media is null when storing downloaded blob"]);i=function(){return a};return a}var j=d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.MediaDownload,d("MAWLoggerUtils").Tag.MessageReceive]);c=d("MAWIndexedDb").makeMsgrTransactor({chunk:(a=d("MAWTransactionMode")).READWRITE,media:a.READWRITE,messages:a.READONLY,threads:a.READONLY,xma:a.READONLY},"handleMediaDownload",function(a){return function(c,e,f,g){var l=d("MAWMediaUtils").genHMACPlaintextHash(c);return d("MAWDexieTable").dexieAll([d("MAWDbMsgTxns").maybeGetMsgByProtocolMsgId(a,g),a.media.where("hashedPlaintextHash").equals(l).first(),d("MAWDbChunkTxns").getOrCreateMediaChunk(a,c,f,e)]).then(function(c){var g=c[0],l=c[1];c[2];if(l==null){j.ERROR(i());return d("WAResultOrError").makeError("missing-media-on-save")}c=d("MAWMediaDownloadManager").getFromMediaDownloadManager(l.mediaId);c!=null&&(c((h||(h=b("Promise"))).resolve(new Blob([f],{type:e}))),d("MAWMediaDownloadManager").removeFromMediaDownloadManager(l.mediaId));if(!k(g)){c=l.msgIds.map(d("MAWDbMsg").getThreadIdFromMsgId);return a.threads.bulkGet(c).then(function(a){a.forEach(function(a){a!=null&&d("MAWIndexedDb").afterTransaction({tag:"NewMedia",value:d("MAWBridgeTypesCreators").createBridgeMedia(a.chatId,a.jid,l,!0,g==null?void 0:g.sortOrderMs)})});return d("WAResultOrError").makeResult()})}return d("MAWDbMediaTxns").updateMedia(a,l,{size:f.byteLength}).then(function(){return d("WAResultOrError").makeResult()})})}});function k(a){return a&&(a.type===d("MAWMsgType").MSG_TYPE.XMA||((a=a.quote)==null?void 0:a.content.xmaMessageType)===d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_REPLY)}g.handleMediaDownload=c}),98);
__d("MAWMediaRetryInfo",[],(function(a,b,c,d,e,f){"use strict";var g=new Map();function a(a,b){g.set(a,b)}function b(a){return g.get(a)}function c(a){g.has(a)&&g["delete"](a)}f.setRetriedMediaInfo=a;f.getRetriedMediaInfo=b;f.clearRetriedMediaInfo=c}),66);
__d("MAWHandleEchoMediaMsgsRestoreV2",["EchoMessage","EchoMessageMediaFieldUtils","LSDataTraceCheckPoint","LSDataTraceType","LSIntEnum","MAWAsConsumerApplication","MAWBridge","MAWBridgeTypesCreators","MAWCastToMsgrServerMediaType","MAWDbChunkTxns","MAWDbMediaTxns","MAWDownloadMedia","MAWEBBackendQPLUtils","MAWFrontendMediaUtils","MAWGlobals","MAWHandleMediaDownloadApi","MAWIndexedDb","MAWJids","MAWMediaManagementTxns","MAWMediaRetryInfo","MAWMediaUtils","MAWQplProxy","MAWSupportedDocumentTypes","MAWTraceUtils","MAWTransactionMode","Promise","WABase64","WAHashStringToNumber","WAJids","WALogger","WAMediaUtils","WAPREList","WAPREMetrics","WATagsLogger","WATimeUtils","WebStorageEstimator","asyncToGeneratorRuntime","gkx","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Cannot find the media entry for message with mediaKey ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Cannot find the media entry for message with mediaKey ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] media for message: "," is already downloaded on the device"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Unable to construct downloadableThumbnail from previewMediaData: ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Encrypted hash cannot be null for non-XMA attachments"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Cannot download media - document extension is disallowed"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Cannot download media - media content type null"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] media entry is missing from index db. It is required to retry download by resigning cdn url"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["isPointRestore: ",""]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] media download failed with error: "," "," when downloading. Message timestamp: ",""]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Retry download media as signature has expired and should be renewed"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] media download complete"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] downloading media from MI directly"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] start media download from whatsapp infra"]);w=function(){return a};return a}function x(){var a=babelHelpers.taggedTemplateLiteralLoose(["Encrypted hash is null - unable to download thumbnail"]);x=function(){return a};return a}var y="media_restore";function z(a){var c=D(a);return c.then(function(c){var d=new Map();a.forEach(function(a){var b=c.get(a);b=b==null?void 0:b.blobData;d.set(a,b)});return(i||(i=b("Promise"))).resolve(d)})}function A(a){switch(a){case d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.IMAGE_JPEG:return"image/jpeg";case d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.IMAGE_PNG:return"image/png";case d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.STICKER:return"image/webp";case d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.GIF:return"image/gif";case d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.AUDIO_MP4:return"audio/mp4";case d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.AUDIO_WAV:return"audio/wav";case d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.XMA:return"xma"}}function a(a,b,c,d){return B.apply(this,arguments)}function B(){B=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g){if(a.length===0)return(i||(i=b("Promise"))).resolve();var q=[],r=[],s=new Map(),t=new Map();a.map(function(a){var c=a.mediaData,e=a.messageTimestamp,f=E(c.plaintextHash),g=c.attachmentObjectId,h=c.attachmentType,j=c.backupEntFbid,k=c.directPath,l=c.filename,u=c.height,v=c.mediaContentType,w=c.mediaKeyTimestamp,x=c.mediaPlayableDuration,y=c.previewContentHeight,z=c.previewContentType,B=c.previewContentWidth,C=c.size;c=c.width;var D=d("WAMediaUtils").stringToPlaintextHash(f),I=d("MAWMediaUtils").genHMACPlaintextHash(D);r.push(I);v=v!=null?d("MAWFrontendMediaUtils").getMediaTypeAndServerMediaTypeFromBlob(v,a.isXMA):z!=null?d("MAWFrontendMediaUtils").getMediaTypeAndServerMediaTypeFromBlob(A(z)):null;if(v==null){d("WALogger").ERROR(p());return(i||(i=b("Promise"))).resolve()}if(h===d("EchoMessageMediaFieldUtils").AttachmentType.DOCUMENT&&!d("MAWSupportedDocumentTypes").isAllowedType(l)){d("WALogger").ERROR(o());return(i||(i=b("Promise"))).resolve()}z=a.mediaData.encryptedHash;if(z==null&&!a.isXMA){d("WALogger").ERROR(n());return(i||(i=b("Promise"))).resolve()}h=v.mediaType;v=v.serverMediaType;g=d("WAMediaUtils").stringToDeliveryObjectId(g);j=j!=null?d("WAMediaUtils").stringToBackupEntFbid(j):void 0;var J=a.threadJId,K=F({filename:l,height:u,mediaPlayableDuration:x,mediaType:h,previewContentHeight:y,previewContentWidth:B,width:c});t.set(g,{filename:l,height:u,mediaPlayableDuration:x,mediaType:h,messageTimestamp:e,plaintextHash:D,previewContentHeight:y,previewContentWidth:B,serverMediaType:v,threadJId:J,width:c});u=null;if(a.previewMediaData!=null)try{u=H(a.previewMediaData)}catch(a){d("WALogger").ERROR(m(),a)}if(z!=null){x=G(f,z,a.mediaData.mediaKey,k,w,v,l,j,g,u);q.push({entry:x,fbId:j,hashedPlaintextHash:I,isXMAShare:a.isXMA,mediaInfo:K,mediaType:h,msgId:a.msgId,objectId:g,plaintextHash:D,size:(e=C)!=null?e:0})}B=(y=s.get(I))!=null?y:[];B.push(a);s.set(I,B)});var u=(yield C(q,e,f));a=(yield z(r));a.forEach(function(a,b){var e=s.get(b);e==null?void 0:e.forEach(function(e){if(e==null)return;if(a!=null){d("WALogger").LOG(l(),e.externalId);var f=u.find(function(a){return a.plaintextHash===e.mediaData.plaintextHash});if(f==null){d("WALogger").LOG(k(),e.mediaData.mediaKey);return}d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:[{tag:"NewMedia",value:d("MAWBridgeTypesCreators").createBridgeMedia(e.chatId,e.threadJId,f,!0)}]});return}f=d("MAWTraceUtils").startNewTrace((h||(h=d("LSIntEnum"))).ofNumber(c("LSDataTraceType").ENCRYPTED_BACKUPS_MEDIA_RESTORE),y);d("MAWTraceUtils").recordCheckpointForTrace(f,h.ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_MEDIA_RESTORE_START),[],!1);var i=t.get(d("WAMediaUtils").stringToDeliveryObjectId(e.mediaData.attachmentObjectId));if(e==null||i==null)return;var m=i.filename,n=i.height,o=i.mediaPlayableDuration,p=i.mediaType,r=i.messageTimestamp,s=i.plaintextHash,v=i.previewContentHeight,w=i.previewContentWidth,x=i.serverMediaType,z=i.threadJId;i=i.width;var A=d("WAJids").extractUserId(d("MAWJids").toUserJid(e.threadJId));x=d("MAWCastToMsgrServerMediaType").castToMsgrServerMediaType(x,e.isXMA);if(x!=null){x={attachmentFbId:e.mediaData.backupEntFbid,attachmentObjectId:d("WAMediaUtils").stringToDeliveryObjectId(e.mediaData.attachmentObjectId),chatId:e.chatId,mediaType:x,messageId:e.externalId,messageTimeStamp:e.messageTimestamp,productType:d("MAWGlobals").getConfig().productTypeForEBAttachments,threadId:A,threadJid:z};A=q.find(function(a){return a.hashedPlaintextHash===b});A=A==null?void 0:A.entry;if(A==null){d("WALogger").ERROR(j(),e.mediaData.mediaKey);return}void I({author:e.author,directPath:e.mediaData.directPath,echoMsg:e.echoMsg,externalId:e.externalId,filename:m,hashedPlaintextHash:b,height:n,isXMA:e.isXMA,mediaPlayableDuration:o,mediaType:p,messageTimestamp:r,plaintextHash:s,previewContentHeight:v,previewContentWidth:w,threadJId:z,width:i},f,x,void 0,d("WAMediaUtils").decodeMediaEntryData(A),g)}})})});return B.apply(this,arguments)}var C=(e=d("MAWIndexedDb")).makeMsgrTransactor({media:(f=d("MAWTransactionMode")).READWRITE,mediaBackup:f.READWRITE,messages:f.READWRITE},"restoreLinkMedias",function(a){return function(b,c,e){return d("MAWMediaManagementTxns").bulkLinkMedia(a,b,c,e)}}),D=e.makeMsgrTransactor({chunk:f.READONLY},"getChunksByHash",function(a){return function(b){return d("MAWDbChunkTxns").maybeBulkGetChunksFromHash(a,b)}});function E(a){if(a.endsWith("=")){var b="";for(var c=0;c<a.length;c++){var d=a.charAt(c);if(d==="=")return b;b+=d}}return a}function F(a){var b=a.height,c=a.mediaType,e=a.width,f=a.previewContentHeight,g=a.previewContentWidth,h=a.mediaPlayableDuration;a=a.filename;return{validatedAudioInfo:c==="Ptt"&&h!=null?{duration:h,mimetype:d("MAWAsConsumerApplication").AUDIO_MIME_TYPE,played:!1}:null,validatedDocumentFileInfo:c==="DocumentFile"?{filename:a,mimetype:d("MAWAsConsumerApplication").FILE_MIME_TYPE}:null,validatedImageInfo:c==="Image"?{height:b,jpegThumbnailHeight:f,jpegThumbnailWidth:g,width:e}:c==="Gif"||c==="Sticker"?{height:b,jpegThumbnailHeight:b,jpegThumbnailWidth:e,width:e}:null,validatedVideoInfo:c==="Video"?{height:b,jpegThumbnailHeight:f,jpegThumbnailWidth:g,mimetype:d("MAWAsConsumerApplication").VIDEO_MIME_TYPE,width:e}:null}}function G(a,b,c,e,f,g,h,i,j,k){a=d("WABase64").decodeB64UrlSafe(a,!0);b=d("WABase64").decodeB64UrlSafe(b,!0);c=d("WABase64").decodeB64UrlSafe(c,!0);return d("WAMediaUtils").rawDataToMediaEntry(a,b,c,e,d("WATimeUtils").castToUnixTime(f),g,j!=null?j:void 0,i!=null?i:void 0,k!=null?k:void 0,h)}function H(a){var b=a.attachmentObjectId,c=a.directPath,e=a.encryptedHash,f=a.mediaKey,g=a.mediaKeyTimestamp;a=a.plaintextHash;if(e==null){d("WALogger").ERROR(x());return}else{g=d("WATimeUtils").castToUnixTime(g);f=d("WAMediaUtils").castToMediaKey(d("WABase64").decodeB64UrlSafe(f,!0));a=d("WABase64").decodeB64UrlSafe(a,!0);e=d("WABase64").decodeB64UrlSafe(e,!0);return{directPath:c,fileEncSha256:e,fileSha256:a,mediaKey:f,mediaKeyTimestamp:g,objectId:b}}}var I=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g,i){var j,k;d("WALogger").LOG(w());var l=a.author,m=a.externalId,n=a.filename,o=a.hashedPlaintextHash,p=a.height,q=a.mediaPlayableDuration,r=a.mediaType,x=a.messageTimestamp,y=a.plaintextHash,z=a.previewContentHeight,A=a.previewContentWidth,B=a.threadJId,C=a.width,D=d("WAJids").switchOnMsgrChatJidType(B,{group:function(a){return"group"},user:function(a){return"user"}});j=((j=(j=d("MAWMediaRetryInfo").getRetriedMediaInfo(m))==null?void 0:j.isXMA)!=null?j:!1)||((j=a==null?void 0:a.isXMA)!=null?j:!1);k=((k=d("MAWMediaRetryInfo").getRetriedMediaInfo(m))==null?void 0:(k=k.echoMsg)==null?void 0:k.serializationOrigin)||(a==null?void 0:(k=a.echoMsg)==null?void 0:k.serializationOrigin)||d("EchoMessage").EchoSerializationOriginType.UNKNOWN;var E=(yield d("WebStorageEstimator").estimateStorage());D=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.MEDIA_DOWNLOAD,{bool:{isRetryFromMI:e==null,isXMA:j,pathMismatch:f!==g.directPath},"int":{storageQuota:(E==null?void 0:E.quota)||0,storageUsage:(E==null?void 0:E.usage)||0},string:{chat_type:D,downloadEntry:"handleEchoMediaMsgsRestore",oldDirectPath:(j=a==null?void 0:a.oldDirectPath)!=null?j:"",origin:k,restorationCdnUrl:(E=f)!=null?E:""}});if(e!=null&&c("gkx")("23960")){d("WALogger").LOG(v());d("MAWMediaRetryInfo").setRetriedMediaInfo(m,a);return J(m,e,b)}j={author:l,chat:B,externalId:m};k=(yield d("MAWDownloadMedia").downloadMedia(j,y,g,D));if(k.success){f=k.value;E=f.mimeType;l=f.plaintext;yield d("MAWHandleMediaDownloadApi").handleMediaDownload(y,E,l,j);D.endSuccess();d("MAWMediaRetryInfo").clearRetriedMediaInfo(m);B=F({filename:n,height:p,mediaPlayableDuration:q,mediaType:r,previewContentHeight:z,previewContentWidth:A,width:C});yield K(o,B);d("WALogger").LOG(u());d("MAWTraceUtils").recordSuccessAndFlushForTraceId(b,(h||(h=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_MEDIA_RESTORE_SUCCESS),[]);e==null&&b!=null&&d("MAWQplProxy").sendQPLSuccessThroughBridge(c("qpl")._(521485815,"2166"),void 0,d("WAHashStringToNumber").hashStringToNumber(b))}else{g=k.error;L(g)&&e?(D.addPoint("eb_resign_requested"),D.endSuccess(),d("WALogger").WARN(t()),d("MAWMediaRetryInfo").setRetriedMediaInfo(m,a),yield J(m,e,b,i)):(D.endFail(g),d("WALogger").ERROR(s(),m,g,x),d("MAWMediaRetryInfo").clearRetriedMediaInfo(m),d("MAWTraceUtils").recordFailureAndFlushForTraceId(b,(h||(h=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_MEDIA_RESTORE_FAILURE),[],"media download failed with error: "+g),d("MAWEBBackendQPLUtils").logMediaRestoreFromMIQPLEndFailure(b,"media_download_failure"))}});return function(b,c,d,e,f,g){return a.apply(this,arguments)}}(),J=e.makeMsgrTransactor({media:f.READONLY,mediaBackup:f.READONLY},"invokeRestoreAccessCheckSprocToDownloadAttachment",function(a){return function(b,e,f,g){var i=d("WAMediaUtils").stringToDeliveryObjectId(e.attachmentObjectId);return d("MAWDbMediaTxns").maybeGetMediaFromObjectId(a,i).then(function(a){if(a){var i;if(f!=null&&e!=null){var j;a=d("WAHashStringToNumber").hashStringToNumber(f);j={bool:{isPointRestore:(j=g)!=null?j:!1},string:{mediaType:e.mediaType}};i=d("MAWQplProxy").startQplUserFlow(c("qpl")._(521485815,"2166"),j,a)}d("WATagsLogger").TAGS(["labyrinth_web","media_restore",(j=f)!=null?j:""]).LOG(r(),g);g===!0?i!=null&&i.endSuccess():d("MAWIndexedDb").afterTransaction({tag:"ResignAttachmentCDNUrl",value:{backupEntFbid:e.attachmentFbId,chatId:e.chatId.toString(),deliveryObjectId:e.attachmentObjectId,mediaType:e.mediaType,messageId:b,productType:d("MAWGlobals").getConfig().productTypeForEBAttachments,sortOrder:e.messageTimeStamp,threadId:e.threadId,threadJid:e.threadJid,traceId:f}})}else d("WALogger").ERROR(q()),d("MAWTraceUtils").recordFailureAndFlushForTraceId(f,(h||(h=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_MEDIA_RESTORE_FAILURE),[],"media entry is missing from index db. It is required to retry download by resigning cdn url")})}}),K=e.makeMsgrTransactor({media:f.READWRITE,messages:f.READWRITE},"updateMediaWithDownloadedChunkBlob",function(a){return function(b,c){return d("MAWMediaManagementTxns").updateMediaEntryWithValidatedMediaInfo(a,b,c)}}),L=function(a){switch(a){case"signature-expired":case"signature-expired-and-resign-failed-no-ids":case"signature-expired-and-resign-failed-cdn-url":return!0;case"hash-mismatch":case"ciphertext-hash-mismatch":case"enc-hash-mismatch":case"decryption-error":case"max-attempts-exceeded":case"request-error":case"download-throttled":case"media-not-found":case"media-entry-invalid":case"no-media-entry-no-message":case"no-media-entry-missing-messages":case"no-media-entry-by-plaintext-hash":case"no-host":case"backoff":case"disconnected":case"missing-media-on-save":case"runtime-error":return!1;default:a;return!0}};g.downloadMediaAndWriteToMediaStore=a;g.handleDownloadMedia=I;g.invokeRestoreAccessCheckSprocToDownloadAttachment=J;g.isResignCDNError=L}),98);
__d("WAStringz",[],(function(a,b,c,d,e,f){"use strict";var g=/\ud83c[\udffb-\udfff](?=\ud83c[\udffb-\udfff])|(?:[^\ud800-\udfff][\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]?|[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|\ud83c[\udffb-\udfff])?)*/g;function a(a){a=a.match(g);return a?a.length:0}function b(a,b,c){b===void 0&&(b=0);a=a.match(g);return!a?"":a.slice(Math.max(0,b),Math.max(0,c)).join("")}function c(a){return a.match(g)||[]}f.astralRange=g;f.length=a;f.substring=b;f.toArray=c}),66);
__d("WAUnicodeUtils",["WAStringz"],(function(a,b,c,d,e,f,g){"use strict";var h=5e3,i=.5;function a(a,b){return j(a||"",0,b)}function b(a){return d("WAStringz").length(a||"")}function j(a,b,c){if(a==null||a==="")return"";b=b||0;c=c==null?Infinity:c;if(b===0&&c===Infinity)return a;return a.length>=h&&c/a.length<=i?l(a,b,c):d("WAStringz").substring(a,b,c)}function k(a,b,c){a=a||"";b=b||0;c=c==null?Infinity:c;return a.length>=h&&c/a.length<=i?m(a,b,c):d("WAStringz").toArray(a).slice(b,c)}function c(a,b){b===void 0&&(b=0);if(a.codePointAt)return a.codePointAt(b);var c=a.charCodeAt(b);if(c>=55296&&c<=56319){a=a.charCodeAt(b+1);a>=56320&&a<=57343&&(c=65536+(c-55296<<10)+(a-56320))}return c}function e(a,b){if(b==null)return a;if(encodeURI(a).length<=b)return a;var c=0,d=k(a),e=d.length;for(var f=0;f<e;f++){var g=d[f];g=encodeURI(g).length;if(c+g>b)return j(a,0,f);c+=g}return a}function l(a,b,c){b=new RegExp(d("WAStringz").astralRange);var e="",f,g=0;do f=b.exec(a),f&&(e+=f[0]),g++;while(f&&g<c);return e}function m(a,b,c){b=new RegExp(d("WAStringz").astralRange);var e=[],f;do f=b.exec(a),f&&e.push(f[0]);while(f&&e.length<c);return e}g.firstNCodepoints=a;g.numCodepoints=b;g.substring=j;g.toArray=k;g.codePointAt=c;g.firstNEncodedBytes=e}),98);
__d("MAWBackupMessageWithMedia",["LSDataTraceCheckPoint","LSIntEnum","MAWDbMsgTxns","MAWEBSwitch","MAWEBUploadTrackingUtils","MAWGetMediaByObjectId","MAWGlobals","MAWIndexedDb","MAWTraceUtils","MAWTransactionMode","MAWUploadMessagesBackup","WALogger","WASortedLists","asyncToGeneratorRuntime","err","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] No affected messages for media"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] No mediaBackup entry found for fbid: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] No media entry found for fbid: ",""]);k=function(){return a};return a}var l=d("MAWIndexedDb").makeMsgrTransactor({messages:d("MAWTransactionMode").READONLY},"getMsgsByMsgIds",function(a){return function(){for(var b=arguments.length,c=new Array(b),e=0;e<b;e++)c[e]=arguments[e];return d("MAWDbMsgTxns").getMsgsByMsgIds.apply(void 0,[a].concat(c))}});function m(a,b,c){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){if(!c("MAWEBSwitch").isEnabled())return;var f=null;if(!c("gkx")("23919")){var g=(yield d("MAWGetMediaByObjectId").getMediaByObjectId(b));if(!g.success){d("WALogger").ERROR(k(),a);d("MAWTraceUtils").recordFailureAndFlushForTraceId(e,(h||(h=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_MEDIA_BACKUP_FAILURE),[],"No media entry found");throw c("err")("No media entry found")}f=g.value.msgIds}else{g=(yield d("MAWGetMediaByObjectId").getMediaBackupByObjectId(b));if(!g.success){d("WALogger").ERROR(j(),a);d("MAWTraceUtils").recordFailureAndFlushForTraceId(e,(h||(h=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_MEDIA_BACKUP_FAILURE),[],"No media entry found");throw c("err")("No mediaBackup entry found")}g.value.msgId!=null&&(f=d("WASortedLists").asSortedSet(new Set([g.value.msgId])))}if(f==null||f.length===0){d("WALogger").ERROR(i());d("MAWTraceUtils").recordFailureAndFlushForTraceId(e,(h||(h=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_MEDIA_BACKUP_FAILURE),[],"No affected messages for media");throw c("err")("No affected messages for media")}b=(yield l(f));var m=new Map();b.forEach(function(a){if(d("MAWEBUploadTrackingUtils").isUploadSupported(a)){var b=d("MAWEBUploadTrackingUtils").genInstanceKeyOnly();m.set(a.externalId,b);d("MAWEBUploadTrackingUtils").startUploadTracking(a.externalId,a.type,"media",b)}});yield d("MAWUploadMessagesBackup").uploadUniqueMessage(b,void 0,void 0,void 0,m);d("MAWTraceUtils").recordCheckpointForTrace(e,(h||(h=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_MEDIA_BACKUP_SUCCESS),[],!1);d("MAWTraceUtils").recordCheckpointForTrace(e,h.ofNumber(c("LSDataTraceCheckPoint").FLOW_END_AND_FLUSH),[],!0)});return n.apply(this,arguments)}a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("backup",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.backupEntFbid,c=a.deliveryObjectId;a=a.traceId;yield m(b,c,a)});return function(b){return a.apply(this,arguments)}}()).end();g.processUpload=m;g.backupMessageWithMedia=a}),98);
__d("MAWCreateGroupStep",["MAWCreateGroupInvitesStep","MAWSendSenderKeyDistributionMsg","WADeprecatedSendIq","WADeprecatedWapParser","WAGlobals","WAGroupParserUtils","WAJobDefinitions","WAJobOrchestratorTypes","WAJobs","WALogger","WAPREList","WAPREMetrics","WAResultOrError","WAScheduleAfterOfflineResume","WATimeUtils","WAWap","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to create group: ",""]);h=function(){return a};return a}var i=new(c("WADeprecatedWapParser"))("createGroupResponse",function(a){a.assertTag("iq");return d("WAGroupParserUtils").parseGroupNode(a.child("group"))});function a(a,b,c,d){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){var f=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.CREATE_GROUP,{"int":{users:c.length}}),g=d("WAGlobals").getJidUtilsApi(),h=g.toUserJid;g=c.map(function(a){return h(a)});c=(yield k(a,b,g,f,e==null?void 0:e.deduplicationKey));f.addPoint("finish_send_create_group_stanza");if(!c.success)return c;var i=c.value.group;f.addPoint("start_create_group");yield d("WAGlobals").getDbImpls().createGroup(i,"added",d("WATimeUtils").unixTime(),null,a,e);f.addPoint("finish_create_group");d("WAScheduleAfterOfflineResume").scheduleAfterOfflineResume({code:function(){return d("MAWSendSenderKeyDistributionMsg").maybePreEstablishSessionsAndSendSenderKeyDistributionMsg(i.jid,i.participants.length)},id:i.jid+"-e2e-session"});b=i.participants.map(function(a){return a.success?a.value.user:void 0}).filter(Boolean);yield d("WAJobs").getJobManager().waitUntilPersisted(d("WAJobDefinitions").createStartJobInfo("getDevices",{ignoreDhash:!1,reason:"create-group",scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.LOW},users:new Set(b)}));f.addPoint("persist_get_devices_create_group");yield d("MAWCreateGroupInvitesStep").createGroupInvitesStep(i.jid,(g=i.creator)!=null?g:d("WAGlobals").getMyUserJid(),i.participants.map(function(a){return!a.success&&a.error.errorCode===403?{expiration:a.error.expiration,inviteCode:a.error.code,user:a.error.user}:void 0}).filter(Boolean));f.addPoint("finish_create_group_invites_step");c=d("WAJobs").getJobResultConvertersImpls().convertCreateGroupResult;a=c?yield c(i):{group:i,type:"default"};f.endSuccess();return d("WAResultOrError").makeResult(a)});return j.apply(this,arguments)}function k(a,b,c,e,f){var g;c=c.map(function(a){return d("WAWap").wap("participant",{jid:d("WAWap").USER_JID(a)})});g=(g=d("WAWap")).wap("iq",{id:g.generateId(),to:g.G_US,type:"set",xmlns:"w:g2"},g.wap("create",{id:a!=null?d("WAWap").CUSTOM_STRING(a):d("WAWap").DROP_ATTR,key:f!=null?d("WAWap").CUSTOM_STRING(f):d("WAWap").DROP_ATTR,subject:b!=null?d("WAWap").CUSTOM_STRING(b):d("WAWap").DROP_ATTR},c));return d("WADeprecatedSendIq").deprecatedSendIq(g,i).then(function(a){if(!a.success){d("WALogger").ERROR(h(),a.errorCode);e.endFail("fail_send_create_group_stanza",{"int":{errorCode:a.errorCode}});return d("WAResultOrError").makeError(a.errorText)}return d("WAResultOrError").makeResult({group:a.result,type:"default"})})}g.createGroupStep=a}),98);
__d("MAWCreateGroup",["MAWCreateGroupStep","MAWGlobals"],(function(a,b,c,d,e,f,g){"use strict";a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("createGroup",function(a){var b=a.extras,c=a.key,e=a.subject;a=a.users;return d("MAWCreateGroupStep").createGroupStep(c,e,a,b)}).end();g.createGroup=a}),98);
__d("MAWDeleteGroups",["MAWGlobals","WAJids","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("deleteGroups",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.groups;yield d("MAWGlobals").getDbImpls().deleteGroups(a.map(function(a){return{deleter:d("WAJids").AUTHOR_ME,group:a}}))});return function(b){return a.apply(this,arguments)}}()).end();g.deleteGroups=a}),98);
__d("MAWDeleteMsgsForMe",["MAWGlobals","MAWJobDefinitions","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["deleteMsgsForMe: ",""]);h=function(){return a};return a}a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("saveAndPassOff",function(a){a=a.msgIds;d("WALogger").DEV(h(),a);a=a.map(function(a){return{protocolMsgId:a,type:"delete_for_me"}});a=a.map(function(a){return{messageAction:a}});a={actions:a,type:"meta_sync"};return d("MAWGlobals").getJobManager().waitUntilCompleted(d("MAWJobDefinitions").jobSerializers.sendAppData({contents:a})).then(function(){return void 0})}).end();g.deleteMsgsForMe=a}),98);
__d("MAWDeleteThread",["MAWDbChatId","MAWGlobals","MAWJobDefinitions","WALogger","WAPREList","WAPREMetrics","WATimeUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["deleteThread job: ",""]);h=function(){return a};return a}a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("saveAndPassOff",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.chatId;d("WALogger").DEV(h(),a);var b=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.DELETE_THREAD,void 0,a);a=d("MAWDbChatId").unsafeCoerceToChatId(a);a=(yield d("MAWGlobals").getDbImpls().getThreadInfoForDeletion(a));var c=a.newestMsgTs!=null?d("WATimeUtils").futureUnixTime(1,a.newestMsgTs):void 0;a={chatJid:a.chatJid,messageRange:{lastMessageTimestamp:c,messages:[]},type:"chat_delete"};c={actions:[{chatAction:a}],type:"meta_sync"};return d("MAWGlobals").getJobManager().waitUntilCompleted(d("MAWJobDefinitions").jobSerializers.sendAppData({contents:c})).then(function(){b.endSuccess()})["catch"](function(){b.endFail("delete_thread_failed")})});return function(b){return a.apply(this,arguments)}}()).end();g.deleteThread=a}),98);
__d("WASmaxInGroupsIQErrorBlockedIntegrityEnforcementMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","blocked-integrity-enforcement");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",486);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorBlockedIntegrityEnforcementMixin=a}),98);
__d("WASmaxInGroupsPromoteDemoteClientErrors",["WAResultOrError","WASmaxInGroupsIQErrorBadRequestMixin","WASmaxInGroupsIQErrorBlockedIntegrityEnforcementMixin","WASmaxInGroupsIQErrorFallbackClientMixin","WASmaxInGroupsIQErrorForbiddenMixin","WASmaxInGroupsIQErrorItemNotFoundMixin","WASmaxInGroupsIQErrorLockedMixin","WASmaxInGroupsIQErrorNotAuthorizedMixin","WASmaxInGroupsIQErrorRateOverlimitMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsIQErrorRateOverlimitMixin").parseIQErrorRateOverlimitMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorRateOverlimit",value:b.value});var c=d("WASmaxInGroupsIQErrorBlockedIntegrityEnforcementMixin").parseIQErrorBlockedIntegrityEnforcementMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IQErrorBlockedIntegrityEnforcement",value:c.value});var e=d("WASmaxInGroupsIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:e.value});var f=d("WASmaxInGroupsIQErrorItemNotFoundMixin").parseIQErrorItemNotFoundMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"IQErrorItemNotFound",value:f.value});var g=d("WASmaxInGroupsIQErrorNotAuthorizedMixin").parseIQErrorNotAuthorizedMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"IQErrorNotAuthorized",value:g.value});var h=d("WASmaxInGroupsIQErrorForbiddenMixin").parseIQErrorForbiddenMixin(a);if(h.success)return d("WAResultOrError").makeResult({name:"IQErrorForbidden",value:h.value});var i=d("WASmaxInGroupsIQErrorLockedMixin").parseIQErrorLockedMixin(a);if(i.success)return d("WAResultOrError").makeResult({name:"IQErrorLocked",value:i.value});var j=d("WASmaxInGroupsIQErrorFallbackClientMixin").parseIQErrorFallbackClientMixin(a);return j.success?d("WAResultOrError").makeResult({name:"IQErrorFallbackClient",value:j.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorRateOverlimit","IQErrorBlockedIntegrityEnforcement","IQErrorBadRequest","IQErrorItemNotFound","IQErrorNotAuthorized","IQErrorForbidden","IQErrorLocked","IQErrorFallbackClient"],[b,c,e,f,g,h,i,j])}g.parsePromoteDemoteClientErrors=a}),98);
__d("WASmaxInGroupsPromoteDemoteResponseClientError",["WAResultOrError","WASmaxInGroupsIQErrorResponseMixin","WASmaxInGroupsPromoteDemoteClientErrors","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInGroupsIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInGroupsPromoteDemoteClientErrors").parsePromoteDemoteClientErrors(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorPromoteDemoteClientErrors:b.value}))}g.parsePromoteDemoteResponseClientError=a}),98);
__d("WASmaxInGroupsPromoteDemoteResponseServerError",["WASmaxInGroupsBaseServerErrorMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxInGroupsBaseServerErrorMixin").parseBaseServerErrorMixin(a,b);return!c.success?c:c}g.parsePromoteDemoteResponseServerError=a}),98);
__d("WASmaxInGroupsIQResultResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQResultResponseMixin=a}),98);
__d("WASmaxInGroupsPromoteDemoteResponseSuccessDemote",["WAResultOrError","WASmaxInGroupsEnums","WASmaxInGroupsGroupAddressingModeMixin","WASmaxInGroupsIQResultResponseMixin","WASmaxInGroupsPhoneNumberMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"jid");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a,"error",d("WASmaxInGroupsEnums").ENUM_404_406);if(!c.success)return c;a=d("WASmaxInGroupsPhoneNumberMixin").parsePhoneNumberMixin(a);return d("WAResultOrError").makeResult({jid:b.value,error:c.value,phoneNumberMixin:a.success?a.value:null})}function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"demote");if(!c.success)return c;b=d("WASmaxInGroupsIQResultResponseMixin").parseIQResultResponseMixin(a,b);if(!b.success)return b;a=d("WASmaxInGroupsGroupAddressingModeMixin").parseGroupAddressingModeMixin(a);c=d("WASmaxParseUtils").mapChildrenWithTag(c.value,"participant",0,1024,h);return!c.success?c:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{groupAddressingModeMixin:a.success?a.value:null,demoteParticipant:c.value}))}g.parsePromoteDemoteResponseSuccessDemoteDemoteParticipant=h;g.parsePromoteDemoteResponseSuccessDemote=a}),98);
__d("WASmaxInGroupsPromoteDemoteResponseSuccessPromote",["WAResultOrError","WASmaxInGroupsEnums","WASmaxInGroupsGroupAddressingModeMixin","WASmaxInGroupsIQResultResponseMixin","WASmaxInGroupsPhoneNumberMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"jid");if(!b.success)return b;var c=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,a,"type","admin");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a,"error",d("WASmaxInGroupsEnums").ENUM_404_419);if(!e.success)return e;a=d("WASmaxInGroupsPhoneNumberMixin").parsePhoneNumberMixin(a);return d("WAResultOrError").makeResult({jid:b.value,type:c.value,error:e.value,phoneNumberMixin:a.success?a.value:null})}function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"promote");if(!c.success)return c;b=d("WASmaxInGroupsIQResultResponseMixin").parseIQResultResponseMixin(a,b);if(!b.success)return b;a=d("WASmaxInGroupsGroupAddressingModeMixin").parseGroupAddressingModeMixin(a);c=d("WASmaxParseUtils").mapChildrenWithTag(c.value,"participant",0,1024,h);return!c.success?c:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{groupAddressingModeMixin:a.success?a.value:null,promoteParticipant:c.value}))}g.parsePromoteDemoteResponseSuccessPromotePromoteParticipant=h;g.parsePromoteDemoteResponseSuccessPromote=a}),98);
__d("WASmaxOutGroupsPromoteDemoteRequest",["WASmaxChildren","WASmaxJsx","WASmaxOutGroupsBaseSetGroupMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.participantJid;a=d("WASmaxJsx").smax("participant",{jid:d("WAWap").USER_JID(a)});return a}function i(a){a=a.participantArgs;a=d("WASmaxJsx").smax("promote",null,d("WASmaxChildren").REPEATED_CHILD(h,a,0,1024));return a}function j(a){a=a.participantJid;a=d("WASmaxJsx").smax("participant",{jid:d("WAWap").USER_JID(a)});return a}function k(a){a=a.participantArgs;a=d("WASmaxJsx").smax("demote",null,d("WASmaxChildren").REPEATED_CHILD(j,a,0,1024));return a}function a(a){var b=a.promoteArgs,c=a.demoteArgs;b=d("WASmaxOutGroupsBaseSetGroupMixin").mergeBaseSetGroupMixin(d("WASmaxJsx").smax("iq",null,d("WASmaxChildren").OPTIONAL_CHILD(i,b),d("WASmaxChildren").OPTIONAL_CHILD(k,c)),a);return b}g.makePromoteDemoteRequestPromoteParticipant=h;g.makePromoteDemoteRequestPromote=i;g.makePromoteDemoteRequestDemoteParticipant=j;g.makePromoteDemoteRequestDemote=k;g.makePromoteDemoteRequest=a}),98);
__d("WASmaxGroupsPromoteDemoteRPC",["WAComms","WASmaxInGroupsPromoteDemoteResponseClientError","WASmaxInGroupsPromoteDemoteResponseServerError","WASmaxInGroupsPromoteDemoteResponseSuccessDemote","WASmaxInGroupsPromoteDemoteResponseSuccessPromote","WASmaxOutGroupsPromoteDemoteRequest","WASmaxParsingFailure","WASmaxRpcUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,h,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:e=d("WASmaxOutGroupsPromoteDemoteRequest").makePromoteDemoteRequest(a);k.next=3;return b("regeneratorRuntime").awrap(d("WAComms").sendSmaxStanza(e,c));case 3:f=k.sent;g=d("WASmaxInGroupsPromoteDemoteResponseSuccessPromote").parsePromoteDemoteResponseSuccessPromote(f,e);if(!g.success){k.next=7;break}return k.abrupt("return",{name:"PromoteDemoteResponseSuccessPromote",value:g.value});case 7:h=d("WASmaxInGroupsPromoteDemoteResponseSuccessDemote").parsePromoteDemoteResponseSuccessDemote(f,e);if(!h.success){k.next=10;break}return k.abrupt("return",{name:"PromoteDemoteResponseSuccessDemote",value:h.value});case 10:i=d("WASmaxInGroupsPromoteDemoteResponseClientError").parsePromoteDemoteResponseClientError(f,e);if(!i.success){k.next=13;break}return k.abrupt("return",{name:"PromoteDemoteResponseClientError",value:i.value});case 13:j=d("WASmaxInGroupsPromoteDemoteResponseServerError").parsePromoteDemoteResponseServerError(f,e);if(!j.success){k.next=16;break}return k.abrupt("return",{name:"PromoteDemoteResponseServerError",value:j.value});case 16:throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("PromoteDemote",{SuccessPromote:g,SuccessDemote:h,ClientError:i,ServerError:j}));case 17:case"end":return k.stop()}},null,this)}g.sendPromoteDemoteRPC=a}),98);
__d("WAPromoteDemoteGroupParticipantProtocol",["WAErr","WALogger","WAResultOrError","WASmaxGroupsPromoteDemoteRPC","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["error sending promote group participants iq: ",", ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["error sending promote group participants iq: ",", ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Demoting participants, but got promotion response"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Promoting participants, but got demotion response"]);k=function(){return a};return a}function a(a){var e,f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:e=a.group,f=a.participants;h.next=3;return b("regeneratorRuntime").awrap(l({group:e,demoteArgs:null,promoteArgs:{participantArgs:f.map(function(a){return{participantJid:a}})}}));case 3:g=h.sent;if(g.success){h.next=6;break}return h.abrupt("return",g);case 6:if(!(g.value.type==="promote")){h.next=8;break}return h.abrupt("return",d("WAResultOrError").makeResult(g.value));case 8:d("WALogger").ERROR(k());throw c("WAErr")("Promoting participants, but got demotion response");case 10:case"end":return h.stop()}},null,this)}function e(a){var e,f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:e=a.group,f=a.participants;h.next=3;return b("regeneratorRuntime").awrap(l({group:e,promoteArgs:null,demoteArgs:{participantArgs:f.map(function(a){return{participantJid:a}})}}));case 3:g=h.sent;if(g.success){h.next=6;break}return h.abrupt("return",g);case 6:if(!(g.value.type==="demote")){h.next=8;break}return h.abrupt("return",d("WAResultOrError").makeResult(g.value));case 8:d("WALogger").ERROR(j());throw c("WAErr")("Demoting participants, but got promotion response");case 10:case"end":return h.stop()}},null,this)}function l(a){var c,e,f,g,j,k,l,m,n,o,p,q;return b("regeneratorRuntime").async(function(r){while(1)switch(r.prev=r.next){case 0:c=a.group,e=a.promoteArgs,f=a.demoteArgs;r.next=3;return b("regeneratorRuntime").awrap(d("WASmaxGroupsPromoteDemoteRPC").sendPromoteDemoteRPC({promoteArgs:e,demoteArgs:f,iqTo:c}));case 3:g=r.sent;r.t0=g.name;r.next=r.t0==="PromoteDemoteResponseSuccessPromote"?7:r.t0==="PromoteDemoteResponseSuccessDemote"?9:r.t0==="PromoteDemoteResponseClientError"?11:14;break;case 7:j=g.value.promoteParticipant.map(function(a){var b=a.error;return{user:a.jid,result:b==null?d("WAResultOrError").makeResult():d("WAResultOrError").makeError(b)}});return r.abrupt("return",d("WAResultOrError").makeResult({type:"promote",participants:j}));case 9:k=g.value.demoteParticipant.map(function(a){var b=a.error;return{user:a.jid,result:b==null?d("WAResultOrError").makeResult():d("WAResultOrError").makeError(b)}});return r.abrupt("return",d("WAResultOrError").makeResult({type:"demote",participants:k}));case 11:l=g.value.errorPromoteDemoteClientErrors.value,m=l.code,n=l.text;d("WALogger").WARN(i(),m,n);return r.abrupt("return",d("WAResultOrError").makeError({type:"client-error",code:m}));case 14:g.name;o=g.value.errorServerErrors.value,p=o.code,q=o.text;d("WALogger").WARN(h(),p,q);return r.abrupt("return",d("WAResultOrError").makeError({type:"server-error",code:p}));case 18:case"end":return r.stop()}},null,this)}g.promoteGroupParticipantsProtocol=a;g.demoteGroupParticipantsProtocol=e}),98);
__d("MAWDemoteGroupParticipants",["MAWGlobals","MAWODSProxy","WAChangeGroupParticipantAdminStatusApi","WAGlobals","WAJids","WAOdsEnums","WAPromoteDemoteGroupParticipantProtocol","WAResultOrError","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("demoteGroupParticipants",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.group;a=a.users;var c=d("WAGlobals").getJidUtilsApi(),e=c.toUserJid;c=a.map(function(a){return e(a)});if(c.length===0)return d("WAResultOrError").makeResult({groupJid:b,participants:[],type:"default"});a=(yield d("WAPromoteDemoteGroupParticipantProtocol").demoteGroupParticipantsProtocol({group:b,participants:c}));if(!a.success){d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.GROUP_DEMOTE_PARTICIPANT,key:"fail"});return d("WAResultOrError").makeError(a.error.type)}d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.GROUP_DEMOTE_PARTICIPANT,key:"success"});c=a.value.participants.filter(function(a){a=a.result;return a.success}).map(function(a){a=a.user;return{addressable:!1,type:"participant",user:a}})||[];yield d("WAChangeGroupParticipantAdminStatusApi").changeGroupParticipantAdminStatus(null,b,d("WAJids").AUTHOR_ME,c,"participant");a=(yield d("MAWGlobals").getJobResultConvertersImpls().convertDemoteGroupParticipantsResult==null?void 0:d("MAWGlobals").getJobResultConvertersImpls().convertDemoteGroupParticipantsResult(b,c));return a?d("WAResultOrError").makeResult(a):d("WAResultOrError").makeResult({groupJid:b,participants:c,type:"default"})});return function(b){return a.apply(this,arguments)}}()).end();g.demoteGroupParticipants=a}),98);
__d("MAWDeletedMsgApi",["MAWIndexedDb","MAWTransactionMode"],(function(a,b,c,d,e,f,g){"use strict";a=d("MAWIndexedDb").makeMsgrTransactor({deletedMessages:d("MAWTransactionMode").READONLY},"getDeletedMsgByProtocolIdApi",function(a){return function(b){return a.deletedMessages.get(babelHelpers["extends"]({},b))}});g.getDeletedMsgByProtocolIdApi=a}),98);
__d("MAWGetDecodedMediaEntry",["MAWGetMediaKnownEntriesApi","WALogger","WAMediaUtils","WAResultOrError","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["No media entry: messages_number=",", numMsgsForMedia=",""]);h=function(){return a};return a}function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=(yield d("MAWGetMediaKnownEntriesApi").getMediaKnownEntries(b));if(b.success===!1)return b;b=b.value;var c=b.missingMessages,e=b.msgMap;b=b.numEntries;a=e.get(a);if(a!=null)return d("WAResultOrError").makeResult(d("WAMediaUtils").decodeMediaEntryData(a));if(c.length>0)return d("WAResultOrError").makeError("no-media-entry-missing-messages");else{d("WALogger").ERROR(h(),e.values().length,b);return d("WAResultOrError").makeError("no-media-entry-no-message")}});return i.apply(this,arguments)}g.getDecodedMediaEntry=a}),98);
__d("MAWGetMostRescentDecodedMediaEntry",["MAWDbMediaTxns","MAWIndexedDb","MAWTransactionMode","WAMediaUtils","WAResultOrError","WATagsLogger","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["No media entry"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["No existing media entry found for plaintextHash ",". Returning new MsgMap."]);i=function(){return a};return a}var j=d("WATagsLogger").TAGS(["getMostRecentDecodedMediaEntry"]),k=d("MAWIndexedDb").makeMsgrTransactor({media:d("MAWTransactionMode").READONLY},"getMediaKnownEntries",function(a){return function(b){return d("MAWDbMediaTxns").maybeGetMediaFromPlaintextHash(a,b).then(function(a){if(!a){j.LOG(i(),b);return d("WAResultOrError").makeError("no-media-by-plaintext-hash")}a=Array.from(a.mediaEntries.values());return d("WAResultOrError").makeResult(a)})}});function a(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield k(a));if(a.success===!1)return a;var b=null;for(a of a.value){var c,e=d("WAMediaUtils").decodeMediaEntryData(a);(((c=b)==null?void 0:c.mediaKeyTimestamp)==null||e.mediaKeyTimestamp!=null&&e.mediaKeyTimestamp>b.mediaKeyTimestamp)&&(b=e)}if(b!=null)return d("WAResultOrError").makeResult(b);j.ERROR(h());return d("WAResultOrError").makeError("no-media-entry")});return l.apply(this,arguments)}g.getMostRecentDecodedMediaEntry=a}),98);
__d("MAWDownloadAndHandleMedia",["MAWAckLevel","MAWDbDeletedMessages","MAWDbMsgTxns","MAWDeletedMsgApi","MAWDownloadMedia","MAWExternalId","MAWGetDecodedMediaEntry","MAWGetMostRescentDecodedMediaEntry","MAWGetStorageQplAnnotations","MAWGlobals","MAWHandleMediaDownloadApi","MAWIndexedDb","MAWLoggerUtils","MAWTransactionMode","WAJids","WAPREList","WAPREMetrics","WATagsLogger","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media for msg ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["downloadAndHandleMedia: Failed to get DecodedMediaEntry - reason: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["downloadAndHandleMedia: Missing msgId in Db - reason: "," msgType: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["DownloadAndHandleMedia: "," hash with "," msgId"]);l=function(){return a};return a}var m=d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.MediaDownload,d("MAWLoggerUtils").Tag.MessageReceive]);a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("downloadAndHandleMedia",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.hash,e=a.metricInstanceKeys,f=a.msgType,g=a.protocolMsgId;a=a.qplEntryPoint;var o=d("WAJids").switchOnMsgrChatJidType(g.chat,{group:function(){return"group"},user:function(){return"user"}});e=e==null?void 0:e.get(d("WAPREList").PRE_METRIC.RECEIVE_MESSAGE);var q=e!=null?d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.RECEIVE_MESSAGE,{},e):void 0;m.LOG(l(),b,g);q==null?void 0:q.addPoint("start_media_download");e=(yield d("MAWGlobals").getDbImpls().getMsgIdByProtocolMsgId(g));if(!e.success){if(c("gkx")("23965")&&(yield n(g))){q==null?void 0:q.endSuccess();return}q==null?void 0:q.endFail(e.error);m.ERROR(k(),e.error,f);return}var r=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.MEDIA_DOWNLOAD,{string:{chat_type:o,downloadEntry:a,e2eePlatform:d("MAWExternalId").getPlatform(g.externalId),jid:g.chat,msgType:f}}),s={addAnnotations:function(a){r.addAnnotations(a),q==null?void 0:q.addAnnotations(a)},addPoint:function(a,b){r.addPoint(a,b),q==null?void 0:q.addPoint(a,b)},endFail:function(a,b){r.endFail(a,b),q==null?void 0:q.endFail(a,b)},endSuccess:function(a){r.endSuccess(a),q==null?void 0:q.endSuccess(a)}};void d("MAWGetStorageQplAnnotations").getStorageQplAnnotations().then(function(a){s.addAnnotations(a)});o=e.value;a=d("MAWGlobals").getConfig().useMostRecentMediaEntryForDownload()?yield d("MAWGetMostRescentDecodedMediaEntry").getMostRecentDecodedMediaEntry(b):yield d("MAWGetDecodedMediaEntry").getDecodedMediaEntry(g,b);if(!a.success){s.endFail(a.error);m.ERROR(j(),a.error);yield p(o);return}f=(yield d("MAWDownloadMedia").downloadMedia(g,b,a.value,s));if(f.success){e=f.value;a=e.mimeType;e=e.plaintext;yield d("MAWHandleMediaDownloadApi").handleMediaDownload(b,a,e,g);s.endSuccess()}else s.endFail(f.error),m.LOG(i(),o),m.ERROR(h(),f.error),yield p(o)});return function(b){return a.apply(this,arguments)}}()).end();function n(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("MAWDeletedMsgApi").getDeletedMsgByProtocolIdApi(a));return!a?!1:a.reason===d("MAWDbDeletedMessages").DbDeletedMsgReasonEnum.ChatDelete||a.reason===d("MAWDbDeletedMessages").DbDeletedMsgReasonEnum.Revoke});return o.apply(this,arguments)}function p(a){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;yield d("MAWIndexedDb").makeMsgrTransactor({chunk:(b=d("MAWTransactionMode")).READONLY,media:b.READONLY,messages:b.READWRITE,xma:b.READONLY},"downloadMedia",function(a){return function(b,c){return d("MAWDbMsgTxns").updateSystemAck(a,b,c)}})(a,d("MAWAckLevel").ACK.failed)});return q.apply(this,arguments)}g.downloadAndHandleMedia=a}),98);
__d("MAWDownloadAndRestoreMedia",["LSDataTraceCheckPoint","LSIntEnum","MAWEBBackendQPLUtils","MAWGetMediaByObjectId","MAWGlobals","MAWHandleEchoMediaMsgsRestoreV2","MAWHandleMediaDownloadAndRestoreApi","MAWTraceUtils","WALogger","WAMediaUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] downloadAndRestoreMedia job completed"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] download metadata is missing"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] media not found in the media table"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] cdn url mismatch between media entry direct path and restoration cdn url"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] media entry is missing for msgId"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] downloadAndRestoreMedia job started"]);n=function(){return a};return a}a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("downloadAndRestoreMedia",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.deliveryObjectId,e=a.restorationCdnUrl;a=a.traceId;d("WALogger").LOG(n());var f=(yield d("MAWHandleMediaDownloadAndRestoreApi").writeCdnUrlAndBakeDownloadPayload(b,e));if(f){var g=(yield d("MAWGetMediaByObjectId").getMediaBackupByObjectId(b));b=(yield d("MAWGetMediaByObjectId").getMediaByObjectId(b));if(b.success&&g.success){b=b.value.mediaEntries.get(g.value.msgId);if(!b){d("WALogger").ERROR(m());d("MAWTraceUtils").recordFailureAndFlushForTraceId(a,(h||(h=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_MEDIA_RESTORE_FAILURE),[],"Media entry data missing for deliveryObjectId");d("MAWEBBackendQPLUtils").logMediaRestoreFromMIQPLEndFailure(a,"media_entry_missing");return}else{g=d("WAMediaUtils").decodeMediaEntryData(b);b=g==null?void 0:g.directPath;b!==e&&d("WALogger").ERROR(l());d("MAWEBBackendQPLUtils").logMediaRestoreFromMIQPLPoint(a,"download_media_start");yield d("MAWHandleEchoMediaMsgsRestoreV2").handleDownloadMedia(f,a,void 0,e,g)}}else{d("WALogger").ERROR(k());d("MAWTraceUtils").recordFailureAndFlushForTraceId(a,(h||(h=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_MEDIA_RESTORE_FAILURE),[],"Media data missing for deliveryObjectId");return}}else d("WALogger").ERROR(j()),d("MAWTraceUtils").recordFailureAndFlushForTraceId(a,(h||(h=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_MEDIA_RESTORE_FAILURE),[],"Download metadata is missing"),d("MAWEBBackendQPLUtils").logMediaRestoreFromMIQPLEndFailure(a,"media_entry_missing");d("WALogger").LOG(i())});return function(b){return a.apply(this,arguments)}}()).end();g.downloadAndRestoreMedia=a}),98);
__d("MAWWriteForwardedMsgApi",["MAWAckLevel","MAWBridgeTypesCreators","MAWBridgeXMA","MAWDbMsg","MAWDbMsgTxns","MAWDbXMATxns","MAWDexieTable","MAWIndexedDb","MAWJidUtils","MAWMediaManagementTxns","MAWMsgReceiptPreparationTxns","MAWMsgType","MAWTransactionMode","MAWWriteMsgTxns","MAWXMAManagementTxns","MAWXMAUtils","WAJids","err"],(function(a,b,c,d,e,f,g){"use strict";b=d("MAWIndexedDb").makeMsgrAndSignalTransactor({chunk:(a=d("MAWTransactionMode")).READONLY,groupInfo:a.READONLY,identity:a.READONLY,media:a.READWRITE,mediaBackup:a.READWRITE,messages:a.READWRITE,participants:a.READONLY,receipts:a.READWRITE,threads:a.READWRITE,xma:a.READWRITE},"writeForwardedMsg",function(a){return function(b,c,e,f,g,k,l,m){k===void 0&&(k=!1);return d("MAWDexieTable").dexieAll([a.threads.get({jid:c}),d("MAWDbMsgTxns").maybeGetMsgByProtocolMsgId(a,e),a.messages.where("externalId").equals(b).toArray()]).then(function(c){var n=c[0],o=c[1];c=c[2];if(n==null)return{type:"missing_thread"};if(o==null)return{type:"missing_msg"};if(o.ephemeralSetting!=null&&o.ephemeralSetting.ephemeralExpirationInSec!==0)return{type:"forwarding_ephemeral_msg"};c=c.find(function(a){return a.thread===n.chatId&&a.author===d("WAJids").AUTHOR_ME});if(c!=null)return c.ack>=d("MAWAckLevel").ACK.sent?{msgId:c.msgId,protocolMsgId:{author:d("WAJids").AUTHOR_ME,chat:n.jid,externalId:c.externalId},type:"already_sent"}:{msgId:c.msgId,protocolMsgId:{author:d("WAJids").AUTHOR_ME,chat:n.jid,externalId:c.externalId},type:"not_sent"};else{c={ack:d("MAWAckLevel").ACK.clock,altIndex:void 0,author:d("WAJids").AUTHOR_ME,ephemeralSetting:g!=null?g:void 0,externalId:b,forwardingScore:((c=o.forwardingScore)!=null?c:0)+1,isForwarded:o.author!==d("WAJids").AUTHOR_ME,mediaId:o.mediaId,msgContent:o.type==="Text"?o.msgContent:void 0,specialTextSize:o.specialTextSize,thread:n.chatId,threadJid:n.jid,ts:f};var p=h(o.type,c,o.type==="Text"?o.msgContent:{content:""},o.xmaMessageType);return d("MAWWriteMsgTxns").writeMsg(a,p,n,{isFirstMsg:k,openMessageParticipantCount:l,participantCount:m}).then(function(b){return d("MAWDexieTable").dexieAll([d("MAWMsgReceiptPreparationTxns").prepareReceiptForMsg(a,b.msgId,n.jid,b.externalId,b.author),j(a,e,b,o,n.chatId,n.jid),i(a,o.mediaId,b,o,n.chatId,n.jid)]).then(function(a){return{msgId:b.msgId,protocolMsgId:{author:d("WAJids").AUTHOR_ME,chat:n.jid,externalId:p.externalId},type:"not_sent"}})})}})}});function h(a,b,e,f){switch(a){case"Text":return babelHelpers["extends"]({},b,{msgContent:e,type:d("MAWMsgType").MSG_TYPE.TEXT});case"Image":return babelHelpers["extends"]({},b,{type:d("MAWMsgType").MSG_TYPE.IMAGE});case"Video":return babelHelpers["extends"]({},b,{type:d("MAWMsgType").MSG_TYPE.VIDEO});case"Ptt":return babelHelpers["extends"]({},b,{type:d("MAWMsgType").MSG_TYPE.PTT});case"Gif":return babelHelpers["extends"]({},b,{type:d("MAWMsgType").MSG_TYPE.GIF});case"Sticker":return babelHelpers["extends"]({},b,{type:d("MAWMsgType").MSG_TYPE.STICKER});case"DocumentFile":return babelHelpers["extends"]({},b,{type:d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE});case"XMA":if(f==null)throw c("err")("XMA type is null in forward msg");return babelHelpers["extends"]({},b,{type:d("MAWMsgType").MSG_TYPE.XMA,xmaMessageType:f});default:throw c("err")("Should not be forwarding a message of type: "+a)}}function i(a,b,e,f,g,h){b=b!=null?a.media.get({mediaId:b}):d("MAWDexieTable").dexieResolve(null);return b.then(function(b){if(b==null&&d("MAWDbMsg").isMediaMsg(e))throw c("err")("Could not find media of forwarded message");return b!=null?d("MAWMediaManagementTxns").linkMedia(a,e,b.plaintextHash,b.mediaType,b.size,b.mediaEntries.get(f.msgId),{validatedAudioInfo:b.validatedAudioInfo,validatedDocumentFileInfo:b.validatedDocumentFileInfo,validatedImageInfo:b.validatedImageInfo,validatedVideoInfo:b.validatedVideoInfo},null,null,!1).then(function(a){a!=null&&d("MAWIndexedDb").afterTransaction({tag:"NewMedia",value:d("MAWBridgeTypesCreators").createBridgeMedia(g,h,a,!0)})}):d("MAWDexieTable").dexieResolve()})}function j(a,b,e,f,g,h){return!d("MAWXMAUtils").isXMAShare(f.xmaMessageType)?d("MAWDexieTable").dexieResolve():d("MAWDbXMATxns").maybeGetXMAFromProtocolMsgId(a,b).then(function(b){if(b==null)return;var i=b.defaultPreviewMediaId,j=b.faviconMediaId,k=b.headerMediaId,l=Array.from(new Set([i,j,k].filter(Boolean)));l=l.map(function(b){return a.media.get(b).then(function(a){if(a==null)throw c("err")("Could not find media of forwarded xma message");return a})});return d("MAWDexieTable").dexieAll(l).then(function(l){l=l.map(function(b){return d("MAWMediaManagementTxns").linkMedia(a,e,b.plaintextHash,b.mediaType,b.size,b.mediaEntries.get(f.msgId),{validatedAudioInfo:b.validatedAudioInfo,validatedDocumentFileInfo:null,validatedImageInfo:b.validatedImageInfo,validatedVideoInfo:b.validatedVideoInfo},void 0,void 0,!0)});return d("MAWDexieTable").dexieAll(l).then(function(l){l=l.reduce(function(a,b){return a.set(b.mediaId,b)},new Map());var m=i==null?void 0:l.get(i);if(i==null&&!d("MAWXMAUtils").isXMAExternalLinkShare(f.xmaMessageType))throw c("err")("Preview Media is missing");l=d("MAWJidUtils").maybeToProtocolMsgId(e.author,h,e.externalId);if(l==null)throw c("err")("ProtocolMsgId is null for forward XMA Share");return d("MAWXMAManagementTxns").saveXMA(a,i,k,j,b.targetType,e.msgId,void 0,l,{defaultCTA:b.defaultCTA,headerTitle:b.headerTitle,maxSubtitleNumOfLines:b.maxSubtitleNumOfLines,maxTitleNumOfLines:b.maxTitleNumOfLines,overlayDescription:b.overlayDescription,overlayIconGlyph:b.overlayIconGlyph,overlayTitle:b.overlayTitle,subtitleText:b.subtitleText,targetExpiringAtSec:b.targetExpiringAtSec,targetId:b.targetId,targetUsername:b.targetUsername,titleText:b.titleText,xmaLayoutType:b.xmaLayoutType}).then(function(a){d("MAWIndexedDb").afterTransaction({tag:"NewXMA",value:d("MAWBridgeXMA").createBridgeXMA(g,m,a)})})})})})}g.writeForwardedMsg=b}),98);
__d("MAWForwardMsg",["MAWGlobals","MAWJobDefinitions","MAWQplProxy","MAWSendMsg","MAWWriteForwardedMsgApi","MWQPLMarkers","WAGlobals","WAJobOrchestratorTypes","WALogger","asyncToGeneratorRuntime","qpl"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["forwardMsg cannot forward an ephemeral message"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["forwardMsg cannot forward a non-existent message"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["forwardMsg cannot send to a non-existent thread"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["forwardMsg already sent message"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["forwardMsg: ",""]);l=function(){return a};return a}var m=function(a){return function(b){if(a==null)return;d("MAWQplProxy").sendQplPointThroughBridge(c("qpl")._(25313175,"1551"),b,{instanceKey:a})}};a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("saveAndPassOff",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=a.chatJid,f=a.ephemeralSetting,g=a.externalId;a=a.protocolMsgId;b=b.args;d("WALogger").DEV(l(),e);var n=m(b==null?void 0:b.s2sInstanceKey);yield d("MAWSendMsg").maybeGetDevicesBeforeSend(e);g=(yield d("MAWWriteForwardedMsgApi").writeForwardedMsg(g,e,a,c.jobStartTime,f));if(g.type==="already_sent"){d("WALogger").LOG(k());return}else if(g.type==="missing_thread"){d("WALogger").LOG(j());return}else if(g.type==="missing_msg"){d("WALogger").LOG(i());return}else if(g.type==="forwarding_ephemeral_msg"){d("WALogger").LOG(h());return}n(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.FORWARDED_MESSAGE_WRITTEN);yield d("MAWGlobals").getJobManager().waitUntilPersisted(d("MAWJobDefinitions").createStartJobInfo("sendWrittenMsg",{gotDevicesBeforeSending:d("WAGlobals").getConfig().getDevicesBeforeSend(),protocolMsgId:g.protocolMsgId,s2sInstanceKey:b==null?void 0:b.s2sInstanceKey,scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION},type:"message"}))});return function(b,c,d){return a.apply(this,arguments)}}()).end();g.forwardMsg=a}),98);
__d("MAWGetSpams",["MAWGlobals","WADeprecatedSendIq","WADeprecatedWapParser","WALogger","WAPersistedJobManager","WATimeUtils","WAWap","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["getSpams result: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["getSpams called"]);i=function(){return a};return a}var j=new(c("WADeprecatedWapParser"))("getSpamsResponse",function(a){a.assertTag("iq"),a.assertFromServer(),a.assertAttr("type","result")});a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("getSpams",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a;d("WALogger").LOG(i());a=(a=d("WAWap")).wap("iq",{id:a.generateId(),to:a.S_WHATSAPP_NET,type:"get",xmlns:"fbid:thread"},a.wap("spam_request",null));a=(yield d("WADeprecatedSendIq").deprecatedSendIq(a,j));d("WALogger").LOG(h(),a);if(!a.success){a=a.errorCode.toString().startsWith("5");if(a)throw new(d("WAPersistedJobManager").RetryOnBackoff)({algo:{first:d("WATimeUtils").HOUR_MILLISECONDS/60,type:"exponential"},jitter:.1});return!1}return!0})).end();g.getSpams=a}),98);
__d("MAWConvertFutureproofMsgTxns",["MAWBridgeMsg","MAWBridgeTypesCreators","MAWDbMsg","MAWDbThreadTxns","MAWDexieTable","MAWIndexedDb","MAWLoadReplyMediaTxns","MAWMediaManagementTxns","MAWMsgType","MAWThreadEvent","MAWThreadSnippetBuildTxns","WAArrayZip","WAJids","err"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,c){return a.type===d("MAWMsgType").MSG_TYPE.REVOKED?babelHelpers["extends"]({},a,{altIndex:"foobar",msgId:b.msgId,rowId:b.rowId,sortOrderMs:b.sortOrderMs,thread:b.thread,threadJid:c,ts:b.ts}):babelHelpers["extends"]({},a,{msgId:b.msgId,rowId:b.rowId,sortOrderMs:b.sortOrderMs,thread:b.thread,threadJid:c,ts:b.ts})}function a(a,b,e,f,g){var i=h(b,e,g.jid);return a.messages.put(i).then(function(){return d("MAWDbThreadTxns").needsRetroactiveReadReceiptInThread(a,i)}).then(function(b){if(b){i.altIndex=d("MAWDbMsg").craftToBeReadAltIndex(i.thread);return a.messages.put(i)}}).then(function(){return d("MAWLoadReplyMediaTxns").getReplyMediaForMsgQuote(a,i)}).then(function(b){d("MAWIndexedDb").afterTransaction({tag:"MsgUpdated",value:d("MAWBridgeMsg").createBridgeMsg(i,void 0,b)});d("MAWIndexedDb").afterTransactionThreadEvent({chatJid:g.jid,msgId:i.msgId},d("MAWThreadEvent").PLACEHOLDER_CONVERT_SUBSCRIPTION);b=i.msgId===g.newestMsg?d("MAWThreadSnippetBuildTxns").buildThreadSnippet(a,i,g).then(function(a){var b=a.snippetParams,c=a.snippetSenderContactId;a=a.snippetType;d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread({snippetParams:b,snippetSenderContactId:c,snippetType:a,threadId:g.chatId,threadJid:g.jid})})}):d("MAWDexieTable").dexieResolve();var e=f!=null?d("MAWMediaManagementTxns").handleUnstoredDbMedia(a,f,i).then(function(a){if(d("WAJids").isAuthorSystem(i.author))throw c("err")("This cannot happen");return{plaintextHash:a.plaintextHash,protocolMsgId:{author:i.author,chat:g.jid,externalId:i.externalId}}}):d("MAWDexieTable").dexieResolve(null);return d("MAWDexieTable").dexieAll([b,e]).then(function(a){a[0];a=a[1];return a})})}function b(a,b){var e=[];b.forEach(function(a){e.push(h(a.unstoredDbMsg,a.dbMsg,a.thread.jid))});var f=d("MAWDbThreadTxns").bulkNeedsRetroactiveReadReceiptInThread(a,e).then(function(a){d("WAArrayZip").zip(e,a).forEach(function(a){var b=a[0];a=a[1];a&&(b.altIndex=d("MAWDbMsg").craftToBeReadAltIndex(b.thread))})});return f.then(function(){return a.messages.bulkPut(e).then(function(){var f=[];e.forEach(function(e){var g=d("MAWLoadReplyMediaTxns").getReplyMediaForMsgQuote(a,e).then(function(f){d("MAWIndexedDb").afterTransaction({tag:"MsgUpdated",value:d("MAWBridgeMsg").createBridgeMsg(e,void 0,f)});var g=(f=b.get(e.msgId))==null?void 0:f.thread;f=(f=b.get(e.msgId))==null?void 0:f.unstoredDbMedia;if(g==null)throw c("err")("MAWConvertFutureproofMsgTxns: thread is null cannot happen");d("MAWIndexedDb").afterTransactionThreadEvent({chatJid:g.jid,msgId:e.msgId},d("MAWThreadEvent").PLACEHOLDER_CONVERT_SUBSCRIPTION);var h=e.msgId===g.newestMsg?d("MAWThreadSnippetBuildTxns").buildThreadSnippet(a,e,g).then(function(a){var b=a.snippetParams,c=a.snippetSenderContactId;a=a.snippetType;d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread({snippetParams:b,snippetSenderContactId:c,snippetType:a,threadId:g.chatId,threadJid:g.jid})})}):d("MAWDexieTable").dexieResolve();f=f!=null?d("MAWMediaManagementTxns").handleUnstoredDbMedia(a,f,e).then(function(a){if(d("WAJids").isAuthorSystem(e.author))throw c("err")("This cannot happen");return{plaintextHash:a.plaintextHash,protocolMsgId:{author:e.author,chat:g.jid,externalId:e.externalId}}}):d("MAWDexieTable").dexieResolve(null);return d("MAWDexieTable").dexieAll([h,f]).then(function(a){a[0];a=a[1];return a})});f.push(g)});return d("MAWDexieTable").dexieAll(f).then(function(a){return a.map(function(a){return a})})})})}g.convertFutureproofMsg=a;g.bulkConvertFutureproofMsgs=b}),98);
__d("MAWProcessFutureproofMsgApi",["MAWConvertFutureproofMsgTxns","MAWDbMsgTxns","MAWDbMsgTypeVersionTxns","MAWDbThreadTxns","MAWDexieTable","MAWIndexedDb","MAWMsgType","MAWTransactionMode","MAWUnstoredContentToUnstoredDbContentUtils","WAArrayZip","WADecodeIncomingMsg","WAJids","WALogger","WAParseV3Protocol"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["processFutureProofMsgs doesn't support system message for ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["processFutureProofMsgs called for instamadillo"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["processFutureProofMsgs called for ephemeral setting msg"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["processFutureProofMsgs called for skdm"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["processFutureProofMsgs tried to decode non plaintext v3 message ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["processFutureProofMsgs get a futureproof message for ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["processFutureProofMsgs got error for message ",", delete this message"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["processFutureProofMsgs thread for "," no longer exists"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["processFutureProofMsgs get a futureproof message for ",""]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["processFutureProofMsgs got error for message ",", delete this message"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["processFutureProofMsgs thread for "," no longer exists"]);r=function(){return a};return a}var s=d("WAParseV3Protocol").createV3ProtocolParser();b=d("MAWIndexedDb").makeMsgrTransactor({appMeta:(a=d("MAWTransactionMode")).READWRITE,chunk:a.READONLY,groupInfo:a.READONLY,media:a.READWRITE,mediaBackup:a.READWRITE,messages:a.READWRITE,threads:a.READWRITE,xma:a.READONLY},"processFutureProofMsgs",function(a){return function(b){return d("MAWDbMsgTypeVersionTxns").getMsgTypeVersion(a).then(function(c){var e=[];if(c!=null&&c<b){d("MAWDbMsgTypeVersionTxns").updateMsgTypeVersion(a,b);return d("MAWDbMsgTxns").getFutureProofMsgs(a).then(function(b){return d("MAWDexieTable").dexieAll(b.map(function(b){return d("MAWDbThreadTxns").getThread(a,b.thread).then(function(c){if(!c.success){d("WALogger").WARN(r(),b.thread);return}c=c.value;var f=t(b,c.jid);if(!f||d("WAJids").isAuthorSystem(f.author))return;if(f.msg.type==="error"){d("WALogger").WARN(q(),b.msgId);return d("MAWDbMsgTxns").deleteDbMsg(a,b.rowId).then(function(){})}f=s(f.msg,c.jid,f.externalId,f.author,f.ts);f=d("MAWUnstoredContentToUnstoredDbContentUtils").unstoredContentToUnstoredDbContent(babelHelpers["extends"]({unstoredXMA:null},f));var g=f.unstoredDbMedia;f=f.unstoredDbMsg;if(!f)return;if(f.type===d("MAWMsgType").MSG_TYPE.FUTUREPROOF){d("WALogger").WARN(p(),b.msgId);return}return d("MAWConvertFutureproofMsgTxns").convertFutureproofMsg(a,f,b,g,c).then(function(a){a!=null&&e.push(a)})})}))}).then(function(){return e})}else if(c==null)return d("MAWDbMsgTypeVersionTxns").addMsgTypeVersion(a,1).then(function(){return e});return e})}});c=d("MAWIndexedDb").makeMsgrTransactor({appMeta:a.READWRITE,chunk:a.READONLY,deletedMessages:a.READWRITE,groupInfo:a.READONLY,media:a.READWRITE,mediaBackup:a.READWRITE,messages:a.READWRITE,threads:a.READWRITE,xma:a.READONLY},"bulkProcessFutureProofMsgs",function(a){return function(b){return d("MAWDbMsgTypeVersionTxns").getMsgTypeVersion(a).then(function(c){if(c!=null&&c<b){d("MAWDbMsgTypeVersionTxns").updateMsgTypeVersion(a,b);var e=[],f=new Map();return d("MAWDbMsgTxns").getFutureProofMsgs(a).then(function(b){return d("MAWDbThreadTxns").getThreads(a,b.map(function(a){return a.thread})).then(function(a){d("WAArrayZip").zip(b,a).forEach(function(a){var b=a[0];a=a[1];if(a==null){d("WALogger").WARN(o(),b.thread);return}var c=t(b,a.jid);if(!c||d("WAJids").isAuthorSystem(c.author))return;if(c.msg.type==="error")d("WALogger").WARN(n(),b.msgId),e.push(b);else{c=s(c.msg,a.jid,c.externalId,c.author,c.ts);c=d("MAWUnstoredContentToUnstoredDbContentUtils").unstoredContentToUnstoredDbContent(babelHelpers["extends"]({unstoredXMA:null},c));var g=c.unstoredDbMedia;c=c.unstoredDbMsg;if(!c)return;if(c.type===d("MAWMsgType").MSG_TYPE.FUTUREPROOF){d("WALogger").WARN(m(),b.msgId);return}f.set(b.msgId,{dbMsg:b,thread:a,unstoredDbMedia:g,unstoredDbMsg:c})}})}).then(function(){return d("MAWDexieTable").dexieAll([d("MAWDbMsgTxns").deleteMessages(a,e),d("MAWConvertFutureproofMsgTxns").bulkConvertFutureproofMsgs(a,f)]).then(function(a){a[0];a=a[1];return a.filter(Boolean)})})})}else if(c==null)return d("MAWDbMsgTypeVersionTxns").addMsgTypeVersion(a,1).then(function(){return[]});return[]})}});function t(a,b){var c=d("WADecodeIncomingMsg").decodeIncomingMsg(new Uint8Array(a.msgContent.protobuf),"v3",a.author===d("WAJids").AUTHOR_ME?b:null);if(c.version!=="v3"){d("WALogger").WARN(l(),a.msgId);return null}else if(c.type==="skdm"||c.type==="msgWithSKDM"){d("WALogger").WARN(k());return null}else if(c.type==="ephemeral"){d("WALogger").WARN(j());return null}else if(c.type==="instamadillo"){d("WALogger").WARN(i());return null}var e=a.author;if(d("WAJids").isAuthorSystem(e)){d("WALogger").WARN(h(),a.msgId);return null}return{author:e,chat:b,externalId:a.externalId,msg:c,ts:a.ts}}g.processFutureProofMsgs=b;g.bulkProcessFutureProofMsgs=c}),98);
__d("MAWHandleFutureProofMsg",["MAWGlobals","MAWJobDefinitions","MAWProcessFutureproofMsgApi","Promise","asyncToGeneratorRuntime","promiseDone","qex"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=c("qex")._("401")?yield d("MAWProcessFutureproofMsgApi").bulkProcessFutureProofMsgs(d("MAWGlobals").getConfig().supportedTypesVersion()):yield d("MAWProcessFutureproofMsgApi").processFutureProofMsgs(d("MAWGlobals").getConfig().supportedTypesVersion()),e=[];a.forEach(function(a){e.push(d("MAWGlobals").getJobManager().waitUntilPersisted(d("MAWJobDefinitions").jobSerializers.downloadAndHandleMedia(a.protocolMsgId,a.plaintextHash,"MAWHandleFutureproofMsg")))});c("promiseDone")((h||(h=b("Promise"))).all(e))});return function(){return a.apply(this,arguments)}}();e=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("checkMessageTypeUpdateAndHandleMsg",a).end();g.handleFutureproofMsg=e}),98);
__d("MAWHandleSpamMsg",["MAWGlobals","WALogger","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleSpamMsg processed spam msgs"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleSpamMsg starts processing spam msgs"]);i=function(){return a};return a}a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("updateAndHandleMsg",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WALogger").DEV(i()),yield d("MAWGlobals").getDbImpls().processSpamMsgs(),d("WALogger").DEV(h())})).end();g.handleSpamMsg=a}),98);
__d("MAWLeaveGroupsApi",["MAWDbGroupInfoTxns","MAWDbParticipantTxns","MAWDbPersonalSenderKeyStatusTxns","MAWDbThreadTxns","MAWDexieTable","MAWGlobals","MAWIndexedDb","MAWTransactionMode"],(function(a,b,c,d,e,f,g){"use strict";b=d("MAWIndexedDb").makeMsgrAndSignalTransactor({groupInfo:(a=d("MAWTransactionMode")).READONLY,participants:a.READWRITE,personalSenderKeyStatuses:a.READWRITE,threads:a.READWRITE},"leaveGroups",function(a){return function(){for(var b=arguments.length,c=new Array(b),d=0;d<b;d++)c[d]=arguments[d];return h.apply(void 0,[a].concat(c))}});function h(a,b){var c=b.groupJids;return d("MAWDbGroupInfoTxns").getGroupInfos(a,c).then(function(b){b=b.filter(Boolean);b=b.map(function(a){return a.threadId});var e=d("MAWGlobals").getMyUserJid();return d("MAWDexieTable").dexieAll([d("MAWDbParticipantTxns").bulkDeleteParticipantAcrossThreads(a,c,e),d("MAWDbThreadTxns").archiveThreads(a,b,!0),d("MAWDbPersonalSenderKeyStatusTxns").bulkDeletePersonalSenderKeyStatus(a,c)]).then(function(){})})}g.leaveGroups=b}),98);
__d("WASmaxInGroupsLeaveClientErrors",["WAResultOrError","WASmaxInGroupsIQErrorBadRequestMixin","WASmaxInGroupsIQErrorFallbackClientMixin","WASmaxInGroupsIQErrorForbiddenMixin","WASmaxInGroupsIQErrorItemNotFoundMixin","WASmaxInGroupsIQErrorLockedMixin","WASmaxInGroupsIQErrorNotAuthorizedMixin","WASmaxInGroupsIQErrorRateOverlimitMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsIQErrorRateOverlimitMixin").parseIQErrorRateOverlimitMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorRateOverlimit",value:b.value});var c=d("WASmaxInGroupsIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:c.value});var e=d("WASmaxInGroupsIQErrorItemNotFoundMixin").parseIQErrorItemNotFoundMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"IQErrorItemNotFound",value:e.value});var f=d("WASmaxInGroupsIQErrorNotAuthorizedMixin").parseIQErrorNotAuthorizedMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"IQErrorNotAuthorized",value:f.value});var g=d("WASmaxInGroupsIQErrorForbiddenMixin").parseIQErrorForbiddenMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"IQErrorForbidden",value:g.value});var h=d("WASmaxInGroupsIQErrorLockedMixin").parseIQErrorLockedMixin(a);if(h.success)return d("WAResultOrError").makeResult({name:"IQErrorLocked",value:h.value});var i=d("WASmaxInGroupsIQErrorFallbackClientMixin").parseIQErrorFallbackClientMixin(a);return i.success?d("WAResultOrError").makeResult({name:"IQErrorFallbackClient",value:i.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorRateOverlimit","IQErrorBadRequest","IQErrorItemNotFound","IQErrorNotAuthorized","IQErrorForbidden","IQErrorLocked","IQErrorFallbackClient"],[b,c,e,f,g,h,i])}g.parseLeaveClientErrors=a}),98);
__d("WASmaxInGroupsLeaveResponseClientError",["WAResultOrError","WASmaxInGroupsIQErrorResponseMixin","WASmaxInGroupsLeaveClientErrors","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInGroupsIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInGroupsLeaveClientErrors").parseLeaveClientErrors(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorLeaveClientErrors:b.value}))}g.parseLeaveResponseClientError=a}),98);
__d("WASmaxInGroupsLeaveResponseServerError",["WASmaxInGroupsBaseServerErrorMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxInGroupsBaseServerErrorMixin").parseBaseServerErrorMixin(a,b);return!c.success?c:c}g.parseLeaveResponseServerError=a}),98);
__d("WASmaxInGroupsLeaveGroupNotAllowedMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"group");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"error","405");return!b.success?b:d("WAResultOrError").makeResult({error:b.value})}g.parseLeaveGroupNotAllowedMixin=a}),98);
__d("WASmaxInGroupsLeaveGroupServerErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"group");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"error","500");return!b.success?b:d("WAResultOrError").makeResult({error:b.value})}g.parseLeaveGroupServerErrorMixin=a}),98);
__d("WASmaxInGroupsLeaveGroupNotAllowedOrServerErrorMixinGroup",["WAResultOrError","WASmaxInGroupsLeaveGroupNotAllowedMixin","WASmaxInGroupsLeaveGroupServerErrorMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsLeaveGroupNotAllowedMixin").parseLeaveGroupNotAllowedMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"LeaveGroupNotAllowed",value:b.value});var c=d("WASmaxInGroupsLeaveGroupServerErrorMixin").parseLeaveGroupServerErrorMixin(a);return c.success?d("WAResultOrError").makeResult({name:"LeaveGroupServerError",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["LeaveGroupNotAllowed","LeaveGroupServerError"],[b,c])}g.parseLeaveGroupNotAllowedOrServerErrorMixinGroup=a}),98);
__d("WASmaxInGroupsLeaveLinkedGroupsBadRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"linked_groups");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"error","400");return!b.success?b:d("WAResultOrError").makeResult({error:b.value})}g.parseLeaveLinkedGroupsBadRequestMixin=a}),98);
__d("WASmaxInGroupsLeaveLinkedGroupsNotAllowedMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"linked_groups");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"error","405");return!b.success?b:d("WAResultOrError").makeResult({error:b.value})}g.parseLeaveLinkedGroupsNotAllowedMixin=a}),98);
__d("WASmaxInGroupsLeaveLinkedGroupsServerErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"linked_groups");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"error","500");return!b.success?b:d("WAResultOrError").makeResult({error:b.value})}g.parseLeaveLinkedGroupsServerErrorMixin=a}),98);
__d("WASmaxInGroupsLeaveLinkedGroupsBadRequestOrNotAllowedOrServerErrorMixinGroup",["WAResultOrError","WASmaxInGroupsLeaveLinkedGroupsBadRequestMixin","WASmaxInGroupsLeaveLinkedGroupsNotAllowedMixin","WASmaxInGroupsLeaveLinkedGroupsServerErrorMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsLeaveLinkedGroupsBadRequestMixin").parseLeaveLinkedGroupsBadRequestMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"LeaveLinkedGroupsBadRequest",value:b.value});var c=d("WASmaxInGroupsLeaveLinkedGroupsNotAllowedMixin").parseLeaveLinkedGroupsNotAllowedMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"LeaveLinkedGroupsNotAllowed",value:c.value});var e=d("WASmaxInGroupsLeaveLinkedGroupsServerErrorMixin").parseLeaveLinkedGroupsServerErrorMixin(a);return e.success?d("WAResultOrError").makeResult({name:"LeaveLinkedGroupsServerError",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["LeaveLinkedGroupsBadRequest","LeaveLinkedGroupsNotAllowed","LeaveLinkedGroupsServerError"],[b,c,e])}g.parseLeaveLinkedGroupsBadRequestOrNotAllowedOrServerErrorMixinGroup=a}),98);
__d("WASmaxInGroupsParentGroupMixin",["WAResultOrError","WASmaxParseJid"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseJid").attrGroupJid(a,"parent_group_jid");return!a.success?a:d("WAResultOrError").makeResult({parentGroupJid:a.value})}g.parseParentGroupMixin=a}),98);
__d("WASmaxInGroupsLeaveResponseSuccess",["WAResultOrError","WASmaxInGroupsIQResultResponseMixin","WASmaxInGroupsLeaveGroupNotAllowedOrServerErrorMixinGroup","WASmaxInGroupsLeaveLinkedGroupsBadRequestOrNotAllowedOrServerErrorMixinGroup","WASmaxInGroupsParentGroupMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"group");if(!b.success)return b;b=d("WASmaxParseJid").attrGroupJid(a,"id");if(!b.success)return b;a=d("WASmaxInGroupsLeaveGroupNotAllowedOrServerErrorMixinGroup").parseLeaveGroupNotAllowedOrServerErrorMixinGroup(a);return d("WAResultOrError").makeResult({id:b.value,leaveGroupNotAllowedOrServerErrorMixinGroup:a.success?a.value:null})}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"linked_groups");if(!b.success)return b;b=d("WASmaxInGroupsParentGroupMixin").parseParentGroupMixin(a);if(!b.success)return b;a=d("WASmaxInGroupsLeaveLinkedGroupsBadRequestOrNotAllowedOrServerErrorMixinGroup").parseLeaveLinkedGroupsBadRequestOrNotAllowedOrServerErrorMixinGroup(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{leaveLinkedGroupsBadRequestOrNotAllowedOrServerErrorMixinGroup:a.success?a.value:null}))}function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"leave");if(!c.success)return c;a=d("WASmaxInGroupsIQResultResponseMixin").parseIQResultResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxParseUtils").mapChildrenWithTag(c.value,"group",0,1024,h);if(!b.success)return b;c=d("WASmaxParseUtils").mapChildrenWithTag(c.value,"linked_groups",0,1024,i);return!c.success?c:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{leaveGroup:b.value,leaveLinkedGroups:c.value}))}g.parseLeaveResponseSuccessLeaveGroup=h;g.parseLeaveResponseSuccessLeaveLinkedGroups=i;g.parseLeaveResponseSuccess=a}),98);
__d("WASmaxOutGroupsBaseSetServerMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutGroupsBaseIQSetRequestMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxOutGroupsBaseIQSetRequestMixin").mergeBaseIQSetRequestMixin(d("WASmaxJsx").smax("iq",{to:d("WAWap").G_US,xmlns:"w:g2"}));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBaseSetServerMixin=a}),98);
__d("WASmaxOutGroupsParentGroupMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.anyParentGroupJid;a=d("WASmaxJsx").smax("smax$any",{parent_group_jid:d("WAWap").GROUP_JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeParentGroupMixin=a}),98);
__d("WASmaxOutGroupsLeaveLeaveGroupsRequestMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutGroupsParentGroupMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.groupId;a=d("WASmaxJsx").smax("group",{id:d("WAWap").GROUP_JID(a)});return a}function i(a){a=d("WASmaxOutGroupsParentGroupMixin").mergeParentGroupMixin(d("WASmaxJsx").smax("linked_groups",null),a);return a}function j(a){var b=a.groupArgs;a=a.linkedGroupsArgs;b=d("WASmaxJsx").smax("leave",null,[].concat(d("WASmaxChildren").REPEATED_CHILD(h,b,1,1024),d("WASmaxChildren").REPEATED_CHILD(i,a,0,1024)));return b}function a(a,b){b=j(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeLeaveLeaveGroupsRequestGroup=h;g.makeLeaveLeaveGroupsRequestLinkedGroups=i;g.mergeLeaveLeaveGroupsRequestMixin=a}),98);
__d("WASmaxOutGroupsLeaveLeaveLinkedGroupsRequestMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutGroupsParentGroupMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.groupId;a=d("WASmaxJsx").smax("group",{id:d("WAWap").GROUP_JID(a)});return a}function i(a){a=d("WASmaxOutGroupsParentGroupMixin").mergeParentGroupMixin(d("WASmaxJsx").smax("linked_groups",null),a);return a}function j(a){var b=a.groupArgs;a=a.linkedGroupsArgs;b=d("WASmaxJsx").smax("leave",null,[].concat(d("WASmaxChildren").REPEATED_CHILD(h,b,0,1024),d("WASmaxChildren").REPEATED_CHILD(i,a,1,1024)));return b}function a(a,b){b=j(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeLeaveLeaveLinkedGroupsRequestGroup=h;g.makeLeaveLeaveLinkedGroupsRequestLinkedGroups=i;g.mergeLeaveLeaveLinkedGroupsRequestMixin=a}),98);
__d("WASmaxOutGroupsLeaveLeaveLinkedOrLeaveGroupsRequestMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutGroupsLeaveLeaveGroupsRequestMixin","WASmaxOutGroupsLeaveLeaveLinkedGroupsRequestMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.leaveLeaveLinkedGroupsRequest)return d("WASmaxOutGroupsLeaveLeaveLinkedGroupsRequestMixin").mergeLeaveLeaveLinkedGroupsRequestMixin(a,b.leaveLeaveLinkedGroupsRequest);if(b.leaveLeaveGroupsRequest)return d("WASmaxOutGroupsLeaveLeaveGroupsRequestMixin").mergeLeaveLeaveGroupsRequestMixin(a,b.leaveLeaveGroupsRequest);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeLeaveLeaveLinkedOrLeaveGroupsRequestMixinGroup=a}),98);
__d("WASmaxOutGroupsLeaveRequest",["WASmaxJsx","WASmaxOutGroupsBaseSetServerMixin","WASmaxOutGroupsLeaveLeaveLinkedOrLeaveGroupsRequestMixinGroup"],(function(a,b,c,d,e,f,g){function a(a){a=a.leaveLeaveLinkedOrLeaveGroupsRequestMixinGroupArgs;a=d("WASmaxOutGroupsBaseSetServerMixin").mergeBaseSetServerMixin(d("WASmaxJsx").smax("iq",null,d("WASmaxOutGroupsLeaveLeaveLinkedOrLeaveGroupsRequestMixinGroup").mergeLeaveLeaveLinkedOrLeaveGroupsRequestMixinGroup(d("WASmaxJsx").smax("leave",null),a)));return a}g.makeLeaveRequest=a}),98);
__d("WASmaxGroupsLeaveRPC",["WAComms","WASmaxInGroupsLeaveResponseClientError","WASmaxInGroupsLeaveResponseServerError","WASmaxInGroupsLeaveResponseSuccess","WASmaxOutGroupsLeaveRequest","WASmaxParsingFailure","WASmaxRpcUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:e=d("WASmaxOutGroupsLeaveRequest").makeLeaveRequest(a);j.next=3;return b("regeneratorRuntime").awrap(d("WAComms").sendSmaxStanza(e,c));case 3:f=j.sent;g=d("WASmaxInGroupsLeaveResponseSuccess").parseLeaveResponseSuccess(f,e);if(!g.success){j.next=7;break}return j.abrupt("return",{name:"LeaveResponseSuccess",value:g.value});case 7:h=d("WASmaxInGroupsLeaveResponseServerError").parseLeaveResponseServerError(f,e);if(!h.success){j.next=10;break}return j.abrupt("return",{name:"LeaveResponseServerError",value:h.value});case 10:i=d("WASmaxInGroupsLeaveResponseClientError").parseLeaveResponseClientError(f,e);if(!i.success){j.next=13;break}return j.abrupt("return",{name:"LeaveResponseClientError",value:i.value});case 13:throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Leave",{Success:g,ServerError:h,ClientError:i}));case 14:case"end":return j.stop()}},null,this)}g.sendLeaveRPC=a}),98);
__d("MAWLeaveGroups",["MAWGlobals","MAWLeaveGroupsApi","MAWODSProxy","WAOdsEnums","WASmaxGroupsLeaveRPC","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.groups;if(a.length===0)return;a=(yield d("WASmaxGroupsLeaveRPC").sendLeaveRPC({leaveLeaveLinkedOrLeaveGroupsRequestMixinGroupArgs:{leaveLeaveGroupsRequest:{groupArgs:a.map(function(a){return{groupId:a}})}}}));if(a.name!=="LeaveResponseSuccess"){d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.GROUP_LEAVE_PARTICIPANT,key:"fail"});throw c("err")("Failed to parse leaveGroups response")}d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.GROUP_LEAVE_PARTICIPANT,key:"success"});a=a.value;yield d("MAWLeaveGroupsApi").leaveGroups({groupJids:a.leaveGroup.map(function(a){return a.id})})});return i.apply(this,arguments)}a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("leaveGroups",function(a){a=a.groups;return h({groups:a})}).end();g.leaveGroupsStep=h;g.leaveGroups=a}),98);
__d("MAWMarkThreadAsRead",["MAWDbMsgTxns","MAWEphemeralGatingUtil","MAWGetUnreadMsgsApi","MAWGetUnreadMsgsApi__DONOTUSE","MAWGlobals","MAWMarkReadReceiptsSentUpToApi","MAWMarkThreadAsReadUpToApi","MAWMessageRequestUtils","MAWUpdateEphemeralityOnMarkMsgsFromOtherAsReadApi","Promise","WADeprecatedSendIq","WAJids","WALogger","WAPromiseQueue","WAWap","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["markThreadAsRead skips sending receipts for ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["markThreadAsRead skips sending receipts for ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["markThreadAsRead skips sending receipts for ",""]);k=function(){return a};return a}var l=256,m=new(d("WAPromiseQueue").PromiseQueueMap)();a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("markThreadAsRead",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){var f=a.chatJid;c=a.isReadReceiptsDisabled;var g=c===void 0?!1:c;c=a.relationship;a=a.upTo;var h=e.interruptJob,o=e.jobStartTime;e=(yield d("MAWMarkThreadAsReadUpToApi").markThreadAsReadUpTo(f,a));if(c!=null&&d("MAWMessageRequestUtils").isInboxRequest(e.folder,c)){d("WALogger").DEV(k(),f);return h()}if(e.type==="missing"){d("WALogger").DEV(j(),f);return h()}if(!e.isReadReceiptExpectedToBeSent){d("WALogger").DEV(i(),f);return h()}e.type;return m.enqueue(String(f),b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=!0;while(a){var b=d("MAWDbMsgTxns").IS_SORT_ORDER_COMPARISON_ENABLED?yield d("MAWGetUnreadMsgsApi").getUnreadMsgs(f,l,g):yield d("MAWGetUnreadMsgsApi__DONOTUSE").getUnreadMsgs__DONOTUSE(f,l,g);if(b.type!=="found"){b.type;break}var c=b.loadedUpTo,e=b.unreadMsgs;yield n(e,o);d("MAWEphemeralGatingUtil").isSendBasedDisappearingMessageEnabled()||(yield d("MAWUpdateEphemeralityOnMarkMsgsFromOtherAsReadApi").updateEphemeralityOnMarkMsgsFromOtherAsRead(e,o));yield d("MAWMarkReadReceiptsSentUpToApi").markReadReceiptsSentUpTo(f,c);a=b.maybeMore}}))});return function(b,c,d){return a.apply(this,arguments)}}()).end();function n(a,e){if(a.length===0)return(h||(h=b("Promise"))).resolve();var f=a[0].chat;return d("WAJids").switchOnChatJidType(f,{group:function(c){var g=d("WAWap").GROUP_JID(c),i=new Map();a.forEach(function(a){var b=a.author,c=i.get(b)||[];c.push(a.externalId);i.set(b,c)});var j=[];i.forEach(function(a,b){j.push(o(g,f,a,b,e))});return(h||(h=b("Promise"))).all(j)},interopUser:function(a){throw c("err")("InteropUserJid is not supported yet")},lidUser:function(a){throw c("err")("LidUserJid is not supported yet")},msgrUser:function(b){b=d("WAWap").USER_JID(b);var c=a.map(function(a){return a.externalId});return o(b,f,c,null,e)},phoneUser:function(a){throw c("err")("PhoneUserJid is not supported yet")}}).then(function(){})}function o(a,b,c,e,f){var g=null;c.length>1&&(g=d("WAWap").wap("list",null,c.slice(1).map(function(a){return d("WAWap").wap("item",{id:d("WAWap").CUSTOM_STRING(a)})})));c=c[0];f=d("WAWap").wap("receipt",{id:d("WAWap").CUSTOM_STRING(c),participant:e!=null?d("WAWap").USER_JID(e):d("WAWap").DROP_ATTR,t:d("WAWap").CUSTOM_STRING(String(f)),to:a,type:"read"},g);return d("WADeprecatedSendIq").deprecatedSendStanzaAndWaitForAck(f,{"class":"receipt",from:b,id:c,participant:e!=null?d("WAJids").defaultDeviceJidForUser(e):null,type:"read"})}g.markThreadAsRead=a}),98);
__d("MAWPromoteGroupParticipants",["MAWGlobals","MAWODSProxy","WAChangeGroupParticipantAdminStatusApi","WAGlobals","WAJids","WAOdsEnums","WAPromoteDemoteGroupParticipantProtocol","WAResultOrError","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("promoteGroupParticipants",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.group;a=a.users;var c=d("WAGlobals").getJidUtilsApi(),e=c.toUserJid;c=a.map(function(a){return e(a)});if(c.length===0)return d("WAResultOrError").makeResult({groupJid:b,participants:[],type:"default"});a=(yield d("WAPromoteDemoteGroupParticipantProtocol").promoteGroupParticipantsProtocol({group:b,participants:c}));if(!a.success){d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.GROUP_PROMOTE_PARTICIPANT,key:"fail"});return d("WAResultOrError").makeError(a.error.type)}d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.GROUP_PROMOTE_PARTICIPANT,key:"success"});c=a.value.participants.filter(function(a){a=a.result;return a.success}).map(function(a){a=a.user;return{addressable:!0,type:"participant",user:a}})||[];yield d("WAChangeGroupParticipantAdminStatusApi").changeGroupParticipantAdminStatus(null,b,d("WAJids").AUTHOR_ME,c,"admin");a=(yield d("MAWGlobals").getJobResultConvertersImpls().convertPromoteGroupParticipantsResult==null?void 0:d("MAWGlobals").getJobResultConvertersImpls().convertPromoteGroupParticipantsResult(b,c));return a?d("WAResultOrError").makeResult(a):d("WAResultOrError").makeResult({groupJid:b,participants:c,type:"default"})});return function(b){return a.apply(this,arguments)}}()).end();g.promoteGroupParticipants=a}),98);
__d("WASmaxInGroupsIQErrorPayloadTooLargeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","payload-too-large");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",413);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorPayloadTooLargeMixin=a}),98);
__d("WASmaxInGroupsRemoveParticipantsClientErrors",["WAResultOrError","WASmaxInGroupsIQErrorBadRequestMixin","WASmaxInGroupsIQErrorFallbackClientMixin","WASmaxInGroupsIQErrorForbiddenMixin","WASmaxInGroupsIQErrorItemNotFoundMixin","WASmaxInGroupsIQErrorLockedMixin","WASmaxInGroupsIQErrorNotAuthorizedMixin","WASmaxInGroupsIQErrorPayloadTooLargeMixin","WASmaxInGroupsIQErrorRateOverlimitMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsIQErrorRateOverlimitMixin").parseIQErrorRateOverlimitMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorRateOverlimit",value:b.value});var c=d("WASmaxInGroupsIQErrorPayloadTooLargeMixin").parseIQErrorPayloadTooLargeMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IQErrorPayloadTooLarge",value:c.value});var e=d("WASmaxInGroupsIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:e.value});var f=d("WASmaxInGroupsIQErrorItemNotFoundMixin").parseIQErrorItemNotFoundMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"IQErrorItemNotFound",value:f.value});var g=d("WASmaxInGroupsIQErrorNotAuthorizedMixin").parseIQErrorNotAuthorizedMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"IQErrorNotAuthorized",value:g.value});var h=d("WASmaxInGroupsIQErrorForbiddenMixin").parseIQErrorForbiddenMixin(a);if(h.success)return d("WAResultOrError").makeResult({name:"IQErrorForbidden",value:h.value});var i=d("WASmaxInGroupsIQErrorLockedMixin").parseIQErrorLockedMixin(a);if(i.success)return d("WAResultOrError").makeResult({name:"IQErrorLocked",value:i.value});var j=d("WASmaxInGroupsIQErrorFallbackClientMixin").parseIQErrorFallbackClientMixin(a);return j.success?d("WAResultOrError").makeResult({name:"IQErrorFallbackClient",value:j.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorRateOverlimit","IQErrorPayloadTooLarge","IQErrorBadRequest","IQErrorItemNotFound","IQErrorNotAuthorized","IQErrorForbidden","IQErrorLocked","IQErrorFallbackClient"],[b,c,e,f,g,h,i,j])}g.parseRemoveParticipantsClientErrors=a}),98);
__d("WASmaxInGroupsRemoveParticipantsResponseClientError",["WAResultOrError","WASmaxInGroupsIQErrorResponseMixin","WASmaxInGroupsRemoveParticipantsClientErrors","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInGroupsIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInGroupsRemoveParticipantsClientErrors").parseRemoveParticipantsClientErrors(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorRemoveParticipantsClientErrors:b.value}))}g.parseRemoveParticipantsResponseClientError=a}),98);
__d("WASmaxInGroupsRemoveParticipantsResponseServerError",["WASmaxInGroupsBaseServerErrorMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxInGroupsBaseServerErrorMixin").parseBaseServerErrorMixin(a,b);return!c.success?c:c}g.parseRemoveParticipantsResponseServerError=a}),98);
__d("WASmaxInGroupsParticipantNotAllowedMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"error","405");return!b.success?b:d("WAResultOrError").makeResult({error:b.value})}g.parseParticipantNotAllowedMixin=a}),98);
__d("WASmaxInGroupsParticipantNotInGroupMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"error","404");return!b.success?b:d("WAResultOrError").makeResult({error:b.value})}g.parseParticipantNotInGroupMixin=a}),98);
__d("WASmaxInGroupsRemoveParticipantsLinkedGroupsServerErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"error","500");return!b.success?b:d("WAResultOrError").makeResult({error:b.value})}g.parseRemoveParticipantsLinkedGroupsServerErrorMixin=a}),98);
__d("WASmaxInGroupsParticipantNotInGroupOrParticipantNotAllowedOrParticipantNotAcceptableOrRemoveParticipantsLinkedGroupsServerErrorMixinGroup",["WAResultOrError","WASmaxInGroupsParticipantNotAcceptableMixin","WASmaxInGroupsParticipantNotAllowedMixin","WASmaxInGroupsParticipantNotInGroupMixin","WASmaxInGroupsRemoveParticipantsLinkedGroupsServerErrorMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsParticipantNotInGroupMixin").parseParticipantNotInGroupMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"ParticipantNotInGroup",value:b.value});var c=d("WASmaxInGroupsParticipantNotAllowedMixin").parseParticipantNotAllowedMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"ParticipantNotAllowed",value:c.value});var e=d("WASmaxInGroupsParticipantNotAcceptableMixin").parseParticipantNotAcceptableMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"ParticipantNotAcceptable",value:e.value});var f=d("WASmaxInGroupsRemoveParticipantsLinkedGroupsServerErrorMixin").parseRemoveParticipantsLinkedGroupsServerErrorMixin(a);return f.success?d("WAResultOrError").makeResult({name:"RemoveParticipantsLinkedGroupsServerError",value:f.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["ParticipantNotInGroup","ParticipantNotAllowed","ParticipantNotAcceptable","RemoveParticipantsLinkedGroupsServerError"],[b,c,e,f])}g.parseParticipantNotInGroupOrParticipantNotAllowedOrParticipantNotAcceptableOrRemoveParticipantsLinkedGroupsServerErrorMixinGroup=a}),98);
__d("WASmaxInGroupsRemoveParticipantsResponseSuccess",["WAResultOrError","WASmaxInGroupsGroupAddressingModeMixin","WASmaxInGroupsParticipantNotInGroupOrParticipantNotAllowedOrParticipantNotAcceptableOrRemoveParticipantsLinkedGroupsServerErrorMixinGroup","WASmaxInGroupsPhoneNumberMixin","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"jid");if(!b.success)return b;var c=d("WASmaxInGroupsPhoneNumberMixin").parsePhoneNumberMixin(a);a=d("WASmaxInGroupsParticipantNotInGroupOrParticipantNotAllowedOrParticipantNotAcceptableOrRemoveParticipantsLinkedGroupsServerErrorMixinGroup").parseParticipantNotInGroupOrParticipantNotAllowedOrParticipantNotAcceptableOrRemoveParticipantsLinkedGroupsServerErrorMixinGroup(a);return d("WAResultOrError").makeResult({jid:b.value,phoneNumberMixin:c.success?c.value:null,participantNotInGroupOrParticipantNotAllowedOrParticipantNotAcceptableOrRemoveParticipantsLinkedGroupsServerErrorMixinGroup:a.success?a.value:null})}function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"remove");if(!c.success)return c;var e=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!e.success)return e;e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",e.value);if(!e.success)return e;e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");if(!e.success)return e;b=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",b.value);if(!b.success)return b;b=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,c.value,"linked_groups","true");if(!b.success)return b;a=d("WASmaxInGroupsGroupAddressingModeMixin").parseGroupAddressingModeMixin(a);c=d("WASmaxParseUtils").mapChildrenWithTag(c.value,"participant",1,1024,h);return!c.success?c:d("WAResultOrError").makeResult({type:e.value,removeLinkedGroups:b.value,groupAddressingModeMixin:a.success?a.value:null,removeParticipant:c.value})}g.parseRemoveParticipantsResponseSuccessRemoveParticipant=h;g.parseRemoveParticipantsResponseSuccess=a}),98);
__d("WASmaxOutGroupsRemoveParticipantsRequest",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxOutGroupsBaseSetGroupMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.participantJid;a=d("WASmaxJsx").smax("participant",{jid:d("WAWap").USER_JID(a)});return a}function a(a){var b=a.participantArgs,c=a.hasRemoveLinkedGroupsTrue;c=d("WASmaxOutGroupsBaseSetGroupMixin").mergeBaseSetGroupMixin(d("WASmaxJsx").smax("iq",null,d("WASmaxJsx").smax("remove",{linked_groups:d("WASmaxAttrs").OPTIONAL_LITERAL("true",c)},d("WASmaxChildren").REPEATED_CHILD(h,b,1,1024))),a);return c}g.makeRemoveParticipantsRequestRemoveParticipant=h;g.makeRemoveParticipantsRequest=a}),98);
__d("WASmaxGroupsRemoveParticipantsRPC",["WAComms","WASmaxInGroupsRemoveParticipantsResponseClientError","WASmaxInGroupsRemoveParticipantsResponseServerError","WASmaxInGroupsRemoveParticipantsResponseSuccess","WASmaxOutGroupsRemoveParticipantsRequest","WASmaxParsingFailure","WASmaxRpcUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:e=d("WASmaxOutGroupsRemoveParticipantsRequest").makeRemoveParticipantsRequest(a);j.next=3;return b("regeneratorRuntime").awrap(d("WAComms").sendSmaxStanza(e,c));case 3:f=j.sent;g=d("WASmaxInGroupsRemoveParticipantsResponseSuccess").parseRemoveParticipantsResponseSuccess(f,e);if(!g.success){j.next=7;break}return j.abrupt("return",{name:"RemoveParticipantsResponseSuccess",value:g.value});case 7:h=d("WASmaxInGroupsRemoveParticipantsResponseClientError").parseRemoveParticipantsResponseClientError(f,e);if(!h.success){j.next=10;break}return j.abrupt("return",{name:"RemoveParticipantsResponseClientError",value:h.value});case 10:i=d("WASmaxInGroupsRemoveParticipantsResponseServerError").parseRemoveParticipantsResponseServerError(f,e);if(!i.success){j.next=13;break}return j.abrupt("return",{name:"RemoveParticipantsResponseServerError",value:i.value});case 13:throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("RemoveParticipants",{Success:g,ClientError:h,ServerError:i}));case 14:case"end":return j.stop()}},null,this)}g.sendRemoveParticipantsRPC=a}),98);
__d("MAWRemoveGroupParticipants",["MAWGlobals","MAWODSProxy","WAGlobals","WAJids","WALogger","WAOdsEnums","WAPREList","WAPREMetrics","WARemoveGroupParticipantsApi","WAResultOrError","WASmaxGroupsRemoveParticipantsRPC","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to remove a participant: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to remove participants: ",""]);i=function(){return a};return a}a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("sendIq",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){b=a.group;c=a.users;var e=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.REMOVE_PARTICIPANTS,{"int":{removedParticipants:c.length}});a=d("WAGlobals").getJidUtilsApi();var f=a.toUserJid;a=c.map(function(a){return f(a)});var g=[];if(a.length>0){c=function(a){d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.GROUP_REMOVE_PARTICIPANT,key:"fail"}),d("WALogger").ERROR(i(),j.name),e.endFail("send_iq_fail "+a)};var j=(yield d("WASmaxGroupsRemoveParticipantsRPC").sendRemoveParticipantsRPC({hasRemoveLinkedGroupsTrue:!1,iqTo:b,participantArgs:a.map(function(a){return{participantJid:a}})}));e.addPoint("finish_send_iq");switch(j.name){case"RemoveParticipantsResponseClientError":a=j.value.errorRemoveParticipantsClientErrors.name;c(a);return d("WAResultOrError").makeError(a);case"RemoveParticipantsResponseServerError":a=j.value.errorServerErrors.name;c(a);return d("WAResultOrError").makeError(a);case"RemoveParticipantsResponseSuccess":d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.GROUP_REMOVE_PARTICIPANT,key:"success"}),j.value.removeParticipant.forEach(function(a){var b=a.jid;a=a.participantNotInGroupOrParticipantNotAllowedOrParticipantNotAcceptableOrRemoveParticipantsLinkedGroupsServerErrorMixinGroup;a==null?g.push({addressable:!0,type:"nonparticipant",user:b}):d("WALogger").ERROR(h(),a.name)})}}e.addPoint("start_remove_participant_txn");yield d("WARemoveGroupParticipantsApi").removeGroupParticipants(null,b,d("WAJids").AUTHOR_ME,g,!0);e.addPoint("finish_remove_participant_txn");c=(yield d("MAWGlobals").getJobResultConvertersImpls().convertRemoveGroupParticipantsResult==null?void 0:d("MAWGlobals").getJobResultConvertersImpls().convertRemoveGroupParticipantsResult(b,g));e.endSuccess();return c?d("WAResultOrError").makeResult(c):d("WAResultOrError").makeResult({groupJid:b,participants:g})});return function(b,c,d){return a.apply(this,arguments)}}()).end();g.removeGroupParticipants=a}),98);
__d("MAWReportUserSpam",["I64","MAWGlobals","MAWJids","MAWSpamReportUtils","WADeprecatedSendIq","WAGetGroupInfo","WAGlobals","WAJids","WAResultOrError","WAWap","asyncToGeneratorRuntime","err","isStringNullOrEmpty"],(function(a,b,c,d,e,f,g){"use strict";var h,i=30;a=["impersonation"];e=["ig_user_impersonation"];var j=Array.of.apply(Array,a.concat(e));f=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("reportUserSpam",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=a.chatJid,f=a.context,g=a.frxParams,h=a.frxTags,k=a.isIgd,o=a.openMsgs,p=a.reportedMessageId,q=a.spamFlow,r=a.userJid;a=(h==null?void 0:h.some(function(a){return j.includes(a)}))===!0;var s=a?[]:yield d("MAWGlobals").getDbImpls().getLastMsgsInChatForSpamReport(e,i);a=null;if(h!=null){if(h.length===0)throw c("err")("spam reasons should not be an empty array");a=d("WAWap").wap("tagset",null,h.map(function(a){return d("WAWap").wap("tag",{value:d("WAWap").CUSTOM_STRING(a)})}))}h=null;c("isStringNullOrEmpty")(g)||(h=d("WAWap").wap("parameters",null,g));g=null;f!=null&&(g=d("WAWap").wap("context",null,f));var t=null;(a!=null||g!=null||h!=null)&&(t=d("WAWap").wap("frx",null,a,g,h));var u=l(o,e,r);f=(yield d("WAJids").switchOnMsgrChatJidType(e,{group:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WAWap").DROP_ATTR,c=d("WAWap").DROP_ATTR,e=(yield d("WAGetGroupInfo").getGroupInfo(a));e!=null&&e.subject!=null&&e.subject.content!=null&&(b=d("WAWap").CUSTOM_STRING(e.subject.content));e!=null&&e.inviter!=null&&(c=d("WAWap").USER_JID(e.inviter));return m(s,a,r,c,b,q,t,u,k,p)});function c(b){return a.apply(this,arguments)}return c}(),user:function(){return n(s,r,q,t,u,k,p)}}));d("WADeprecatedSendIq").deprecatedCastStanza(f);return d("WAResultOrError").makeResult()});return function(b){return a.apply(this,arguments)}}()).end();function k(a,b){var c=a.flat();if(a.length<i){var d;a=i-a.length;if(a<((d=b==null?void 0:b.length)!=null?d:0)){c=[].concat(((d=b)!=null?d:[]).slice(0,a),c)}else{c=[].concat((d=b)!=null?d:[],c)}}return c}function l(a,b,c){return((a=a)!=null?a:[]).map(function(a){var e=d("MAWJids").toUserJid((h||(h=d("I64"))).to_string(a.senderId));if(d("WAJids").interpretAsGroupJid(b)!=null)return d("MAWSpamReportUtils").formatLSDbMsgForSpamReport(a,null,d("MAWJids").toGroupJid(b),e);else{var f=(h||(h=d("I64"))).equal(a.senderId,(h||(h=d("I64"))).of_string(d("MAWJids").userIdFromJid(d("WAGlobals").getMyUserJid())))?c:d("WAGlobals").getMyUserJid();return d("MAWSpamReportUtils").formatLSDbMsgForSpamReport(a,f,null,e)}})}function m(a,b,c,e,f,g,h,i,j,l){a=a.map(function(a){return d("MAWSpamReportUtils").getformattedMsgsForSpamReport(a.msg,a.mediaInfo,a.editHistory,null,b,d("MAWSpamReportUtils").getAuthorAsJidForSpam(a.msg),j,l!=null&&((a=a.msg)==null?void 0:a.msgId)===l)});a=k(a,i);return(i=d("WAWap")).wap("iq",{id:i.generateId(),to:i.S_WHATSAPP_NET,type:"set",xmlns:"spam"},i.wap("spam_list",{jid:i.GROUP_JID(b),reportee:i.USER_JID(c),source:e,spam_flow:i.CUSTOM_STRING(g),subject:f},a),h)}function n(a,b,c,e,f,g,h){a=a.map(function(a){return d("MAWSpamReportUtils").getformattedMsgsForSpamReport(a.msg,a.mediaInfo,a.editHistory,d("MAWSpamReportUtils").getRecipientAsJidForSpam(a.msg,b),null,d("MAWSpamReportUtils").getAuthorAsJidForSpam(a.msg),g,h!=null&&((a=a.msg)==null?void 0:a.msgId)===h)}).filter(function(a){return a!=null});a=k(a,f);return(f=d("WAWap")).wap("iq",{id:f.generateId(),to:f.S_WHATSAPP_NET,type:"set",xmlns:"spam"},f.wap("spam_list",{jid:f.USER_JID(b),reportee:f.USER_JID(b),spam_flow:f.CUSTOM_STRING(c)},a),e)}g.reportUserSpam=f}),98);
__d("MAWRerevokePendingStanzas",["MAWBuildIncomingMsgs","MAWDbMsg","MAWDbMsgTxns","MAWDexieTable","MAWGlobals","MAWIndexedDb","MAWJidUtils","MAWMsgType","MAWRemoveExpiredUnsendMsgsContent","MAWTransactionMode","MAWWriteRevokeMessageTxns","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("echoSerialization",function(){return h()}).end();var h=d("MAWIndexedDb").makeMsgrTransactor({chunk:(b=d("MAWTransactionMode")).READWRITE,deletedMessages:b.READWRITE,editMsgHistory:b.READWRITE,groupInfo:b.READWRITE,media:b.READWRITE,mediaBackup:b.READWRITE,messages:b.READWRITE,pendingStanzas:b.READWRITE,reactions:b.READWRITE,threads:b.READWRITE,xma:b.READWRITE},"reRevokeMsgs",function(a){return function(){return a.pendingStanzas.toArray().then(function(b){b=b.map(function(b){var c;if(((c=b.pendingContent)==null?void 0:c.type)==="Revoked"){var e=b==null?void 0:(c=b.pendingContent)==null?void 0:c.content;c=d("MAWJidUtils").maybeToProtocolMsgId(e.author,e.threadJid,e.revokedExternalId);return c==null||e==null?d("MAWDexieTable").dexieResolve():d("MAWDexieTable").dexieAll([d("MAWDbMsgTxns").maybeGetMsgByProtocolMsgId(a,c),a.threads.get({jid:c.chat})]).then(function(c){var f=c[0];c=c[1];if(f==null||c==null)return d("MAWDexieTable").dexieResolve();var g=e.ts+d("WATimeUtils").castToUnixTime(d("MAWBuildIncomingMsgs").REVOKE_CONTENT_EXPIRATION_IN_SEC);g=babelHelpers["extends"]({},f,{externalId:e.externalId,msgContent:d("MAWDbMsg").getMsgContent(f),originalTs:f.ts,revokedExternalId:e.revokedExternalId,ts:e.ts,type:d("MAWMsgType").MSG_TYPE.REVOKED,unsendMsgContentDeleteTs:d("WATimeUtils").castToUnixTime(g)});return d("MAWDexieTable").dexieAll([d("MAWWriteRevokeMessageTxns").markExistingMsgRevoked(a,f,g,c,!0),a.pendingStanzas["delete"](b.rowId)])})}return d("MAWDexieTable").dexieResolve()});return d("MAWDexieTable").dexieAll(b).then(function(){return d("MAWRemoveExpiredUnsendMsgsContent").removeExpiredUnsendMsgsContentTxn(a)})})}});g.rerevokeMsgs=a;g.reRevokeMsgs=h}),98);
__d("WASendAppDataFanoutProtocol",["WAAsMessageApplication","WABridge","WAConvertAppData","WAEncUserMsg","WAErrorMessage","WAGetCurrentUserDeviceInfoApi","WAGlobals","WAMsgApplication.pb","WAOdsEnums","WAResultOrError","WASmaxAppdataPublishPeerRPC","WATagsLogger","encodeProtobuf","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to send appdata. Error: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Got phash mismatch on appdata, local[","] server[","]"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to fetch current device public identity key"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Attempting to send an appData stanza to more than the allowed "," devices"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Attempting to send an appData stanza to "," devices"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Sending appdata, externalId: ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to send appdata to devices with error: ",""]);n=function(){return a};return a}var o=d("WATagsLogger").TAGS(["sendAppDataFanout"]);function a(a,b,c,e){e===void 0&&(e="checkPhash");return p(a,b,c,e)["catch"](function(a){a=d("WAErrorMessage").maybeGetMessageFromError(a);o.ERROR(n(),a);return d("WAResultOrError").makeError("runtime-error")})}function p(a,c,e,f){var g,n,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F;return b("regeneratorRuntime").async(function(G){while(1)switch(G.prev=G.next){case 0:f===void 0&&(f="checkPhash");o.LOG(m(),c);g=d("WAConvertAppData").convertAppData(a);n={bytes:d("WAAsMessageApplication").castToMessageApplicationBytes(d("encodeProtobuf").encodeProtobuf(d("WAMsgApplication.pb").MessageApplicationSpec,g).readByteArray()),version:"v3"};p=[];q=Array.from(e.entries()).map(function(a){var b=a[0];a=a[1];return{identity:a.pubKey,jid:b}});r=d("WAGlobals").getConfig().maxAppDataRecipients();q.length>r&&(o.WARN(l(),q.length),o.ERROR(k(),r),q=q.slice(0,r));s=[{devicesInfo:q,user:d("WAGlobals").getMyUserJid()}];G.next=11;return b("regeneratorRuntime").awrap(d("WAGlobals").getWaOneQueue().enqueue(function(a){a=a.cryptoManager;return d("WAEncUserMsg").encryptUserMsg(s,{messageBytes:n,type:"appdata"},[],{cryptoManager:a})},{operationType:"encrypt",flush:!0}));case 11:t=G.sent;u=t.phash;v=!1;t.participants!=null&&t.participants.forEach(function(a){a.type==="pkmsg"&&(v=!0),p.push({toJid:a.to,encTypeIndividualMixinArgs:{encType:a.type,encElementValue:a.ciphertext},encVersionFutureproofMixinArgs:{encV:parseInt(a.v,10)}})});w={appdataTo:d("WAGlobals").getMyUserJid(),toArgs:p};x={peerPeerFanout:w};y=void 0;if(!v){G.next=27;break}G.next=21;return b("regeneratorRuntime").awrap(d("WAGetCurrentUserDeviceInfoApi").getCurrentUserDeviceInfo());case 21:z=G.sent;A=z==null?void 0:z.identityKey;if(!(A==null)){G.next=26;break}o.ERROR(j());return G.abrupt("return",d("WAResultOrError").makeError("no-public-identity"));case 26:y={deviceIdentityElementValue:A};case 27:B={appdataDeviceListCheck:f==="checkPhash"?"true":"false"};C={appdataId:c,peerPeerFanoutOrPeerSingleMixinGroupArgs:x,deviceIdentityMixinArgs:y,withDeviceListCheckMixinArgs:B};G.next=31;return b("regeneratorRuntime").awrap(d("WASmaxAppdataPublishPeerRPC").sendPeerRPC(C));case 31:D=G.sent;G.t0=D.name;G.next=G.t0==="PeerResponseSuccess"?35:43;break;case 35:F=(E=D.value.deviceListStaleMixin)==null?void 0:E.phash;if(!(F!=null&&u!=null&&F!==u)){G.next=42;break}o.LOG(i(),u,F);d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.PHASH_MISMATCH,key:"appdata"});return G.abrupt("return",d("WAResultOrError").makeResult({phashMismatch:!0}));case 42:return G.abrupt("return",d("WAResultOrError").makeResult({phashMismatch:!1}));case 43:D.name;o.ERROR(h(),D.value.error);return G.abrupt("return",d("WAResultOrError").makeError("ack-failure"));case 46:case"end":return G.stop()}},null,this)}g.sendAppDataToDevicesProtocol=a}),98);
__d("MAWResendWrittenAppData",["MAWGlobals","WAGetDevices","WALogger","WASendAppDataFanoutProtocol","WATimeUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenAppData(","): too old, dropping"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["resendWrittenAppData not sending message: ",""]);i=function(){return a};return a}a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("resendWrittenAppData",{code:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.appDataExternalId;yield d("WAGetDevices").fetchAndSaveDevices(new Set([d("MAWGlobals").getMyUserJid()]),"resend-written-app-data");var b=(yield d("MAWGlobals").getDbImpls().getAppDataForResend(a));if(b.type!=="not_sent"){d("WALogger").LOG(i(),b.type);return}b=(yield d("WASendAppDataFanoutProtocol").sendAppDataToDevicesProtocol(b.appData,a,b.permittedIdentitiesPerDevice,"dontCheckPhash"));b.success===!1&&(yield d("MAWGlobals").getDbImpls().markAppDataSendFailed(a))});function c(b){return a.apply(this,arguments)}return c}(),stopRetryIf:{onStopRetry:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.appDataExternalId;d("WALogger").LOG(h(),a);yield d("MAWGlobals").getDbImpls().markAppDataDropped(a)});function c(b){return a.apply(this,arguments)}return c}(),timePassedSeconds:d("WATimeUtils").DAY_SECONDS}}).end();g.resendWrittenAppData=a}),98);
__d("MAWRestoreMessagesFromEncryptedBackups",["MAWBridge","MAWGlobals","MAWHandleEchoMsgsRestoreApiV2","MAWUpdateClientRestoreStatusOperationType","Promise","WALogger","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Encountered unhandled exception while running job restoreMessagesFromEncryptedBackups: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Job restoreMessagesFromEncryptedBackups, thread: ",", messages count: ",""]);j=function(){return a};return a}a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("decodeAndRestoreMessages",function(a){var c=a.hasMoreAfter,e=a.hasMoreBefore,f=a.instanceKey,g=a.isPointQuery,k=a.messages,l=a.minMsgId,m=a.optimisticMsgs,n=a.startSortKey,o=a.taskSource,p=a.threadId;a=a.traceId;var q={messageIds:[],pendingRestoreSortKeys:[]};q=d("WAResultOrError").makeResult(q);try{d("WALogger").LOG(j(),p,k.length);return d("MAWHandleEchoMsgsRestoreApiV2").handleEchoMsgsBulkRestore(p,k,g,e,c,l,a,n,f,m,o)}catch(a){d("WALogger").ERROR(i(),a)}finally{n==null&&d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:[{tag:"UpdateClientRestoreStatus",value:{action:d("MAWUpdateClientRestoreStatusOperationType").markCompleteClientRestoreStatus,ebPrefetch:!1,threadId:p}}]})}return(h||(h=b("Promise"))).resolve(q)}).end();g.restoreMessagesFromEncryptedBackups=a}),98);
__d("MAWRestoreProtobufMsgsForThread",["MAWDbMsgTxns","MAWDbThreadTxns","MAWDexieTable","MAWIndexedDb","MAWMsgType","MAWThreadSnippetBuildTxns","MAWTransactionMode","MAWWriteMsgSideEffectTxns","MAWWriteMsgTxns","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Starting restore for protobuf msg with external id "," chatjid ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["unstoredDbMsg cannot both be missing for external id "," chat jid ",""]);i=function(){return a};return a}b=d("MAWIndexedDb").makeMsgrTransactor({groupInfo:(a=d("MAWTransactionMode")).READWRITE,messages:a.READWRITE,participants:a.READWRITE,threads:a.READWRITE},"handleProtobufMessageRestore",function(a){return function(b,c,e,f,g,k,l,m){f=f.unstoredDbMsg;var n=e.jid;if(f==null){d("WALogger").ERROR(i(),c,n);return d("MAWDexieTable").dexieResolve()}d("WALogger").LOG(h(),c,n);switch(f.type){case d("MAWMsgType").MSG_TYPE.TEXT:return j(a,c,b,f,e,g,k,l,m)}return d("MAWDexieTable").dexieResolve()}});function j(a,b,c,e,f,g,h,i,j){var k=f.chatId;return d("MAWDbMsgTxns").maybeGetMsgByExternalId(a,b,k,c).then(function(b){if(b==null){var c=babelHelpers["extends"]({},babelHelpers["extends"]({},e,{thread:f.chatId,threadJid:f.jid}));return d("MAWWriteMsgTxns").writeMsg(a,c,f,{},!0,g,h,i,j).then(function(b){return d("MAWDbThreadTxns").getThread(a,f.chatId).then(function(e){if(e.success){var f=e.value;return d("MAWDexieTable").dexieAll([d("MAWWriteMsgSideEffectTxns").updateParticipantTimestampsForMsg(a,c),d("MAWThreadSnippetBuildTxns").refreshThreadSnippet(a,f)]).then(function(){return{dbMsg:b,updatedThread:f}})}})})}})}g.handleProtobufMessageRestore=b}),98);
__d("MAWWriteReactionTxns",["MAWAuthor","MAWDbMsg","MAWDbReaction","MAWDbReactionUtils","MAWDbReactionsTxns","MAWDexieTable","WAJids"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c){var e=b.author,f=b.externalId,g=b.groupingKey,h=b.reaction,i=b.reactToAuthor,j=b.reactToExternalId,k=b.ts;return d("MAWDexieTable").dexieAll([a.messages.where("externalId").equals(j).toArray(),a.reactions.where("reactToExternalId").equals(j).toArray(),d("MAWDbReactionsTxns").getNextReactionIdNumberForThread(a,c)]).then(function(b){var l=b[0],m=b[1];b=b[2];m=d("MAWDbReaction").findMatchingReaction(m,c.jid,e);var n=d("MAWAuthor").getAuthorUserJid(i);l=l.find(function(a){return a.thread===c.chatId&&n===d("MAWAuthor").getAuthorUserJid(a.author)});var o=d("MAWDbReaction").formatReactionForDb(c.jid,f,d("MAWDbMsg").craftReactionId(c.chatId,b),j,h,g,i,l==null?void 0:l.msgId,k,(b=e)!=null?b:d("WAJids").AUTHOR_ME,m==null?void 0:m.rowId);l=m!=null?a.receipts.where("waMsgId").equals(d("MAWDbMsg").getWAMsgId(m))["delete"]():d("MAWDexieTable").dexieResolve();return d("MAWDexieTable").dexieAll([d("MAWDbReactionsTxns").putReaction(a,c,o),l]).then(function(a){a=a[0];a=babelHelpers["extends"]({},o,{rowId:a});d("MAWDbReactionUtils").dispatchReaction(a,c.chatId);return a})})}g.writeReaction=a}),98);
__d("MAWWriteReactionMsgApi",["MAWIndexedDb","MAWMsgReceiptPreparationTxns","MAWTransactionMode","MAWWriteReactionTxns","WAJids"],(function(a,b,c,d,e,f,g){"use strict";b=d("MAWIndexedDb").makeMsgrAndSignalTransactor({contacts:(a=d("MAWTransactionMode")).READONLY,groupInfo:a.READONLY,identity:a.READONLY,media:a.READONLY,messages:a.READONLY,participants:a.READONLY,reactions:a.READWRITE,receipts:a.READWRITE,threads:a.READWRITE},"writeReactionMsg",function(a){return function(b,c,e,f,g){g===void 0&&(g=d("WAJids").AUTHOR_ME);var h=e.groupingKey,i=e.reaction,j=e.reactToAuthor;e=e.reactToExternalId;var k={author:g,externalId:b,groupingKey:h,reaction:i,reactToAuthor:j,reactToExternalId:e,ts:f};return a.threads.get({jid:c}).then(function(b){return b==null?"missing_thread":d("MAWWriteReactionTxns").writeReaction(a,k,b)}).then(function(b){return b==="missing_thread"?{type:"missing_thread"}:d("MAWMsgReceiptPreparationTxns").prepareReceiptForMsg(a,b.reactionId,c,b.externalId,b.author).then(function(){return{msgId:b.reactionId,protocolMsgId:{author:g,chat:c,externalId:b.externalId},type:"not_sent"}})})}});g.writeReactionMsg=b}),98);
__d("MAWHandleEchoProtobufsRestoreApi",["LSMEBTaskCreationSource","MAWBridgeEventTransmitter","MAWBridgeMsg","MAWDexieTable","MAWHandleEchoMsgsRestoreApiV2","MAWIndexedDb","MAWJids","MAWJobDefinitions","MAWRestoreProtobufMsgsForThread","MAWTransactionMode","MAWUnstoredContentToUnstoredDbContentUtils","MAWUpdateQuotedMsgTxns","MAWWriteReactionMsgApi","MessageBackupSupplementalKeyGenerator","Promise","WAAckLevel","WAArmadilloBackupMessage.pb","WAConsumerApplication.pb","WAGlobals","WAJids","WALogger","WAMessageKey","WAMsgApplication.pb","WAMsgType","WAParseConsumerMessageProtocol","WAParseMessageApplication","WAStanzaUtils","WATimeUtils","decodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["cannot support message type for protobuf restore - reverting to echo restore"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Protobuf restore initiated for "," messages. isPointRestore: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Parsed message application subprotocol type is not of type consumer message - unable to restore"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Message contains unparseable message application - unable to restore message"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth][web] INvalid reaction text in the protobuf restore"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth][web] Failed to create db msg from protobuf"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth][web] Missing required fields, unable to create db msg from protobuf for thread jid "," and otid ",""]);o=function(){return a};return a}var p=new Set(),q=new Set(),r=new Map(),s=d("MAWIndexedDb").makeMsgrTransactor({messages:d("MAWTransactionMode").READWRITE},"associateQuotedMessagesForRestoredDbMsgs",function(a){return function(b,c){return d("MAWDexieTable").dexieAll(b.map(function(b){return d("MAWUpdateQuotedMsgTxns").associateQuotedMessage(a,c,b,!0).then(function(a){a!=null&&a.forEach(function(a){d("MAWIndexedDb").afterTransaction({tag:"MsgUpdated",value:d("MAWBridgeMsg").createBridgeMsg(a,void 0,void 0)})})})})).then(function(){return d("MAWDexieTable").dexieResolve()})}});function t(a,b,c){c={author:c,chat:b,externalId:a};return c}function u(a,b){var c=a.metadata;a=a.reactionData;if(c!=null&&a!=null){c=c.senderId;if(c!=null)return a.map(function(a){var c=a.ts,e=a.senderId;if(e==null)return;e=d("MAWJids").toUserJid(e);e=e===d("WAGlobals").getMyUserJid()?d("WAJids").AUTHOR_ME:e;var f=e===d("WAJids").AUTHOR_ME?d("WAAckLevel").ACK.SENT:d("WAAckLevel").ACK.RECEIVED;return x(e,b,a.reaction,f,c)})}}function v(a,b,c,e,f,g){if(a===d("WAMsgType").MSG_TYPE.TEXT&&f!=null&&g!=null){a={ack:c===d("WAJids").AUTHOR_ME?d("WAAckLevel").ACK.SENT:d("WAAckLevel").ACK.RECEIVED,forwardingScore:0,id:e,msgContent:{content:f,mentionedJids:g.map(d("WAJids").validateUserJid).filter(Boolean)},ts:b,type:d("WAMsgType").MSG_TYPE.TEXT};return a}}function w(a,b){var c=a.metadata,e=a.decodedPayload;a=a.msgType;if(c!=null&&e!=null&&a!=null){var f=c.timestampMs,g=c.messageId;c=c.senderId;var h=e.text;if(f!=null&&typeof f==="number"&&g!=null&&c!=null){f=d("WATimeUtils").castMilliSecondsToUnixTime(f);c=d("MAWJids").toUserJid(c);var i=d("WAStanzaUtils").toStanzaId(g),j=c===d("WAGlobals").getMyUserJid()?d("WAJids").AUTHOR_ME:c,k=t(i,b,c);a=v(a,f,j,k,h,e.mentionedJid);if(a==null){d("WALogger").ERROR(o(),b,i);return}f={unstoredMedia:void 0,unstoredMsg:a,unstoredQuotedMedia:void 0,unstoredXMA:void 0};j=d("MAWUnstoredContentToUnstoredDbContentUtils").unstoredContentToUnstoredDbContent(f);k=r.get(g);if(j.unstoredDbMsg!=null){h=j.unstoredDbMsg;h.author!=null&&d("WAGlobals").getMyUserJid()===h.author&&h.author!==d("WAJids").AUTHOR_SYSTEM&&(h.author=d("WAJids").AUTHOR_ME);k!=null&&(h.quoteExternalId=d("WAStanzaUtils").toStanzaId(k));e={authorJid:c,stanzaId:i,unstoredDbContent:j};return e}}}d("WALogger").ERROR(n())}function x(a,b,c,e,f){a=d("WAParseConsumerMessageProtocol").interpretAsNonSystemAuthor(a);var g=d("WAMessageKey").extractProtocolMessageId(b,a,c.key),h=c.groupingKey;c=c.text;c=d("WAParseConsumerMessageProtocol").validReactionMessageText(c);if(!c.success){d("WALogger").WARN(m());return}return{ack:e,groupingKey:h,id:{author:a,chat:b,externalId:g.externalId},reaction:c.value,reactToAuthor:g.author,reactToExternalId:g.externalId,ts:f,type:d("WAMsgType").MSG_TYPE.REACTION}}function y(a){if(a.payload!=null){a=A(a);return a==null?void 0:(a=a.payload)==null?void 0:(a=a.content)==null?void 0:a.messageText}}function z(a){if(a.payload!=null){a=A(a);return a==null?void 0:(a=a.payload)==null?void 0:(a=a.content)==null?void 0:a.reactionMessage}}function A(a){var b;b=(b=a.metadata)==null?void 0:b.messageId;a=d("decodeProtobuf").decodeProtobuf(d("WAMsgApplication.pb").MessageApplicationSpec,a.payload);var c=d("WAParseMessageApplication").parseMessageApplication(a);if(c.type==="error"){d("WALogger").ERROR(l());return}if(c.subprotocolType!=="consumerMessage"){d("WALogger").ERROR(k());return}a=a.metadata;a=a==null?void 0:a.quotedMessage;a=a==null?void 0:a.stanzaId;b!=null&&a!=null&&(q.has(a)||p.add(a),r.set(b,a));return d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAConsumerApplication.pb").ConsumerApplicationSpec,c.payload)}function B(a){return a.map(function(a){var b=d("decodeProtobuf").decodeProtobuf(d("WAArmadilloBackupMessage.pb").BackupMessageSpec,a.toplevelProtobuf.decryptedProtobuf),c=y(b);if(c==null||c.text==null)return;var e=d("WAMsgType").MSG_TYPE.TEXT,f=a.supplementalProtobufs,g=[];for(var f=f,h=Array.isArray(f),i=0,f=h?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var j;if(h){if(i>=f.length)break;j=f[i++]}else{i=f.next();if(i.done)break;j=i.value}j=j;var k=j[0];j=j[1];if(!d("MessageBackupSupplementalKeyGenerator").isSupplementalProtobufAReaction(k))continue;var l=d("decodeProtobuf").decodeProtobuf(d("WAArmadilloBackupMessage.pb").BackupMessageSpec,j.decryptedProtobuf);l=z(l);k=d("MessageBackupSupplementalKeyGenerator").getSupplementalSenderId(k);l!=null&&k!=null&&g.push({reaction:l,senderId:k,ts:d("WATimeUtils").castMilliSecondsToUnixTime(j.protobufTimestampMS)})}q.add(a.otid);l={decodedPayload:c,metadata:b.metadata,msgType:e,reactionData:g,unknownFieldCount:b.$$unknownFieldCount};return l})}function C(a,b,e,f,g){return s(a,e).then(function(){b!=null&&(p.forEach(function(a){d("MAWBridgeEventTransmitter").issuePointQueryOutsideTxn(a,b,void 0,c("LSMEBTaskCreationSource").EB_POINT_QUERY_IN_ACT,g)}),p.clear(),r.clear(),q.clear());if(f)return d("MAWHandleEchoMsgsRestoreApiV2").deleteMessages(a)})}function a(a,c,e,f,g,k,l,m,n,o,p){d("WALogger").LOG(j(),e.length,f);if(e.length>0){var r=c;return d("MAWHandleEchoMsgsRestoreApiV2").getThread(c).then(function(a){if(a){var j=a.jid,m=B(e),n=!1;for(var s=m,t=Array.isArray(s),u=0,s=t?s:s[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var v;if(t){if(u>=s.length)break;v=s[u++]}else{u=s.next();if(u.done)break;v=u.value}v=v;if(v==null){n=!0;break}}if(n){d("WALogger").LOG(i());q.clear();v=p.map(function(a){return d("MAWJobDefinitions").toEncodedEchoMessage(a)});return d("MAWHandleEchoMsgsRestoreApiV2").handleEchoMsgsBulkRestore(c,v,!1,g,k,l,void 0,void 0,o,void 0,void 0).then(function(){return(h||(h=b("Promise"))).resolve()})}var x=a,y=[],z=m.length;return m.reduce(function(a,b){return a.then(function(){if(b!=null){var a=w(b,j);if(a!=null)return d("MAWRestoreProtobufMsgsForThread").handleProtobufMessageRestore(a.authorJid,a.stanzaId,x,a.unstoredDbContent,g,k,f,z--).then(function(a){var c=a==null?void 0:a.updatedThread;a=a==null?void 0:a.dbMsg;c!==void 0&&(x=c);a!=null&&y.push(a);return D(b,j)})}})},(h||(h=b("Promise"))).resolve()).then(function(){return C(y,r,a.chatId,f,a.jid)})}return(h||(h=b("Promise"))).resolve()})}return(h||(h=b("Promise"))).resolve()}function D(a,c){var e=u(a,c);a=a.metadata;if(e!=null&&a!=null){var f=a.messageId;e.filter(Boolean).map(function(a){var b=a.ts;if(b!=null&&f!=null){var e=d("WAStanzaUtils").toStanzaId(f);return d("MAWWriteReactionMsgApi").writeReactionMsg(e,c,{groupingKey:a.groupingKey,reaction:a.reaction,reactToAuthor:a.reactToAuthor,reactToExternalId:a.reactToExternalId},b)}});return(h||(h=b("Promise"))).resolve()}}g.handleProtobufsRestore=a}),98);
__d("MAWRestoreProtobufsFromEncryptedBackups",["MAWBridge","MAWGlobals","MAWHandleEchoProtobufsRestoreApi","MAWUpdateClientRestoreStatusOperationType","Promise","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Encountered unhandled exception while running job restoreProtobufsFromEncryptedBackups: ",""]);i=function(){return a};return a}a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("decodeAndRestoreMessages",function(a){var c=a.echoMessages,e=a.hasMoreAfter,f=a.hasMoreBefore,g=a.instanceKey,j=a.isPointQuery,k=a.messages,l=a.minMsgId,m=a.referenceTimestamp,n=a.requestId,o=a.threadId;a=a.transportKey;try{return d("MAWHandleEchoProtobufsRestoreApi").handleProtobufsRestore(a,o,k,j,f,e,l,n,m,g,c)}catch(a){d("WALogger").ERROR(i(),a)}finally{m==null&&d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:[{tag:"UpdateClientRestoreStatus",value:{action:d("MAWUpdateClientRestoreStatusOperationType").markCompleteClientRestoreStatus,ebPrefetch:!1,threadId:o}}]});return(h||(h=b("Promise"))).resolve()}}).end();g.restoreProtobufsFromEncryptedBackups=a}),98);
__d("MAWRevokeMsgsApi",["MAWAckLevel","MAWBuildIncomingMsgs","MAWDbMsg","MAWDbMsgTxns","MAWDexieTable","MAWGlobals","MAWIndexedDb","MAWMsgReceiptPreparationTxns","MAWTransactionMode","MAWWriteRevokeMessageTxns","WAJids","WATimeUtils","justknobx"],(function(a,b,c,d,e,f,g){"use strict";b=d("MAWIndexedDb").makeMsgrAndSignalTransactor({contacts:(a=d("MAWTransactionMode")).READONLY,deletedMessages:a.READWRITE,groupInfo:a.READWRITE,identity:a.READONLY,messages:a.READWRITE,participants:a.READWRITE,reactions:a.READWRITE,receipts:a.READWRITE,threads:a.READWRITE,xma:a.READONLY},"revokeMsgs",function(a){return function(b,e){return d("MAWDexieTable").dexieAll(b.filter(function(a){return a.author===d("WAJids").AUTHOR_ME}).map(function(b){return d("MAWDexieTable").dexieAll([d("MAWDbMsgTxns").maybeGetMsgByProtocolMsgId(a,b).then(function(c){return c==null?d("MAWDbMsgTxns").maybeGetRevokedMsgByProtocolMsgId(a,b):c}),d("MAWDexieTable").dexieResolve(b)])})).then(function(b){return d("MAWDexieTable").dexieAll(b.map(function(b){var f=b[0];b=b[1];if(f==null)return;if(f.type==="Revoked"){b={author:d("WAJids").AUTHOR_ME,chat:b.chat,externalId:f.externalId};return b}var g=d("MAWGlobals").getDependencies().generateExternalId();return a.threads.get(f.thread).then(function(b){var h;if(b==null)return;h={ack:d("MAWAckLevel").ACK.clock,altIndex:void 0,author:d("WAJids").AUTHOR_ME,externalId:g,mediaId:f.mediaId,msgContent:d("MAWDbMsg").getMsgContent(f),msgId:f.msgId,originalTs:c("justknobx")._("1753")?f.ts:(h=f.serverTs)!=null?h:f.ts,quote:f.quote,reportingMeta:f.reportingMeta,revokedExternalId:f.externalId,rowId:f.rowId,sortOrderMs:f.sortOrderMs,thread:f.thread,threadJid:b.jid,ts:e,type:"Revoked",unsendMsgContentDeleteTs:d("WATimeUtils").castToUnixTime(e+d("MAWBuildIncomingMsgs").REVOKE_CONTENT_EXPIRATION_IN_SEC),xmaMessageType:f.xmaMessageType};return d("MAWDexieTable").dexieAll([d("MAWWriteRevokeMessageTxns").markExistingMsgRevoked(a,f,h,b),d("MAWMsgReceiptPreparationTxns").prepareReceiptForMsg(a,f.msgId,b.jid,f.externalId,f.author,!0,!0)]).then(function(){var a={author:d("WAJids").AUTHOR_ME,chat:b.jid,externalId:g};return a})})}).filter(Boolean))})}});g.revokeMsgs=b}),98);
__d("MAWRevokeMsg",["MAWGlobals","MAWJobDefinitions","MAWRevokeMsgsApi","Promise","WAJids","WAJobOrchestratorTypes","WALogger","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["revokeMsg: ",""]);i=function(){return a};return a}a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("revokeMsg",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){var f=a.msgIds;d("WALogger").DEV(i(),JSON.stringify(f));c=(yield d("MAWRevokeMsgsApi").revokeMsgs(f,e.jobStartTime));var g=[];a=c.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=f[b];a!=null&&!d("WAJids").isAuthorSystem(a.author)&&(g.push({deleting:a,original:b}),yield d("MAWGlobals").getJobManager().waitUntilPersisted(d("MAWJobDefinitions").createStartJobInfo("sendWrittenMsg",{gotDevicesBeforeSending:"not-applicable",protocolMsgId:a,referencedOriginalExternalId:b.externalId,scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION},type:"revoke"})))});return function(b,c){return a.apply(this,arguments)}}());yield (h||(h=b("Promise"))).all(a);return g});return function(b,c,d){return a.apply(this,arguments)}}()).end();g.revokeMsgs=a}),98);
__d("MAWWriteOutgoingAppDataApi",["MAWAckLevel","MAWDbIdentityTxns","MAWDexieTable","MAWGlobals","MAWIndexedDb","MAWODSProxy","MAWThreadTypes","MAWTransactionMode","MAWUpdateDevicesForUserApi","MAWWriteMetaSyncsTxns","WAJids","WAOdsEnums"],(function(a,b,c,d,e,f,g){"use strict";a=d("MAWIndexedDb").makeMsgrAndSignalTransactor(babelHelpers["extends"]({appData:d("MAWTransactionMode").READWRITE,identity:d("MAWTransactionMode").READONLY},d("MAWThreadTypes").ThreadRelatedTablesPermissions),"writeOutgoingAppData",function(a){return function(b,c,e){return a.appData.get({externalId:b}).then(function(f){if(f!=null)if(f.ack>=d("MAWAckLevel").ACK.sent)return d("MAWDexieTable").dexieResolve({appDataExternalId:b,devices:Array.from(f.recipientDevices),type:"already_sent"});else return d("MAWDexieTable").dexieResolve({appDataExternalId:b,devices:Array.from(f.recipientDevices),type:"not_sent"});var g=e.contents,h=e.deviceIds;g.type==="meta_sync"?f=d("MAWDexieTable").dexieAll(g.actions.map(function(b){b.messageAction&&b.messageAction.type==="delete_for_me"&&d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.C2C_META_SYNC,key:"delete_for_me"});return d("MAWWriteMetaSyncsTxns").handleMetaSyncAction(a,b)})):(g.type,f=d("MAWDexieTable").dexieAll([]));return d("MAWDexieTable").dexieAll([d("MAWUpdateDevicesForUserApi").getAllDeviceJidsForUser(a,d("MAWGlobals").getMyUserJid()),f]).then(function(a){a=a[0];if(h==null)return a;else{var b=new Set(h);return a.filter(function(a){return b.has(d("WAJids").extractDeviceId(a))})}}).then(function(b){return d("MAWDbIdentityTxns").getIdentitiesForDevices(a,b)}).then(function(e){var f=d("MAWGlobals").getMyDeviceJid();e["delete"](f);return e.size===0?{type:"no_devices"}:a.appData.add({ack:d("MAWAckLevel").ACK.clock,contents:g,externalId:b,permittedIdentitiesPerDevice:e,recipientDevices:new Set(e.keys()),sendPartial:h!=null,ts:c}).then(function(){return{appDataExternalId:b,devices:Array.from(e.keys()),type:"not_sent"}})})})}});g.writeOutgoingAppData=a}),98);
__d("MAWSendAppData",["MAWGlobals","MAWJobDefinitions","MAWWriteOutgoingAppDataApi","WALogger","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["no other devices"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendAppData already sent message"]);i=function(){return a};return a}a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("saveAndPassOff",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){b=a.args;a=a.externalId;a=(yield d("MAWWriteOutgoingAppDataApi").writeOutgoingAppData(a,c.jobStartTime,b));if(a.type==="already_sent"){d("WALogger").LOG(i());return a}else if(a.type==="no_devices"){d("WALogger").LOG(h());return a}else{a.type;yield d("MAWGlobals").getJobManager().waitUntilPersisted(d("MAWJobDefinitions").jobSerializers.sendWrittenAppData(a.appDataExternalId));return a}});return function(b,c,d){return a.apply(this,arguments)}}()).end();g.sendAppData=a}),98);
__d("MAWPrepareReceiptTxns",["MAWIndexedDb","MAWMsgReceiptPreparationTxns","MAWTransactionMode"],(function(a,b,c,d,e,f,g){"use strict";b=d("MAWIndexedDb").makeMsgrAndSignalTransactor({identity:(a=d("MAWTransactionMode")).READONLY,participants:a.READONLY,receipts:a.READWRITE,threads:a.READWRITE},"prepareReceipt",function(a){return function(b,c,e,f){return d("MAWMsgReceiptPreparationTxns").prepareReceiptForMsg(a,b,c.chat,c.externalId,c.author,e,f).then(function(){})}});g.prepareReceipt=b}),98);
__d("MAWWriteEditTxns",["FBLogger","MAWAckLevel","MAWBridgeMsg","MAWBridgeTypesCreators","MAWDbEditMsgHistoryTxns","MAWDbMsgTxns","MAWDexieTable","MAWEBSwitch","MAWEBUploadTrackingUtils","MAWIndexedDb","MAWJids","MAWLoadReplyMediaTxns","MAWThreadSnippetForTextMsg","MAWUnsafeCoerce","WAGlobals","WAJids","WAMsgType","WAResultOrError","err"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var e=b.args,f=b.externalId,g=e.editMsgContent;e=e.originalProtocolMsgId;var i=e.chat,j=e.externalId;return d("MAWDexieTable").dexieAll([a.threads.get({jid:i}),d("MAWDbMsgTxns").maybeGetMsgByProtocolMsgId(a,e),a.messages.where("quoteExternalId").equals(j).toArray(),a.editMsgHistory.where("originalMsgExternalId").equals(j).toArray()]).then(function(e){var k=e[0],l=e[1],m=e[2];e=e[3];if(k==null)return d("WAResultOrError").makeError("missing_thread");if(l==null)return d("WAResultOrError").makeError("missing_msg");if(l.type!==d("WAMsgType").MSG_TYPE.TEXT)throw c("err")("Msg other than text cannot be edited.");var n=e.find(function(a){return a.author===d("WAJids").AUTHOR_ME&&a.threadJid===i&&a.editExternalId===f});if((n==null?void 0:n.sendStatus)!=null&&n.sendStatus>d("MAWAckLevel").ACK.clock)return d("WAResultOrError").makeError("already_sent");n=[];n.push(h(b,i,j));e=e.find(function(a){return a.author===d("WAJids").AUTHOR_ME&&a.threadJid===i&&a.editExternalId===j});e==null&&(l.editCount==null||l.editCount===0)&&n.push(h(l,i,j));return d("MAWDbEditMsgHistoryTxns").bulkAddEditMsgHistory(a,n,!1).then(function(){if(c("MAWEBSwitch").isEnabled()&&!d("WAGlobals").getConfig().useEbUploadQueue()){var b=d("MAWEBUploadTrackingUtils").genInstanceKeyForMiddleware(f);b!=null&&d("MAWEBUploadTrackingUtils").startUploadTracking(f,d("WAMsgType").MSG_TYPE.EDIT_ACTION,"send",b)}var e=babelHelpers["extends"]({},l,{ack:d("MAWAckLevel").ACK.clock,editCount:((b=l.editCount)!=null?b:0)+1,msgContent:g});if(k.newestMsg!=null&&k.newestMsg===e.msgId){b=d("MAWJids").userIdFromJid(d("WAGlobals").getMyUserJid());var h=c("MAWThreadSnippetForTextMsg")(e,b,d("WAJids").interpretAsGroupJid(k.jid)!=null),n=h.snippetParams;h=h.snippetType;d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread({snippetParams:n,snippetSenderContactId:b,snippetType:h,threadId:k.chatId,threadJid:k.jid})})}var o=[],p=d("WAGlobals").getMyUserJid();n=m.find(function(a){var b;return(((b=a.quote)==null?void 0:b.content.author)===d("WAJids").AUTHOR_ME||((b=a.quote)==null?void 0:b.content.author)===p)&&a.threadJid===i});if(n!=null){b=n.quote;h=n.quoteExternalId;if(b==null)c("FBLogger")("messenger_e2ee_web").warn("[edit message] Failed to get the quoted content for a msg that has been quoted.",h);else{h=babelHelpers["extends"]({},n,{quote:babelHelpers["extends"]({},b,{content:babelHelpers["extends"]({},b.content,{msgContent:babelHelpers["extends"]({},e.msgContent)})})});o.push(h)}}return a.messages.bulkPut([e].concat(o)).then(function(){return d("MAWLoadReplyMediaTxns").getReplyMediaForMsgQuote(a,l)}).then(function(a){d("MAWIndexedDb").afterTransaction({tag:"MsgUpdated",value:d("MAWBridgeMsg").createBridgeMsg(e,void 0,a)})}).then(function(){o.forEach(function(a){d("MAWIndexedDb").afterTransaction({tag:"MsgUpdated",value:d("MAWBridgeMsg").createBridgeMsg(a)})});return d("WAResultOrError").makeResult({originalMsgExternalId:j,originalMsgId:l.msgId,protocolMsgId:{author:d("WAJids").AUTHOR_ME,chat:i,externalId:f}})})})})}function h(a,b,c){var e;return{author:d("WAJids").AUTHOR_ME,editExternalId:a.externalId,editTs:(e=a.serverTs)!=null?e:a.ts,msgContent:(e=(e=a.args)==null?void 0:e.editMsgContent)!=null?e:d("MAWUnsafeCoerce").unsafeCoerce(a.msgContent),originalMsgExternalId:c,sendStatus:d("MAWAckLevel").ACK.clock,specialTextSize:a.specialTextSize,threadJid:b}}g.writeEdit=a}),98);
__d("MAWWriteEditMsgApi",["MAWIndexedDb","MAWTransactionMode","MAWWriteEditTxns"],(function(a,b,c,d,e,f,g){"use strict";b=d("MAWIndexedDb").makeMsgrTransactor({chunk:(a=d("MAWTransactionMode")).READONLY,editMsgHistory:a.READWRITE,media:a.READONLY,messages:a.READWRITE,threads:a.READWRITE,xma:a.READONLY},"writeEditMsg",function(a){return function(b,c,e){c={args:c,externalId:b,ts:e};return d("MAWWriteEditTxns").writeEdit(a,c).then(function(a){return a})}});g.writeEditMsg=b}),98);
__d("MAWSendEditMsg",["MAWGlobals","MAWJobDefinitions","MAWPrepareReceiptTxns","MAWWriteEditMsgApi","WAJobOrchestratorTypes","WALogger","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendEditMsg already sent a message"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendEditMsg cannot edit to a non-existent message"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendEditMsg cannot send to a non-existent thread"]);j=function(){return a};return a}a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("sendEditMsg",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){if(!d("MAWGlobals").getConfig().isEditMessageSendEnabled())throw c("err")("Edit message send feature is disabled.");b=(yield d("MAWWriteEditMsgApi").writeEditMsg(a.externalId,a.args,e.jobStartTime));if(!b.success){b.error==="missing_thread"?d("WALogger").ERROR(j()):b.error==="missing_msg"?d("WALogger").ERROR(i()):b.error==="already_sent"&&d("WALogger").ERROR(h());return}yield d("MAWPrepareReceiptTxns").prepareReceipt(b.value.originalMsgId,b.value.protocolMsgId,!0,!0);yield d("MAWGlobals").getJobManager().waitUntilPersisted(d("MAWJobDefinitions").createStartJobInfo("sendWrittenMsg",{gotDevicesBeforeSending:"not-applicable",protocolMsgId:b.value.protocolMsgId,referencedOriginalExternalId:b.value.originalMsgExternalId,scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION},type:"edit"}))});return function(b,c,d){return a.apply(this,arguments)}}()).end();g.sendEditMsg=a}),98);
__d("MAWGetSyncResponseBackoffInfoByJidApi",["MAWDbContactsTxns","MAWIndexedDb","MAWTransactionMode","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";a=d("MAWIndexedDb").makeSignalTransactor({contacts:d("MAWTransactionMode").READONLY},"getSyncResponseBackoffInfoByJid",function(a){return function(b){return d("MAWDbContactsTxns").getContact(a,b).then(function(a){return a==null?d("WAResultOrError").makeError("missing_contact"):d("WAResultOrError").makeResult(a.ephemeralSyncResponseBackoffInfo)})}});g.getSyncResponseBackoffInfoByJid=a}),98);
__d("MAWSendEphemeralSettingMsg",["MAWGetSyncResponseBackoffInfoByJidApi","MAWGlobals","MAWJobDefinitions","MAWLoggerUtils","MAWMsgType","MAWWriteOutgoingMsgApi","WAGlobals","WAJids","WAJobOrchestratorTypes","WATagsLogger","WATimeUtils","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendMsg cannot send to a non-existent thread"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendMsg already sent message"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["send ephemeral setting message: chatJid ",", type ",", externalId ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["ephemeral sync response backed off"]);k=function(){return a};return a}var l=d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.Ephemeral,d("MAWLoggerUtils").Tag.SettingSync]);a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("sendEphemeralSettingMsg",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){b=a.args;var f=a.chatJid;a=a.externalId;if(b.isForSyncResponse){var g=(yield d("WAJids").switchOnMsgrChatJidType(f,{group:function(){throw c("err")("ChatJid is not supposed to be a group")},user:function(a){return d("MAWGetSyncResponseBackoffInfoByJidApi").getSyncResponseBackoffInfoByJid(a)}}));if(g.success&&m(e.jobStartTime,g.value)){l.LOG(k());return}}g=b.isForSyncResponse?d("MAWMsgType").MSG_TYPE.EPHEMERAL_SYNC_RESPONSE:d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_CHANGE_FROM_CURRENT_DEVICE;e=(yield d("MAWWriteOutgoingMsgApi").writeOutgoingMsg(a,f,e.jobStartTime,b,g));l.LOG(j(),f,g,a);if(e.type==="already_sent"){l.LOG(i());return}else if(e.type==="missing_thread"){l.LOG(h());return}yield d("MAWGlobals").getJobManager().waitUntilPersisted(d("MAWJobDefinitions").createStartJobInfo("sendWrittenMsg",{gotDevicesBeforeSending:d("WAGlobals").getConfig().getDevicesBeforeSend(),protocolMsgId:e.protocolMsgId,scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION},type:"message"}))});return function(b,c,d){return a.apply(this,arguments)}}()).end();function m(a,b){if(b==null)return!1;var c=b.syncResponseRetries;b=b.syncResponseSentTs;switch(c){case 1:return d("WATimeUtils").happenedWithinAt(a,b,3*60);case 2:return d("WATimeUtils").happenedWithinAt(a,b,15*60);default:return!0}}g.sendEphemeralSettingMsg=a}),98);
__d("MAWSendGroupInviteMsg",["MAWGlobals","MAWJobDefinitions","MAWMsgType","MAWSendMsg","WAGlobals","WAJobOrchestratorTypes","WALogger","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendGroupInviteMsg cannot send to a non-existent thread"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendGroupInviteMsg already sent message"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendGroupInviteMsg for group "," to invited user ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendGroupInviteMsg failed to store a new group invite"]);k=function(){return a};return a}a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("saveAndPassOff",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){b=a.args;var e=a.externalId;yield d("MAWSendMsg").maybeGetDevicesBeforeSend(b.groupJid);var f=(yield d("MAWGlobals").getDbImpls().writeGroupInvite(b.groupJid,{expiration:b.expiration,inviteCode:b.inviteCode,invitedParticipantUserJid:b.invitedParticipantUserJid,inviterUserJid:b.inviterUserJid}));if(!f.success){d("WALogger").LOG(k());return}c=(yield d("MAWGlobals").getDbImpls().writeOutgoingMsg(e,b.groupJid,c.jobStartTime,babelHelpers["extends"]({},b,{groupName:(e=f.value)!=null?e:void 0}),d("MAWMsgType").MSG_TYPE.GROUP_INVITE));d("WALogger").DEV(j(),a.args.groupJid,a.args.invitedParticipantUserJid);if(c.type==="already_sent"){d("WALogger").LOG(i());return}else if(c.type==="missing_thread"){d("WALogger").LOG(h());return}yield d("MAWGlobals").getJobManager().waitUntilPersisted(d("MAWJobDefinitions").createStartJobInfo("sendWrittenMsg",{gotDevicesBeforeSending:d("WAGlobals").getConfig().getDevicesBeforeSend(),protocolMsgId:c.protocolMsgId,scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION},type:"message"}))});return function(b,c,d){return a.apply(this,arguments)}}()).end();g.sendGroupInviteMsg=a}),98);
__d("MAWStartMediaUploaQplFlow",["MAWGetStorageQplAnnotations","WAJids","WAMediaQplHelper","WAPREList","WAPREMetrics","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.chatJid,e=a.fileSize,f=a.serverMediaType;a=a.uploadEntry;var g=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.MEDIA_UPLOAD,{string:{chat_type:d("WAJids").switchOnMsgrChatJidType(b,{group:function(){return"group"},user:function(){return"user"}}),jid:b,media_size:d("WAMediaQplHelper").convertIntegerSizeToStringBucket(e),media_type:f,upload_entry:a}},void 0);c("promiseDone")(d("MAWGetStorageQplAnnotations").getStorageQplAnnotations().then(function(a){g.addAnnotations(a)}));return g}g.startMediaUploaQplFlow=a}),98);
__d("WAHttpResumeCheck",["WALogger","WAResultOrError","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["HttpResumeCheck: fail to parse request body ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["HttpResumeCheck: resume is NaN: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["HttpResumeCheck: object_id is missing"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["HttpResumeCheck: direct_path is missing"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["HttpResumeCheck: response status ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["HttpResumeCheck: fail to initiate fetch ",""]);m=function(){return a};return a}function a(a){var c,e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:g.prev=0;g.next=3;return b("regeneratorRuntime").awrap(fetch(a,{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"text/plain"}}));case 3:c=g.sent;g.next=10;break;case 6:g.prev=6;g.t0=g["catch"](0);d("WALogger").ERROR(m(),g.t0);throw g.t0;case 10:e=c,f=e.status;d("WALogger").LOG(l(),f);g.t1=f;g.next=g.t1===200?15:g.t1===404?16:g.t1===408?17:g.t1===429?18:g.t1===507?18:19;break;case 15:return g.abrupt("return",c.json().then(function(a){var b=a.resume,c=a.direct_path;a=a.object_id;if(b==="complete"){if(c==null){d("WALogger").ERROR(k());return d("WAResultOrError").makeResult({type:"media-not-found"})}if(a==null){d("WALogger").ERROR(j());return d("WAResultOrError").makeResult({type:"media-not-found"})}return d("WAResultOrError").makeResult({type:"media-found",directPath:c,objectId:a})}c=parseInt(b,10);if(c===0)return d("WAResultOrError").makeResult({type:"media-not-found"});if(Number.isNaN(c)){d("WALogger").ERROR(i(),b);return d("WAResultOrError").makeResult({type:"media-not-found"})}return d("WAResultOrError").makeResult({type:"media-partial-found",resumeFromBytes:c})})["catch"](function(a){d("WALogger").ERROR(h(),a);return d("WAResultOrError").makeError("body-network-error")}));case 16:return g.abrupt("return",d("WAResultOrError").makeResult({type:"media-not-found"}));case 17:return g.abrupt("return",d("WAResultOrError").makeError("server-timeout"));case 18:return g.abrupt("return",d("WAResultOrError").makeError("upload-throttled"));case 19:if(!(f>=400&&f<500)){g.next=21;break}return g.abrupt("return",d("WAResultOrError").makeError("request-error"));case 21:return g.abrupt("return",d("WAResultOrError").makeError("unspecified-http-error"));case 22:case"end":return g.stop()}},null,this,[[0,6]])}g.httpResumeCheck=a}),98);
__d("WACheckCiphertextInServer",["WAHttpResumeCheck","WAMediaUrl","WAResultOrError","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,c,e,f){return f.run(function(f,g){var h,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:h=d("WAMediaUrl").buildUploadUrl(a,e,c,f.domain,g,!0);k.next=3;return b("regeneratorRuntime").awrap(d("WAHttpResumeCheck").httpResumeCheck(h));case 3:i=k.sent;if(!i.success){k.next=8;break}return k.abrupt("return",d("WAResultOrError").makeResult(i));case 8:j=i.error;k.t0=j;k.next=k.t0==="server-timeout"?12:k.t0==="unspecified-http-error"?12:13;break;case 12:return k.abrupt("return",d("WAResultOrError").makeError({progressMade:!0}));case 13:return k.abrupt("return",d("WAResultOrError").makeResult(d("WAResultOrError").makeError(j)));case 14:case"end":return k.stop()}},null,this)}).then(function(a){return(a=a)!=null?a:d("WAResultOrError").makeError("max-attempts-exceeded")})}g.checkCiphertextInServer=a}),98);
__d("WACreateRetrier",["WAComms","WAGetMediaRoute","WAGlobals","WAMediaOperationsRetrier","WAResultOrError","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,c){var e,f,g,h,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:c==null?void 0:c.addPoint("get_media_route_start");k.next=3;return b("regeneratorRuntime").awrap(d("WAGetMediaRoute").getMediaRoute({operation:"upload",serverMediaType:a},c));case 3:e=k.sent;c==null?void 0:c.addPoint("get_media_route_finish");if(e.success){k.next=7;break}return k.abrupt("return",e);case 7:f=e.value,g=f.selectedHost,h=f.fallbackHost,i=f.authToken;j=new(d("WAMediaOperationsRetrier").MediaOperationsRetrier)("upload",{host:{domain:g.domain,"class":g["class"]},fallbackHost:h&&{domain:h.domain,"class":h["class"]},authToken:i,timeElapsed:null},d("WAGlobals").getConfig().isMediaWaitForConnectionOnRetryEnabled()===!0?d("WAComms").waitForConnection:void 0);return k.abrupt("return",d("WAResultOrError").makeResult(j));case 10:case"end":return k.stop()}},null,this)}g.createUploadRetrier=a}),98);
__d("WAHttpRegularUploadMedia",["WAErr","WALogger","WAResultOrError","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["HttpRegularUploadMedia: fail to parse request body ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Fetch Media HTTP status ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["HttpRegularUploadMedia: fail to initiate fetch ",""]);j=function(){return a};return a}function a(a,e){var f,g,k;return b("regeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:l.prev=0;l.next=3;return b("regeneratorRuntime").awrap(fetch(a,{method:"POST",mode:"cors",cache:"no-store",headers:{"Content-Type":"text/plain"},body:new Blob([e])}));case 3:f=l.sent;l.next=10;break;case 6:l.prev=6;l.t0=l["catch"](0);d("WALogger").ERROR(j(),l.t0);throw l.t0;case 10:g=f,k=g.status;d("WALogger").LOG(i(),k);l.t1=k;l.next=l.t1===200?15:l.t1===408?16:l.t1===413?17:l.t1===415?18:l.t1===429?19:l.t1===507?19:20;break;case 15:return l.abrupt("return",f.json().then(function(a){if(!Object.prototype.hasOwnProperty.call(a,"direct_path"))throw c("WAErr")("direct_path not available in wa upload http response");if(typeof a.direct_path!=="string")throw c("WAErr")('directPath: "'+a.direct_path+'" is not a string');if(a.object_id&&typeof a.object_id!=="string")throw c("WAErr")('objectId: "'+a.object_id+'" is not a string');if(a.handle&&typeof a.handle!=="string")throw c("WAErr")('handle: "'+a.handle+'" is not a string');a={directPath:a.direct_path,objectId:a.object_id,handle:a.handle};return d("WAResultOrError").makeResult(a)})["catch"](function(a){d("WALogger").ERROR(h(),a);return d("WAResultOrError").makeError("body-network-error")}));case 16:return l.abrupt("return",d("WAResultOrError").makeError("server-timeout"));case 17:return l.abrupt("return",d("WAResultOrError").makeError("payload-too-large"));case 18:return l.abrupt("return",d("WAResultOrError").makeError("invalid-media"));case 19:return l.abrupt("return",d("WAResultOrError").makeError("upload-throttled"));case 20:if(!(k>=400&&k<500)){l.next=22;break}return l.abrupt("return",d("WAResultOrError").makeError("request-error"));case 22:return l.abrupt("return",d("WAResultOrError").makeError("unspecified-http-error"));case 23:case"end":return l.stop()}},null,this,[[0,6]])}g.httpRegularUploadMedia=a}),98);
__d("WAEncryptAndUploadPlaintext",["WABase64","WAGlobals","WAHttpRegularUploadMedia","WAHttpResumeCheck","WALogger","WAMediaCrypto","WAMediaUrl","WAMediaUtils","WAProgressiveJpegGetPJpegDetails","WAResultOrError","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext: upload success "," ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext given up"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext error: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext error: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext: start upload media to ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext: error during retrier ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext: Found valid progressiveJpeg details. Adding to media entry."]);n=function(){return a};return a}function a(a){var c,e,f,g,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q;return b("regeneratorRuntime").async(function(R){while(1)switch(R.prev=R.next){case 0:c=a.mediaTypeDetails,e=a.plaintextHash,f=a.plaintext,g=a.mediaKey,o=a.mediaKeyTimestamp,p=a.uploadToken,a._size,q=a.uploadRetrier,r=a.updateMediaEntry,s=a.mediaUploadQplFlow,t=a.filename,u=a.fromOffset,v=u===void 0?0:u;if(!(c.type==="preview")){R.next=11;break}R.next=4;return b("regeneratorRuntime").awrap(d("WAMediaCrypto").computeMediaKeysForPreview(g));case 4:A=R.sent;w=A.iv;x=A.cipherKey;y=A.hmacKey;z="preview";R.next=18;break;case 11:R.next=13;return b("regeneratorRuntime").awrap(d("WAMediaCrypto").computeMediaKeys(g,c.mediaType));case 13:B=R.sent,w=B.iv,x=B.cipherKey,y=B.hmacKey,z=c.mediaType;case 18:R.next=20;return b("regeneratorRuntime").awrap(d("WAMediaCrypto").encryptAndHmac(x,w,y,f,z));case 20:C=R.sent;D=C.ciphertext;E=C.ciphertextHash;F=C.sidecar;G=C.ivCiphertext;H=null;if(!(z==="image")){R.next=41;break}R.t0=b("regeneratorRuntime");R.t1=d("WAProgressiveJpegGetPJpegDetails").getProgressiveJpegDetails;R.t2=Uint8Array;R.next=32;return b("regeneratorRuntime").awrap(d("WAMediaUtils").blobToArrayBuffer(f));case 32:R.t3=R.sent;R.t4=new R.t2(R.t3);R.t5=G;R.t6=y;R.t7=R.t1(R.t4,R.t5,R.t6);R.next=39;return R.t0.awrap.call(R.t0,R.t7);case 39:I=R.sent,d("WAProgressiveJpegGetPJpegDetails").isValidProgressiveJpegDetails(I)&&d("WAGlobals").getConfig().isProgressiveJpegSendReceiveEnabled()&&(d("WALogger").LOG(n()),H=I);case 41:J={fileSha256:d("WABase64").decodeB64UrlSafe(e),fileEncSha256:E,mediaKey:g,mediaKeyTimestamp:o,serverMediaType:z,uploadToken:p,sidecar:F,filename:t,progressiveJpegDetails:H};R.next=44;return b("regeneratorRuntime").awrap(r(J));case 44:R.next=46;return b("regeneratorRuntime").awrap(q.run(function(a,c,e){var f,g,h,i,n,o;return b("regeneratorRuntime").async(function(q){while(1)switch(q.prev=q.next){case 0:f=a.domain;g=v;if(!(e>0)){q.next=19;break}q.prev=3;h=d("WAMediaUrl").buildUploadUrl(z,p,E,f,c,!0);q.next=7;return b("regeneratorRuntime").awrap(d("WAHttpResumeCheck").httpResumeCheck(h));case 7:i=q.sent;if(!i.success){q.next=14;break}n=i.value;if(!(n.type==="media-found")){q.next=13;break}s==null?void 0:s.addAnnotations({bool:{existingMediaFound:!0}});return q.abrupt("return",d("WAResultOrError").makeResult(d("WAResultOrError").makeResult({directPath:n.directPath,objectId:null,handle:null})));case 13:n.type==="media-partial-found"&&(g=n.resumeFromBytes);case 14:q.next=19;break;case 16:q.prev=16,q.t0=q["catch"](3),d("WALogger").ERROR(m(),q.t0);case 19:g>0&&g<D.byteLength?(s==null?void 0:s.addAnnotations({"int":{fromOffset:g},bool:{continuedFromOffset:!0}}),K=D.subarray(g)):K=D;o=d("WAMediaUrl").buildUploadUrl(z,p,E,f,c,!1,g);d("WALogger").LOG(l(),o);return q.abrupt("return",d("WAHttpRegularUploadMedia").httpRegularUploadMedia(o,K).then(function(a){if(a.success){s==null?void 0:s.addPoint("upload_finish",{"int":{byteLength:K.byteLength,attempt:e}});return d("WAResultOrError").makeResult(a)}else{a=a.error;d("WALogger").LOG(k(),a);switch(a){case"server-timeout":case"unspecified-http-error":return d("WAResultOrError").makeError({progressMade:!0});default:return d("WAResultOrError").makeResult(d("WAResultOrError").makeError(a))}}})["catch"](function(a){d("WALogger").ERROR(j(),a);return d("WAResultOrError").makeError({progressMade:!1})}));case 23:case"end":return q.stop()}},null,this,[[3,16]])}));case 46:L=R.sent;if(!(L==null)){R.next=51;break}d("WALogger").WARN(i());s==null?void 0:s.endFail("maxAttemptsExceeded");return R.abrupt("return",d("WAResultOrError").makeError("max-attempts-exceeded"));case 51:if(!(L.success===!1)){R.next=54;break}s==null?void 0:s.endFail(L.error);return R.abrupt("return",L);case 54:M=L.value,N=M.directPath,O=M.objectId,P=M.handle;R.next=57;return b("regeneratorRuntime").awrap(d("WAGlobals").getDbImpls().getDownloadableThumbnailForMedia(e));case 57:Q=R.sent;J=babelHelpers["extends"]({},J,{directPath:N,downloadableThumbnail:Q,handle:P,objectId:O});R.next=61;return b("regeneratorRuntime").awrap(r(J));case 61:d("WALogger").LOG(h(),{directPath:N},{objectId:O});s==null?void 0:s.endSuccess();return R.abrupt("return",d("WAResultOrError").makeResult(J));case 64:case"end":return R.stop()}},null,this)}g.encryptAndUploadPlaintext=a}),98);
__d("WAIsMediaKeyReusable",["WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h=2*d("WATimeUtils").DAY_SECONDS;function a(a){var b=Math.floor(Math.random()*d("WATimeUtils").DAY_SECONDS);return a!=null&&d("WATimeUtils").happenedWithin(a,h+b)}g.MMS_MEDIA_KEY_TTL=h;g.isMediaKeyReusable=a}),98);
__d("WAFindReusableMediaEntry",["WAGlobals","WAIsMediaKeyReusable","WAMediaUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return d("WAGlobals").getDbImpls().getMediaKnownEntries(a).then(function(a){if(b==null)return null;a=a.get(b);if(a==null)return null;a=d("WAMediaUtils").decodeMediaEntryData(a);var c=a.fileEncSha256,e=a.mediaKey,f=a.mediaKeyTimestamp,g=a.uploadToken;a=babelHelpers.objectWithoutPropertiesLoose(a,["fileEncSha256","mediaKey","mediaKeyTimestamp","uploadToken"]);return e!=null&&g!=null&&c!=null&&f!=null&&d("WAIsMediaKeyReusable").isMediaKeyReusable(f)?babelHelpers["extends"]({},a,{fileEncSha256:c,mediaKey:e,mediaKeyTimestamp:f,uploadToken:g}):null})}g.findReusableMediaEntryForArmadillo=a}),98);
__d("WAUploadMedia",["WABase64","WACheckCiphertextInServer","WACreateRetrier","WAEncryptAndUploadPlaintext","WAFindReusableMediaEntry","WAGlobals","WALogger","WAMediaUtils","WAResultOrError","WATimeUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext: no plaintext"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["uploadMedia: media is not on the server, start uploading"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext: no plaintext"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["uploadMedia: media is partially on the server, start uploading from byteOffset ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["uploadMedia: media is on the server"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["uploadMedia: resume/exist check exhausted available retries"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["uploadMedia: async upload"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext: no plaintext"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["uploadMedia: no media entry found, need to upload media"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["uploadMedia: fail to gather media routes"]);q=function(){return a};return a}a=function(a){var c,e,f,g,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S;return b("regeneratorRuntime").async(function(T){while(1)switch(T.prev=T.next){case 0:a.chatJid,c=a.filename,e=a.hash,f=a.mediaTypeDetails,g=a.protocolMsgId,s=a.size,t=a.uploadMediaFlow;f.type==="regular"?u=f.mediaType:u="preview";T.next=4;return b("regeneratorRuntime").awrap(d("WACreateRetrier").createUploadRetrier(u,t));case 4:v=T.sent;if(v.success){T.next=9;break}d("WALogger").WARN(q());t==null?void 0:t.endFail("failToGatherMediaRoutes");return T.abrupt("return",v);case 9:w=v.value;x=r(g,e);T.next=13;return b("regeneratorRuntime").awrap(d("WAFindReusableMediaEntry").findReusableMediaEntryForArmadillo(e,g));case 13:y=T.sent;if(!(y==null)){T.next=27;break}d("WALogger").LOG(p());z=d("WAMediaUtils").createMediaKey();A=d("WAMediaUtils").createUploadToken();B=d("WATimeUtils").unixTime();T.next=21;return b("regeneratorRuntime").awrap(d("WAGlobals").getDbImpls().getMediaPlaintext(e));case 21:C=T.sent;if(!(C==null)){T.next=26;break}d("WALogger").ERROR(o());t==null?void 0:t.endFail("missingPlaintext");return T.abrupt("return",d("WAResultOrError").makeError("no-plaintext"));case 26:return T.abrupt("return",d("WAEncryptAndUploadPlaintext").encryptAndUploadPlaintext({_size:s,filename:c,mediaKey:z,mediaKeyTimestamp:B,mediaTypeDetails:f,mediaUploadQplFlow:t,plaintext:C,plaintextHash:e,updateMediaEntry:x,uploadRetrier:w,uploadToken:A}));case 27:D=y.directPath,E=y.downloadableThumbnail,F=y.fileEncSha256,G=y.fileSha256,H=y.mediaKey,I=y.mediaKeyTimestamp,J=y.objectId,K=y.uploadToken;L={directPath:D,downloadableThumbnail:E,fileEncSha256:F,filename:c,fileSha256:G||d("WABase64").decodeB64UrlSafe(e),mediaKey:H,mediaKeyTimestamp:I,objectId:J,serverMediaType:u,uploadToken:K};if(!(D!=null)){T.next=35;break}d("WALogger").LOG(n());T.next=33;return b("regeneratorRuntime").awrap(x(L));case 33:t==null?void 0:t.endSuccess({bool:{reused_media_entry:!0}});return T.abrupt("return",d("WAResultOrError").makeResult(L));case 35:T.next=37;return b("regeneratorRuntime").awrap(d("WACheckCiphertextInServer").checkCiphertextInServer(u,F,K,w));case 37:M=T.sent;if(M.success){T.next=42;break}d("WALogger").WARN(m());t==null?void 0:t.endFail("failToUpload");return T.abrupt("return",M);case 42:N=M.value;if(!(N.type==="media-found")){T.next=53;break}d("WALogger").LOG(l());t==null?void 0:t.addAnnotations({bool:{existingMediaFound:!0}});O=babelHelpers["extends"]({},L,{directPath:N.directPath,objectId:N.objectId});T.next=49;return b("regeneratorRuntime").awrap(x(O));case 49:t==null?void 0:t.endSuccess({bool:{reused_media_entry:!0}});return T.abrupt("return",d("WAResultOrError").makeResult(O));case 53:if(!(N.type==="media-partial-found")){T.next=64;break}d("WALogger").LOG(k(),N.resumeFromBytes);P=N.resumeFromBytes;T.next=58;return b("regeneratorRuntime").awrap(d("WAGlobals").getDbImpls().getMediaPlaintext(e));case 58:Q=T.sent;if(!(Q==null)){T.next=63;break}d("WALogger").ERROR(j());t==null?void 0:t.endFail("missingPlaintext");return T.abrupt("return",d("WAResultOrError").makeError("no-plaintext"));case 63:return T.abrupt("return",d("WAEncryptAndUploadPlaintext").encryptAndUploadPlaintext({_size:s,filename:c,fromOffset:P,mediaKey:H,mediaKeyTimestamp:I,mediaTypeDetails:f,mediaUploadQplFlow:t,plaintext:Q,plaintextHash:e,updateMediaEntry:x,uploadRetrier:w,uploadToken:K}));case 64:d("WALogger").LOG(i());R=d("WATimeUtils").unixTime();T.next=68;return b("regeneratorRuntime").awrap(d("WAGlobals").getDbImpls().getMediaPlaintext(e));case 68:S=T.sent;if(!(S==null)){T.next=73;break}d("WALogger").ERROR(h());t==null?void 0:t.endFail("missingPlaintext");return T.abrupt("return",d("WAResultOrError").makeError("no-plaintext"));case 73:return T.abrupt("return",d("WAEncryptAndUploadPlaintext").encryptAndUploadPlaintext({_size:s,filename:c,mediaKey:H,mediaKeyTimestamp:R,mediaTypeDetails:f,mediaUploadQplFlow:t,plaintext:S,plaintextHash:e,updateMediaEntry:x,uploadRetrier:w,uploadToken:K}));case 74:case"end":return T.stop()}},null,this)};function r(a,b){return function(c){var e=d("WAMediaUtils").encodeMediaEntryForUpload(c);if(a==null)return d("WAGlobals").getDbImpls().updateMediaEntryForOptimisticUpload(b,function(){return e},c==null?void 0:c.objectId,c==null?void 0:c.serverMediaType);else return d("WAGlobals").getDbImpls().updateMediaEntryForMsg(b,a,function(){return e},c==null?void 0:c.objectId,c==null?void 0:c.serverMediaType)}}g.uploadMedia=a}),98);
__d("MAWSendRavenActionMsg",["MAWGlobals","MAWJobDefinitions","MAWMsgType","MAWSendMsg","WAGlobals","WAJobOrchestratorTypes","WALogger","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendRavenActionMsg cannot send to a non-existent thread"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendRavenActionMsg already sent message"]);i=function(){return a};return a}a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("sendRavenActionMsg",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){b=a.args;var e=a.chatJid;a=a.externalId;yield d("MAWGlobals").getDbImpls().modifyRavenMsg(b.ravenProtocolMsgId);yield d("MAWSendMsg").maybeGetDevicesBeforeSend(e);a=(yield d("MAWGlobals").getDbImpls().writeOutgoingMsg(a,e,c.jobStartTime,b,d("MAWMsgType").MSG_TYPE.RAVEN_ACTION));if(a.type==="already_sent"){d("WALogger").LOG(i());return}else if(a.type==="missing_thread"){d("WALogger").LOG(h());return}yield d("MAWGlobals").getJobManager().waitUntilPersisted(d("MAWJobDefinitions").createStartJobInfo("sendWrittenMsg",{gotDevicesBeforeSending:d("WAGlobals").getConfig().getDevicesBeforeSend(),protocolMsgId:a.protocolMsgId,scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION},type:"message"}))});return function(b,c,d){return a.apply(this,arguments)}}()).end();g.sendRavenActionMsg=a}),98);
__d("MAWSendReactionMsg",["MAWGlobals","MAWJobDefinitions","MAWSendMsg","MAWWriteReactionMsgApi","WAGlobals","WALogger","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendReactionMsg cannot react to a non-existent message"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendReactionMsg cannot send to a non-existent thread"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendReactionMsg already sent message"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendReactionMsg: ",""]);k=function(){return a};return a}function l(a){return a==="\u2764\ufe0f"?"\u2764":a}a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("saveAndPassOff",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){b=a.args;var e=a.chatJid;a=a.externalId;d("WALogger").DEV(k(),e);var f=b.reaction,g=b.reactToProtocolMsgId;f=l(f);var m=d("MAWGlobals").getJidUtilsApi();m=m.toUserJid;m=m(b.reactToAuthor);yield d("MAWSendMsg").maybeGetDevicesBeforeSend(e);b=(yield d("MAWWriteReactionMsgApi").writeReactionMsg(a,e,{groupingKey:f,reaction:f,reactToAuthor:m,reactToExternalId:g.externalId},c.jobStartTime));if(b.type==="already_sent"){d("WALogger").LOG(j());return}else if(b.type==="missing_thread"){d("WALogger").LOG(i());return}else if(b.type==="missing_msg"){d("WALogger").LOG(h());return}yield d("MAWGlobals").getJobManager().waitUntilPersisted(d("MAWJobDefinitions").createStartJobInfo("sendWrittenMsg",{gotDevicesBeforeSending:d("WAGlobals").getConfig().getDevicesBeforeSend(),protocolMsgId:b.protocolMsgId,type:"reaction"}))});return function(b,c,d){return a.apply(this,arguments)}}()).end();g.sendReactionMsg=a}),98);
__d("MAWSendWrittenAppData",["MAWGlobals","MAWJobDefinitions","WALogger","WASendAppDataFanoutProtocol","WATimeUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenAppData(","): too old, dropping"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenAppData not sending message: ",""]);i=function(){return a};return a}a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("encryptAndSend",{code:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.appDataExternalId;var b=(yield d("MAWGlobals").getDbImpls().getAppData(a));if(b.type!=="not_sent"){d("WALogger").LOG(i(),b.type);return{type:"error"}}b=(yield d("WASendAppDataFanoutProtocol").sendAppDataToDevicesProtocol(b.appData,a,b.permittedIdentitiesPerDevice,b.sendPartial?"dontCheckPhash":"checkPhash"));if(b.success===!0){b.value.phashMismatch===!0&&(yield d("MAWGlobals").getJobManager().waitUntilPersisted(d("MAWJobDefinitions").jobSerializers.resendWrittenAppData(a)));yield d("MAWGlobals").getDbImpls().markAppDataSent(a);return{type:"success"}}else{yield d("MAWGlobals").getDbImpls().markAppDataSendFailed(a);return{type:"error"}}});function c(b){return a.apply(this,arguments)}return c}(),stopRetryIf:{onStopRetry:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.appDataExternalId;d("WALogger").LOG(h(),a);yield d("MAWGlobals").getDbImpls().markAppDataDropped(a);return{type:"error"}});function c(b){return a.apply(this,arguments)}return c}(),timePassedSeconds:d("WATimeUtils").DAY_SECONDS}}).end();g.sendWrittenAppData=a}),98);
__d("MAWMsgRecipientsTxns",["MAWDbIdentityTxns","MAWDexieTable","MAWGlobals","WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["MAWMsgRecipientsTxns -- devicesInfoPerUser is empty"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["MAWMsgRecipientsTxns -- permittedIds is empty"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["MAWMsgRecipientsTxns -- permittedIdentitiesPerDevice is different with recipientDevices"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["MAWMsgRecipientsTxns -- permittedIdentitiesPerDevice is null for msg types="," msg rows="," reactions rows=",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["MAWMsgRecipientsTxns -- permittedIdentitiesPerDevice is null in receipt"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["MAWMsgRecipientsTxns -- there is no receipt for message"]);m=function(){return a};return a}function a(a,b){return a.receipts.get(b).then(function(c){if(c==null||c.permittedIdentitiesPerDevice==null){c==null&&d("WALogger").ERROR(m());if((c==null?void 0:c.permittedIdentitiesPerDevice)==null){d("WALogger").ERROR(l());return d("MAWDexieTable").dexieAll([a.messages.where("msgId").equals(b).toArray(),a.reactions.where("reactionId").equals(b).toArray()]).then(function(a){var b=a[0];a=a[1];var c=b.map(function(a){return a.type}).toString();b=b.map(function(a){return a.rowId}).toString();a=a.map(function(a){return a.rowId}).toString();d("WALogger").ERROR(k(),c,b,a);return{isDeviceMismatch:!1,recipients:[]}})}return{isDeviceMismatch:!1,recipients:[]}}var e=c.permittedIdentitiesPerDevice,f=Array.from(e.keys());c=c.recipientDevices;c=n(c,f);c&&d("WALogger").ERROR(j());var g=new Map();e.size===0&&d("WALogger").ERROR(i());e.forEach(function(a,b){a=a.pubKey;var c=d("WAJids").extractUserJid(b);a={identity:a,jid:b};b=g.get(c)||[];b.push(a);g.set(c,b)});var o=[];g.size===0&&d("WALogger").ERROR(h());g.forEach(function(a,b){o.push({devicesInfo:a,user:b})});return{isDeviceMismatch:c,recipients:o}})}function b(a,b){return a.receipts.get(b).then(function(b){if(b==null)return{isDeviceMismatch:!1,recipients:[]};var c=[];b.statusTsPerUser.forEach(function(a,b){return c.push(b)});return d("MAWDbIdentityTxns").getIdentitiesForMultipleUsers(a,c,d("MAWGlobals").getMyDeviceJid()).then(function(a){var b=[];a.forEach(function(a,c){a=a.map(function(a){return{identity:a.identity,jid:a.deviceJid}});b.push({devicesInfo:a,user:c})});return{isDeviceMismatch:!1,recipients:b}})})}function n(a,b){if(a.size!==b.length)return!0;for(var c=0;c<b.length;c++){var d=b[c];if(!a.has(d))return!0}return!1}g.getMsgRecipients=a;g.getOriginalMsgRecipients=b}),98);
__d("MAWGetEditMsgForSending",["MAWAckLevel","MAWAsMessageApplication","MAWDbEditMsgHistoryTxns","MAWDbMsgTxns","MAWDbParticipantTxns","MAWDbThreadTxns","MAWDexieTable","MAWIndexedDb","MAWJidUtils","MAWMsgRecipientsTxns","MAWRecipientDevicesTxns","MAWTransactionMode","WAJids","WALogger","WAResultOrError","err"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[SendEditMsg] Failed to get originalMsg"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[SendEditMsg] Failed to get thread (success:",") or ICDC (success:",")"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[SendEditMsg] Failed to get originalMsgProtocolMsgId"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[SendEditMsg] Failed to get edit history"]);k=function(){return a};return a}b=d("MAWIndexedDb").makeMsgrAndSignalTransactor({contacts:(a=d("MAWTransactionMode")).READONLY,editMsgHistory:a.READONLY,identity:a.READONLY,messages:a.READONLY,participants:a.READONLY,reactions:a.READONLY,receipts:a.READONLY,threads:a.READONLY},"getEditMsgForSending",function(a){return function(b,e){return l(a,b,e).then(function(a){if(!a.success)return{type:a.error};a=a.value;var e=a.contactsInThread,f=a.contactsSyncInfo,g=a.icdcInfo,h=a.msg;a=a.recipients;var i=d("MAWAsMessageApplication").asEditMessageApplication(h);if(d("WAJids").isAuthorSystem(h.author))throw c("err")("This cannot happen because there are no system edit");return{contactsInThread:e,contactsSyncInfo:f,dbMsg:h,editOriginalExternalId:h.originalMsgExternalId,icdcInfo:g,messageApplication:i,messageType:{isRevoked:!1,type:"text"},protocolMsgId:b,recipients:a,type:"unsent"}})}});function l(a,b,c){return d("MAWDbEditMsgHistoryTxns").getEditHistoryMsgByEditedProtocolMsgId(a,b,c).then(function(b){if(b==null){d("WALogger").ERROR(k());return d("WAResultOrError").makeError("missing_history")}else if(b.sendStatus!=null&&b.sendStatus>d("MAWAckLevel").ACK.clock)return d("WAResultOrError").makeError("sent");var c=d("MAWJidUtils").maybeToProtocolMsgId(b.author,b.threadJid,b.originalMsgExternalId);if(c==null){d("WALogger").ERROR(j());return d("WAResultOrError").makeError("missing_msg")}return d("MAWDexieTable").dexieAll([d("MAWDbThreadTxns").getThreadByJid(a,b.threadJid),d("MAWDbMsgTxns").maybeGetMsgByProtocolMsgId(a,c),d("MAWDbParticipantTxns").getParticipantsInThread(a,b.threadJid).then(function(a){return a.map(function(a){return a.userJid})}),d("MAWRecipientDevicesTxns").getICDCInfoForUsersInThread(a,b.threadJid)]).then(function(c){var e=c[0],f=c[1],g=c[2],j=c[3];if(!e.success||!j.success){d("WALogger").ERROR(i(),e.success,j.success);return d("WAResultOrError").makeError("missing_thread")}if(f==null){d("WALogger").ERROR(h());return d("WAResultOrError").makeError("missing_msg")}return f.ack>d("MAWAckLevel").ACK.clock?d("WAResultOrError").makeError("sent"):d("MAWMsgRecipientsTxns").getOriginalMsgRecipients(a,f.msgId).then(function(a){return d("WAResultOrError").makeResult({contactsInThread:g,contactsSyncInfo:j.value.contactsSyncInfo,icdcInfo:j.value.icdcInfoList,msg:b,recipients:a.recipients,thread:e.value})})})})}g.getEditMsgForSending=b}),98);
__d("MAWGetMsgForSendingApi",["MAWAckLevel","MAWAsMessageApplication","MAWDbGroupInviteTxns","MAWDbMediaTxns","MAWDbMsg","MAWDbMsgTxns","MAWDbParticipantTxns","MAWDbThreadTxns","MAWDbUnrenderedMsgTxns","MAWDbXMATxns","MAWDexieTable","MAWIndexedDb","MAWMsgRecipientsTxns","MAWMsgType","MAWRecipientDevicesTxns","MAWSendMsgUtil","MAWTransactionMode","MAWXMAUtils","WAJids","WALogger","WAResultOrError","err"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[SendMsg] Failed to get XMA: isXma: ",", type: "," "]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[SendMsg] Failed to get thread (success:",")"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[SendMsg] Failed to get ICDC for users in thread ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[SendMsg] Failed to get message"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenMsg "," -- MAWGetMsgForSendingAPI -- Done"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenMsg "," -- MAWGetMsgForSendingAPI -- Unrecognized type ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenMsg "," -- MAWGetMsgForSendingAPI -- Error: ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenMsg "," -- MAWGetMsgForSendingAPI -- Entering"]);o=function(){return a};return a}b=d("MAWIndexedDb").makeMsgrAndSignalTransactor({contacts:(a=d("MAWTransactionMode")).READONLY,groupInvites:a.READONLY,identity:a.READONLY,media:a.READONLY,messages:a.READONLY,participants:a.READONLY,reactions:a.READONLY,receipts:a.READONLY,threads:a.READONLY,unrenderedMessages:a.READONLY,xma:a.READONLY},"getMsgForSending",function(a){return function(b){return p(a,b).then(function(a){d("WALogger").LOG(o(),b);if(!a.success){d("WALogger").LOG(n(),b,a.error);return{type:a.error}}a=a.value;var e=a.contactsInThread,f=a.contactsSyncInfo,g=a.groupInvite,h=a.icdcInfo,i=a.isDeviceMismatch,j=a.isReplyMsg,k=a.media,p=a.msg,q=a.recipients,r=a.thread;a=a.xmaPayload;if(!d("MAWDbMsg").NO_CONTENT_MESSAGE_TYPES_ALLOWLIST.includes(p.type)&&!d("MAWDbMsg").isContentMsg(p)){d("WALogger").LOG(m(),b,p.type);throw c("err")("We do not support message sending with "+p.type+" type")}k=d("MAWAsMessageApplication").asMessageApplication(p,k,g,a);var s=null;p.type===d("MAWMsgType").MSG_TYPE.GROUP_INVITE&&g?s={invitedParticipantUserJid:g.inviteeJid,isRevoked:!1,type:"text"}:s=d("MAWSendMsgUtil").getMessageTypeFromMsg(p.type);if(d("WAJids").isAuthorSystem(p.author))throw c("err")("A system message cannot be sent");d("WALogger").LOG(l(),b);return{contactsInThread:e,contactsSyncInfo:f,dbMsg:p,icdcInfo:h,isDeviceMismatch:i,isReplyMsg:j,isXMAMsg:a!=null,messageApplication:k,messageType:s,protocolMsgId:{author:p.author,chat:r.jid,externalId:a!=null&&a.associatedMessage!=null?a.associatedMessage.externalId:p.externalId},recipients:q,type:"unsent"}})}});function p(a,b){return d("MAWDexieTable").dexieAll([d("MAWDbMsgTxns").maybeGetMsgByProtocolMsgId(a,b),d("MAWDbUnrenderedMsgTxns").maybeGetUnrenderedMsgByProtocolMsgId(a,b)]).then(function(c){var e=c[0];c=c[1];var f=c.value,g=e||f;if(g==null){d("WALogger").ERROR(k());return d("WAResultOrError").makeError("missing_msg")}else if(g.ack>d("MAWAckLevel").ACK.clock)return d("WAResultOrError").makeError("sent");g.type===d("MAWMsgType").MSG_TYPE.REVOKED?f=d("MAWMsgRecipientsTxns").getOriginalMsgRecipients(a,g.msgId):f=d("MAWMsgRecipientsTxns").getMsgRecipients(a,g.msgId);var l=d("MAWXMAUtils").maybeXMAMessage(e),m=g.quote!=null;return d("MAWDexieTable").dexieAll([d("MAWDbThreadTxns").getThread(a,g.thread),e?d("MAWDbMediaTxns").getAndCheckMediaFromMsg(a,e):d("MAWDexieTable").dexieResolve(d("WAResultOrError").makeResult()),c.success?d("MAWDbGroupInviteTxns").getAndCheckGroupInviteFromMsg(a,c.value):d("MAWDexieTable").dexieResolve(),f,d("MAWRecipientDevicesTxns").getICDCInfoForUsersInThread(a,g.threadJid),l?d("MAWDbXMATxns").maybeGetXMAPayloadFromProtocolMsgId(a,b):null,d("MAWDbParticipantTxns").getParticipantsInThread(a,g.threadJid).then(function(a){return a.map(function(a){return a.userJid})})]).then(function(a){var b=a[0],c=a[1],e=a[2],f=a[3],k=a[4],n=a[5];a=a[6];if(!c.success)return c;if(!k.success){d("WALogger").ERROR(j(),k.error);return d("WAResultOrError").makeError(k.error)}if(!b.success){d("WALogger").ERROR(i(),b.success);return d("WAResultOrError").makeError("missing_thread")}if(n!=null&&!n.success){d("WALogger").ERROR(h(),l,g.type);return d("WAResultOrError").makeError("missing_xma")}c=c.value;b=b.value;return d("WAResultOrError").makeResult({contactsInThread:a,contactsSyncInfo:k.value.contactsSyncInfo,groupInvite:e,icdcInfo:k.value.icdcInfoList,isDeviceMismatch:f.isDeviceMismatch,isReplyMsg:m,media:c,msg:g,recipients:f.recipients,thread:b,xmaPayload:n!=null?n.value:null})})})}g.getMsgForSending=b}),98);
__d("MAWGetReactionForSending",["MAWAckLevel","MAWAsMessageApplication","MAWDbReactionsTxns","MAWDbThreadTxns","MAWDexieTable","MAWIndexedDb","MAWMsgRecipientsTxns","MAWRecipientDevicesTxns","MAWTransactionMode","WAJids","WAResultOrError","err"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){return d("MAWDbReactionsTxns").getReaction(a,b).then(function(b){if(b==null)return d("WAResultOrError").makeError("missing");else if(b.ack>d("MAWAckLevel").ACK.clock)return d("WAResultOrError").makeError("sent");return d("MAWDbThreadTxns").getThreadByJid(a,b.threadJid).then(function(c){return!c.success?d("WAResultOrError").makeError(c.error):d("MAWDexieTable").dexieAll([d("MAWMsgRecipientsTxns").getMsgRecipients(a,b.reactionId),d("MAWRecipientDevicesTxns").getICDCInfoForUsersInThread(a,c.value.jid)]).then(function(a){var c=a[0];a=a[1];return!a.success?d("WAResultOrError").makeError("missing"):d("WAResultOrError").makeResult({contactsSyncInfo:a.value.contactsSyncInfo,icdcInfo:a.value.icdcInfoList,msg:b,recipients:c.recipients})})})})}b=d("MAWIndexedDb").makeMsgrAndSignalTransactor({contacts:(a=d("MAWTransactionMode")).READONLY,identity:a.READONLY,media:a.READONLY,messages:a.READONLY,participants:a.READONLY,reactions:a.READONLY,receipts:a.READONLY,threads:a.READONLY},"getReactionForSending",function(a){return function(b){return h(a,b).then(function(a){if(!a.success)return{type:a.error};a=a.value;var b=a.contactsSyncInfo,e=a.icdcInfo,f=a.msg;a=a.recipients;var g=d("MAWAsMessageApplication").asReactionMessageApplication(f);if(d("WAJids").isAuthorSystem(f.author))throw c("err")("This cannot happen because there are no system reactions");return{chat:f.threadJid,contactsSyncInfo:b,dbMsg:f,externalId:f.externalId,icdcInfo:e,messageApplication:g,messageType:{isInvisible:!0,type:"reaction"},protocolMsgId:{author:f.author,chat:f.threadJid,externalId:f.externalId},recipients:a,type:"unsent"}})}});g.getReactionForSending=b}),98);
__d("MAWMarkEditMsgDroppedApi",["FBLogger","MAWAckLevel","MAWBridgeMsg","MAWBridgeTypesCreators","MAWDbEditMsgHistoryTxns","MAWDbMsgTxns","MAWDexieTable","MAWIndexedDb","MAWJidUtils","MAWJids","MAWThreadSnippetForTextMsg","MAWTransactionMode","WAGlobals","WAJids","WALogger","WAMsgType"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[markEditMsgDropped] editMsgHistory updated"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[markEditMsgDropped] originalMsg is not a text message"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[markEditMsgDropped] thread is null"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[markEditMsgDropped] newestEditedMsg is not the newest edit"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[markEditMsgDropped] originalMsg or editHistoryMsg is null"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[markEditMsgDropped] originalProtocolMsgId is null"]);m=function(){return a};return a}a=d("MAWIndexedDb").makeMsgrTransactor({editMsgHistory:d("MAWTransactionMode").READWRITE,messages:d("MAWTransactionMode").READWRITE,threads:d("MAWTransactionMode").READWRITE},"markEditMsgDropped",function(a){return function(b,e){var f=d("MAWJidUtils").maybeToProtocolMsgId(b.author,b.chat,e);if(f==null){d("WALogger").ERROR(m());return d("MAWDexieTable").dexieResolve()}return d("MAWDexieTable").dexieAll([a.threads.get({jid:b.chat}),d("MAWDbMsgTxns").maybeGetMsgByProtocolMsgId(a,f),d("MAWDbEditMsgHistoryTxns").maybeGetEditMsgHistoryFromProtocolMsgId(a,f),a.messages.where("quoteExternalId").equals(e).toArray()]).then(function(e){var f=e[0],g=e[1],m=e[2];e=e[3];var n=m.sort(function(a,b){return((b=b.editTs)!=null?b:0)-((b=a.editTs)!=null?b:0)}),o=m.find(function(a){return a.editExternalId===b.externalId}),p=n[1];if(g==null||p==null||o==null){d("WALogger").ERROR(l());return}if(o.editExternalId!==n[0].editExternalId){d("WALogger").ERROR(k());return}if(f==null){d("WALogger").ERROR(j());return}if(g.type!==d("WAMsgType").MSG_TYPE.TEXT){d("WALogger").ERROR(i());return}var q=babelHelpers["extends"]({},g,{ack:d("MAWAckLevel").ACK.sent,editCount:((n=g.editCount)!=null?n:0)-1,msgContent:p.msgContent}),r=d("WAGlobals").getMyUserJid(),s=[];n=e.find(function(a){var c;return(((c=a.quote)==null?void 0:c.content.author)===d("WAJids").AUTHOR_ME||((c=a.quote)==null?void 0:c.content.author)===r)&&a.threadJid===b.chat});if(n!=null){e=n.quote;var t=n.quoteExternalId;if(e==null)c("FBLogger")("messenger_e2ee_web").warn("[markEditMsgDropped] Failed to get the quoted content for a msg that has been quoted.",t);else{t=babelHelpers["extends"]({},n,{quote:babelHelpers["extends"]({},e,{content:babelHelpers["extends"]({},e.content,{msgContent:babelHelpers["extends"]({},q.msgContent)})})});s.push(t)}}n=[];g.editCount===1&&m.length===2&&n.push(p.editMsgHistoryId);n.push(o.editMsgHistoryId);return d("MAWDexieTable").dexieAll([a.messages.put(q),a.editMsgHistory.bulkDelete(n)]).then(function(){d("WALogger").LOG(h());d("MAWIndexedDb").afterTransaction({tag:"MsgUpdated",value:d("MAWBridgeMsg").createBridgeMsg(q)});s.forEach(function(a){d("MAWIndexedDb").afterTransaction({tag:"MsgUpdated",value:d("MAWBridgeMsg").createBridgeMsg(a)})});if(f.newestMsg!=null&&f.newestMsg===g.msgId){var a=d("MAWJids").userIdFromJid(d("WAGlobals").getMyUserJid()),b=c("MAWThreadSnippetForTextMsg")(q,a,d("WAJids").interpretAsGroupJid(f.jid)!=null),e=b.snippetParams;b=b.snippetType;d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread({snippetParams:e,snippetSenderContactId:a,snippetType:b,threadId:f.chatId,threadJid:f.jid})})}})})}});g.markEditMsgDropped=a}),98);
__d("MAWMarkEditMsgSentApi",["ArmadilloDataTraceType","MAWAckLevel","MAWBridgeMsg","MAWBridgeTrace","MAWBridgeTraceEvent","MAWDbEditMsgHistory","MAWDbEditMsgHistoryTxns","MAWDbMsgTxns","MAWDexieTable","MAWIndexedDb","MAWJidUtils","MAWLoadReplyMediaTxns","MAWTransactionMode","WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[markEditMsgSent] editMsgHistory updated"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[markEditMsgSent] on incoming message"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[markEditMsgSent] editMsgHistory has already been sent"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[markEditMsgSent] originalMsg or editHistoryMsg is null"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[markEditMsgSent] originalProtocolMsgId is null"]);l=function(){return a};return a}b=d("MAWIndexedDb").makeMsgrTransactor({chunk:(a=d("MAWTransactionMode")).READONLY,editMsgHistory:a.READWRITE,media:a.READONLY,messages:a.READWRITE,xma:a.READONLY},"markMsgSent",function(a){return function(b,e,f,g){var m=d("MAWJidUtils").maybeToProtocolMsgId(b.author,b.chat,e);if(m==null){d("WALogger").ERROR(l());return d("MAWDexieTable").dexieResolve()}return d("MAWDexieTable").dexieAll([d("MAWDbMsgTxns").maybeGetMsgByProtocolMsgId(a,m),d("MAWDbEditMsgHistoryTxns").maybeGetEditMsgHistoryFromProtocolMsgId(a,m)]).then(function(l){var m=l[0];l=l[1];var n=l.find(function(a){return a.editExternalId===e}),o=l.find(function(a){return a.editExternalId===b.externalId});if(m==null||n==null||(o==null?void 0:o.editExternalId)==null){d("WALogger").ERROR(k());return}if(o.sendStatus!=null&&o.sendStatus>d("MAWAckLevel").ACK.clock&&m.ack>d("MAWAckLevel").ACK.clock){d("WALogger").LOG(j());return}if(o.author!==d("WAJids").AUTHOR_ME){d("WALogger").ERROR(i());return}d("MAWIndexedDb").afterTransaction({tag:"UpdateTrace",value:d("MAWBridgeTrace").createBridgeUpdateTraceData([o.editExternalId],c("MAWBridgeTraceEvent").ReceivedSent,d("ArmadilloDataTraceType").armadilloMessageSend)});var p=[];if(l.length===2&&m.editCount===1){l=babelHelpers["extends"]({},n,{sendStatus:d("MAWAckLevel").ACK.sent});p.push(l)}n=babelHelpers["extends"]({},o,{editTs:f,sendStatus:d("MAWAckLevel").ACK.sent});p.push(n);var q=p.map(function(a){return babelHelpers["extends"]({},a,{editMsgHistoryId:d("MAWDbEditMsgHistory").convertToEditMsgHistoryId64(a.editMsgHistoryId),originalMsgId:m.msgId})}),r=babelHelpers["extends"]({},m,{ack:d("MAWAckLevel").ACK.sent});g!=null&&(r.reportingMeta=g);return d("MAWDexieTable").dexieAll([a.editMsgHistory.bulkPut(p),a.messages.put(r),d("MAWLoadReplyMediaTxns").getReplyMediaForMsgQuote(a,r)]).then(function(a){a[0];a=a[2];d("WALogger").LOG(h());d("MAWIndexedDb").afterTransaction({tag:"MsgUpdated",value:d("MAWBridgeMsg").createBridgeMsg(r,void 0,a)});d("MAWIndexedDb").afterTransaction({tag:"EditMsgHistoryAdded",value:q})})})}});g.markEditMsgSent=b}),98);
__d("MAWMarkMsgDroppedApi",["MAWAckLevel","MAWDbMsgTxns","MAWIndexedDb","MAWTransactionMode"],(function(a,b,c,d,e,f,g){"use strict";b=d("MAWIndexedDb").makeMsgrTransactor({chunk:(a=d("MAWTransactionMode")).READONLY,media:a.READONLY,messages:a.READWRITE,threads:a.READWRITE,xma:a.READONLY},"markMsgDropped",function(a){return function(b){return d("MAWDbMsgTxns").maybeGetMsgByProtocolMsgId(a,b).then(function(b){return b==null?"missing":d("MAWDbMsgTxns").updateSystemAck(a,b.msgId,d("MAWAckLevel").ACK.expired).then(function(a){return a==null?"missing":a.ack<=d("MAWAckLevel").ACK.clock?"dropped":"sent"})})}});g.markMsgDropped=b}),98);
__d("MAWMarkMsgSentApi",["ArmadilloDataTraceType","I64","MAWAckLevel","MAWBridgeTrace","MAWBridgeTraceEvent","MAWBridgeTypesCreators","MAWCalculateBumpTimestampMs","MAWDbMsg","MAWDbMsgTxns","MAWDbThread","MAWDbThreadTxns","MAWDbUnrenderedMsgTxns","MAWDexieTable","MAWEphemeralGatingUtil","MAWEphemeralMsgTxns","MAWEphemeralSettingsTxns","MAWIndexedDb","MAWMsgType","MAWThreadSnippetBuildTxns","MAWTransactionMode","WALogger","WATimeUtils","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Thread missing from DB"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Found both regular and unrendered message with the same protocol msg ID"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Msg missing from DB"]);k=function(){return a};return a}b=d("MAWIndexedDb").makeMsgrAndSignalTransactor({chunk:(a=d("MAWTransactionMode")).READONLY,contacts:a.READWRITE,groupInfo:a.READONLY,media:a.READONLY,messages:a.READWRITE,threads:a.READWRITE,unrenderedMessages:a.READWRITE,xma:a.READONLY},"markMsgSent",function(a){return function(b,e,f){return d("MAWDexieTable").dexieAll([d("MAWDbMsgTxns").maybeGetMsgByProtocolMsgId(a,b),d("MAWDbUnrenderedMsgTxns").maybeGetUnrenderedMsgByProtocolMsgId(a,b)]).then(function(g){var l=g[0];g=g[1];if(l==null&&!g.success){d("WALogger").LOG(k());return}else if(l!=null){d("MAWIndexedDb").afterTransaction({tag:"UpdateTrace",value:d("MAWBridgeTrace").createBridgeUpdateTraceData([l.externalId],c("MAWBridgeTraceEvent").ReceivedSent,d("ArmadilloDataTraceType").armadilloMessageSend)});g.success&&d("WALogger").ERROR(j());var m=l.ack<d("MAWAckLevel").ACK.sent;return d("MAWDexieTable").dexieAll([d("MAWDbMsgTxns").updateSystemAck(a,l.msgId,d("MAWAckLevel").ACK.sent,e,f),d("MAWDbThreadTxns").getThread(a,l.thread)]).then(function(b){var f=b[0];b=b[1];if(!b.success){d("WALogger").ERROR(i());return}var g=b.value,j=d("WATimeUtils").castUnixTimeToMillisTime(e);b=babelHelpers["extends"]({},g,{lastReadMsgTs:j,newestMsgTs:j,threadOrder:d("MAWDbThread").craftThreadOrder(j,g.jid)});b=m?d("MAWDbThreadTxns").updateThread(a,b):d("MAWDexieTable").dexieResolve();return d("MAWDexieTable").dexieAll([d("MAWEphemeralGatingUtil").isSendBasedDisappearingMessageEnabled()?d("MAWEphemeralMsgTxns").markEphemeralMessageAsSent(a,f):d("MAWEphemeralMsgTxns").maybeUpdateEphemeralMessageWhenMarkedSent(a,f,e),b]).then(function(){if(l.altIndex!==d("MAWDbMsg").SPAM_ALT_INDEX&&l.altIndex!==d("MAWDbMsg").FUTUREPROOF_SPAM_ALT_INDEX&&m)if(!c("gkx")("23996"))d("MAWIndexedDb").afterTransaction({tag:"ThreadBumpedServer",value:{description:"markMsgSent",isCurrentDeviceSendingMsg:!0,lastActivityTs:j,lastMsgExternalId:f?(h||(h=d("I64"))).of_string_opt(f.externalId):void 0,threadId:g.chatId,threadJid:g.jid}});else return d("MAWThreadSnippetBuildTxns").buildThreadSnippet(a,l,g).then(function(a){var b=a.snippetParams,c=a.snippetSenderContactId;a=a.snippetType;var e=l.externalId!==void 0?(h||(h=d("I64"))).of_string_opt(l.externalId):void 0;e=d("MAWCalculateBumpTimestampMs").calculateBumpTimestampMs(j,e);d("MAWIndexedDb").afterTransaction({tag:"ThreadBumpedV2",value:d("MAWBridgeTypesCreators").createBridgeBumpedThreadV2(g.chatId,g.jid,e,a,b,c,"markMsgSent",!0)})})})})}else if(g.success){var n=g.value;return d("MAWDbUnrenderedMsgTxns").updateSystemAckForUnrenderedMsg(a,n.msgId,d("MAWAckLevel").ACK.sent).then(function(){if(n.type===d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_CHANGE_FROM_CURRENT_DEVICE)return d("MAWEphemeralSettingsTxns").updateContactWhenEphemeralSettingChangeMarkedSent(a,b.chat,e)})}}).then(function(){})}});g.markMsgSent=b}),98);
__d("MAWSendWrittenMsg",["FBLogger","I64","MAWEBSwitch","MAWEBUploadTrackingUtils","MAWGetEditMsgForSending","MAWGetMsgForSendingApi","MAWGetReactionForSending","MAWGlobals","MAWJobDefinitions","MAWMarkEditMsgDroppedApi","MAWMarkEditMsgSentApi","MAWMarkMsgDroppedApi","MAWMarkMsgSentApi","MAWMsgType","MAWSendMsgUtil","MAWSharedEbUploadQueue","MessageBackupDirectiveGenerator","Promise","WAAsMessageApplication","WAFrankingTypes","WAGenReportingMeta","WAICDCUtils","WAJids","WAJobOrchestratorTypes","WALogger","WAMsg","WAMsgApplication.pb","WAPREList","WAPREMetrics","WAResultOrError","WASendMsgUtil","WASendMsgUtilV2","WASentBytesCache","WATimeUtils","asyncToGeneratorRuntime","encodeProtobuf","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenMsg END ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenMsg END ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenMsg failed to save sent bytes to cache: ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenMsg encryptAndSend message to chat ","."]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenMsg not sending message: ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenMsg ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["Triggering getDevices for users with missing icdc info."]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenMsg(","): drop result: ",""]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenMsg(","): too old, dropping"]);r=function(){return a};return a}e=24*60*60;function s(a,b){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){d("WALogger").LOG(o(),a.protocolMsgId);var f=null;e.addPoint("get_msg_for_sending",{bool:a.gotDevicesBeforeSending==="not-applicable"?{}:{gotDevicesBeforeSending:a.gotDevicesBeforeSending},string:{type:a.type}});if(a.type==="message"||a.type==="revoke")f=(yield d("MAWGetMsgForSendingApi").getMsgForSending(a.protocolMsgId));else if(a.type==="reaction")f=(yield d("MAWGetReactionForSending").getReactionForSending(a.protocolMsgId));else if(a.type==="edit")f=(yield d("MAWGetEditMsgForSending").getEditMsgForSending(a.protocolMsgId,a.referencedOriginalExternalId));else{a.type;throw c("err")("This cannot happen because type has `message` as default argument but flow does not know that")}if(f.type!=="unsent"){d("WALogger").LOG(n(),f.type);e.endFail(f.type);return d("WAResultOrError").makeError("unknown-error")}f=f;var g=f.contactsInThread,p=f.contactsSyncInfo,q=f.dbMsg,r=f.editOriginalExternalId,s=f.icdcInfo,t=f.isDeviceMismatch,v=f.isReplyMsg,w=f.isXMAMsg,A=f.messageApplication,B=f.messageType,C=f.protocolMsgId;f=f.recipients;e.addPoint("message-fetched-from-db",{bool:{isEditMsg:r!=null,isReplyMsg:v,isXMAMsg:w},string:{msgType:B.type}});var D={bytes:d("WAAsMessageApplication").castToMessageApplicationBytes(d("encodeProtobuf").encodeProtobuf(d("WAMsgApplication.pb").MessageApplicationSpec,A).readByteArray()),version:"v3"};v=a.type==="revoke"||a.type==="edit"?{originalWAMsgId:{author:q.author,chat:q.threadJid,externalId:a.referencedOriginalExternalId},type:"originalRecipients"}:{type:"chatParticipants"};if(d("MAWGlobals").getConfig().useSendMsgV2()){a=(yield d("WASendMsgUtilV2").sendChatMessage({messagePayload:{frankingKey:((w=A.metadata)==null?void 0:w.frankingKey)?d("WAFrankingTypes").castToFrankingKey(new Uint8Array((a=A.metadata)==null?void 0:a.frankingKey)):null,frankingVersion:(w=A.metadata)==null?void 0:w.frankingVersion,messageBytes:D,messageType:B,protocolMsgId:C},receiptType:v},e));a.success===!1&&(e==null?void 0:e.addPoint("send-msg-v2-failed",{string:{errorType:a.error,msgType:q.type}}));e==null?void 0:e.addPoint("sent-to-wai",{bool:{useSendMsgV2:!0}})}else{w=B.type==="text"&&B.invitedParticipantUserJid!=null?f.filter(function(a){return a.user===B.invitedParticipantUserJid||a.user===d("MAWGlobals").getMyUserJid()}):f;e==null?void 0:e.addPoint("recipients-calculated",{"int":{recipientsCount:w.length},string:{msgType:B.type}});v=B.type==="text"&&B.invitedParticipantUserJid!=null?B.invitedParticipantUserJid:C.chat;d("WALogger").LOG(m(),v);yield x(p,s,w);var E=(yield B.isRevoked===!0?(i||(i=b("Promise"))).resolve(null):d("WAGenReportingMeta").genReportingMeta(D.bytes,((f=A.metadata)==null?void 0:f.frankingKey)?d("WAFrankingTypes").castToFrankingKey(new Uint8Array((p=A.metadata)==null?void 0:p.frankingKey)):null,(f=A.metadata)==null?void 0:f.frankingVersion));a=(yield d("WASendMsgUtil").sendMessage({chat:v,deviceIdentity:null,externalId:C.externalId,icdcInfo:s,messageBytes:D,messageType:B,protocolMsgId:C,recipients:w,reportingMeta:E,type:"chat"},e).then(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){e==null?void 0:e.addPoint("sent-to-wai",{bool:{useSendMsgV2:!1}});a.success&&(yield d("WASentBytesCache").sentBytesCache().saveSentBytes({frankingKey:E==null?void 0:E.frankingKey,frankingVersion:E==null?void 0:E.frankingVersion,messageBytes:D,messageType:B,protocolMsgId:C,ts:a.value.serverTs,waMsgId:d("WAMsg").craftWAMsgIdString({author:C.author,chat:C.chat,externalId:C.externalId})})["catch"](function(a){d("WALogger").ERROR(l(),a)}));return a});return function(b){return a.apply(this,arguments)}}()))}if(a.success===!1)e.endFail(a.error),r!=null?yield d("MAWMarkEditMsgDroppedApi").markEditMsgDropped(C,r):yield d("MAWMarkMsgDroppedApi").markMsgDropped(C),d("WALogger").ERROR(k(),a.error);else{r!=null?yield y({editOriginalExternalId:r,protocolMsgId:C,reportingMeta:a.value.reportingMeta,serverTs:a.value.serverTs},e):yield z({protocolMsgId:C,reportingMeta:a.value.reportingMeta,serverTs:a.value.serverTs},e);e.endSuccess();d("WALogger").LOG(j(),a.success);if(c("MAWEBSwitch").isEnabled()&&d("MAWGlobals").getConfig().useEbUploadQueue())try{if(q!=null&&!d("WAJids").isAuthorSystem(q.author)){p=A==null?void 0:A.metadata;f=d("MessageBackupDirectiveGenerator").createMessageBackupDirectiveFromDbMsg(q);f!=null&&(d("MAWEBUploadTrackingUtils").maybeStartTrackingForUploadQueue(C,"send",0,u(q)),yield d("MAWSharedEbUploadQueue").putMsgsToEbUpload([{backupDirective:f,messageApplication:D.bytes,msgId:C,originalMsgProtocolId:f.originalMsgProtocolId.externalId!==C.externalId?f.originalMsgProtocolId:void 0,reportingMeta:yield d("WAGenReportingMeta").genReportingMeta(D.bytes,(p==null?void 0:p.frankingKey)?d("WAFrankingTypes").castToFrankingKey(new Uint8Array(p==null?void 0:p.frankingKey)):null,p==null?void 0:p.frankingVersion),senderId:(h||(h=d("I64"))).of_string(d("WAJids").authorToUserId(C.author,d("WAJids").extractUserId(d("MAWGlobals").getMyUserJid()))),serverTs:a.value.serverTs}]))}}catch(a){c("FBLogger")("labyrinth_web").mustfix("Failed to decode message application and add to EB upload queue")}}if(t===!0&&g!=null){v=new Set(g);yield d("MAWGlobals").getJobManager().waitUntilPersisted(d("MAWJobDefinitions").createStartJobInfo("getDevices",{ignoreDhash:!0,reason:"miss-recipient-in-sendWrittenMsg",scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION},users:v}))}if(a.success===!1)throw c("err")("sendWrittenMsg error");return a});return t.apply(this,arguments)}function u(a){if(a.reactToExternalId!=null)return d("MAWMsgType").MSG_TYPE.REACTION;return a.editMsgHistoryId!=null?d("MAWMsgType").MSG_TYPE.EDIT_ACTION:a.type}f=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("encryptAndSend",{code:function(a,b,c){a.s2sInstanceKey!=null&&d("MAWSendMsgUtil").addS2SInstanceKey(a.s2sInstanceKey);b=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.SEND_MESSAGE,{bool:{afterCrash:c.afterCrash,isSenderKeyPredistriubtionEnabled:d("MAWGlobals").getConfig().isSenderKeyPredistributionEnabled(),isSmartSenderKeyRotationEnabled:d("MAWGlobals").getConfig().isSmartSenderKeyRotationEnabled()},string:{jid:a.protocolMsgId.chat}},a.s2sInstanceKey);return s(a,b)},stopRetryIf:{onStopRetry:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.protocolMsgId;d("WALogger").LOG(r(),a);var b=(yield d("MAWMarkMsgDroppedApi").markMsgDropped(a));d("WALogger").LOG(q(),a,b);return d("WAResultOrError").makeError("too-many-retries")});function c(b){return a.apply(this,arguments)}return c}(),timePassedSeconds:e}}).end();var v=4*d("WATimeUtils").HOUR_SECONDS;function w(a){return a==null?!0:!d("WATimeUtils").happenedWithin(a,v)}function x(a,b,c){var e=new Map();a.forEach(function(a){return e.set(a.user,a)});var f=new Set(),g=d("MAWGlobals").getMyUserJid();a=b.find(function(a){return a.user===g});(a==null||d("WAICDCUtils").isICDCIndexInvalid(a))&&f.add(g);c.forEach(function(a){a=a.user;var b=e.get(a);b=b==null||w(b.lastSyncTs);b&&f.add(a)});if(f.size>0){d("WALogger").LOG(p());return d("MAWGlobals").getJobManager().waitUntilPersisted(d("MAWJobDefinitions").createStartJobInfo("getDevices",{ignoreDhash:!0,reason:"missing-icdc-info",scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.HIGH},users:f}))}}function a(a){if(a.reactToExternalId!=null)return a.reactToExternalId;if(a.originalMsgExternalId!=null)return a.originalMsgExternalId;switch(a.type){case d("MAWMsgType").MSG_TYPE.EDIT_ACTION:return a.originalMsgExternalId;case d("MAWMsgType").MSG_TYPE.REACTION:return a.reactToExternalId;default:return null}}function y(a,b){var c=a.editOriginalExternalId,e=a.protocolMsgId,f=a.reportingMeta;a=a.serverTs;return d("MAWMarkEditMsgSentApi").markEditMsgSent(e,c,a,f).then(function(){b==null?void 0:b.addPoint("mark_edit_msg_sent")})}function z(a,b){var c=a.protocolMsgId,e=a.reportingMeta;a=a.serverTs;return d("MAWMarkMsgSentApi").markMsgSent(c,a,e).then(function(){b==null?void 0:b.addPoint("mark_msg_sent")})}g.sendWrittenMsg=f;g.getTopLevelOfflineThreadingId=a}),98);
__d("MAWFetchAndEmitThreadApi",["MAWIndexedDb","MAWThreadFetchAndEmitTxns","MAWTransactionMode"],(function(a,b,c,d,e,f,g){"use strict";b=d("MAWIndexedDb").makeMsgrTransactor({chunk:(a=d("MAWTransactionMode")).READONLY,editMsgHistory:a.READONLY,groupInfo:a.READWRITE,groupInvites:a.READONLY,media:a.READONLY,messages:a.READWRITE,participants:a.READWRITE,reactions:a.READONLY,threads:a.READWRITE,xma:a.READONLY},"fetchAndEmitThread",function(a){return function(b,c){c===void 0&&(c="fetchAndEmitThreadInTxn");return d("MAWThreadFetchAndEmitTxns").fetchAndEmitThread(a,b,void 0,void 0,c)}});g.fetchAndEmitThreadInTxn=b}),98);
__d("MAWGetParticipantsInThreadApi",["MAWDbParticipantTxns","MAWIndexedDb","MAWTransactionMode"],(function(a,b,c,d,e,f,g){"use strict";a=d("MAWIndexedDb").makeMsgrTransactor({participants:d("MAWTransactionMode").READONLY},"getParticipantsInThread",function(a){return function(b){return d("MAWDbParticipantTxns").getParticipantsInThread(a,b)}});g.getParticipantsInThreadInTxn=a}),98);
__d("MAWSendXMAShareMsg",["MAWAckLevel","MAWBridgeMsg","MAWBridgeXMA","MAWDbMsgTxns","MAWDexieTable","MAWExpiredXMACleaner","MAWFetchAndEmitThreadApi","MAWFrontendMediaUtils","MAWGetParticipantsInThreadApi","MAWGlobals","MAWIndexedDb","MAWJobDefinitions","MAWMediaManagementTxns","MAWMediaUtils","MAWMsgType","MAWMsgUtil","MAWOptimisticUploadManager","MAWQplProxy","MAWSendMediaMsg","MAWStartMediaUploaQplFlow","MAWTransactionMode","MAWVault","MAWXMAManagementTxns","MAWXMAUtils","MWQPLMarkers","Promise","WAArmadilloXMA.pb","WAJids","WAJobOrchestratorTypes","WALogger","WAMediaUtils","WAUploadMedia","asyncToGeneratorRuntime","err","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to upload media xma"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["MAWSendXMAShareMsg - Message missing in db"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to send xma - missing thread"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["MAWSendXMAShareMsg - Associated Message missing in db"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to send xma associated msg - missing thread"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["MAWSendXMAShareMsg - Missing thread with jid: ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["MAWSendXMAShareMsg - XMAMessageType is null"]);o=function(){return a};return a}a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("sendXMAShareMsg",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){e=function(b,c){c===void 0&&(c={}),a.args.s2sUserFlowQPLEvent!=null&&d("MAWQplProxy").sendQplPointThroughBridge(a.args.s2sUserFlowQPLEvent,b,{annotations:c,instanceKey:a.args.s2sInstanceKey})};var g=function(b,c){c===void 0&&(c={}),a.args.s2sUserFlowQPLEvent!=null&&d("MAWQplProxy").sendQPLFailThroughBridge(a.args.s2sUserFlowQPLEvent,b,c,a.args.s2sInstanceKey)};e(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.RECEIVED_MESSAGE_IN_WAJOB);var p=Boolean(a.associatedMsgContent)&&a.associatedMsgContent!=null?d("MAWVault").vault(a.associatedMsgContent):void 0,q=void 0,t=a.associatedMsgContentExternalId,u=a.args.xmaMessageType;if(u==null){d("WALogger").ERROR(o());return}yield d("MAWFetchAndEmitThreadApi").fetchAndEmitThreadInTxn(a.chatJid,"sendXMAShareMsg");var v=(yield d("MAWGlobals").getDbImpls().getThreadIdByJid(a.chatJid));if(v==null){g(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.FAILED_MISSING_THREAD_IN_DB);d("WALogger").ERROR(n(),a.chatJid);return}if(c("gkx")("23945")){var w=(yield d("MAWGetParticipantsInThreadApi").getParticipantsInThreadInTxn(a.chatJid));w=w.map(function(a){return a.userJid});yield d("MAWGlobals").getJobManager().waitUntilPersisted(d("MAWJobDefinitions").createStartJobInfo("getDevices",{ignoreDhash:!0,reason:"send-xma-share-msg",users:new Set(w)}))}e(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.WRITING_XMA_TO_DB);var x=(yield d("MAWGlobals").getDbImpls().writeOutgoingMsg(a.xmaMsgExternalId,a.chatJid,f.jobStartTime,a.args,d("MAWMsgType").MSG_TYPE.XMA));if(p!=null&&t!=null){w=babelHelpers["extends"]({},a.args,{content:p});e(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.WRITING_MESSAGE_TO_DB);p=(yield d("MAWGlobals").getDbImpls().writeOutgoingMsg(t,a.chatJid,f.jobStartTime,w,d("MAWMsgType").MSG_TYPE.TEXT));if(p.type==="missing_thread"){g(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.FAILED_MESSAGE_MISSING_THREAD);d("WALogger").ERROR(m());return}t=(yield d("MAWGlobals").getDbImpls().getMsgIdByProtocolMsgId(p.protocolMsgId));if(!t.success){g(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.FAILED_MISSING_ASSOCIATED_MESSAGE_IN_DB);d("WALogger").ERROR(l());return}q=t.value}if(x.type==="missing_thread"){d("WALogger").ERROR(k());g(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.FAILED_MISSING_THREAD_IN_WRITING_XMA);return}f=(yield d("MAWGlobals").getDbImpls().getMsgIdByProtocolMsgId(x.protocolMsgId));if(!f.success){g(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.FAILED_MISSING_XMA_MESSAGE_IN_DB);d("WALogger").ERROR(j());return}var y=f.value;w=a.previewFile;p=a.headerFile;t=a.faviconFile;g=babelHelpers["extends"]({},a.xmaArgs,{overlayIconGlyph:(g=a.xmaArgs.overlayIconGlyph)!=null?g:d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.NONE,xmaLayoutType:(f=a.xmaArgs.xmaLayoutType)!=null?f:d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_XMA_LAYOUT_TYPE.SINGLE});f=(yield s(w,p,t,y,u,q,v,x.protocolMsgId,g,a.chatJid,a.args.offlineAttachmentId));e(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.SAVED_XMA_CONTENT_IN_DB);w=g.targetExpiringAtSec;p=d("MAWXMAUtils").isXMAExpired(!1,w);if(!p&&w!=null)d("MAWExpiredXMACleaner").addNewExpiredXMACleanerTimestamp(w);else if(p){t=(yield d("MAWGlobals").getJobManager().waitUntilPersisted(d("MAWJobDefinitions").createStartJobInfo("sendWrittenMsg",{gotDevicesBeforeSending:"not-applicable",protocolMsgId:x.protocolMsgId,scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION},type:"message"})));e(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.SUCCESSFUL_MESSAGE_SENT_TO_BACKEND,{bool:{isExpired:p}});return t}var z=d("MAWOptimisticUploadManager").getOptimisticUploadManager();u=(yield r(f,a.chatJid,x.protocolMsgId,z));e(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.SUCCESSFUL_UPLOAD_MEDIA_TO_BACKEND);q=u.filter(function(a){return!a.uploadResult.success}).length;if(q>0){d("WALogger").ERROR(i());return d("MAWMsgUtil").updateSystemAckWithTxn(y,d("MAWAckLevel").ACK.failed)}v=u.map(function(b){var c=b.uploadResult;b=b.media;return d("MAWSendMediaMsg").maybePersistMediaEntry(b.plaintextHash,y,a.chatJid,x.protocolMsgId.externalId,c==null?void 0:(c=c.value)==null?void 0:c.objectId,d("MAWMediaUtils").getServerMediaTypeFromMediaType(b.mediaType,"xma-media"))});yield (h||(h=b("Promise"))).all(v);e(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.SAVING_XMA_UPLOAD_RESULT_IN_DB);yield d("MAWGlobals").getJobManager().waitUntilPersisted(d("MAWJobDefinitions").createStartJobInfo("sendWrittenMsg",{gotDevicesBeforeSending:!1,protocolMsgId:x.protocolMsgId,scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION},type:"message"}));e(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.SUCCESSFUL_MESSAGE_SENT_TO_BACKEND);u.forEach(function(a){z["delete"](a.media.plaintextHash)})});return function(b,c,d){return a.apply(this,arguments)}}()).end();function p(a,b,c,d,e,f){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f,g){g=g.get(a);g=g==null?void 0:g.optimisticUploadPromise;if(g!=null)return g;g=(yield d("MAWStartMediaUploaQplFlow").startMediaUploaQplFlow({chatJid:b,fileSize:f,serverMediaType:e,uploadEntry:"sendXMAShareMsg"}));return d("WAUploadMedia").uploadMedia({chatJid:b,hash:a,mediaTypeDetails:{mediaType:e,type:"regular"},protocolMsgId:c,size:f,uploadMediaFlow:g})});return q.apply(this,arguments)}function r(a,c,e,f){a=[a.previewDbMedia,a.faviconDbMedia,a.headerDbMedia].filter(Boolean);a=a.reduce(function(a,b){a.includes(b.plaintextHash)||a.push(b);return a},[]);a=a.map(function(a){var b=d("MAWMediaUtils").getServerMediaTypeFromMediaType(a.mediaType,"xma-media");return p(a.plaintextHash,c,e,b,a.size,f).then(function(b){return{media:a,uploadResult:b}})});return(h||(h=b("Promise"))).all(a)}function s(a,b,c,d,e,f,g,h,i,j,k){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,d,e,f,g,i,j,k,l,m){a=(yield (h||(h=b("Promise"))).all([u(a),u(c),u(d)]));c=a[0];d=a[1];a=a[2];return w(e,c,d,a,f,g,i,j,k,l,m)});return t.apply(this,arguments)}function u(a){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a==null)return a;var b=a.file,e=d("MAWFrontendMediaUtils").getMediaTypeAndServerMediaTypeFromBlob(b.type,!0),f=e.mediaType;e=e.serverMediaType;var g=(yield d("MAWMediaUtils").genBlobHashes(b)),h=g[0];g=g[1];if(f!=="Image")throw c("err")("Expected Image when sending XMA share");var i=(yield d("WAMediaUtils").blobToArrayBuffer(b));return{blobArrayBuffer:i,file:b,hashedPlaintextHash:g,mediaInfo:{validatedAudioInfo:null,validatedDocumentFileInfo:null,validatedImageInfo:{height:a.height,width:a.width},validatedVideoInfo:null},mediaType:f,plaintextHash:h,serverMediaType:e}});return v.apply(this,arguments)}function w(a,b,c,e,f,g,h,i,j,k,l){var m;return d("MAWIndexedDb").makeMsgrTransactor({chunk:(m=d("MAWTransactionMode")).READWRITE,media:m.READWRITE,mediaBackup:m.READWRITE,messages:m.READWRITE,unrenderedMessages:m.READWRITE,xma:m.READWRITE},"saveXMAMediaAndMetadata",function(m){return function(){var n=new Map();b!=null&&n.set(b.plaintextHash,d("MAWMediaManagementTxns").attachHashAndSaveMedia(m,i,b.blobArrayBuffer,b.plaintextHash,void 0,void 0,b.mediaType,b.mediaInfo,b.file,!0));if(c!=null){var o=n.get(c.plaintextHash);o==null&&n.set(c.plaintextHash,d("MAWMediaManagementTxns").attachHashAndSaveMedia(m,i,c.blobArrayBuffer,c.plaintextHash,void 0,void 0,c.mediaType,c.mediaInfo,c.file,!0))}if(e!=null){o=n.get(e.plaintextHash);o==null&&n.set(e.plaintextHash,d("MAWMediaManagementTxns").attachHashAndSaveMedia(m,i,e.blobArrayBuffer,e.plaintextHash,void 0,void 0,e.mediaType,e.mediaInfo,e.file,!0))}o=Array.from(n.values());return d("MAWDexieTable").dexieAll([d("MAWDbMsgTxns").maybeGetMsg(m,g),d("MAWDexieTable").dexieAll(o)]).then(function(n){var o=n[0];n=n[1];n=n.reduce(function(a,b){return a.set(b.plaintextHash,b)},new Map());var p=b!=null?n.get(b.plaintextHash):void 0,q=c!=null?n.get(c.plaintextHash):void 0,r=e!=null?n.get(e.plaintextHash):void 0,s=d("MAWDexieTable").dexieResolve();return d("MAWXMAManagementTxns").saveXMA(m,p==null?void 0:p.mediaId,q==null?void 0:q.mediaId,r==null?void 0:r.mediaId,f,a,g,i,j,l).then(function(a){d("MAWXMAUtils").isXMAStoryReply(f)&&o!=null?s=x(m,k,a,p,o):d("MAWIndexedDb").afterTransaction({tag:"NewXMA",value:d("MAWBridgeXMA").createBridgeXMA(h,p,a)});return s.then(function(){return{faviconDbMedia:r,headerDbMedia:q,previewDbMedia:p}})})})}})()}function x(a,b,e,f,g){var h=d("WAJids").interpretAsUserJid(b);if(h==null)throw c("err")("this is a flow check, participant jid can not be null");var i=e.defaultCTA;i=i==null?void 0:i.nativeUrl;h={author:h,externalId:e.externalId,mediaId:f==null?void 0:f.mediaId,sourceId:i,ts:void 0,type:d("MAWMsgType").MSG_TYPE.XMA,xmaMessageType:e.targetType};f={content:h,remoteJid:b};if(g.type!==d("MAWMsgType").MSG_TYPE.TEXT)throw c("err")("flow check, this message type is only in text type");var j=babelHelpers["extends"]({},g,{quote:f});return a.messages.put(j).then(function(){d("MAWIndexedDb").afterTransaction({tag:"MsgUpdated",value:d("MAWBridgeMsg").createBridgeMsg(j)})})}g.sendXMAShareMsg=a}),98);
__d("WASmaxInGroupsIQErrorNotAcceptableMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"field");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"name");if(!b.success)return b;a=d("WASmaxParseUtils").attrString(a,"reason");return!a.success?a:d("WAResultOrError").makeResult({name:b.value,reason:a.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"field",h);if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","not-acceptable");if(!c.success)return c;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",406);return!a.success?a:d("WAResultOrError").makeResult({text:c.value,code:a.value,field:b.value})}g.parseIQErrorNotAcceptableField=h;g.parseIQErrorNotAcceptableMixin=a}),98);
__d("WASmaxInGroupsSetSubjectClientErrors",["WAResultOrError","WASmaxInGroupsIQErrorBadRequestMixin","WASmaxInGroupsIQErrorFallbackClientMixin","WASmaxInGroupsIQErrorForbiddenMixin","WASmaxInGroupsIQErrorItemNotFoundMixin","WASmaxInGroupsIQErrorLockedMixin","WASmaxInGroupsIQErrorNotAcceptableMixin","WASmaxInGroupsIQErrorNotAuthorizedMixin","WASmaxInGroupsIQErrorRateOverlimitMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:b.value});var c=d("WASmaxInGroupsIQErrorItemNotFoundMixin").parseIQErrorItemNotFoundMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IQErrorItemNotFound",value:c.value});var e=d("WASmaxInGroupsIQErrorNotAuthorizedMixin").parseIQErrorNotAuthorizedMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"IQErrorNotAuthorized",value:e.value});var f=d("WASmaxInGroupsIQErrorForbiddenMixin").parseIQErrorForbiddenMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"IQErrorForbidden",value:f.value});var g=d("WASmaxInGroupsIQErrorNotAcceptableMixin").parseIQErrorNotAcceptableMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"IQErrorNotAcceptable",value:g.value});var h=d("WASmaxInGroupsIQErrorLockedMixin").parseIQErrorLockedMixin(a);if(h.success)return d("WAResultOrError").makeResult({name:"IQErrorLocked",value:h.value});var i=d("WASmaxInGroupsIQErrorRateOverlimitMixin").parseIQErrorRateOverlimitMixin(a);if(i.success)return d("WAResultOrError").makeResult({name:"IQErrorRateOverlimit",value:i.value});var j=d("WASmaxInGroupsIQErrorFallbackClientMixin").parseIQErrorFallbackClientMixin(a);return j.success?d("WAResultOrError").makeResult({name:"IQErrorFallbackClient",value:j.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorBadRequest","IQErrorItemNotFound","IQErrorNotAuthorized","IQErrorForbidden","IQErrorNotAcceptable","IQErrorLocked","IQErrorRateOverlimit","IQErrorFallbackClient"],[b,c,e,f,g,h,i,j])}g.parseSetSubjectClientErrors=a}),98);
__d("WASmaxInGroupsSetSubjectResponseClientError",["WAResultOrError","WASmaxInGroupsIQErrorResponseMixin","WASmaxInGroupsSetSubjectClientErrors","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInGroupsIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInGroupsSetSubjectClientErrors").parseSetSubjectClientErrors(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorSetSubjectClientErrors:b.value}))}g.parseSetSubjectResponseClientError=a}),98);
__d("WASmaxInGroupsSetSubjectResponseServerError",["WASmaxInGroupsBaseServerErrorMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxInGroupsBaseServerErrorMixin").parseBaseServerErrorMixin(a,b);return!c.success?c:c}g.parseSetSubjectResponseServerError=a}),98);
__d("WASmaxInGroupsSetSubjectResponseSuccess",["WASmaxInGroupsIQResultResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxInGroupsIQResultResponseMixin").parseIQResultResponseMixin(a,b);return!c.success?c:c}g.parseSetSubjectResponseSuccess=a}),98);
__d("WASmaxOutGroupsSetSubjectChangeSubjectMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.subjectElementValue;a=d("WASmaxJsx").smax("iq",null,d("WASmaxJsx").smax("subject",null,a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeSetSubjectChangeSubjectMixin=a}),98);
__d("WASmaxOutGroupsSetSubjectRequest",["WASmaxJsx","WASmaxOutGroupsBaseSetGroupMixin","WASmaxOutGroupsSetSubjectChangeSubjectMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutGroupsSetSubjectChangeSubjectMixin").mergeSetSubjectChangeSubjectMixin(d("WASmaxOutGroupsBaseSetGroupMixin").mergeBaseSetGroupMixin(d("WASmaxJsx").smax("iq",null),a),a);return a}g.makeSetSubjectRequest=a}),98);
__d("WASmaxGroupsSetSubjectRPC",["WAComms","WASmaxInGroupsSetSubjectResponseClientError","WASmaxInGroupsSetSubjectResponseServerError","WASmaxInGroupsSetSubjectResponseSuccess","WASmaxOutGroupsSetSubjectRequest","WASmaxParsingFailure","WASmaxRpcUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:e=d("WASmaxOutGroupsSetSubjectRequest").makeSetSubjectRequest(a);j.next=3;return b("regeneratorRuntime").awrap(d("WAComms").sendSmaxStanza(e,c));case 3:f=j.sent;g=d("WASmaxInGroupsSetSubjectResponseSuccess").parseSetSubjectResponseSuccess(f,e);if(!g.success){j.next=7;break}return j.abrupt("return",{name:"SetSubjectResponseSuccess",value:g.value});case 7:h=d("WASmaxInGroupsSetSubjectResponseClientError").parseSetSubjectResponseClientError(f,e);if(!h.success){j.next=10;break}return j.abrupt("return",{name:"SetSubjectResponseClientError",value:h.value});case 10:i=d("WASmaxInGroupsSetSubjectResponseServerError").parseSetSubjectResponseServerError(f,e);if(!i.success){j.next=13;break}return j.abrupt("return",{name:"SetSubjectResponseServerError",value:i.value});case 13:throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("SetSubject",{Success:g,ClientError:h,ServerError:i}));case 14:case"end":return j.stop()}},null,this)}g.sendSetSubjectRPC=a}),98);
__d("MAWSetGroupSubject",["MAWGlobals","WALogger","WAResultOrError","WASmaxGroupsSetSubjectRPC","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to change subject: ",""]);h=function(){return a};return a}a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("sendSetSubjectRPC",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.group;a=a.subject;b=(yield d("WASmaxGroupsSetSubjectRPC").sendSetSubjectRPC({iqTo:b,subjectElementValue:a}));if(b.name==="SetSubjectResponseSuccess")return d("WAResultOrError").makeResult();b.name;d("WALogger").ERROR(h(),b.name);return d("WAResultOrError").makeError(b.name)});return function(b){return a.apply(this,arguments)}}()).end();g.setGroupSubject=a}),98);
__d("MAWUpdateBackupEntFbidForMedia",["LSDataTraceCheckPoint","LSIntEnum","MAWDbMediaTxns","MAWGlobals","MAWIndexedDb","MAWJobDefinitions","MAWMediaBackupTxns","MAWMediaManagementTxns","MAWTraceUtils","MAWTransactionMode","Promise","WAJobOrchestratorTypes","WALogger","WAMediaUtils","asyncToGeneratorRuntime","err","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Caught Error in updateBackupEntForFbid job for objectId ",": ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] media is null for deliveryObjectId provided"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Caught Error in makeMsgrTransactor while updating the media object with fbid ",": ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] backupEntFbid is empty"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] deliveryObjectId is empty"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Caught Error in updateBackupEntForFbid job for objectId ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] mediaBackup is null for deliveryObjectId provided"]);p=function(){return a};return a}var q=d("MAWIndexedDb").makeMsgrTransactor({media:d("MAWTransactionMode").READWRITE,mediaBackup:d("MAWTransactionMode").READWRITE},"updateBackupEntFbidInMediaBackup",function(a){return function(b,c,d){return r(a,b,c,d)}});function r(a,b,e,f){return d("MAWDbMediaTxns").maybeGetMediaBackupRowFromObjectId(a,b).then(function(g){if(g==null){d("WALogger").ERROR(p());throw c("err")("mediaBackup is null for deliveryObjectId provided")}return d("MAWDbMediaTxns").maybeGetMediaFromMediaId(a,g.mediaId).then(function(c){if(c!=null){var f=d("MAWMediaManagementTxns").updateBackupFbidInMediaEntries(c,b,e);f=babelHelpers["extends"]({},c,{fbid:e,mediaEntries:f});return a.media.update(f.mediaId,f).then(function(){if(c.msgIds.length>0)return d("MAWMediaBackupTxns").linkMediaBackup(a,c.mediaId,g.msgId,b,e)})}})["catch"](function(a){d("WALogger").ERROR(o(),a),d("MAWTraceUtils").recordFailureAndFlushForTraceId(f,(i||(i=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_MEDIA_BACKUP_FAILURE),[],"Caught Error in updateBackupEntForFbid job")}).then(function(){})})}function s(a,e,f){if(a==null||a.length===0){d("WALogger").ERROR(n());d("MAWTraceUtils").recordFailureAndFlushForTraceId(f,(i||(i=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_MEDIA_BACKUP_FAILURE),[],"deliveryObjectId is empty");return(h||(h=b("Promise"))).reject(c("err")("deliveryObjectId is empty"))}if(e==null||e.length===0){d("WALogger").ERROR(m());d("MAWTraceUtils").recordFailureAndFlushForTraceId(f,(i||(i=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_MEDIA_BACKUP_FAILURE),[],"backupEntFbid is empty");return(h||(h=b("Promise"))).reject(c("err")("backupEntFbid is empty"))}if(c("gkx")("23919"))if(a!=null&&e!=null)return q(a,e,f);else return(h||(h=b("Promise"))).resolve();else return d("MAWIndexedDb").makeMsgrTransactor({media:d("MAWTransactionMode").READWRITE,mediaBackup:d("MAWTransactionMode").READONLY},"updateBackupEntFbid",function(b){return function(){return d("MAWDbMediaTxns").maybeGetMediaFromObjectId(b,a).then(function(g){if(g!=null){var h=d("MAWMediaManagementTxns").updateBackupFbidInMediaEntries(g,a,e);g=babelHelpers["extends"]({},g,{fbid:e,mediaEntries:h});return b.media.update(g.mediaId,g)["catch"](function(a){d("WALogger").ERROR(l(),e,a),d("MAWTraceUtils").recordFailureAndFlushForTraceId(f,(i||(i=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_MEDIA_BACKUP_FAILURE),[],"Caught Error in makeMsgrTransactor while updating the media object with fbid")}).then(function(){})}else{d("WALogger").ERROR(k());throw c("err")("media is null for deliveryObjectId provided")}})["catch"](function(b){d("WALogger").ERROR(j(),a,b),d("MAWTraceUtils").recordFailureAndFlushForTraceId(f,(i||(i=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_MEDIA_BACKUP_FAILURE),[],"Caught Error in updateBackupEntForFbid job")})}})()}a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("writeToDb",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.backupEntFbid,c=a.deliveryObjectId;a=a.traceId;yield s(d("WAMediaUtils").stringToDeliveryObjectId(c),d("WAMediaUtils").stringToBackupEntFbid(b));yield d("MAWGlobals").getJobManager().waitUntilPersisted(d("MAWJobDefinitions").createStartJobInfo("backupMessageWithMedia",{backupEntFbid:b,deliveryObjectId:c,scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.LOW},traceId:a}))});return function(b){return a.apply(this,arguments)}}()).end();g.updateBackupEntFbidInMediaBackupTxn=r;g.updateBackupEntFbid=s;g.updateBackupEntFbidForMedia=a}),98);
__d("MAWUploadRetroactiveMessageBatch",["MAWGlobals","MAWUploadRetroactiveMessageBatchApi","WALogger","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["cannot upload retroactive message batch - null dbMsgArray"]);h=function(){return a};return a}a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("uploadRetroactiveMessageBatch",function(a){var b=a.chatId;a=a.dbMsgArray;a!=null?c("promiseDone")(d("MAWUploadRetroactiveMessageBatchApi").uploadRetroactiveMessageBatch(b,a)):d("WALogger").ERROR(h())}).end();g.uploadRetroactiveMessageBatch=a}),98);
__d("MAWUploadRetroactiveThreadsAndMessages",["MAWDbMsgTxns","MAWDbThreadTxns","MAWDexieTable","MAWEBSwitch","MAWGlobals","MAWIndexedDb","MAWJobDefinitions","MAWTransactionMode","Promise","WALogger","gkx","promiseDone","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] The user is not eligible for EB"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Retroactive backups failed - no threads containing messages to upload"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Initiating job: upload retroactive backups"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] thread.newestMsg is null - retroactive message uploads for thread "," cannot proceed"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Unknown error with retroactive uploads}"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Error with retroactive uploads, err: ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] thread.newestMsg is null - retroactive message uploads for thread "," cannot proceed"]);o=function(){return a};return a}var p=50,q=200,r=new Map(),s=new Map(),t=new Map();function u(a,b,c,e){return d("MAWDbMsgTxns").getMsgsFromOffset(a,b.chatId,e,p,c,!1).then(function(c){var e;c=c.msgs;(e=r.get(b.chatId))==null?void 0:e.push(c);return c.length===p?u(a,b,!1,c[c.length-1].msgId):d("MAWDexieTable").dexieResolve()})}function v(a,b){var e=r.get(b);if(e!=null){var f=e[a];c("promiseDone")(d("MAWGlobals").getJobManager().waitUntilPersisted(d("MAWJobDefinitions").jobSerializers.uploadRetroactiveMessageBatch(f,void 0,void 0,b)));a<e.length-1&&c("setTimeout")(function(){return v(a+1,b)},q)}}function w(a,b,e){if(e!=null)return u(a,b,!0,e).then(function(){c("setTimeout")(function(){return v(0,b.chatId)},q);return d("MAWDexieTable").dexieResolve()});else{d("WALogger").ERROR(o(),b.chatId);return d("MAWDexieTable").dexieResolve()}}function x(a){return d("MAWDbThreadTxns").getAllThreadsForUser(a,d("MAWGlobals").getMyUserJid()).then(function(a){a.forEach(function(a){r.set(a.chatId,[]),s.set(a.chatId,a),t.set(a.chatId,a.newestMsg)});return a})["catch"](function(a){a instanceof Error?d("WALogger").ERROR(n(),a):d("WALogger").ERROR(m())})}var y=d("MAWIndexedDb").makeMsgrTransactor({participants:(a=d("MAWTransactionMode")).READONLY,threads:a.READONLY},"getBackupThreads",function(a){return function(){return x(a)}});function z(a,b){return a.retroactiveBackupsState.count().then(function(c){if(c===0){var e=[];b.forEach(function(a){a.newestMsg!=null?e.push({msgId:a.newestMsg,threadId:a.chatId}):d("WALogger").ERROR(l(),a.chatId)});return a.retroactiveBackupsState.bulkAdd(e).then(function(){})}else{var f=[];return a.retroactiveBackupsState.each(function(a){f.push(a.threadId),t.set(a.threadId,a.msgId)}).then(function(){var a=[];r.forEach(function(b,c){f.includes(c)||a.push(c)});a.forEach(function(a){r["delete"](a),s["delete"](a),t["delete"](a)})})}})}var A=d("MAWIndexedDb").makeMsgrTransactor({media:a.READONLY,messages:a.READONLY,participants:a.READONLY,reactions:a.READONLY,threads:a.READONLY,xma:a.READONLY},"uploadBackupMessagesForThread",function(a){return function(){for(var b=arguments.length,c=new Array(b),d=0;d<b;d++)c[d]=arguments[d];return w.apply(void 0,[a].concat(c))}}),B=d("MAWIndexedDb").makeMsgrTransactor({retroactiveBackupsState:a.READWRITE},"writeRetroactiveBackupsState",function(a){return function(){for(var b=arguments.length,c=new Array(b),d=0;d<b;d++)c[d]=arguments[d];return z.apply(void 0,[a].concat(c))}});e=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("uploadAllThreadsAndMessages",function(){d("WALogger").LOG(k());if(c("gkx")("23914")){c("MAWEBSwitch").set(!0);return y().then(function(a){if(a!=null)return B(a).then(function(){s.forEach(function(a,b){a=s.get(b);a!=null&&c("promiseDone")(A(a,t.get(b)))})});else{d("WALogger").ERROR(j());return(h||(h=b("Promise"))).resolve()}})}else{d("WALogger").WARN(i());return(h||(h=b("Promise"))).resolve()}}).end();g.uploadRetroactiveThreadsAndMessages=e}),98);
__d("WAPushNotificationsSetup",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap"],(function(a,b,c,d,e,f,g){"use strict";var h=new(c("WADeprecatedWapParser"))("pushResult",function(a){a.assertAttr("type","result")});function a(a,b,c){var e;return d("WADeprecatedSendIq").deprecatedSendIq((e=d("WAWap")).wap("iq",{id:e.generateId(),to:e.S_WHATSAPP_NET,type:"set",xmlns:"urn:xmpp:whatsapp:push"},e.wap("config",{appid:e.CUSTOM_STRING(a),deviceid:e.CUSTOM_STRING(b),platform:e.CUSTOM_STRING(c)})),h)}g.setupPushNotifications=a}),98);
__d("WASendPushNotificationConfig",["WAJobs","WALogger","WAPushNotificationsSetup","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Push notification setup failed"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendPushNotificationSetup"]);i=function(){return a};return a}a=d("WAJobs").getPersistedJobsApi().definePersistedJob().finalStep("sendPushNotificationSetup",function(a){var c,e,f,g;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:c=a.appId,e=a.deviceId,f=a.platform;d("WALogger").LOG(i());j.next=4;return b("regeneratorRuntime").awrap(d("WAPushNotificationsSetup").setupPushNotifications(c,e,f));case 4:g=j.sent,g.success||d("WALogger").ERROR(h());case 6:case"end":return j.stop()}},null,this)}).end();g.sendPushNotificationSetup=a}),98);
__d("MAWJobHandlers",["MAWAcceptGroupInvite","MAWAddGroupParticipants","MAWBackupMessageWithMedia","MAWCreateGroup","MAWCreateJobNotImplemented","MAWDeleteGroups","MAWDeleteMsgsForMe","MAWDeleteThread","MAWDemoteGroupParticipants","MAWDownloadAndHandleMedia","MAWDownloadAndRestoreMedia","MAWForwardMsg","MAWGetCurrentUserDeviceList","MAWGetSpams","MAWHandleFutureProofMsg","MAWHandleSpamMsg","MAWLeaveGroups","MAWMarkThreadAsRead","MAWPromoteGroupParticipants","MAWRemoveGroupParticipants","MAWReportUserSpam","MAWRerevokePendingStanzas","MAWResendWrittenAppData","MAWRestoreMessagesFromEncryptedBackups","MAWRestoreProtobufsFromEncryptedBackups","MAWRevokeMsg","MAWSendAppData","MAWSendEditMsg","MAWSendEphemeralSettingMsg","MAWSendGroupInviteMsg","MAWSendMediaMsg","MAWSendMsg","MAWSendRavenActionMsg","MAWSendReactionMsg","MAWSendWrittenAppData","MAWSendWrittenMsg","MAWSendXMAShareMsg","MAWSetGroupSubject","MAWUpdateBackupEntFbidForMedia","MAWUploadMessagesBackup","MAWUploadRetroactiveMessageBatch","MAWUploadRetroactiveThreadsAndMessages","MAWUploadRetryStatusUtil","WAComputeAndUploadICDCInfo","WAGenerateAndUploadPreKeys","WAGetDevices","WANotifyDeviceChange","WAQueryGroups","WARemoveDevice","WARequestPreKeyDigest","WARotateSignedPreKey","WASendPushNotificationConfig","WASyncAbProps"],(function(a,b,c,d,e,f,g){"use strict";function a(){return{acceptGroupInvite:d("MAWAcceptGroupInvite").acceptGroupInvite,addGroupParticipants:d("MAWAddGroupParticipants").addGroupParticipants,backupMessageWithMedia:d("MAWBackupMessageWithMedia").backupMessageWithMedia,computeAndUploadICDCInfo:d("WAComputeAndUploadICDCInfo").computeAndUploadICDCInfo,createGroup:d("MAWCreateGroup").createGroup,deleteGroups:d("MAWDeleteGroups").deleteGroups,deleteMsgsForMe:d("MAWDeleteMsgsForMe").deleteMsgsForMe,deleteThread:d("MAWDeleteThread").deleteThread,demoteGroupParticipants:d("MAWDemoteGroupParticipants").demoteGroupParticipants,downloadAndHandleMedia:d("MAWDownloadAndHandleMedia").downloadAndHandleMedia,downloadAndRestoreMedia:d("MAWDownloadAndRestoreMedia").downloadAndRestoreMedia,forwardMsg:d("MAWForwardMsg").forwardMsg,generateAndUploadPreKeys:d("WAGenerateAndUploadPreKeys").generateAndUploadPreKeys,getCurrentUserDeviceList:d("MAWGetCurrentUserDeviceList").getCurrentUserDeviceList,getDevices:d("WAGetDevices").getDevices,getSpams:d("MAWGetSpams").getSpams,handleFutureproofMsg:d("MAWHandleFutureProofMsg").handleFutureproofMsg,handleSpamMsg:d("MAWHandleSpamMsg").handleSpamMsg,igdReportUserSpam:[],igdSendMsg:[],leaveGroups:d("MAWLeaveGroups").leaveGroups,markThreadAsRead:d("MAWMarkThreadAsRead").markThreadAsRead,notifyDeviceChange:d("WANotifyDeviceChange").notifyDeviceChange,postBackupWriteCompletionHook:d("MAWUploadRetryStatusUtil").postBackupWriteCompletionHook,promoteGroupParticipants:d("MAWPromoteGroupParticipants").promoteGroupParticipants,queryGroups:d("WAQueryGroups").queryGroups,removeDevice:d("WARemoveDevice").removeDeviceJob,removeGroupParticipants:d("MAWRemoveGroupParticipants").removeGroupParticipants,reportUserSpam:d("MAWReportUserSpam").reportUserSpam,requestAllSyncdMissingKeys:[],requestPreKeyDigest:d("WARequestPreKeyDigest").requestPreKeyDigest,rerevokeMsgs:d("MAWRerevokePendingStanzas").rerevokeMsgs,resendWrittenAppData:d("MAWResendWrittenAppData").resendWrittenAppData,restoreMessagesFromEncryptedBackups:d("MAWRestoreMessagesFromEncryptedBackups").restoreMessagesFromEncryptedBackups,restoreProtobufsFromEncryptedBackups:d("MAWRestoreProtobufsFromEncryptedBackups").restoreProtobufsFromEncryptedBackups,revokeMsgs:d("MAWRevokeMsg").revokeMsgs,rotateSignedPreKey:d("WARotateSignedPreKey").rotateSignedPreKey,sendAppData:d("MAWSendAppData").sendAppData,sendEditMsg:d("MAWSendEditMsg").sendEditMsg,sendEphemeralSettingMsg:d("MAWSendEphemeralSettingMsg").sendEphemeralSettingMsg,sendGroupInviteMsg:d("MAWSendGroupInviteMsg").sendGroupInviteMsg,sendMediaMsg:d("MAWSendMediaMsg").sendMediaMsg,sendMsg:d("MAWSendMsg").sendMsg,sendPushNotificationSetup:d("WASendPushNotificationConfig").sendPushNotificationSetup,sendRavenActionMsg:d("MAWSendRavenActionMsg").sendRavenActionMsg,sendReactionMsg:d("MAWSendReactionMsg").sendReactionMsg,sendWrittenAppData:d("MAWSendWrittenAppData").sendWrittenAppData,sendWrittenMsg:d("MAWSendWrittenMsg").sendWrittenMsg,sendXMAShareMsg:d("MAWSendXMAShareMsg").sendXMAShareMsg,setGroupSubject:d("MAWSetGroupSubject").setGroupSubject,startInstamadilloDYI:d("MAWCreateJobNotImplemented").createNotImplementedJob("startInstamadilloDYI"),syncAbProps:d("WASyncAbProps").syncAbProps,syncdSyncAllCollections:[],updateBackupEntFbidForMedia:d("MAWUpdateBackupEntFbidForMedia").updateBackupEntFbidForMedia,uploadMessagesBackup:d("MAWUploadMessagesBackup").uploadMessagesBackup,uploadRetroactiveMessageBatch:d("MAWUploadRetroactiveMessageBatch").uploadRetroactiveMessageBatch,uploadRetroactiveThreadsAndMessages:d("MAWUploadRetroactiveThreadsAndMessages").uploadRetroactiveThreadsAndMessages}}g.getJobHandlers=a}),98);
__d("minBy",[],(function(a,b,c,d,e,f){var g=function(a,b){return a-b};function a(a,b,c){c=c||g;var d=void 0,e=null;for(var a=a,f=Array.isArray(a),h=0,a=f?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i;if(f){if(h>=a.length)break;i=a[h++]}else{h=a.next();if(h.done)break;i=h.value}i=i;var j=b(i);(e===null||c(j,e)<0)&&(d=i,e=j)}return d}f["default"]=a}),66);
__d("zipWith",["minBy"],(function(a,b,c,d,e,f,g){function a(a){for(var b=arguments.length,d=new Array(b>1?b-1:0),e=1;e<b;e++)d[e-1]=arguments[e];if(d.length===0)return[];var f=c("minBy")(d,function(a){return a.length})||[];return f.map(function(b,c){b=d.map(function(a){return a[c]});return a.apply(void 0,b)})}g["default"]=a}),98);
__d("zip",["zipWith"],(function(a,b,c,d,e,f,g){function a(){for(var a=arguments.length,b=new Array(a),d=0;d<a;d++)b[d]=arguments[d];return c("zipWith").apply(void 0,[function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];return b}].concat(b))}g["default"]=a}),98);
__d("MAWBackend",["MAWAbProps","MAWBridge","MAWCOP","MAWComms","MAWDebug","MAWDebugDefineFunctions","MAWDefinePersistedJob","MAWDeleteExpiredMsgsApi","MAWDeleteForMeMsgContentCleaner","MAWDyiBatchRestoreDataSync","MAWEbRestoreQueue","MAWEbUploadQueue","MAWEphemeralCleaner","MAWExpiredXMACleaner","MAWExternalId","MAWFTSDataSync","MAWGetWorkerHeartbeatApi","MAWGlobals","MAWJobHandlers","MAWMailboxUploadDataSync","MAWMessageReceiveReliabilityLogger","MAWMockServerShell","MAWPREListeners","MAWPendingStanzaCleaner","MAWPersistedQueueApi","MAWRunInTransaction","MAWSentBytesCacheApi","MAWSharedEbUploadQueue","MAWSharedOfflineResumeStats","MAWSharedOfflineResumeUINotifier","MAWTaskDefinitions","MAWUnsendMsgContentCleaner","Promise","WAArrayBufferUtils","WACryptoManager","WACryptoManagerUtils","WADanglingQueue","WADebugTools","WADeviceNotificationFlushable","WADevicesState","WAErr","WAFetchAndSaveDevices","WAGetClockSkewApi","WAICDCUtils","WAMessageLoggingPublisher","WAOfflineUtils","WAOneQueue","WAPassiveMode","WAPersistedJobManagerV2","WAProtocolQueue","WAResolvable","WAScheduleAfterOfflineResume","WASentBytesCache","WATagsLogger","WATimeUtils","asyncToGeneratorRuntime","gkx","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Worker inited"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["deviceJid: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["initWAInfra"]);k=function(){return a};return a}b("MAWDebug");var l=d("WATagsLogger").TAGS(["backend"]);function a(a,b,c,d,e){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,m){l.LOG(k());l.LOG(j(),a.deviceJid);var n=new(d("WAResolvable").Resolvable)(),o=new(d("WAResolvable").Resolvable)(),p=d("WACryptoManagerUtils").createCryptoManager(g.crypto);d("WADevicesState").initDevicesState({fetchAndSaveDevices:function(a,b){return d("WAFetchAndSaveDevices").fetchAndSaveDevicesWithResults(new Set(a),b)}});var q=new(d("WAPersistedJobManagerV2").PersistedJobManager)({accessors:g.jobPersistenceAccessors,deprecatedJobs:{removeCurrentDevice:"NOOP"},isRestartAfterCrash:!1,listeners:{onJobFinished:function(a,b,c,e){d("MAWBridge").getBridge().fireAndForget("event","onJobFinished",{id:a,originalArgs:c,result:e,type:b},!0);return null},onJobStarted:function(){}},offlineQueueCompletePromise:o,unfinishedJobEntries:n.promise.then(function(){return g.jobPersistenceAccessors.loadAllJobs()})});d("MAWMessageReceiveReliabilityLogger").subscribeToIncomingMessageEvents(d("WAMessageLoggingPublisher").messageLoggingPublisher);var r=d("WAProtocolQueue").initProtocolQueue(d("MAWPersistedQueueApi").dexieApiForPersistedQueue()),s=new(d("WAOneQueue").WAOneQueue)({cryptoManager:p.manager,flushables:[d("WAICDCUtils").icdcFlushable,d("WADeviceNotificationFlushable").deviceNotificationFlushable,d("WAProtocolQueue").protocolQueueFlushable(r),d("WACryptoManager").cryptoManagerFlushable(p.manager)],mode:d("WAOfflineUtils").ServerRPCMode.INIT});d("MAWCOP").cop.subscribeToOfflineQueue(s,r);d("WADanglingQueue").initDanglingQueue(d("MAWPersistedQueueApi").dexieApiForPersistedQueue());d("MAWEbRestoreQueue").initEbRestoreQueue();d("MAWSharedEbUploadQueue").initEbUploadQueue();d("MAWGlobals").setGlobals({activeThreadKey:null,config:m,crypto:p,db:g.dbCallbacks,dependencies:{generateExternalId:d("MAWExternalId").generateExternalId},fbCat:d("WAArrayBufferUtils").stringToArrayBuffer(a.fbCat),hmacKey:e,jidUtils:g.jidUtils,jobResultConverter:g.jobResultConverters,myJids:{deviceJid:a.deviceJid,userJid:a.userJid},offlineResumeStats:new(d("MAWSharedOfflineResumeStats").MAWSharedOfflineResumeStats)(s,d("WAPassiveMode").passiveModeNotifier,d("MAWCOP").cop,d("WAMessageLoggingPublisher").messageLoggingPublisher),persistedJobs:{api:g.persistedJobs,manager:q},runInTransaction:d("MAWRunInTransaction").runInTransaction,waOneQueue:s});d("MAWSharedOfflineResumeUINotifier").offlineResumeUINotifier.subscribeToWAEvents(s);d("MAWSharedOfflineResumeUINotifier").offlineResumeUINotifier.subscribeToMawEvents(d("MAWCOP").cop);d("MAWSharedOfflineResumeUINotifier").offlineResumeUINotifier.subscribeToMessageEvents(d("WAMessageLoggingPublisher").messageLoggingPublisher);d("MAWEphemeralCleaner").startEphemeralCleaner({backendFns:{getNextTs:g.dbCallbacks.getNextDeletionTs,purgeEnabled:function(){return!0},removeExpired:function(){return d("MAWDeleteExpiredMsgsApi").deleteExpiredMsgs().then(function(a){return a.length>0?d("MAWDeleteExpiredMsgsApi").deleteReceipts(a).then(function(){return a.length}):a.length})}},uiFns:{getNextTs:g.dbCallbacks.getNextExpirationTs,purgeEnabled:function(){return!0},removeExpired:g.dbCallbacks.removeExpiredMsgsFromUI}});d("MAWUnsendMsgContentCleaner").startUnsendMsgContentCleaner({getNextTs:g.dbCallbacks.getNextDeleteUnsendContentTs,purgeEnabled:function(){return!0},removeExpired:g.dbCallbacks.removeExpiredUnsendMsgsContent});d("MAWDeleteForMeMsgContentCleaner").startDeleteForMeMsgContentCleaner({getNextTs:g.dbCallbacks.getNextDeleteDFMContentTs,purgeEnabled:function(){return!0},removeExpired:g.dbCallbacks.removeExpiredDFMMsgsContent});d("MAWPendingStanzaCleaner").startPendingStanzaCleaner({getNextTs:g.dbCallbacks.getNextDeletePendingStanzaTs,purgeEnabled:function(){return!0},removeExpired:g.dbCallbacks.removeExpiredPendingStanzas});d("MAWExpiredXMACleaner").startExpiredXMACleaner({getNextTs:g.dbCallbacks.getNextExpiredXMATs,purgeEnabled:function(){return!0},removeExpired:g.dbCallbacks.removeExpiredXMAMsgsContent});d("MAWDefinePersistedJob").setMsgrJobImplementations(d("MAWJobHandlers").getJobHandlers());d("WAScheduleAfterOfflineResume").scheduleAfterOfflineResume({code:function(){o.resolve();return(h||(h=b("Promise"))).resolve()},id:"task-scheduler"});d("MAWMockServerShell").isMockServerMode||c("promiseDone")(n.promise.then(function(){return d("MAWTaskDefinitions").registerTasks(o.promise)}));f.setHandlers("backend",babelHelpers["extends"]({},g.bridgeHandlers,{initMockServer:function(a){return d("MAWMockServerShell").getMockServer==null?(h||(h=b("Promise"))).reject("Mock server is not available. Make sure you use worker v2"):d("MAWMockServerShell").getMockServer().init(a)},runJobFireAndForget:function(a){return n.promise.then(function(){return q.fireAndForget(a)})},runJobWaitUntilCompleted:function(a){return n.promise.then(function(){return q.waitUntilCompleted(a)})},runJobWaitUntilPersisted:function(a){return n.promise.then(function(){return q.waitUntilPersisted(a)})},runMock:function(a){return d("MAWMockServerShell").getMockServer==null?(h||(h=b("Promise"))).reject("Mock server is not available. Make sure you use worker v2"):d("MAWMockServerShell").getMockServer().runMock(a)},setMockVariables:function(a){if(d("MAWMockServerShell").getMockServer==null)throw c("WAErr")("Mock server is not available. Make sure you use worker v2");d("MAWMockServerShell").getMockServer().setVariables(a.variables)}}));d("MAWPREListeners").initializeWAPREMetrics();c("promiseDone")(d("MAWFTSDataSync").initFTS());d("MAWMailboxUploadDataSync").initMailboxUpload();d("MAWDyiBatchRestoreDataSync").initDyiBatchUpload();r=(yield d("WAGetClockSkewApi").getClockSkew());m=r.clockSkew;d("WATimeUtils").setClockSkew(m);yield d("MAWAbProps").initAbProps();c("gkx")("23903")&&d("WADebugTools").initDebugFunctions(d("MAWDebugDefineFunctions").getAllDebugFunctions());return d("MAWComms").startComms(a.regInfo,s).then(function(){d("WASentBytesCache").initSentBytesCache(d("MAWSentBytesCacheApi").sentBytesCacheApi)}).then(function(){l.LOG(i());d("MAWGetWorkerHeartbeatApi").markWorkerAsInited();return n.resolve()}).then(function(){d("MAWEbUploadQueue").listenForEbUploadQueueFlush()})});return m.apply(this,arguments)}g.startMAWBackend=a}),98);
__d("MAWSignalIndexedDb",["MAWCurrentUser","MAWErrorObject","MAWExceededStorageQuota","MAWIndexedDbMetadata","MAWQplProxy","MAWTransactionMode","Promise","WALogger","WAWorkerGlobalScope","err","gkx","promiseDone","qex","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[SignalDb initialization] upgradeneeded is triggered in another worker. This should not happen."]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[JOB] Setting up the jobs database"]);j=function(){return a};return a}var k=null,l=null,m="jobs";function n(){return c("qex")._("940")}function o(){if(k==null)throw c("err")("SignalDB IndexDB should've been initialized");return k}function p(){if(l==null)throw c("err")("SignalDB IndexDB should've been initialized");return l.then(function(){return o()})}function a(){return k!=null}var q=[function(a){a=a.target.result;a=a.createObjectStore(m,{autoIncrement:!0,keyPath:"jobId"});a.createIndex("uniqKey","uniqKey")},function(){},function(){}];function r(){return c("gkx")("23943")}function e(a,b){b===void 0&&(b=!1);l=null;k=null;return s(a,b).then(function(){return k.version})}function s(a,c){c===void 0&&(c=!1);if(!c&&r())return(h||(h=b("Promise"))).resolve();if(l!=null)return l;if(k!=null)return(h||(h=b("Promise"))).resolve();c=d("MAWCurrentUser").getID();var e=d("MAWIndexedDbMetadata").signalDbName(c),f=(a=(c=a)!=null?c:n())!=null?a:q.length;l=new(h||(h=b("Promise")))(function(a,b){d("WALogger").LOG(j());var c=indexedDB.open(e,f);c.onupgradeneeded=function(a){for(var b=0;b<q.length;b++){var c=q[b],d=b+1;t(a,d)&&c(a)}};c.onsuccess=function(b){var c=b.target.result;c.onversionchange=function(){var a;d("WALogger").ERROR(i());c.close();(a=d("WAWorkerGlobalScope").workerGlobalScope.location)==null?void 0:a.reload==null?void 0:a.reload()};k=c;a()};c.onerror=function(){b(c.error)}});return l}function t(a,b){var c=a.newVersion;a=a.oldVersion;return a<b&&c>=b}function u(a){return a===d("MAWTransactionMode").READWRITE?"readwrite":"readonly"}function f(a,b,e,f){var g=u(b);return function(b){return function(){for(var h=arguments.length,i=new Array(h),j=0;j<h;j++)i[j]=arguments[j];var m=f!=null?d("MAWQplProxy").startQplUserFlow(f):null,n=function f(h){return p().then(function(c){var e=function(b){b=c.transaction(a,b!=null?u(b):g,{durability:"relaxed"});d("MAWExceededStorageQuota").listenToQuotaExceededError(b);return b.objectStore(a)};return b.apply(void 0,[e].concat(i))}).then(function(a){m==null?void 0:m.endSuccess();return a})["catch"](function(b){m==null?void 0:m.endFail("job_transaction_fail");b=d("MAWErrorObject").getErrorObject(b);if((b==null?void 0:b.name)==="InvalidStateError"&&h===1){l=null;k=null;c("promiseDone")(s());return f(h-1)}throw c("unrecoverableViolation")(e+":"+a+" - Error performing transaction in signalDB transactor v2","messenger_e2ee_web",b?{error:b}:{})})};return n(1)}}}g.getSignalDbVersion=n;g.getSignalDB=o;g.isSignalDBInitted=a;g.dbMigrations=q;g.makeSignalDbIgnoringPreviousCreations=e;g.makeSignalDB=s;g.makeSignalMsgrTransactor=f}),98);
__d("MAWClearSignalAndTempStores",["MAWDeleteOldLogsFromDisk","MAWDexieTable","MAWIndexedDb","MAWJobActionsV2","MAWLoggingSwitches","MAWSignalIndexedDb","MAWTransactionMode","Promise"],(function(a,b,c,d,e,f,g){"use strict";var h,i=d("MAWIndexedDb").makeSignalTransactor({meta:(a=d("MAWTransactionMode")).READWRITE,personalSenderKeyStatuses:a.READWRITE,prekey:a.READWRITE,prekeyGeneration:a.READWRITE,senderKeySessions:a.READWRITE,session:a.READWRITE,signedPrekey:a.READWRITE,tasks:a.READWRITE},"clearSignalAndTempStores",function(a){return function(){return d("MAWDexieTable").dexieAll([a.meta.clear(),a.prekey.clear(),a.prekeyGeneration.clear(),a.session.clear(),a.signedPrekey.clear(),a.tasks.clear(),a.senderKeySessions.clear(),a.personalSenderKeyStatuses.clear()]).then(function(){})}}),j=d("MAWSignalIndexedDb").makeSignalMsgrTransactor("jobs",a.READWRITE,"clearJob")(d("MAWJobActionsV2").clearJobs);c=function(){return(h||(h=b("Promise"))).all([d("MAWLoggingSwitches").removeLoggingFromBridge&&d("MAWDeleteOldLogsFromDisk").clearLogs(),i(),j()]).then(function(){})};g.clearSignalAndTempStores=c}),98);
__d("MAWConvertExtendedContentOverlayIconGlyphToXMAGatingType",["EchoMessageXMAFieldUtils","WAArmadilloXMA.pb","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Not a valid ExtendedContentOverlayIconGlyph: ",""]);h=function(){return a};return a}function a(a){switch(a){case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.INFO:return d("EchoMessageXMAFieldUtils").XMAGatingType.INFO;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.EYE_OFF:return d("EchoMessageXMAFieldUtils").XMAGatingType.EYE_OFF;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.NEWS_OFF:return d("EchoMessageXMAFieldUtils").XMAGatingType.NEWS_OFF;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.WARNING:return d("EchoMessageXMAFieldUtils").XMAGatingType.WARNING;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.PRIVATE:return d("EchoMessageXMAFieldUtils").XMAGatingType.PRIVATE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.NONE:return d("EchoMessageXMAFieldUtils").XMAGatingType.NONE;default:d("WALogger").ERROR(h(),a);return d("EchoMessageXMAFieldUtils").XMAGatingType.NONE}}g.convertExtendedContentOverlayIconGlyphToXMAGatingType=a}),98);
__d("MAWConvertExtendedContentTargetTypeToXMATargetType",["EchoMessageXMAFieldUtils","WAArmadilloXMA.pb","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Not a valid ExtendedContentTargetType: ",""]);h=function(){return a};return a}function a(a){switch(a){case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_MENTION:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_PHOTO_MENTION;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SINGLE_IMAGE_POST_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_SINGLE_IMAGE_POST_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_MULTIPOST_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_MULTIPOST_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SINGLE_VIDEO_POST_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_SINGLE_VIDEO_POST_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_PHOTO_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_VIDEO_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_CLIPS_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_CLIPS_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_IGTV_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_IGTV_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SHOP_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_SHOP_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_PROFILE_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_PROFILE_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_HIGHLIGHT_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_PHOTO_HIGHLIGHT_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_HIGHLIGHT_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_VIDEO_HIGHLIGHT_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_REPLY:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_REPLY;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_REACTION:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_REACTION;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.FB_FEED_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_REPLY:return d("EchoMessageXMAFieldUtils").XMAContentType.FB_STORY_REPLY;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.FB_STORY_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_MENTION:return d("EchoMessageXMAFieldUtils").XMAContentType.FB_STORY_MENTION;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_VIDEO_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.FB_FEED_VIDEO_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_GAMING_CUSTOM_UPDATE:return d("EchoMessageXMAFieldUtils").XMAContentType.FB_GAMING_CUSTOM_UPDATE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_PRODUCER_STORY_REPLY:return d("EchoMessageXMAFieldUtils").XMAContentType.FB_PRODUCER_STORY_REPLY;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_EXTERNAL_LINK_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.MSG_EXTERNAL_LINK_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_AUDIO_CALL:return d("EchoMessageXMAFieldUtils").XMAContentType.RTC_AUDIO_CALL;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_VIDEO_CALL:return d("EchoMessageXMAFieldUtils").XMAContentType.RTC_VIDEO_CALL;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_AUDIO_CALL:return d("EchoMessageXMAFieldUtils").XMAContentType.RTC_MISSED_AUDIO_CALL;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_VIDEO_CALL:return d("EchoMessageXMAFieldUtils").XMAContentType.RTC_MISSED_VIDEO_CALL;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_AUDIO_CALL:return d("EchoMessageXMAFieldUtils").XMAContentType.RTC_GROUP_AUDIO_CALL;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_VIDEO_CALL:return d("EchoMessageXMAFieldUtils").XMAContentType.RTC_GROUP_VIDEO_CALL;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_EVENT:return d("EchoMessageXMAFieldUtils").XMAContentType.FB_EVENT;default:d("WALogger").ERROR(h(),a);return d("EchoMessageXMAFieldUtils").XMAContentType.NONE}}g.convertExtendedContentTargetTypeToXMATargetType=a}),98);
__d("MAWConvertExtendedContentXMLLayoutTypeToXMALayoutType",["EchoMessageXMAFieldUtils","WAArmadilloXMA.pb","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Not a valid ExtendedContentXMLLayoutType: ",""]);h=function(){return a};return a}function a(a){switch(a){case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_XMA_LAYOUT_TYPE.SINGLE:return d("EchoMessageXMAFieldUtils").XMALayoutType.SINGLE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_XMA_LAYOUT_TYPE.PORTRAIT:return d("EchoMessageXMAFieldUtils").XMALayoutType.PORTRAIT;default:d("WALogger").ERROR(h(),a);return d("EchoMessageXMAFieldUtils").XMALayoutType.SINGLE}}g.convertExtendedContentXMLLayoutTypeToXMALayoutType=a}),98);
__d("MAWCryptoAuthTokenWrapper",["MessengerWebInitData"],(function(a,b,c,d,e,f,g){"use strict";function a(){return d("MessengerWebInitData").cryptoAuthToken}g.getCryptoAuthToken=a}),98);
__d("MAWDeviceRegistrationActions",["MAWCompareIdentity","MAWCurrentUser","MAWDexieTable","MAWLoggerUtils","MessengerWebInitData","SignalDbTypes","WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": signedPrekey}"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Device Registration Meta Check] Device Id should be a number"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["MAWDeviceRegistrationActions: sessionId is null"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": ",""]);o=function(){return a};return a}var p="Device registration meta is incomplete: ",q=d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.DeviceRegistration]);function r(a,b,c,e,f){(a!=null||b!=null||c!=null||e!=null||f!=null)&&(a==null&&q.TAGS([d("MAWLoggerUtils").Tag.SignedPrekey]).ERROR(o(),p,d("SignalDbTypes").MetaKeysEnum.lastSignedPrekeyId),b==null&&q.ERROR(n(),p,d("SignalDbTypes").MetaKeysEnum.deviceUUID),c==null&&q.ERROR(m(),p,d("SignalDbTypes").MetaKeysEnum.regId),e==null&&q.ERROR(l(),p,d("SignalDbTypes").MetaKeysEnum.identityKeyPair),f==null&&q.ERROR(k(),p,d("SignalDbTypes").MetaKeysEnum.fbid))}function a(a){var b;return d("MAWDexieTable").dexieAll([a.meta.bulkGet([(b=d("SignalDbTypes")).MetaKeysEnum.lastSignedPrekeyId,b.MetaKeysEnum.deviceUUID,b.MetaKeysEnum.lastSessionDeviceWasLinkedTo,b.MetaKeysEnum.regId,b.MetaKeysEnum.identityKeyPair,b.MetaKeysEnum.fbid,b.MetaKeysEnum.deviceId,b.MetaKeysEnum.registrationVersion]),d("MAWCompareIdentity").compareIdentityDexie(a)]).then(function(b){var e=b[0],f=e[0],g=e[1],k=e[2],l=e[3],m=e[4],n=e[5],o=e[6];e=e[7];var s=b[1],t=f==null?void 0:(b=f.value)==null?void 0:b.lastSignedPrekeyId,u=g==null?void 0:(f=g.value)==null?void 0:f.deviceUUID,v=k==null?void 0:(b=k.value)==null?void 0:b.lastSessionDeviceWasLinkedTo,w=l==null?void 0:(g=l.value)==null?void 0:g.regId,x=m==null?void 0:(f=m.value)==null?void 0:f.identityKeyPair;b=n==null?void 0:(k=n.value)==null?void 0:k.fbid;var y=o==null?void 0:(l=o.value)==null?void 0:l.deviceId,z=e==null?void 0:e.value.registrationVersion;if(t==null||u==null||w==null||x==null||b==null){r(t,u,w,x,b);return null}c("MessengerWebInitData").sessionId==null&&q.ERROR(j());if(y!=null&&typeof y!=="number"){q.ERROR(i());return null}return a.signedPrekey.get(t).then(function(a){if(a==null){q.TAGS([d("MAWLoggerUtils").Tag.SignedPrekey]).ERROR(h(),p);return null}return{deviceId:y,deviceUUID:u,identityCompareResult:s,lastSessionDeviceWasLinkedTo:v,lastSignedPrekeyId:t,registrationVersion:z,signalRegInfo:{identityKeyPair:x,regId:w,signedPreKey:a}}})})}function b(a,b){var c;return d("MAWDexieTable").dexieAll([a.meta.bulkPut([{key:(c=d("SignalDbTypes")).MetaKeysEnum.deviceUUID,value:{deviceUUID:b.deviceUUID}},{key:c.MetaKeysEnum.fbid,value:{fbid:d("MAWCurrentUser").getID()}},{key:c.MetaKeysEnum.regId,value:{regId:b.signalRegInfo.regId}},{key:c.MetaKeysEnum.identityKeyPair,value:{identityKeyPair:b.signalRegInfo.identityKeyPair}},{key:c.MetaKeysEnum.lastSignedPrekeyId,value:{lastSignedPrekeyId:b.signalRegInfo.signedPreKey.keyId}},{key:c.MetaKeysEnum.registrationVersion,value:{registrationVersion:b.registrationVersion}},{key:c.MetaKeysEnum.authKeyPair,value:{authKeyPair:b.signalRegInfo.authKeyPair}}]),a.signedPrekey.put(b.signalRegInfo.signedPreKey)])}function e(a,b){return a.meta.put({key:d("SignalDbTypes").MetaKeysEnum.deviceId,value:{deviceId:b}})}function f(a,b){return a.meta.put({key:d("SignalDbTypes").MetaKeysEnum.lastSessionDeviceWasLinkedTo,value:{lastSessionDeviceWasLinkedTo:b}})}function s(a,b,c){return a.contacts.get(b).then(function(d){if(d!=null)return a.contacts.put(babelHelpers["extends"]({},d,{icdcInfo:c}));else return a.contacts.put({contactJid:b,dhash:null,icdcInfo:c})}).then(function(){})}g.getRegistrationMetaDexie=a;g.saveUnsentRegistrationMeta=b;g.saveDeviceId=e;g.saveLastSessionDeviceWasLinkedTo=f;g.saveICDC=s}),98);
__d("XArmadilloWebLinkDeviceToSessionControllerRouteBuilder",["jsRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsRouteBuilder")("/messenger/armadillo/link_device/",Object.freeze({}),void 0);b=a;g["default"]=b}),98);
__d("MAWDeviceRegistrationSessionUtil",["CSRFGuard","DTSG","DTSGUtils","MAWDeviceRegistrationActions","MAWIndexedDb","MAWLoggerUtils","MAWTransactionMode","PHPQuerySerializer","SprinkleConfig","WATagsLogger","WAWorkerGlobalScope","XArmadilloWebLinkDeviceToSessionControllerRouteBuilder","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[LinkDeviceToTheSession] fetch result is not succesful"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[LinkDeviceToTheSession] success"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[LinkDeviceToTheSession] parse response error ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[LinkDeviceToTheSession] fetch is not 200: ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[LinkDeviceToTheSession] fetch error ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[LinkDeviceToTheSession] deviceUUID is null"]);n=function(){return a};return a}var o=d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.DeviceRegistration]),p=d("MAWIndexedDb").makeSignalTransactor({meta:d("MAWTransactionMode").READWRITE},"saveLastSessionDeviceWasLinkedTo",function(a){return function(b){return d("MAWDeviceRegistrationActions").saveLastSessionDeviceWasLinkedTo(a,b)}});function a(a,b){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e;e=(e=d("WAWorkerGlobalScope").workerGlobalScope.location)==null?void 0:e.origin;if(e==null||e==="")return;if(a==null){o.ERROR(n());return}e=new URL(e).hostname;e=(e=c("XArmadilloWebLinkDeviceToSessionControllerRouteBuilder").buildUri({}).setDomain(e))==null?void 0:(e=e.setProtocol("https"))==null?void 0:e.toString();if(e==null)return;var f=d("DTSG").getToken();if(f==null)return;a={device_id:a,fb_dtsg:f};c("SprinkleConfig").param_name&&(a[c("SprinkleConfig").param_name]=c("DTSGUtils").getNumericValue(f));f=d("WAWorkerGlobalScope").workerGlobalScope.fetch;var g;try{g=(yield f(e,{body:(h||(h=c("PHPQuerySerializer"))).serialize(a),headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",redirect:"error"}))}catch(a){o.ERROR(m(),a);return}if(!g.ok){o.ERROR(l(),g.status);return}f=(yield g.text());d("CSRFGuard").exists(f)&&(f=d("CSRFGuard").clean(f));var q;try{q=JSON.parse(f)}catch(a){o.ERROR(k(),a);return}((e=q)==null?void 0:e.success)===!0?(o.LOG(j()),yield p(b)):o.WARN(i())});return q.apply(this,arguments)}g.linkDeviceToTheSession=a}),98);
__d("WAPreRegistrationCrypto",["WACryptoManager","WAErr","WASignalSignatures","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(){var a,c,e,f,g,h,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:k.next=2;return b("regeneratorRuntime").awrap(d("WACryptoManager").generateRegistrationInfo());case 2:a=k.sent;c=a.regId;e=a.staticKeyPair;f=a.authKeyPair;g=Date.now();k.next=9;return b("regeneratorRuntime").awrap(d("WASignalSignatures").generateSignedPreKey(1,g,e));case 9:h=k.sent;i=h.plainObject;j=h.record;return k.abrupt("return",{regId:c,identityKeyPair:e,authKeyPair:f,signedPreKey:{keyId:i.id,encoded:j}});case 13:case"end":return k.stop()}},null,this)}function e(a){var b=d("WASignalSignatures").deserializeSignedPreKey(a.signedPreKey.encoded);if(b==null||b.id!==a.signedPreKey.keyId)throw c("WAErr")("Badly formatted signed prekey");return{regId:a.regId,identityPubKeyType:5,identityPubKey:a.identityKeyPair.publicKey,signedPreKey:b}}g.makeRegistrationData=a;g.serializeRegistrationData=e}),98);
__d("MAWDeviceRegistrationUtilWorker",["MAWConstants","MAWCurrentUser","MAWDeviceRegistrationTypes","MAWLoggerUtils","URI","WABase64","WAPreRegistrationCrypto","WATagsLogger","WAWorkerGlobalScope","asyncToGeneratorRuntime","err","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["ICDC failed to fetch url:",". error: ",""]);i=function(){return a};return a}function j(a,b){var c=new Uint8Array(b);a=a;for(b=b-1|0;b>=0;--b)c[b]=a&255,a=a>>>8;return c}function k(a,b,c,e,f,g,h,i,k){var l;f=(l=d("WABase64")).encodeB64(j(f,4));g=l.encodeB64(j(g,1));h=l.encodeB64(h);var m=l.encodeB64(j(i.id,3)),n=l.encodeB64(i.keyPair.publicKey);l=l.encodeB64(i.signature);i=new Map().set("fbid",a).set("fb_cat",b).set("app_id",c).set("device_id",e).set("e_regid",f).set("e_keytype",g).set("e_ident",h).set("e_skey_id",m).set("e_skey_val",n).set("e_skey_sig",l);if(k){a=d("WABase64").encodeB64(k.signedICDCIdentityList);b=d("WABase64").encodeB64(k.ihash);i.set("icdc_list",a).set("icdc_ts",k.ts).set("icdc_seq",k.seq).set("ihash",b)}return i}function l(a){var b=[];a.forEach(function(a,c,d){b.push(encodeURIComponent(c)+("="+encodeURIComponent(a.toString())))});return b.join("&")}function m(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{a=(yield d("WAWorkerGlobalScope").workerGlobalScope.fetch(b,{body:a,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},method:"POST"}));return yield a.json()}catch(c){a=c.message||c.description||c;d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.DeviceRegistration]).ERROR(i(),b,a);throw c}});return n.apply(this,arguments)}function o(a,b){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=(yield d("WAWorkerGlobalScope").workerGlobalScope.fetch(b,{body:a,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},method:"POST"}));return b.json()});return p.apply(this,arguments)}function q(){var a=new(h||(h=c("URI")))(t()+d("MAWDeviceRegistrationTypes").ICDC_ENDPOINT);return a.toString()}function r(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=q();a=(yield m(a,b));if(a==null)throw c("err")(d("MAWDeviceRegistrationTypes").NULL_RESPONSE_FROM_SERVER);if(a.status!==200)throw c("err")("WA Server returned status code "+a.status+" while attempting device registration");return a});return s.apply(this,arguments)}function t(){var a=Number(d("MAWCurrentUser").getAppID()),b=d("MAWDeviceRegistrationTypes").REG_FB_DOMAIN;switch(a){case 1217981644879628:case 936619743392459:case 487152425211411:case 1035956773910536:b=d("MAWDeviceRegistrationTypes").REG_IGD_DOMAIN;break;case 772021112871879:b=d("MAWDeviceRegistrationTypes").REG_MSGR_DOMAIN;break;default:b=d("MAWDeviceRegistrationTypes").REG_FB_DOMAIN}return b}function u(){var a=new(h||(h=c("URI")))(t()+d("MAWDeviceRegistrationTypes").REGISTRATION_ENDPOINT);return a.toString()}function v(a){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=u(),e;try{e=(yield o(a,b))}catch(a){throw c("err")("Post request failed: "+(a==null?void 0:a.message)+" url:"+b)}if(e==null)throw c("err")(d("MAWDeviceRegistrationTypes").NULL_RESPONSE_FROM_SERVER);if(e.wa_device_id==null||e.status!==200){a=e.message!=null?': "'+e.message+'"':"";b="WA Server returned status code "+e.status+a+" while attempting device registration";throw c("err")(b)}if(typeof e.wa_device_id!=="number")throw c("err")("Device ID from WA Server was not a number");return{deviceId:e.wa_device_id,icdcSuccess:(a=e.icdc_success)!=null?a:!1,type:e.type}});return w.apply(this,arguments)}function a(a,b,c,d){a=new Map().set("fbid",a).set("fb_cat",b).set("app_id",c).set("device_id",d);b=l(a);return r(b)}function e(a,b,c,d,e,f,g,h,i){a=k(a,b,c,d,e,f,g,h,i);b=l(a);return v(b)}function f(){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAPreRegistrationCrypto").makeRegistrationData());return{deviceUUID:c("uuidv4")(),lastSignedPrekeyId:a.signedPreKey.keyId,registrationVersion:d("MAWConstants").CURRENT_REGISTRATION_VERSION,signalRegInfo:a}});return x.apply(this,arguments)}g.getRegistrationEndpoint=u;g.fetchICDC=a;g.register=e;g.createNewRegistrationMeta=f}),98);
__d("MAWDeviceRegistrationWorker",["IGDWebUtils","MAWClearSignalAndTempStores","MAWCryptoAuthTokenWrapper","MAWCurrentUser","MAWDbMetaTxns","MAWDeviceRegistrationActions","MAWDeviceRegistrationSessionUtil","MAWDeviceRegistrationTypes","MAWDeviceRegistrationUtilWorker","MAWIndexedDb","MAWJids","MAWLoggerUtils","MAWMockServerShell","MAWODSProxy","MAWQplProxy","MAWTransactionMode","MessengerWebInitData","Promise","WAICDCUtils","WAIdentityUtils","WAOdsEnums","WAPreRegistrationCrypto","WASignalKeys","WATagsLogger","WATimeUtils","asyncToGeneratorRuntime","cr:2025","gkx","promiseDone","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Skipping device registration"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Crypto Auth Token was null or incomplete"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Cannot process ICDC payload during registration: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Beginning device registration"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Device registration failure - ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);n=function(){return a};return a}var o=typeof window!=="undefined"?window:self,p=d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.DeviceRegistration]),q=!1,r,s=function(){return d("IGDWebUtils").isInstagramWebSupportedApp(Number(d("MAWCurrentUser").getAppID()))};function t(a){var b;b=(b=o.location.origin)!=null?b:"unknown";q||(r=d("MAWQplProxy").startQplUserFlow(c("qpl")._(25302457,"311"),{bool:{identityCompareResult:a.identityCompareResult,isDeviceRegistrationDomainUniquenessEnabled:c("gkx")("23930")},"int":{registrationVersion:a.registrationVersion},string:{hostname:b}}),q=!0)}function u(){if(q){var a;(a=r)==null?void 0:a.endFail("failure_during_device_registration");r=null}}function a(){if(q){var a;(a=r)==null?void 0:a.endSuccess();r=null}}function v(a){var b;(b=r)==null?void 0:b.addPoint("wa_registration_response",{string:{registrationType:a}})}function w(a){return{message:a,registrationState:d("MAWDeviceRegistrationTypes").RegistrationStatesEnum.failed}}var x=function(a){return d("MAWIndexedDb").makeSignalTransactor({meta:d("MAWTransactionMode").READWRITE,signedPrekey:d("MAWTransactionMode").READWRITE},"inMetaStoreAndSignedPreKey",function(b){return function(c){return a(b,c)}})},y=function(a){return d("MAWIndexedDb").makeSignalTransactor({meta:d("MAWTransactionMode").READWRITE},"saveDeviceId",function(b){return function(c){return a(b,c)}})};function z(a){return A.apply(this,arguments)}function A(){A=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){p.LOG(l());var b=(yield d("MAWDeviceRegistrationUtilWorker").createNewRegistrationMeta());yield x(d("MAWDeviceRegistrationActions").saveUnsentRegistrationMeta)(b);var e=d("MAWCurrentUser").getID(),f=b.deviceUUID,g=d("WAPreRegistrationCrypto").serializeRegistrationData(b.signalRegInfo),h=null,i=!1;i=(i=i?1019394685547802:d("MAWCurrentUser").getAppID())==null?void 0:i.toString();if(i==null)return w("appId is null, cannot register to WhatsApp");if(e==="0")return w(d("MAWDeviceRegistrationTypes").DEVICE_REGISTER_ERROR_ZERO_AS_USER_ID);var j=null,m=null;try{var n=(yield d("MAWDeviceRegistrationUtilWorker").fetchICDC(e,a.encrypted_serialized_cat,i,f)),o=[].concat(d("WAICDCUtils").base64DeviceIdentitiesToSerializedPubKeys(n.device_identities));if(n.curr_identity_idx!=null){var q=n.curr_identity_idx;o[q]=d("WASignalKeys").serializeIdentity(g.identityPubKey)}else o.push(d("WASignalKeys").serializeIdentity(g.identityPubKey));j=d("WAICDCUtils").computeICDCInfoForUpload(b.signalRegInfo.identityKeyPair,n.icdc_seq,o,"registration","registration");m=(yield d("WAIdentityUtils").computeIdentitiesHash(o))}catch(a){p.ERROR(k(),a)}q=!1;try{b=(yield d("MAWDeviceRegistrationUtilWorker").register(e,a.encrypted_serialized_cat,i,f,g.regId,g.identityPubKeyType,g.identityPubKey,g.signedPreKey,j&&m?{ihash:m,seq:j.icdcInfo.seq,signedICDCIdentityList:j.encodedSignedICDC,ts:j.icdcInfo.timestamp}:null));n=b==null?void 0:b.type;n!=null&&d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.REGISTRATION_TYPE,key:n});h=b==null?void 0:b.deviceId;q=(o=b==null?void 0:b.icdcSuccess)!=null?o:!1;v(b==null?void 0:b.type)}catch(a){return w(a)}if(h==null)return w(d("MAWDeviceRegistrationTypes").NULL_RESPONSE_FROM_SERVER);a=d("MAWJids").toUserJid(e);if(!s()){i=c("MessengerWebInitData").sessionId;i!=null&&c("promiseDone")(d("MAWDeviceRegistrationSessionUtil").linkDeviceToTheSession(f,i))}if(j!=null&&q){g=j.icdcInfo;m=function(a){return d("MAWIndexedDb").makeSignalTransactor({contacts:d("MAWTransactionMode").READWRITE},"saveICDC",function(b){return function(c,d){return a(b,c,d)}})};yield m(d("MAWDeviceRegistrationActions").saveICDC)(a,{devices:g.devices,dirty:!0,sequence:g.seq,signingDeviceIndex:g.signingDeviceIndex,timestamp:g.timestamp})}yield y(d("MAWDeviceRegistrationActions").saveDeviceId)(h);return{message:d("MAWDeviceRegistrationTypes").DEVICE_SUCCESSFULLY_REGISTERED,registrationState:d("MAWDeviceRegistrationTypes").RegistrationStatesEnum.finished}});return A.apply(this,arguments)}var B=function(a){return d("MAWIndexedDb").makeSignalTransactor({identity:d("MAWTransactionMode").READONLY,meta:d("MAWTransactionMode").READONLY,signedPrekey:d("MAWTransactionMode").READONLY},"checkExistingRegistration",function(b){return function(){return a(b)}})()};function e(a){return C.apply(this,arguments)}function C(){C=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=d("MAWCryptoAuthTokenWrapper").getCryptoAuthToken();if(e==null||e.encrypted_serialized_cat===""){p.WARN(j());return w(d("MAWDeviceRegistrationTypes").DEVICE_REGISTER_ERROR_EMPTY_CAT_TOKEN)}if(!d("WATimeUtils").isInFuture(d("WATimeUtils").castToUnixTime(e.expiration_time_in_seconds)))return w(d("MAWDeviceRegistrationTypes").DEVICE_REGISTER_ERROR_EXPIRED_CAT_TOKEN);if(d("MAWMockServerShell").isMockServerMode){var f=(yield d("MAWDeviceRegistrationUtilWorker").createNewRegistrationMeta());yield (h||(h=b("Promise"))).all([x(d("MAWDeviceRegistrationActions").saveUnsentRegistrationMeta)(f),y(d("MAWDeviceRegistrationActions").saveDeviceId)(d("MAWJids").interpretAsDeviceId(1)),d("MAWDbMetaTxns").saveCAT(e)]);return{message:"Skipping registration because of Mock Server",registrationState:d("MAWDeviceRegistrationTypes").RegistrationStatesEnum.finished}}f=b("cr:2025")?yield b("cr:2025").getRegistrationMetaRestore():yield B(d("MAWDeviceRegistrationActions").getRegistrationMetaDexie);a!=null&&d("MAWQplProxy").sendQplPointThroughBridge(a,"device_registration_check",{annotations:{bool:{identityCompareResult:f==null?void 0:f.identityCompareResult,isDeviceRegistrationDomainUniquenessEnabled:c("gkx")("23930")},"int":{registrationVersion:f==null?void 0:f.registrationVersion}}});a=(f==null?void 0:f.identityCompareResult)===!1;if(f==null||f.deviceId==null||a){try{yield d("MAWClearSignalAndTempStores").clearSignalAndTempStores(),yield d("MAWDbMetaTxns").saveCAT(e)}catch(a){return w(a)}t({identityCompareResult:f==null?void 0:f.identityCompareResult,registrationVersion:f==null?void 0:f.registrationVersion});return z(e)}else{yield d("MAWDbMetaTxns").saveCAT(e);a=c("MessengerWebInitData").sessionId;e=f.lastSessionDeviceWasLinkedTo==null||f.lastSessionDeviceWasLinkedTo!==a;a!=null&&!(f.deviceUUID===a||f.deviceUUID.startsWith(a+"-"))&&e&&!s()&&c("promiseDone")(d("MAWDeviceRegistrationSessionUtil").linkDeviceToTheSession(f.deviceUUID,a))}p.LOG(i());return{message:d("MAWDeviceRegistrationTypes").DEVICE_ALREADY_REGISTERED,registrationState:d("MAWDeviceRegistrationTypes").RegistrationStatesEnum.finished}});return C.apply(this,arguments)}function f(a){d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.DEVICE_REGISTRATION,key:"fail"});d("MAWCurrentUser").isEmployee()||d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.DEVICE_REGISTRATION_NON_EMPLOYEE,key:"fail"});p.ERROR(n(),d("MAWDeviceRegistrationTypes").FAILED_REGISTRATION_RETRIES);for(a of a)p.ERROR(m(),a);u()}g.endRegistrationTimerSuccess=a;g.handleRegistrationError=w;g.setupDeviceRegistration=e;g.logDeviceRegistrationRetryFailure=f}),98);
__d("MAWDeviceRegistrationInitWorker",["MAWCurrentUser","MAWDeviceRegistrationTypes","MAWDeviceRegistrationWorker","MAWLoggerUtils","MAWODSProxy","MAWQplProxy","WALogger","WAOdsEnums","WAPromiseRetryLoop","WARetryUtils","WATagsLogger","asyncToGeneratorRuntime","qpl"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Registration finished, ending device registration promise retry loop"]);i=function(){return a};return a}function a(){var a=1,e=new Set(),f=new(d("WAPromiseRetryLoop").PromiseRetryLoop)({code:function(){var f=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){if(a===d("MAWDeviceRegistrationTypes").MAX_DEVICE_REGISTRATION_RETRIES){d("MAWDeviceRegistrationWorker").logDeviceRegistrationRetryFailure(e);var f=d("MAWDeviceRegistrationWorker").handleRegistrationError(d("MAWDeviceRegistrationTypes").FAILED_REGISTRATION_RETRIES);b(f);return}try{f=a===1?c("qpl")._(25310776,"6155"):null;f=(yield d("MAWDeviceRegistrationWorker").setupDeviceRegistration(f));f.registrationState===d("MAWDeviceRegistrationTypes").RegistrationStatesEnum.finished&&(f.message===d("MAWDeviceRegistrationTypes").DEVICE_SUCCESSFULLY_REGISTERED&&(d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.DEVICE_REGISTRATION,key:"success"}),d("MAWCurrentUser").isEmployee()||d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.DEVICE_REGISTRATION_NON_EMPLOYEE,key:"success"}),d("MAWDeviceRegistrationWorker").endRegistrationTimerSuccess()),d("WALogger").LOG(i()),b(f));e.add(f.message)}catch(a){b="Uncaught device registration error - "+a;d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.DeviceRegistration]).WARN(h(),b);e.add(""+b)}a++});function g(a){return f.apply(this,arguments)}return g}(),name:"deviceRegistration",timer:d("WARetryUtils").FIBONACCI_BACKOFF});d("MAWQplProxy").sendQplPointThroughBridge(c("qpl")._(25310776,"6155"),"device_registration_start");f.start();return f.promise()}g.initDeviceRegistration=a}),98);
__d("MAWGetAttachmentTypeForServerMediaType",["EchoMessageMediaFieldUtils","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Not a valid AttachmentType: ",""]);h=function(){return a};return a}function a(a){switch(a){case"image":return d("EchoMessageMediaFieldUtils").AttachmentType.IMAGE;case"video":return d("EchoMessageMediaFieldUtils").AttachmentType.VIDEO;case"ptt":return d("EchoMessageMediaFieldUtils").AttachmentType.PTT;case"gif":return d("EchoMessageMediaFieldUtils").AttachmentType.GIF;case"sticker":return d("EchoMessageMediaFieldUtils").AttachmentType.STICKER;case"xma-image":return d("EchoMessageMediaFieldUtils").AttachmentType.XMA;case"document":return d("EchoMessageMediaFieldUtils").AttachmentType.DOCUMENT;default:d("WALogger").WARN(h(),a);return null}}g.getAttachmentTypeForServerMediaType=a}),98);
__d("MAWGetMediaAttachmentTypeForServerMediaType",["EchoMessageMediaFieldUtils","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Not a valid EchoMessageActMediaAttachmentType: ",""]);h=function(){return a};return a}function a(a){switch(a){case"image":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.IMAGE;case"video":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.VIDEO;case"ptt":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.AUDIO;case"gif":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.GIF;case"sticker":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.STICKER;case"audio":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.AUDIO;case"document":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.DOCUMENT;case"ppic":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.PROFILE_PICTURE;case"md-app-state":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.APP_STATE;case"md-msg-hist":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.HISTORY_SYNC;case"thumbnail-image":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.THUMBNAIL_IMAGE;case"thumbnail-video":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.THUMBNAIL_VIDEO;case"thumbnail-gif":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.THUMBNAIL_GIF;case"thumbnail-document":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.THUMBNAIL_DOCUMENT;case"thumbnail-link":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.THUMBNAIL_LINK;case"novi-video":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.NOVI_VIDEO;case"novi-image":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.NOVI_IMAGE;case"xma-image":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.XMA_IMAGE;default:d("WALogger").ERROR(h(),a);return null}}g.getMediaAttachmentTypeForServerMediaType=a}),98);
__d("MAWGetPreviewContentTypeForMediaType",["EchoMessageMediaFieldUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){switch(a){case"image":return d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.IMAGE_JPEG;case"gif":return d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.GIF;case"sticker":return d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.STICKER;case"video":return d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.AUDIO_MP4;case"ptt":return d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.AUDIO_WAV;case"xma-image":return d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.IMAGE_JPEG;default:return null}}g.getPreviewContentTypeForMediaType=a}),98);
__d("MAWSignalUtils",[],(function(a,b,c,d,e,f){"use strict";var g=null;function h(){if(g==null){g=[];for(var a=0;a<=255;a++){var b=a.toString(16).padStart(2,"0").toUpperCase();g.push(b)}}return g}function a(a){var b=h(),c=[];a.forEach(function(a){c.push(b[a])});return c.join(" ")}f.getHexRepresentation=a}),66);
__d("MAWMediaSizeCheck",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a>100*1024}f.isMinSizeForImagePreviewGeneration=a}),66);
__d("MAWOptimisticUploadMedia",["MAWFrontendMediaUtils","MAWGlobals","MAWMediaSizeCheck","MAWMediaUtils","MAWOptimisticUploadManager","MAWStartMediaUploaQplFlow","WALogger","WAMediaCrypto","WAMediaUtils","WAResultOrError","WAUploadMedia","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["optimisticUploadMedia: fileUploadResult success, setting with previewPlaintextHash"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["optimisticUploadMedia: previewUploadResult success"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["optimisticUploadMedia: preview uploading"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["optimisticUploadMedia: thumbnail_exists: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["optimisticUploadMedia: File is already being uploaded"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["optimisticUploadMedia: fileUploadResult success"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["optimisticUploadMedia: file uploading"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["Expected chatJid in optimisticUploadMedia"]);o=function(){return a};return a}function p(a,b,c){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=(yield d("MAWMediaUtils").hashBlob(a));e=d("WAMediaUtils").toPlaintextHash(e);var f=d("MAWOptimisticUploadManager").getOptimisticUploadManager();f=f.get(e);if(f!=null)return d("WAResultOrError").makeError("already_uploading");if(b==null){d("WALogger").ERROR(o());return d("WAResultOrError").makeError("missing_chat_jid")}f=c.type==="regular"?c.mediaType:"preview";var g=(yield d("MAWStartMediaUploaQplFlow").startMediaUploaQplFlow({chatJid:b,fileSize:a.size,serverMediaType:f,uploadEntry:"optimisticUploadMedia"}));b=d("WAUploadMedia").uploadMedia({chatJid:b,filename:f==="document"?a.name:void 0,hash:e,mediaTypeDetails:c,protocolMsgId:null,size:a.size,uploadMediaFlow:g});return d("WAResultOrError").makeResult({plaintextHash:e,uploadPromise:b})});return q.apply(this,arguments)}function a(a){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.file,c=a.threadId;a=a.thumbnail;var e=d("MAWOptimisticUploadManager").getOptimisticUploadManager();c=(yield d("MAWGlobals").getDbImpls().getThreadJidByChatId(c));var f=d("MAWFrontendMediaUtils").getMediaTypeAndServerMediaTypeFromBlob(b.type);f=f.serverMediaType;d("WALogger").LOG(n());var g=(yield p(b,c,{mediaType:f,type:"regular"}));if(g.success===!0)d("WALogger").LOG(m()),e.set(g.value.plaintextHash,{file:b,optimisticUploadPromise:g.value.uploadPromise,previewPlaintextHash:null});else{var o=g.error;switch(o){case"already_uploading":d("WALogger").LOG(l());break;case"missing_chat_jid":break}}o=null;d("WALogger").LOG(k(),a!=null);if(a&&s(f,b.size)){d("WALogger").LOG(j());c=(yield p(a,c,{messageType:d("WAMediaCrypto").convertServerMediaTypeToPreviewMediaType(f),type:"preview"}));c.success===!0&&(d("WALogger").LOG(i()),o=c.value.plaintextHash,e.set(c.value.plaintextHash,{file:a,optimisticUploadPromise:c.value.uploadPromise}),g.success===!0&&(d("WALogger").LOG(h()),e.set(g.value.plaintextHash,{file:b,optimisticUploadPromise:g.value.uploadPromise,previewPlaintextHash:o})))}});return r.apply(this,arguments)}function s(a,b){if(a!=="image")return!0;a;return d("MAWMediaSizeCheck").isMinSizeForImagePreviewGeneration(b)}g.optimisticUploadMedia=a;g.shouldUploadPreview=s}),98);
__d("MAWLowLevelApiImpl",["MAWBulkSaveSignalDataApi","MAWCommonLowLevelApiBridgeHandlers","MAWCommonLowLevelApiDbCallbacks","MAWCommonLowLevelApiLogWrapper","MAWConvertCreateGroupResultApi","MAWDefinePersistedJob","MAWDeletePreKeyGenerationsApi","MAWGetLastPreKeyGenerationIdApi","MAWGetPreKeyGenerationsTimestampsApi","MAWJids","MAWJobPersistenceAccessorsApi","MAWLoadAllJobsApi","MAWLoadICDCApi","MAWLoadIdentitiesApi","MAWLoadLastSyncTsApi","MAWLoadLatestSignedPreKeyApi","MAWLoadOneTimePreKeyApi","MAWLoadPreKeysApi","MAWLoadSenderKeySessionApi","MAWLoadSignedPreKeyApi","MAWSaveOneTimePreKeyApi","MAWSavePreKeysGenerationApi","MAWSaveSignedPreKeyIfNewApi","MAWSessionApi"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return{bridgeHandlers:babelHelpers["extends"]({},d("MAWCommonLowLevelApiBridgeHandlers").commonBridgeHandlers),crypto:{db:d("MAWCommonLowLevelApiLogWrapper").lowLevelApiLogWrapper({bulkLoadIdentities:d("MAWLoadIdentitiesApi").bulkLoadIdentities,bulkSaveSignalData:d("MAWBulkSaveSignalDataApi").bulkSaveSignalData,deletePreKeyGenerations:d("MAWDeletePreKeyGenerationsApi").deletePreKeyGenerations,getLastPreKeyGenerationId:d("MAWGetLastPreKeyGenerationIdApi").getLastPreKeyGenerationId,getPreKeyGenerationsTimestamps:d("MAWGetPreKeyGenerationsTimestampsApi").getPreKeyGenerationsTimestamps,loadICDC:d("MAWLoadICDCApi").loadICDC,loadIdentities:d("MAWLoadIdentitiesApi").loadIdentities,loadLastSyncTs:d("MAWLoadLastSyncTsApi").loadLastSyncTs,loadLatestSignedPreKey:d("MAWLoadLatestSignedPreKeyApi").loadLatestSignedPreKey,loadOneTimePreKey:d("MAWLoadOneTimePreKeyApi").loadOneTimePreKey,loadPreKeys:d("MAWLoadPreKeysApi").loadPreKeys,loadSenderKeySession:d("MAWLoadSenderKeySessionApi").loadSenderKeySession,loadSession:d("MAWSessionApi").loadSession,loadSessions:d("MAWSessionApi").bulkLoadSession,loadSignedPreKey:d("MAWLoadSignedPreKeyApi").loadSignedPreKey,saveOneTimePreKey:d("MAWSaveOneTimePreKeyApi").saveOneTimePreKey,savePreKeysGeneration:d("MAWSavePreKeysGenerationApi").savePreKeysGeneration,saveSignedPreKeyIfNew:d("MAWSaveSignedPreKeyIfNewApi").saveSignedPreKeyIfNew}),regInfo:a},dbCallbacks:d("MAWCommonLowLevelApiDbCallbacks").dbCallbacks,jidUtils:d("MAWJids").jidUtils,jobPersistenceAccessors:d("MAWJobPersistenceAccessorsApi").getJobPersistenceAccessors(),jobResultConverters:{convertCreateGroupResult:d("MAWConvertCreateGroupResultApi").convertCreateGroupResult},loadAllJobs:d("MAWLoadAllJobsApi").loadAllJobs,persistedJobs:d("MAWDefinePersistedJob").persistedJobsApi}}g.makeLowLevelApi=a}),98);
__d("MAWReStoreMigrationUtils",["Deferred","MAWDbObjEncryption","MAWDbSchema.restore","MWEARKeychainV3","Promise","WATagsLogger","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error fetching batch: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["REQUESTING ",""]);j=function(){return a};return a}var k=d("WATagsLogger").TAGS(["DBInit","Migration"]),l=new Map(d("MAWDbSchema.restore").clientSchema.map(function(a){return[a.name,a]}));function a(a){return new(h||(h=b("Promise")))(function(b,c){var d=indexedDB.open(a);d.onupgradeneeded=function(a){a.target.transaction.abort(),b(null)};d.onerror=function(a){c("Error opening database: "+a.target.error)};d.onsuccess=function(a){a=a.target.result;b(a)}})}function e(a){var b=new(c("Deferred"))();a=indexedDB.deleteDatabase(a);a.onsuccess=function(){return b.resolve()};a.onerror=function(a){return b.reject(a)};return b.getPromise()}function f(a,c){var e=a.transaction("appMeta").objectStore("appMeta");return new(h||(h=b("Promise")))(function(a,b){var f=e.get(c);f.onsuccess=function(b){b=b.target.result;if(b==null){a();return}a(d("MAWDbObjEncryption").decryptDbObj(b,"appMeta",d("MWEARKeychainV3").getDbEncryptionKey))};f.onerror=function(a){k.LOG(j(),a),b(a)}})}function m(a,c,e){if(a==null)return(h||(h=b("Promise"))).resolve();var f=a.transaction("appMeta","readwrite").objectStore("appMeta");return new(h||(h=b("Promise")))(function(a,b){var g;g=f.put(d("MAWDbObjEncryption").encryptDbObj({key:c,value:(g={},g[c]=e,g)},"appMeta",d("MWEARKeychainV3").getDbEncryptionKey));g.onsuccess=function(){a()};g.onerror=function(a){b(a)}})}function n(a,c){return new(h||(h=b("Promise")))(function(b,d){var e=a.transaction(c).objectStore(c);e=e.count();e.onsuccess=function(a){b(a.target.result)};e.onerror=function(a){d(a)}})}function o(a,c){var d="e2ee_"+c;c=l.get(d);return c==null?(h||(h=b("Promise"))).resolve(-1):a.runInTransaction(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=new WeakMap();a=(yield a[d].keys(b,"asc",void 0));b=0;var c=(yield a.next());while(!c.done)b++,c=(yield a.next());return b});return function(b){return a.apply(this,arguments)}}(),"readonly")}function p(a,d){var e=100,f=[];return new(h||(h=b("Promise")))(function(b){if(d==null){b([]);return}var g=a==null?d.openCursor():d.openCursor(IDBKeyRange.lowerBound(a,!0));g.onsuccess=function(a){a=a.target.result;a&&f.length<e?(f.push([a.key,a.value]),a["continue"]()):b(f)};g.onerror=function(a){k.ERROR(i(),a.target.error);throw c("err")("Error opening cursor: "+a.target.error)}})}function q(a,c){return new(h||(h=b("Promise")))(function(b){var d=a.transaction([c],"readwrite"),e=d.objectStore(c);e.add({}).onsuccess=function(a){b(a.target.result);try{d.abort()}catch(a){}}})}g.getDBForMigration=a;g.deleteDB=e;g.fetchAppMetaKey=f;g.putAppMetaKey=m;g.indexedDBCount=n;g.restoreCount=o;g.fetchIDBBatch=p;g.getNextKey=q}),98);
__d("MAWRestoreDbMigration",["I64","LSQueryBulkUtils","MAWDbAppMeta","MAWDbObjEncryption","MAWDbSchema.restore","MAWReStoreDbSetup","MAWReStoreMigrationUtils","MWEARKeychainV3","WATagsLogger","err","gkx","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Incrementing failed migration counter: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Incrementing failure count as executeMigration returned false"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Marking DB as not needing migration in the future."]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Migration completed with status: ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Starting DB migration"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Previous migration attempt purged"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["Purging previous migration attempt"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["Skipping due to previous failures"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["Migration is currently disabled, skipping the attempt"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["Already migrated db, no need to migrate"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["Skipping due to source db not existing"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["Checking if we need to migrate the database"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["Completing migration"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["Data counts match.... completing migration"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose(["Data moved, checking for consistency"]);w=function(){return a};return a}function x(){var a=babelHelpers.taggedTemplateLiteralLoose(["Moving data"]);x=function(){return a};return a}var y=d("WATagsLogger").TAGS(["DBInit","Migration"]),z=c("justknobx")._("1864"),A=c("justknobx")._("1871"),B=c("gkx")("23908"),C=new Map(d("MAWDbSchema.restore").clientSchema.map(function(a){return[a.name,a]})),D=function(a){return new Promise(function(b){return setTimeout(b,a)})};async function E(a,b,c){if(b==null)return;var e="e2ee_"+c,f=await d("MAWReStoreMigrationUtils").fetchIDBBatch(null,b.transaction(c).objectStore(c)),g=C.get(e)||{},i=g.auto_increment;g=g.primary_key;g=(g=g)!=null?g:[];var j=g[0];g=async function(){var g=f.map(function(a){a[0];a=a[1];a=babelHelpers.extends({},d("MAWDbObjEncryption").decryptDbObj(a,c,d("MWEARKeychainV3").getDbEncryptionKey));j!=null&&i===!0&&(a[j]=(h||(h=d("I64"))).of_int32(a[j]));return a});await a.runInTransaction(async function(a){await d("LSQueryBulkUtils").bulkPut(a[e],g)},"readwrite");a.clearCacheIfSupported==null?void 0:a.clearCacheIfSupported();f=await d("MAWReStoreMigrationUtils").fetchIDBBatch(f[f.length-1][0],b.transaction(c).objectStore(c))};while(f.length)await g();if(i===!0){g=await d("MAWReStoreMigrationUtils").getNextKey(b,c);var k=(h||(h=d("I64"))).of_int32(g);await a.runInTransaction(async function(a){var b;await a[e].add((b={},b[j]=k,b));await a[e].delete(k)},"readwrite")}}async function F(a,b,e){var f=Array.from(a.objectStoreNames).filter(function(a){return C.has("e2ee_"+a)});y.LOG(x());e==null?void 0:e.addPoint("table-migration-start");await f.reduce(function(c,d){return c.then(function(){return E(b,a,d)})},Promise.resolve());e==null?void 0:e.addPoint("table-migration-end");y.LOG(w());e==null?void 0:e.addPoint("data-verification-start");f=await f.reduce(function(c,e){return c.then(async function(c){var f=await Promise.all([d("MAWReStoreMigrationUtils").indexedDBCount(a,e),d("MAWReStoreMigrationUtils").restoreCount(b,e)]),g=f[0];f=f[1];b.clearCacheIfSupported==null?void 0:b.clearCacheIfSupported();return[].concat(c,[[e,g===f]])})},Promise.resolve([]));if(!f.every(function(a){a=a[1];return a})){f=f.filter(function(a){a=a[1];return!a}).map(function(a){a=a[0];return a});throw c("err")("count mismatch: "+f.join(",")+" ")}y.LOG(v());e==null?void 0:e.addPoint("data-verification-end");y.LOG(u());return!0}async function G(){var a;a=await ((a=navigator.storage)==null?void 0:a.estimate==null?void 0:a.estimate());return(a=a==null?void 0:a.usage)!=null?a:0}async function a(a,b,e){y.LOG(t());e==null?void 0:e.addPoint("open-source-db-start");a=await d("MAWReStoreMigrationUtils").getDBForMigration(a);e==null?void 0:e.addPoint("open-source-db-end");e==null?void 0:e.addAnnotations({bool:{shouldRunMigration:a!=null},int:{storageSize:await G()}});if(a==null){y.LOG(s());e==null?void 0:e.addAnnotations({string:{migrationSkipReason:"new-indexeddb"}});return!0}var f=await Promise.all([d("MAWReStoreMigrationUtils").fetchAppMetaKey(a,d("MAWDbAppMeta").AppMetaKeysEnum.restoreMigrationAttempts),d("MAWReStoreMigrationUtils").fetchAppMetaKey(a,d("MAWDbAppMeta").AppMetaKeysEnum.hasMigratedFromDexie)]),g=f[0];f=f[1];g=(g=g==null?void 0:(g=g.value)==null?void 0:g.restoreMigrationAttempts)!=null?g:0;f=(f=f==null?void 0:(f=f.value)==null?void 0:f.hasMigratedFromDexie)!=null?f:!1;if(f===!0){y.LOG(r());e==null?void 0:e.addAnnotations({string:{migrationSkipReason:"previously-migrated"}});a.close();return!0}if(B===!1){y.LOG(q());e==null?void 0:e.addAnnotations({string:{migrationSkipReason:"migration-disabled"}});a.close();return!1}if(g>A){e==null?void 0:e.addAnnotations({string:{migrationSkipReason:"exceeded-max-attempts"}});y.LOG(p());a.close();return!1}e==null?void 0:e.addPoint("checking-target-db-start");f=await d("MAWReStoreMigrationUtils").getDBForMigration(b);f!=null&&(y.LOG(o()),e==null?void 0:e.addAnnotations({bool:{purgedPreviousAttempt:!0}}),f.close(),await d("MAWReStoreDbSetup").closeDB(),await d("MAWReStoreMigrationUtils").deleteDB(b),y.LOG(n()));e==null?void 0:e.addPoint("checking-target-db-end");try{y.LOG(m());f=await d("MAWReStoreDbSetup").getDB();b=await Promise.race([D(z).then(function(){throw c("err")("timeout")}),F(a,f,e)]).then(function(a){return typeof a==="boolean"?a:!1});y.LOG(l(),b);b?(y.LOG(k()),await d("MAWReStoreMigrationUtils").putAppMetaKey(a,d("MAWDbAppMeta").AppMetaKeysEnum.hasMigratedFromDexie,!0)):(y.LOG(j()),await d("MAWReStoreMigrationUtils").putAppMetaKey(a,d("MAWDbAppMeta").AppMetaKeysEnum.restoreMigrationAttempts,g+1));return b}catch(b){a!=null&&(y.LOG(i(),b),await d("MAWReStoreMigrationUtils").putAppMetaKey(a,d("MAWDbAppMeta").AppMetaKeysEnum.restoreMigrationAttempts,g+1));throw b}finally{a==null?void 0:a.close()}}g.migrateToRestoreFromDexie=a}),98);
__d("WorkerBanzaiLazyQueueChannelWorker",["BanzaiLazyQueue","WorkerFuncChannel"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=d("WorkerFuncChannel").importChannel({queuePost:null},a,"banzai_lazyqueue_channel");c("BanzaiLazyQueue").onQueue.add(function(){h(b)});h(b)}function h(a){c("BanzaiLazyQueue").flushQueue().forEach(function(b){a.queuePost.apply(a,b)})}g.init=a}),98);
__d("WorkerSelf",["WorkerBanzaiLazyQueueChannelWorker","WorkerFuncChannel","WorkerQPLChannel"],(function(a,b,c,d,e,f,g){"use strict";function a(a){d("WorkerFuncChannel").activateChannels(a,"worker","client"),d("WorkerBanzaiLazyQueueChannelWorker").init(a),d("WorkerQPLChannel").setMessagePort(a)}g.init=a}),98);
__d("MAWMainWebWorkerConfig",["MAWBaseConfig","MAWConstants","MAWCurrentUser","MAWDeviceRegistrationTypes","MAWEphemeralConsts","MAWGK","MAWParseXMAFBConfig","MAWTransactionsConfig","WorkerUtils","getOrchestratorVersion","gkx","isSmartSenderKeyRotationEnabled","isStickerEnabled","isUseridAnnotationEnabled","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h,i=1;a=babelHelpers["extends"]({},c("MAWBaseConfig"),{armadilloWebProcessFutureproof:function(){return c("MAWGK").armadillo_web_process_futureproof},batchSize:function(){return c("justknobx")._("1866")},defaultUnknownContactText:function(){return d("MAWConstants").FB_UNKNOWN_USER},ephemeralMaxDeletionWindowForUnseenMessage:function(){return d("MAWEphemeralConsts").ephemeralMaxDelectionWindowForUnseenMessage},getDevicesBeforeSend:function(){return c("gkx")("23971")},getSignalFutureMessagesMax:function(){return c("gkx")("4280")?c("justknobx")._("847"):2e3},handleICDCInProtocol:function(){return c("gkx")("33007")},icdcAlertTriggerFailureCounter:function(){return c("justknobx")._("1970")},icdcCooldownIntervalInMinutes:function(){return c("justknobx")._("1971")},icdcIntervalInMinutes:function(){return c("justknobx")._("1972")},isDeviceRegistrationDomainUniquenessEnabled:function(){return c("gkx")("23969")},isDocumentReceiveEnabled:function(){return!c("gkx")("23924")},isEditMessageSendEnabled:function(){return c("gkx")("23972")},isEmployee:d("MAWCurrentUser").isEmployee,isEphemeralMessagesEnabled:function(){return!0},isFrankingDropOnInvalid:function(){return c("gkx")("23973")},isFrankingDropOnMissing:function(){return c("gkx")("23974")},isFrankingEnabled:function(){return c("justknobx")._("1347")},isGifEnabled:function(){return c("justknobx")._("1147")},isICDCErrorEnabled:function(){return c("gkx")("23975")},isMediaFallbackToAlternativeHmacSaltsEnabled:function(){return c("gkx")("23976")},isMediaLoggingEnabled:function(){return c("gkx")("23970")},isMediaWaitForConnectionOnRetryEnabled:function(){return c("gkx")("23977")},isPollsFallbackExperienceEnabled:function(){return c("gkx")("23978")},isPreEstablishSessionEnabled:function(){return c("gkx")("23979")},isProgressiveJpegSendReceiveEnabled:function(){return c("gkx")("23980")},isRavenMessagesEnabled:function(){return!0},isSenderKeyPredistributionEnabled:function(){return c("gkx")("23981")},isSharedWorkerContext:function(){return(h||(h=d("WorkerUtils"))).isSharedWorkerContext()},isSmartSenderKeyRotationEnabled:c("isSmartSenderKeyRotationEnabled"),isStickerEnabled:c("isStickerEnabled"),isUseridAnnotationEnabled:c("isUseridAnnotationEnabled"),maxAppDataRecipients:function(){return d("MAWConstants").MAX_APPDATA_RECIPIENTS},maxUsersForNotifyDeviceChange:function(){return d("MAWDeviceRegistrationTypes").MAX_USERS_FOR_NOTIFY_DEVICE_CHANGE},mediaUploadRoot:function(){return"/wa-msgr/mms"},messageRetryCountLimit:function(){return d("MAWConstants").MESSAGE_RETRY_COUNT_LIMIT},orchestratorVersion:function(){return c("getOrchestratorVersion")()},productTypeForEBAttachments:"msgr",supportedTypesVersion:function(){return c("MAWGK").armadillo_web_process_futureproof?i+1:i},supportedXMATargetTypes:function(){return d("MAWParseXMAFBConfig").FB_SUPPORTED_TARGET_TYPES},transactions:d("MAWTransactionsConfig").transactions,useCryptoManagerV2:function(){return!0},useEbUploadQueue:function(){return c("gkx")("23936")},useMostRecentMediaEntryForDownload:function(){return c("justknobx")._("1891")},useSendMsgV2:function(){return c("gkx")("3224")}});b=a;g["default"]=b}),98);
__d("MessengerFalcoLoggerTransports",["FalcoLoggerTransports"],(function(a,b,c,d,e,f){"use strict";a=importNamespace("FalcoLoggerTransports").attach;f.attach=a}),66);
__d("MAWMainWebWorker",["MAWBackend","MAWCommonMainWebWorker","MAWLowLevelApiImpl","MAWMainWebWorkerConfig","MessengerFalcoLoggerTransports","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h=!((b=c("gkx")("23949"))!=null?b:!1);function a(a){if("SharedWorkerGlobalScope"in self&&self instanceof SharedWorkerGlobalScope&&a!=null){var b=new(d("MAWCommonMainWebWorker").BridgeAdaptor)(a,"MAWMainWebWorker");d("MAWCommonMainWebWorker").initWorker(b,d("MAWLowLevelApiImpl").makeLowLevelApi,c("MAWMainWebWorkerConfig"),d("MAWBackend").startMAWBackend)}else if("DedicatedWorkerGlobalScope"in self&&self instanceof DedicatedWorkerGlobalScope){a=new(d("MAWCommonMainWebWorker").BridgeAdaptor)((b=a)!=null?b:self,"MAWMainWebWorker");d("MAWCommonMainWebWorker").initWorker(a,d("MAWLowLevelApiImpl").makeLowLevelApi,c("MAWMainWebWorkerConfig"),d("MAWBackend").startMAWBackend)}h&&d("MessengerFalcoLoggerTransports").attach()}g["default"]=a}),98);
__d("MAWUploadMessageTxns",["EchoCommonUtils","EchoEncodingUtils","EchoMessage","LSEBPayloadSerializerError","LSMEBTaskCreationSource","MAWBridgeEventTransmitter","MAWConvertExtendedContentOverlayIconGlyphToXMAGatingType","MAWConvertExtendedContentTargetTypeToXMATargetType","MAWConvertExtendedContentXMLLayoutTypeToXMALayoutType","MAWDbEditMsgHistoryTxns","MAWDbMediaTxns","MAWDbMsg","MAWDbMsgTxns","MAWDbReactionsTxns","MAWDbXMATxns","MAWDexieTable","MAWEBUploadMessageUtils","MAWEncryptedBackupCacheManager","MAWGetAttachmentTypeForServerMediaType","MAWGetMediaAttachmentTypeForServerMediaType","MAWGetPreviewContentTypeForMediaType","MAWGlobals","MAWJidUtils","MAWJids","MAWMsgType","MAWUploadMessagesBackup","MAWVault","WAArmadilloXMA.pb","WABase64","WAJids","WALogger","WAMediaUtils","WATimeUtils","err","gkx","qex"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] edit history has length ",", but edit count on message is ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] No XMA object found for msg with external id ",". Cannot upload XMA"]);k=function(){return a};return a}function l(a,b){return a.threads.get(b).then(function(a){if(a==null)throw c("err")("constructEchoMessage: thread not present");return a.jid})}var m="You unsent a message";function n(a){switch(a.specialTextSize){case 1:return d("EchoMessage").MessageTextSize.SMALL;case 2:return d("EchoMessage").MessageTextSize.MEDIUM;case 3:return d("EchoMessage").MessageTextSize.LARGE;default:return d("EchoMessage").MessageTextSize.NONE}}function o(a,b){return d("MAWDbXMATxns").maybeGetXMAFromProtocolMsgId(a,d("MAWJidUtils").maybeToProtocolMsgId(b.author,b.threadJid,b.externalId)).then(function(e){if(e!=null)return e.previewMediaIds!=null?d("MAWDexieTable").dexieAll(e.previewMediaIds.map(function(b){return d("MAWDbMediaTxns").maybeGetMediaFromMediaId(a,b)})).then(function(a){for(var a=a,b=Array.isArray(a),f=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(b){if(f>=a.length)break;g=a[f++]}else{f=a.next();if(f.done)break;g=f.value}g=g;if(g==null)return d("MAWDexieTable").dexieResolve({maybeErrorDetail:{errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"constructEchoMessage: DbMedia is null for the XMA message",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.WARN},xmaData:void 0});if(g.fbid==null)return d("MAWDexieTable").dexieResolve({maybeErrorDetail:{errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"constructEchoMessage: fbid is null for the XMA message",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.WARN},xmaData:void 0})}return v(e)}):v(e);else{d("WALogger").ERROR(k(),b.externalId);return d("MAWDexieTable").dexieResolve({maybeErrorDetail:{errorCode:c("LSEBPayloadSerializerError").UNKNOWN_ERROR,errorMsg:"constructEchoMessage: no xma object found for msg with external id "+b.externalId,uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.WARN},xmaData:void 0})}})}function p(a,b){try{return d("MAWDbMsg").isMediaMsg(a)||a.type===d("MAWMsgType").MSG_TYPE.XMA}catch(e){a="[labyrinth_web] Invalid msg type for isMediaMsg check: "+e;d("WALogger").ERROR(j(),a);b.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:a,uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return!1}}function q(a,b){return{echoMessage:null,externalId:a,maybeErrorDetail:{errorCode:c("LSEBPayloadSerializerError").NOT_IMPLEMENTED,errorMsg:b,uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.WARN}}}function r(a,b,e){var f=e.threadJid!=null?d("MAWDexieTable").dexieResolve(e.threadJid):l(a,e.thread),g={mediaMetadata:null},h=p(e,g);h=h?t(a,e):d("MAWDexieTable").dexieResolve(g);g=u(a,e);b=e.quote!=null?A(a,e.quote,e.thread,f,b):d("MAWDexieTable").dexieResolve();var i=d("MAWDbMsg").isXMAMsg(e)?o(a,e):d("MAWDexieTable").dexieResolve(null),j=[];a=c("gkx")("23918")||c("qex")._("778")===!0?d("MAWDbEditMsgHistoryTxns").getEditHistoryAsEchoWithJidPromise(a,e.externalId,e.author,f):d("MAWDexieTable").dexieResolve(j);return{editHistoryPromise:a,mediaMetadataUploadPromise:h,quotedMsgPromise:b,reactionsPromise:g,threadJidPromise:f,xmaDataUploadRequestPromise:i}}function s(a,b,c,e,f,g,h,j){var k;a=d("WAJids").threadIdForChatJid(a);var l=h.serverTs;k=(k=h.editCount)!=null?k:0;g.length>0&&g.length-1!==h.editCount&&(d("WALogger").WARN(i(),g.length,h.editCount),k=g.length-1);l={authoritativeTimestampMs:l!=null?l*1e3:void 0,contentSubtype:d("EchoMessage").EchoMessageContentSubtype.NONE,contentType:d("EchoMessage").EchoMessageContentType.TEXT,displayTimestampMs:h.ts*1e3,editCount:k,editHistory:g,from:d("EchoCommonUtils").craftEchoAddress(null,j,"AdvancedCrypto"),isForwarded:h.isForwarded,messageId:h.externalId,serializationOrigin:d("EchoMessage").EchoSerializationOriginType.WEB,sortOrderMs:d("MAWEBUploadMessageUtils").echoOverrideMessageSortOrder(h),textSize:n(h),threadId:a,version:d("EchoMessage").ECHO_MESSAGE_MIGRATION_DOCUMENT_VERSION,xContentType:d("EchoEncodingUtils").convertDbMsgTypeToXMessageContentType(h.type),xMessagePlaceholderType:d("EchoMessage").EchoMessagePlaceholderType.NO_PLACEHOLDER,xOfflineThreadingId:h.externalId,xThreadId:a};((k=h.msgContent)==null?void 0:k.content)!=null&&(l=babelHelpers["extends"]({},l,{text:d("MAWVault").unvault(h.msgContent.content)}));h.type===d("MAWMsgType").MSG_TYPE.REVOKED&&(l.contentType=d("EchoMessage").EchoMessageContentType.PLACEHOLDER,l.contentSubtype=d("EchoMessage").EchoMessageContentSubtype.UNSEND,l.revokeSentTimestampMs=h.originalTs,l.revokeUnsentTimestampMS=h.unsendMsgContentDeleteTs,l.text=m);if(e!=null){g=z(e);j=g.senderId;a=d("EchoCommonUtils").craftEchoAddress(null,j,"AdvancedCrypto");e.sortOrderMs!=null&&(l.quoteData={quoteMessageId:e.externalId,quoteMessageSender:a,quoteSortOrderInMs:e.sortOrderMs})}if(d("MAWMsgType").isMAWSupportedMediaType(h.type)){k=b.mediaMetadata;if(k!=null)l=babelHelpers["extends"]({},l,{contentType:d("EchoMessage").EchoMessageContentType.MEDIA,mediaData:k});else if(h.type!==d("MAWMsgType").MSG_TYPE.XMA)return{echoMessage:l,externalId:h.externalId,maybeErrorDetail:b.maybeErrorDetail}}if(f!=null&&f.xmaData!=null&&h.type===d("MAWMsgType").MSG_TYPE.XMA){l.xmaData=f.xmaData;l.contentType=d("EchoMessage").EchoMessageContentType.XMA;if(l.mediaData==null&&((g=f.xmaData)==null?void 0:g.xmaDefaultCTA)!=null&&l.text==null){l.text=(j=f.xmaData)==null?void 0:j.xmaDefaultCTA}}else if(f!=null&&f.xmaData==null&&h.type===d("MAWMsgType").MSG_TYPE.XMA)return{echoMessage:l,externalId:h.externalId,maybeErrorDetail:f.maybeErrorDetail};return{echoMessage:babelHelpers["extends"]({},l,c),externalId:h.externalId}}function a(a,b){return d("MAWDexieTable").dexieAll(b.map(function(b){var c=b.dbMsg;b=b.quotedMsg;if(!d("MAWMsgType").isEBSupportedMsgType(c.type))return d("MAWDexieTable").dexieResolve(q(c.externalId,'constructEchoMessage: "'+String(c.type)+'" NYI'));if(c.serverTs==null)return d("MAWDexieTable").dexieResolve(q(c.externalId,'constructEchoMessage: "'+String(c.type)+'" Not authoritative msg. '));var e=d("WATimeUtils").castToUnixTime(0);if(c.serverTs===e||c.serverTs===null&&c.ts===e){e="constructEchoMessage: Invalid timestamp - timestamp for message corresponds to 1/1/1970";d("WALogger").ERROR(h(),e);return d("MAWDexieTable").dexieResolve(q(c.externalId,e))}e=z(c);var f=e.senderId;e=r(a,b,c);b=e.editHistoryPromise;var g=e.mediaMetadataUploadPromise,i=e.quotedMsgPromise,j=e.reactionsPromise,k=e.threadJidPromise;e=e.xmaDataUploadRequestPromise;return d("MAWDexieTable").dexieAll([k,g,j,i,e,b]).then(function(a){var b=a[0],d=a[1],e=a[2],g=a[3],h=a[4];a=a[5];return s(b,d,e,g,h,a,c,f)})}))}function t(a,b){var e={mediaMetadata:null};if(b.type===d("MAWMsgType").MSG_TYPE.XMA)return d("MAWDbXMATxns").maybeGetXMAFromProtocolMsgId(a,d("MAWJidUtils").maybeToProtocolMsgId(b.author,b.threadJid,b.externalId)).then(function(b){if(b!=null)return w(a,b);else{e.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] Media meta data couldn't be created for XMA because DbXMA is not in IndexedDB. This probably means the XMA message was not sent properly by ChatX.",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return d("MAWDexieTable").dexieResolve(e)}});if(!d("MAWMsgType").isMAWSupportedMediaType(b.type)){e.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").NOT_SUPPORTED_ON_WEB,errorMsg:"[labyrinth_web] Media type is not supported for msg, type: "+b.type,uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.WARN};return d("MAWDexieTable").dexieResolve(e)}if(b.mediaId==null){e.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] No media id found in a media msg",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return d("MAWDexieTable").dexieResolve(e)}var f=d("WATimeUtils").DAY_SECONDS*28,g=b.serverTs;if(g!=null&&d("WATimeUtils").unixTime()-g>f){e.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] Media is older than 28 days and is not being uploaded.",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.WARN};return d("MAWDexieTable").dexieResolve(e)}return d("MAWDbMediaTxns").maybeGetMediaFromMediaId(a,b.mediaId).then(function(f){if(!f){e.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] No media db entry for media id",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return d("MAWDexieTable").dexieResolve(e)}var g=c("gkx")("23919")?d("MAWDbMediaTxns").maybeGetMediaBackupRowFromMsgId(a,b.msgId):d("MAWDexieTable").dexieResolve();return g.then(function(a){return d("MAWDexieTable").dexieResolve(x(b.msgId,f,!1,a))})})}function u(a,b){return d("MAWDbReactionsTxns").getReactionsFromMessage(a,b).then(function(a){if(a!=null&&a.length>0){var b=d("WAJids").extractUserId(d("MAWGlobals").getMyUserJid()),c=a.map(function(a){var c=d("WAJids").authorToUserId(a.author,b);return d("EchoCommonUtils").craftEchoAddress(a.reaction,c,"AdvancedCrypto")}),e=a.map(function(a){var c=d("WAJids").authorToUserId(a.author,b);return d("EchoCommonUtils").craftEchoAddress((a.ts*1e3).toString(),c,"AdvancedCrypto")});a=a.map(function(a){var c=d("WAJids").authorToUserId(a.author,b);return d("EchoCommonUtils").craftEchoAddress(a.externalId.toString(),c,"AdvancedCrypto")});return{reactionAuthoritativeTimestampMs:e,reactions:c,reactionXOfflineThreadingIds:a}}})}function v(a){var b={xmaData:null};if(a.isTombstoned==null){b.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no isTombstoned to construct XMAData",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return b}var e={xmaHeaderSubtitle:a.overlayTitle,xmaHeaderTitle:a.headerTitle,xmaIsTombstoned:a.isTombstoned,xmaMaxSubtitleNumLines:a.maxSubtitleNumOfLines,xmaMaxTitleNumLines:a.maxTitleNumOfLines,xmaSubtitleText:a.subtitleText,xmaTargetExpiry:a.targetExpiringAtSec,xmaTargetId:a.targetId,xmaTargetUsername:a.targetUsername,xmaTitleText:a.titleText},f=a.xmaLayoutType||d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_XMA_LAYOUT_TYPE.SINGLE;e=babelHelpers["extends"]({},e,{xmaLayoutType:d("MAWConvertExtendedContentXMLLayoutTypeToXMALayoutType").convertExtendedContentXMLLayoutTypeToXMALayoutType(f)});a.targetType!=null&&(e=babelHelpers["extends"]({},e,{xmaTargetType:d("MAWConvertExtendedContentTargetTypeToXMATargetType").convertExtendedContentTargetTypeToXMATargetType(a.targetType)}));a.overlayIconGlyph!=null&&(e=babelHelpers["extends"]({},e,{xmaGatingType:d("MAWConvertExtendedContentOverlayIconGlyphToXMAGatingType").convertExtendedContentOverlayIconGlyphToXMAGatingType(a.overlayIconGlyph)}));a.defaultCTA!=null&&a.defaultCTA.nativeUrl!=null&&(e=babelHelpers["extends"]({},e,{xmaDefaultCTA:a.defaultCTA.nativeUrl}));b.xmaData=e;return b}function w(a,b){var e={mediaMetadata:null};if(b.previewMediaIds!=null){var f=b.previewMediaIds[0];return d("MAWDbMediaTxns").maybeGetMediaFromMediaId(a,f).then(function(f){if(!f){e.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] No media db entry for media id to be used for xma",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.WARN};return d("MAWDexieTable").dexieResolve(e)}var g=b.msgId;if(g==null){e.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] No message id found in a xma msg",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return d("MAWDexieTable").dexieResolve(e)}var h=c("gkx")("23919")?d("MAWDbMediaTxns").maybeGetMediaBackupRowFromMsgId(a,g):d("MAWDexieTable").dexieResolve();return h.then(function(a){return d("MAWDexieTable").dexieResolve(x(g,f,!0,a))})})}else return d("MAWDexieTable").dexieResolve(e)}function x(a,b,e,f){var g={mediaMetadata:null},h=null;f!=null&&f.length>0&&(h=f.find(function(a){return a.mediaId===b.mediaId}));f=h!=null?h.fbid:b.fbid;a=b.mediaEntries.get(a);if(a==null){g.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no media entry to construct mediaMetadata",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return g}a=d("WAMediaUtils").decodeMediaEntryData(a);h=h!=null?h.objectId:b.objectId;if(h==null)return g;var i=d("MAWGetAttachmentTypeForServerMediaType").getAttachmentTypeForServerMediaType(a.serverMediaType);if(i==null){g.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no attachment type to construct mediaMetadata",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return g}var j=a.mediaKey;if(j==null){g.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no mediaKey to construct mediaMetadata",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return g}var k=a.mediaKeyTimestamp;if(k==null){g.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no mediaKeyTimestamp to construct mediaMetadata",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return g}var l=a.directPath;if(l==null){g.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no directPath to construct mediaMetadata",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return g}if(a.serverMediaType==null){g.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no mediaContentType to construct mediaMetadata",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return g}e=e?"image/jpeg":d("WAMediaUtils").getMimeTypeFromServerMediaType(a.serverMediaType);var m=d("MAWGetMediaAttachmentTypeForServerMediaType").getMediaAttachmentTypeForServerMediaType(a.serverMediaType);if(m==null){g.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no xAttachmentType to construct mediaMetadata",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return g}if(a.serverMediaType!=null&&a.serverMediaType in{gif:1,image:1,sticker:1}&&b.validatedImageInfo==null){g.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no imageinfo to construct mediaMetadata",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return g}if(a.serverMediaType==="video"&&b.validatedVideoInfo==null){g.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no videoinfo to construct mediaMetadata",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return g}if(a.serverMediaType==="ptt"&&b.validatedAudioInfo==null){g.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no audioinfo to construct mediaMetadata",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return g}if(a.fileSha256==null){g.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no WA fileSha256 found",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return g}var n=d("WABase64").encodeB64UrlSafe(a.fileSha256);if(a.fileEncSha256==null){g.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no WA fileEncSha256 found",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return g}g=d("WABase64").encodeB64UrlSafe(a.fileEncSha256);var o=null,p=null,q=null,r=null,s=null,t=void 0;a=d("MAWGetPreviewContentTypeForMediaType").getPreviewContentTypeForMediaType(a.serverMediaType);if(b.validatedImageInfo!=null){var u;o=(u=b.validatedImageInfo.width)!=null?u:0;p=(u=b.validatedImageInfo.height)!=null?u:0;r=(u=b.validatedImageInfo.jpegThumbnailWidth)!=null?u:0;s=(u=b.validatedImageInfo.jpegThumbnailHeight)!=null?u:0}if(b.validatedVideoInfo!=null){o=(u=b.validatedVideoInfo.width)!=null?u:0;p=(u=b.validatedVideoInfo.height)!=null?u:0;r=(u=b.validatedVideoInfo.jpegThumbnailWidth)!=null?u:0;s=(u=b.validatedVideoInfo.jpegThumbnailHeight)!=null?u:0;q=(u=b.validatedVideoInfo.duration)!=null?u:0}if(b.validatedAudioInfo!=null){q=(u=b.validatedAudioInfo.duration)!=null?u:0}b.validatedDocumentFileInfo!=null&&(t=b.validatedDocumentFileInfo.filename);u={attachmentObjectId:h,attachmentType:i,directPath:l,encryptedHash:g,mediaBackupStatus:"success",mediaContentType:e,mediaKey:d("EchoEncodingUtils").convertMediaKeyToString(j),mediaKeyTimestamp:k,plaintextHash:n,size:b.size,xAttachmentType:m,xContentType:"full"};u=y(u,f,a,o,p,q,r,s,t);return{mediaMetadata:u}}function y(a,b,c,d,e,f,g,h,i){a=a;b!=null&&(a=babelHelpers["extends"]({},a,{backupEntFbid:b}));c!=null&&(a=babelHelpers["extends"]({},a,{previewContentType:c}));d!=null&&(a=babelHelpers["extends"]({},a,{width:d}));e!=null&&(a=babelHelpers["extends"]({},a,{height:e}));f!=null&&(a=babelHelpers["extends"]({},a,{mediaPlayableDuration:f}));g!=null&&(a=babelHelpers["extends"]({},a,{previewContentWidth:g}));h!=null&&(a=babelHelpers["extends"]({},a,{previewContentHeight:h}));i!=null&&(a=babelHelpers["extends"]({},a,{filename:i}));return a}function z(a){a=d("WAJids").authorToUserId(a.author,d("MAWJids").userIdFromJid(d("MAWGlobals").getMyUserJid()));var b=d("MAWJids").toUserJid(a);return{senderId:a,senderJid:b}}function A(a,b,e,f,g){var h=b.content.msgId,i=b.content.externalId;return g!=null?d("MAWDexieTable").dexieResolve(g):d("MAWDbMsgTxns").maybeGetMsg(a,h).then(function(a){if(a==null)return f.then(function(a){var b=d("WAJids").threadIdForChatJid(a);if(!d("MAWEncryptedBackupCacheManager").peekRestoreCache(i)){d("MAWEncryptedBackupCacheManager").addMsgEntryToReuploadCache(e,i);d("MAWBridgeEventTransmitter").issuePointQueryOutsideTxn(i,b,void 0,c("LSMEBTaskCreationSource").EB_POINT_QUERY_IN_ACT,a);return null}else{a=(b=d("MAWEncryptedBackupCacheManager").getRestoredCache(i))==null?void 0:b.dbMsg;return d("MAWDexieTable").dexieResolve(a)}});else return d("MAWDexieTable").dexieResolve(a)})}g.constructEchoMessage=a;g.constructXMAData=v;g.constructMediaMetadata=x;g.setConditionalFields=y}),98);